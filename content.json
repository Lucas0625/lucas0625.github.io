{"meta":{"title":"Mr.chen","subtitle":null,"description":null,"author":"ç›","url":"http://lucas0625.github.io/blog"},"pages":[{"title":"About","date":"2019-05-31T08:18:32.592Z","updated":"2019-05-31T08:18:32.590Z","comments":true,"path":"about/index.html","permalink":"http://lucas0625.github.io/blog/about/index.html","excerpt":"","text":"ä¸ªäººä¿¡æ¯ å§“åï¼šLucas æ€§åˆ«ï¼šç”· ç”µå­é‚®ç®±ï¼šwangchen_jh@outlook.com Wechatï¼š751009328 ç›®å‰çŠ¶æ€ï¼šæ‘¸é±¼ğŸ¦‘"},{"title":"Categories","date":"2019-02-05T07:55:36.181Z","updated":"2019-02-04T08:28:25.234Z","comments":true,"path":"categories/index.html","permalink":"http://lucas0625.github.io/blog/categories/index.html","excerpt":"","text":""},{"title":"Tags","date":"2019-02-04T08:28:25.266Z","updated":"2019-02-04T08:28:25.246Z","comments":true,"path":"tags/index.html","permalink":"http://lucas0625.github.io/blog/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Javaé›¶åŸºç¡€å­¦ä¹ ç¬”è®°","slug":"Javaå­¦ä¹ ç¬”è®°","date":"2019-11-13T10:00:59.026Z","updated":"2019-11-13T10:47:46.964Z","comments":true,"path":"2019/11/13/Javaå­¦ä¹ ç¬”è®°/","link":"","permalink":"http://lucas0625.github.io/blog/2019/11/13/Javaå­¦ä¹ ç¬”è®°/","excerpt":"å½¢åŠ¿æ‰€è¿«ï¼Œä»é›¶å¼€å§‹å­¦Javaã€‚","text":"å½¢åŠ¿æ‰€è¿«ï¼Œä»é›¶å¼€å§‹å­¦Javaã€‚ è®¡ç®—æœºåŸºç¡€å­˜å‚¨ ä½ï¼ˆbitï¼‰ï¼Œ ä¸€ä¸ªæ•°å­—0æˆ–è€…1ï¼Œä»£è¡¨ä¸€ä½ã€‚ å­—èŠ‚ï¼ˆByteï¼‰ï¼Œæ¯é€¢8ä½æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œè¿™æ˜¯æ•°æ®å­˜å‚¨çš„æœ€å°å•ä½ã€‚ 1 Byte = 8 bit 100 Mbps å®½å¸¦ï¼Œbä»£è¡¨çš„æ˜¯ä½ï¼Œ 15 MB/S å®é™…ä¸‹è½½é€Ÿåº¦ï¼ŒBä»£è¡¨çš„æ˜¯å­—èŠ‚ã€‚ åŸºç¡€è¯­æ³•å…³é”®å­—çš„æ¦‚å¿µå’Œç‰¹å¾ å®šä¹‰ï¼šå…·æœ‰ç‰¹æ®Šå«ä¹‰çš„ï¼Œè¢«ä¿ç•™çš„ï¼Œä¸èƒ½éšæ„ä½¿ç”¨çš„å­—ç¬¦ã€‚ å…³é”®å­—çš„ç‰¹ç‚¹ï¼š å®Œå…¨å°å†™çš„å­—æ¯ã€‚ åœ¨å¢å¼ºç‰ˆè®°äº‹æœ¬ä¸­æœ‰ç‰¹æ®Šé¢œè‰²ã€‚ æ ‡å¿—ç¬¦ æ ‡å¿—ç¬¦å®šä¹‰ï¼šæ˜¯æŒ‡åœ¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å†…å®¹ã€‚æ¯”å¦‚ç±»åå­—ï¼Œæ–¹æ³•çš„åå­—å’Œå˜é‡çš„åå­—ç­‰ç­‰ã€‚ å‘½åè§„åˆ™ï¼š å¯ä»¥åŒ…å«è‹±æ–‡26ä¸ª(åŒºåˆ†å¤§å°å†™)ï¼Œ0-9æ•°å­—ï¼Œ$ï¼Œ_ ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ ä¸èƒ½æ˜¯å…³é”®å­— å‘½åè§„èŒƒï¼š ç±»åè§„èŒƒï¼šé¦–å­—æ¯å¤§å†™ï¼Œåé¢æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™(å¤§é©¼å³°å¼) æ–¹æ³•åè§„èŒƒï¼šé¦–å­—æ¯å°å†™ï¼Œåé¢æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™(å°é©¼å³°å¼) å˜é‡åè§„èŒƒï¼šåŒæ–¹æ³•åè§„èŒƒ å¸¸é‡ æ¦‚å¿µï¼šæ˜¯æŒ‡åœ¨javaç¨‹åºä¸­å›ºå®šä¸å˜çš„æ•°æ®ã€‚ åˆ†ç±»ï¼š ç±»å‹ å«ä¹‰ æ•°æ®ä¸¾ä¾‹ æ•´æ•°å¸¸é‡ æ‰€æœ‰æ•´æ•° 0ï¼Œ1ï¼Œ567ï¼Œ-9 å°æ•°å¸¸é‡ æ‰€æœ‰çš„å°æ•° 0.0, -0.1, 2.55 å­—ç¬¦å¸¸é‡ å•å¼•å·å¼•èµ·æ¥ï¼Œåªèƒ½å†™ä¸€ä¸ªå­—ç¬¦ï¼Œå¿…é¡»æœ‰å†…å®¹ â€˜aâ€™, â€˜å¥½â€™ å­—ç¬¦ä¸²å¸¸é‡ åŒå¼•å·å¼•èµ·æ¥ï¼Œå¯ä»¥å†™å¤šä¸ªå­—ç¬¦ï¼Œä¹Ÿå¯ä»¥ä¸å†™ â€œAâ€, â€œHelloâ€, â€œä½ å¥½â€, â€œâ€ å¸ƒå°”å¸¸é‡ åªæœ‰ä¸¤ä¸ªå€¼ true, false ç©ºå¸¸é‡ ä»£è¡¨æ²¡æœ‰ä»»ä½•æ•°æ®ï¼Œåªæœ‰ä¸€ä¸ªå€¼ null æ•°æ®ç±»å‹ æ•°æ®ç±»å‹åˆ†ç±»ï¼š åŸºæœ¬æ•°æ®ç±»å‹ï¼šæ•´æ•°(byte, short, int, long)ï¼Œæµ®ç‚¹æ•°(float, double)ï¼Œå­—ç¬¦(char)ï¼Œå¸ƒå°”(boolean) å¼•ç”¨æ•°æ®ç±»å‹ï¼šå­—ç¬¦ä¸²ï¼Œæ•°ç»„ï¼Œç±»ï¼Œæ¥å£ï¼ŒLambda åŸºæœ¬æ•°æ®ç±»å‹ï¼š æ•°æ®ç±»å‹ å…³é”®å­— å†…å­˜å ç”¨ å–å€¼èŒƒå›´ å­—èŠ‚å‹ byte 1ä¸ªå­—èŠ‚ -128 ï½ 127 çŸ­æ•´å‹ short 2ä¸ªå­—èŠ‚ -32768 ï½ 32767 æ•´å‹ int(é»˜è®¤) 4ä¸ªå­—èŠ‚ -2^31 ï½ 2^31 - 1 é•¿æ•´å‹ long 8ä¸ªå­—èŠ‚ -2^63 ï½ 2^63 - 1 å•ç²¾åº¦æµ®ç‚¹æ•° float 4ä¸ªå­—èŠ‚ 1.4013E-45 ï½ 3.4028E+38 åŒç²¾åº¦æµ®ç‚¹æ•° double(é»˜è®¤) 8ä¸ªå­—èŠ‚ 4.9E-324- ï½ 1.7977E+308 å­—ç¬¦å‹ char 2ä¸ªå­—èŠ‚ 0 ï½ 65535 å¸ƒå°”ç±»å‹ boolean 1ä¸ªå­—èŠ‚ trueï¼Œfalse longç±»å‹ï¼šå»ºè®®æ•°æ®ååŠ Lè¡¨ç¤ºï¼Œ1234Lfloatç±»å‹ï¼šå»ºè®®æ•°æ®ååŠ Fè¡¨ç¤ºï¼Œ1234F å˜é‡å®šä¹‰ æ ¼å¼ï¼šæ•°æ®ç±»å‹ å˜é‡å = æ•°å€¼; æ³¨æ„äº‹é¡¹ï¼š å˜é‡åç§°ï¼šåœ¨åŒä¸€ä¸ªå¤§æ‹¬å·èŒƒå›´å†…ï¼Œå˜é‡çš„åå­—ä¸å¯ä»¥ç›¸åŒã€‚ å˜é‡èµ‹å€¼ï¼šå®šä¹‰çš„å˜é‡ï¼Œä¸èµ‹å€¼ä¸èƒ½ä½¿ç”¨ã€‚ å˜é‡ä½¿ç”¨ä¸èƒ½è¶…è¿‡ä½œç”¨åŸŸçš„èŒƒå›´ã€‚(ä½œç”¨åŸŸï¼šä»å®šä¹‰å˜é‡çš„ä¸€è¡Œå¼€å§‹ï¼Œä¸€ç›´åˆ°ç›´æ¥æ‰€å±çš„å¤§æ‹¬å·ç»“æŸä¸ºæ­¢ã€‚) æ•°æ®ç±»å‹è½¬æ¢ è‡ªåŠ¨è½¬æ¢ï¼šå°†å–å€¼èŒƒå›´å°çš„ç±»å‹è‡ªåŠ¨æå‡ä¸ºå–å€¼èŒƒå›´å¤§çš„ç±»å‹ã€‚ è½¬æ¢è§„åˆ™ï¼šèŒƒå›´å°çš„å‘èŒƒå›´å¤§çš„ç±»å‹æå‡ï¼Œbyte, short, charè¿ç®—æ—¶ç›´æ¥æå‡ä¸ºint å¼ºåˆ¶è½¬æ¢ï¼šå°†å–å€¼èŒƒå›´å¤§çš„ç±»å‹å¼ºåˆ¶è½¬æ¢æˆå–å€¼èŒƒå›´å°çš„ç±»å‹ã€‚ è½¬æ¢è§„åˆ™: æ•°æ®ç±»å‹ å˜é‡å = (æ•°æ®ç±»å‹) è¢«è½¬æ•°æ®å€¼; æ³¨æ„äº‹é¡¹ï¼š1). å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸€èˆ¬ä¸æ¨èä½¿ç”¨ã€‚2). byte/short/charè¿™ä¸‰ç§ç±»å‹åœ¨è¿ç®—çš„æ—¶å€™ï¼Œé¦–å…ˆæå‡ä¸ºintç±»å‹ï¼Œç„¶åå†è®¡ç®—ã€‚3). booleanç±»å‹ä¸èƒ½å‘ç”Ÿæ•°æ®ç±»å‹è½¬æ¢ã€‚ æ•°å­—å’Œå­—ç¬¦å¯¹ç…§å…³ç³»è¡¨(ç¼–ç è¡¨)ï¼š ASCII ç è¡¨ Unicode ç è¡¨ï¼Œå¼€å¤´0-127å’ŒASCIIç è¡¨ä¸€è‡´ï¼Œä»128å¼€å§‹åŒ…å«æ›´å¤šå­—ç¬¦ã€‚ ASCIIç ï¼š å­—ç¬¦ æ•°å€¼ 0 48 9 57 A 65 Z 90 a 97 z 122 è¿ç®—ç¬¦ è¿ç®—ç¬¦ï¼šè¿›è¡Œç‰¹å®šæ“ä½œçš„ç¬¦å·ï¼Œå¦‚ï¼šâ€™+â€™ è¡¨è¾¾å¼ï¼šç”¨è¿ç®—ç¬¦è¿æ¥èµ·æ¥çš„å¼å­å«åšè¡¨è¾¾å¼ã€‚ ç®—æ•°è¿ç®—ç¬¦ ç¬¦å· è§£é‡Š + åŠ æ³•è¿ç®—ï¼Œå­—ç¬¦ä¸²è¿æ¥è¿ç®— - å‡æ³•è¿ç®— * ä¹˜æ³•è¿ç®— / é™¤æ³•è¿ç®— % å–æ¨¡è¿ç®—ï¼Œä¸¤ä¸ªæ•°å­—ç›¸é™¤å–ä½™æ•° ++ï¼Œâ€” è‡ªå¢è‡ªå‡è¿ç®— è‡ªå¢è‡ªå‡è¿ç®—æ³¨æ„äº‹é¡¹ï¼š int a = 1;int b = ++a;int b = a++; å˜é‡å‰++ï¼Œ å˜é‡aè‡ªå·±åŠ 1ï¼Œå°†åŠ 1åçš„ç»“æœèµ‹å€¼ç»™bï¼Œä¹Ÿå°±æ˜¯è¯´aå…ˆè®¡ç®—ï¼Œaå’Œbçš„ç»“æœéƒ½æ˜¯2 å˜é‡å++ï¼Œå˜é‡aå…ˆæŠŠè‡ªå·±çš„å€¼1ï¼Œèµ‹å€¼ç»™å˜é‡bï¼Œæ­¤æ—¶å˜é‡bçš„å€¼å°±æ˜¯1ï¼Œå˜é‡aè‡ªå·±å†åŠ 1ï¼Œaçš„ç»“æœæ˜¯2ï¼Œbçš„ç»“æœæ˜¯1ã€‚ +è¿ç®—ç¬¦çš„æ³¨æ„äº‹é¡¹ï¼š + ç¬¦å·åœ¨é‡åˆ°å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¿æ¥ï¼Œæ‹¼æ¥çš„å«ä¹‰ã€‚ + ç¬¦å·å†é‡åˆ°å­—ç¬¦ç±»å‹çš„æ—¶å€™ï¼Œåœ¨è®¡ç®—ä¹‹å‰charä¼šè¢«æå‡ä¸ºintï¼Œç„¶åå†è®¡ç®—ã€‚ ä»»ä½•æ•°æ®ç±»å‹å’Œå­—ç¬¦ä¸²è¿›è¡Œè¿æ¥çš„æ—¶å€™ï¼Œç»“æœéƒ½ä¼šå˜æˆå­—ç¬¦ä¸² èµ‹å€¼è¿ç®—ç¬¦ è¯´æ˜ï¼šå°†å³ä¾§çš„æ•°æ®äº¤ç»™å·¦ä¾§çš„å˜é‡ã€‚ ç¬¦å· è¯´æ˜ = ç­‰äºå· += åŠ ç­‰äº -= å‡ç­‰äº *= ä¹˜ç­‰äº /= é™¤ç­‰äº %= å–æ¨¡ç­‰ æ¯”è¾ƒè¿ç®—ç¬¦ è¯´æ˜ï¼šä¸¤ä¸ªæ•°æ®ä¹‹é—´è¿›è¡Œæ¯”è¾ƒçš„è¿ç®—ï¼Œè¿ç®—ç»“æœæ˜¯å¸ƒå°”å€¼trueæˆ–è€…false ç¬¦å· è¯´æ˜ == ä¸¤ä¾§æ˜¯å¦ç›¸ç­‰ &lt; å·¦è¾¹æ•°æ®æ˜¯å¦å°äºå³è¾¹æ•°æ® &gt; å·¦è¾¹æ•°æ®æ˜¯å¦å¤§äºå³è¾¹æ•°æ® &lt;= å·¦è¾¹æ•°æ®æ˜¯å¦å°äºç­‰äºå³è¾¹æ•°æ® &gt;= å·¦è¾¹æ•°æ®æ˜¯å¦å¤§äºç­‰äºå³è¾¹æ•°æ® != ä¸ç­‰äºç¬¦å· æ³¨æ„äº‹é¡¹ï¼šä¸èƒ½è¿ç»­æ¯”è¾ƒï¼Œæ¯”å¦‚ 1 &lt; a &lt; 3ï¼Œæ¯”è¾ƒè¿™ç§æƒ…å†µéœ€è¦ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦ï¼Œ1 &lt; a &amp;&amp; a &lt; 3ã€‚ é€»è¾‘è¿ç®—ç¬¦ è¯´æ˜ï¼šæ˜¯ç”¨æ¥è¿æ¥ä¸¤ä¸ªå¸ƒå°”ç±»å‹ç»“æœçš„è¿ç®—ç¬¦ï¼Œè¿ç®—ç»“æœéƒ½æ˜¯å¸ƒå°”å€¼trueæˆ–è€…false ç¬¦å· è¯´æ˜ &amp;&amp; ä¸è¿ç®— &#124;&#124; æˆ–è¿ç®— ! å–åè¿ç®— æ³¨æ„äº‹é¡¹ï¼š &amp;&amp; å’Œ || å…·æœ‰çŸ­è·¯æ•ˆæœï¼Œå¦‚æœæ ¹æ®å·¦è¾¹å·²ç»å¯ä»¥åˆ¤æ–­å¾—å‡ºæœ€ç»ˆç»“æœï¼Œé‚£ä¹ˆå³è¾¹çš„ä»£ç å°†ä¸å†æ‰§è¡Œï¼Œä»è€ŒèŠ‚çœä¸€å®šçš„æ€§èƒ½ã€‚ ä¸‰å…ƒè¿ç®—ç¬¦ æ ¼å¼ï¼šæ•°æ®ç±»å‹ å˜é‡å = å¸ƒå°”ç±»å‹è¡¨è¾¾å¼ï¼Ÿç»“æœ1:ç»“æœ2 public static void main(String[] args)&#123; int i = (1==2 ? 100 : 200); System.out.println(i); // 200 int j = (2&lt;=4 ? 500 : 600); System.out.println(j); // 500&#125; æ–¹æ³• å®šä¹‰ï¼šå°±æ˜¯å°†ä¸€ä¸ªåŠŸèƒ½æŠ½å–å‡ºæ¥ï¼ŒæŠŠä»£ç å•ç‹¬å®šä¹‰åœ¨ä¸€ä¸ªå¤§æ‹¬å·å†…ï¼Œå½¢æˆä¸€ä¸ªå•ç‹¬çš„åŠŸèƒ½ã€‚ æ ¼å¼ï¼š ä¿®é¥°ç¬¦ è¿”å›å€¼ç±»å‹ æ–¹æ³•å (å‚æ•°åˆ—è¡¨)&#123; ä»£ç ... reutn ;&#125; JShellçš„ä½¿ç”¨ ä½¿ç”¨åœºæ™¯ï¼šå½“æˆ‘ä»¬ç¼–å†™çš„ä»£ç éå¸¸å°‘çš„æ—¶å€™ï¼Œè€Œåˆä¸æ„¿æ„ç¼–å†™ç±»ï¼Œmainæ–¹æ³•ï¼Œä¹Ÿä¸æ„¿æ„å»ç¼–è¯‘å’Œè¿è¡Œï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨JShellå·¥å…· å¯åŠ¨æ–¹å¼ï¼šåœ¨ç»ˆç«¯ç›´æ¥è¾“å…¥jshellå‘½ä»¤ã€‚ æµç¨‹æ§åˆ¶é¡ºåºç»“æ„ å®šä¹‰ï¼šé¡ºåºæ‰§è¡Œï¼Œæ ¹æ®ç¼–å†™çš„é¡ºåºï¼Œä»ä¸Šåˆ°ä¸‹è¿è¡Œã€‚ åˆ¤æ–­è¯­å¥åˆ¤æ–­è¯­å¥1 â€” ifif (å…³ç³»è¡¨è¾¾å¼)&#123; è¯­å¥ä½“;&#125; åˆ¤æ–­è¯­å¥2 â€” ifâ€¦elseif (å…³ç³»è¡¨è¾¾å¼)&#123; è¯­å¥ä½“1;&#125;else&#123; è¯­å¥ä½“2;&#125; åˆ¤æ–­è¯­å¥3 â€” if..else ifâ€¦elseif (åˆ¤æ–­æ¡ä»¶1)&#123; æ‰§è¡Œè¯­å¥1;&#125;else if (åˆ¤æ–­æ¡ä»¶2)&#123; æ‰§è¡Œè¯­å¥2;&#125;else if (åˆ¤æ–­æ¡ä»¶3)&#123; æ‰§è¡Œè¯­å¥3;&#125;else&#123; æ‰§è¡Œè¯­å¥;&#125; é€‰æ‹©è¯­å¥ å¦‚æœæ‰€æœ‰çš„caseéƒ½ä¸æ»¡è¶³ï¼Œåˆ™æ‰§è¡Œdefaultä¸‹çš„è¯­å¥ã€‚ æ³¨æ„äº‹é¡¹ï¼šcaseåé¢ä¸å†™breakçš„æ—¶å€™ä¼šå‡ºç°ç©¿é€ç°è±¡ï¼Œç¨‹åºä¸€ç›´å‘åèµ°ï¼Œä¸ä¼šåœ¨åˆ¤æ–­caseï¼Œç›´æ¥è¿è¡Œå®Œæ•´ä½“switchæˆ–é‡åˆ°breakã€‚é‰´äºæ­¤ï¼Œåœ¨ç¼–å†™switchè¯­å¥æ—¶ï¼Œå¿…é¡»å†™ä¸Šbreakã€‚ switch(è¡¨è¾¾å¼)&#123; case å¸¸é‡å€¼1: è¯­å¥ä½“1; break; case å¸¸é‡å€¼2: è¯­å¥ä½“2; break; ... default: è¯­å¥ä½“n+1; break;&#125; å¤šä¸ªcaseåé¢çš„æ•°å€¼ä¸å¯ä»¥é‡å¤ã€‚ switchåé¢çš„å°æ‹¬å·åªèƒ½æ˜¯ä¸‹åˆ—æ•°æ®ç±»å‹ï¼š åŸºæœ¬æ•°æ®ç±»å‹: byte/short/char/int å¼•ç”¨æ•°æ®ç±»å‹: Stringå­—ç¬¦ä¸², enumæšä¸¾ å¾ªç¯è¯­å¥å¾ªç¯è¯­å¥1 â€” for æ ¼å¼ï¼š for (åˆå§‹åŒ–è¡¨è¾¾å¼; å¸ƒå°”è¡¨è¾¾å¼; æ­¥è¿›è¡¨è¾¾å¼)&#123; å¾ªç¯ä½“;&#125; å¾ªç¯è¯­å¥2 â€” while æ ¼å¼ï¼š while(å¸ƒå°”è¡¨è¾¾å¼)&#123; å¾ªç¯ä½“ï¼› æ­¥è¿›è¡¨è¾¾å¼;&#125; å¾ªç¯è¯­å¥3 â€” do..while æ ¼å¼: do&#123; å¾ªç¯ä½“; æ­¥è¿›è¡¨è¾¾å¼;&#125;while(å¸ƒå°”è¡¨è¾¾å¼); å¾ªç¯è¯­å¥çš„åŒºåˆ«: æ§åˆ¶æ¡ä»¶è¯­å¥æ‰€æ§åˆ¶çš„é‚£ä¸ªå˜é‡ï¼Œåœ¨forå¾ªç¯ç»“æŸåï¼Œå°±ä¸èƒ½åœ¨è¢«è®¿é—®åˆ°äº†ï¼Œè€Œwhileå¾ªç¯ç»“æŸè¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œå¦‚æœæƒ³ç»§ç»­ä½¿ç”¨ï¼Œå°±ç”¨whileï¼Œå¦åˆ™æ¨èä½¿ç”¨forï¼ŒåŸå› æ˜¯forå¾ªç¯ç»“æŸï¼Œè¯¥å˜é‡å°±ä»å†…å­˜ä¸­æ¶ˆå¤±äº†ï¼Œèƒ½å¤Ÿæé«˜å†…å­˜çš„ä½¿ç”¨æ•ˆç‡ã€‚ åœ¨å·²çŸ¥å¾ªç¯æ¬¡æ•°çš„æ—¶å€™æ¨èä½¿ç”¨forå¾ªç¯ï¼Œå¾ªç¯æ¬¡æ•°æœªçŸ¥çš„æ—¶å€™æ¨èä½¿ç”¨whileå¾ªç¯ã€‚ è·³å‡ºè¯­å¥ break: ç»ˆæ­¢switchæˆ–è€…å¾ªç¯ continue: ç»“æŸæœ¬æ¬¡å¾ªç¯ï¼Œç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯ æ•°ç»„ æ ¼å¼: åŠ¨æ€åˆå§‹åŒ–ï¼š æ•°æ®ç±»å‹[] æ•°ç»„åç§° = new æ•°æ®ç±»å‹[æ•°ç»„é•¿åº¦] é™æ€åˆå§‹åŒ–ï¼š æ•°æ®ç±»å‹[] æ•°ç»„åç§° = new æ•°æ®ç±»å‹[] {å…ƒç´ 1, å…ƒç´ 2, â€¦} æ•°æ®ç±»å‹[] æ•°ç»„åç§° = {å…ƒç´ 1, å…ƒç´ 2, ... } javaå†…å­˜åˆ’åˆ† æ ˆ Stack: å­˜æ”¾çš„éƒ½æ˜¯æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ã€‚æ–¹æ³•çš„è¿è¡Œä¸€å®šè¦åœ¨æ ˆå½“ä¸­ã€‚ å±€éƒ¨å˜é‡ï¼šæ–¹æ³•çš„å‚æ•°ï¼Œæˆ–è€…æ˜¯æ–¹æ³•å†…éƒ¨çš„å˜é‡ã€‚ ä½œç”¨åŸŸï¼šä¸€æ—¦è¶…å‡ºä½œç”¨åŸŸï¼Œç«‹åˆ»ä»æ ˆå†…å­˜å½“ä¸­æ¶ˆå¤±ã€‚ å † Heapï¼šå‡¡æ˜¯newå‡ºæ¥çš„ä¸œè¥¿ï¼Œéƒ½åœ¨å †ä¸­ã€‚å †å†…å­˜é‡Œé¢çš„ä¸œè¥¿éƒ½æœ‰ä¸€ä¸ªåœ°å€å€¼ï¼š16è¿›åˆ¶ï¼Œå †å†…å­˜é‡Œé¢çš„æ•°æ®ï¼Œéƒ½æœ‰é»˜è®¤å€¼ï¼Œè§„åˆ™ï¼š æ•´æ•° é»˜è®¤ 0 æµ®ç‚¹æ•° é»˜è®¤ 0.0 å­—ç¬¦ é»˜è®¤ â€˜\\u0000â€™ å¸ƒå°” é»˜è®¤ false å¼•ç”¨ç±»å‹ é»˜è®¤ null æ–¹æ³•åŒº Method Areaï¼š å­˜å‚¨classç›¸å…³ä¿¡æ¯ï¼ŒåŒ…å«æ–¹æ³•çš„ä¿¡æ¯ã€‚ æœ¬åœ°æ–¹æ³•æ ˆ Native Method Stackï¼šä¸æ“ä½œç³»ç»Ÿç›¸å…³ã€‚ å¯„å­˜å™¨ pc Register: ä¸CPUç›¸å…³ã€‚ é¢å‘å¯¹è±¡æ€æƒ³é¢å‘å¯¹è±¡æ€æƒ³æ¦‚è¿° é¢å‘è¿‡ç¨‹ï¼šå½“éœ€è¦å®ç°ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œæ¯ä¸€ä¸ªå…·ä½“çš„æ­¥éª¤éƒ½è¦äº²åŠ›äº²ä¸ºï¼Œè¯¦ç»†å¤„ç†æ¯ä¸€ä¸ªç»†èŠ‚ã€‚ é¢å‘å¯¹è±¡ï¼šå½“éœ€è¦å®ç°ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œä¸å…³å¿ƒå…·ä½“çš„æ­¥éª¤ï¼Œè€Œæ˜¯æ‰¾ä¸€ä¸ªå·²ç»å…·æœ‰è¯¥åŠŸèƒ½çš„äººï¼Œæ¥å¸®æˆ‘åšäº‹ã€‚ é¢å‘å¯¹è±¡ç‰¹ç‚¹å°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ ç±»å’Œå¯¹è±¡ ç±»ï¼šæ˜¯ä¸€ç»„ç›¸å…³å±æ€§å’Œè¡Œä¸ºå’Œé›†åˆï¼Œå¯ä»¥çœ‹æˆæ˜¯ä¸€ç±»äº‹ç‰©çš„æ¨¡ç‰ˆï¼Œä½¿ç”¨äº‹ç‰©çš„å±æ€§ç‰¹å¾å’Œè¡Œä¸ºç‰¹å¾æ¥æè¿°è¯¥ç±»äº‹ç‰©ã€‚æ˜¯æŠ½è±¡çš„ã€‚ å¯¹è±¡ï¼šæ˜¯ä¸€ç±»äº‹ç‰©çš„å…·ä½“ä½“ç°ã€‚å¯¹è±¡æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œå¿…ç„¶å…·å¤‡è¯¥ç±»äº‹ç‰©çš„å±æ€§å’Œè¡Œä¸ºã€‚æ˜¯å…·ä½“çš„ã€‚ ç±»å’Œå¯¹è±¡çš„å…³ç³»ï¼šç±»æ˜¯å¯¹è±¡çš„æ¨¡ç‰ˆï¼Œå¯¹è±¡æ˜¯ç±»çš„å®ä½“ã€‚ ç±»çš„å®šä¹‰ ç±»çš„å®šä¹‰æ ¼å¼ï¼š public class ClassName&#123; // æˆå‘˜å˜é‡ String name; //å§“å // æˆå‘˜æ–¹æ³• public void study()&#123; System.out.println(\"å¥½å¥½å­¦ä¹ ï¼\"); &#125;&#125; å¯¹è±¡çš„ä½¿ç”¨æ ¼å¼: ç±»å å¯¹è±¡å = new ç±»å();``` ### å±€éƒ¨å˜é‡å’Œæˆå‘˜å˜é‡1. åŒºåˆ«ï¼š```javapublic class Car&#123; String color; //æˆå‘˜å˜é‡ public void drive()&#123; int speed = 80; //å±€éƒ¨å˜é‡ System.out.println(\"æ—¶é€Ÿ\" + speed); &#125;&#125; å°è£…æ€§ å®šä¹‰ï¼šå°è£…å°±æ˜¯å°†ä¸€äº›ç»†èŠ‚ä¿¡æ¯éšè—èµ·æ¥ï¼Œå¯¹äºå¤–ç•Œä¸å¯è§ã€‚ æ–¹æ³•å°±æ˜¯ä¸€ç§å°è£…ã€‚ å…³é”®å­—privateä¹Ÿæ˜¯ä¸€ç§å°è£…ã€‚ è®¿é—®ç§æœ‰æˆå‘˜å˜é‡ï¼šæä¾›getXxxæ–¹æ³•å’ŒsetXxxæ–¹æ³•ã€‚ å°è£…ä¼˜åŒ–1 â€” thiså…³é”®å­— å¦‚æœéœ€è¦è®¿é—®æœ¬ç±»ä¸­çš„æˆå‘˜å˜é‡ï¼Œéœ€è¦ä½¿ç”¨this.æˆå‘˜å˜é‡å é€šè¿‡è°è°ƒç”¨çš„æ–¹æ³•ï¼Œè°å°±æ˜¯this å°è£…ä¼˜åŒ–2 â€” æ„é€ æ–¹æ³• æ ¼å¼ï¼š public ç±»åç§°(å‚æ•°ç±»å‹ å‚æ•°åç§°)&#123; æ–¹æ³•ä½“;&#125; ä½œç”¨ï¼šä¸“é—¨ç”¨æ¥åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå½“æˆ‘ä»¬é€šè¿‡å…³é”®å­— new æ¥åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå°±æ˜¯åœ¨è°ƒç”¨æ„é€ æ–¹æ³•ã€‚ å¦‚æœæ²¡æœ‰ç¼–å†™ä»»ä½•æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±ä¼šé»˜è®¤å†™ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œæ²¡æœ‰å‚æ•°ï¼Œæ–¹æ³•ä½“ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ javaè¯­è¨€æ ‡å‡†ç±»è§„èŒƒ-javaBeanç±» public class ClassName&#123; // æˆå‘˜å˜é‡ // æ„é€ æ–¹æ³• // æ— å‚æ„é€ æ–¹æ³•ã€å¿…é¡»ã€‘ // æœ‰å‚æ„é€ æ–¹æ³•ã€å»ºè®®ã€‘ // æˆå‘˜æ–¹æ³• // getXxx() // setXxx()&#125;public class Student&#123; // æˆå‘˜å˜é‡ private String name; private int age; // æ„é€ æ–¹æ³• public Student()&#123;&#125; public Student(String name, int age)&#123; this.name = name; this.age = age; &#125; // æˆå‘˜æ–¹æ³• public void setName(String name)&#123; this.name = name; &#125; public void getName()&#123; return name; &#125; public void setAge(int age)&#123; this.age = age; &#125; public int getAge()&#123; return age; &#125;&#125;","categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://lucas0625.github.io/blog/categories/ç¼–ç¨‹/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://lucas0625.github.io/blog/tags/Java/"}]},{"title":"ä¼ ç»Ÿæ–‡æœ¬ç›¸ä¼¼åº¦ç®—æ³•","slug":"class-text-similarity","date":"2019-08-07T09:46:55.293Z","updated":"2019-08-08T01:29:58.053Z","comments":true,"path":"2019/08/07/class-text-similarity/","link":"","permalink":"http://lucas0625.github.io/blog/2019/08/07/class-text-similarity/","excerpt":"ä»‹ç»TF-IDFå’ŒBM25","text":"ä»‹ç»TF-IDFå’ŒBM25 æ–‡æœ¬ç›¸ä¼¼åº¦ç®—æ³•TFâˆ’IDF ç®—æ³•ç†è®º TFæ˜¯æŒ‡å½’ä¸€åŒ–åçš„è¯é¢‘ï¼ŒIDFæ˜¯æŒ‡é€†æ–‡æ¡£é¢‘ç‡ã€‚ç»™å®šä¸€ä¸ªæ–‡æ¡£é›†åˆ Dï¼Œæœ‰ $d_1,d_2,d_3,â€¦â€¦,d_n âˆˆ D$ã€‚æ–‡æ¡£é›†åˆæ€»å…±åŒ…å« m ä¸ªè¯ï¼ˆæ³¨ï¼šä¸€èˆ¬åœ¨è®¡ç®— TFâˆ’IDFæ—¶ä¼šå»é™¤å¦‚ â€œçš„â€ è¿™ä¸€ç±»çš„åœç”¨è¯ï¼‰ï¼Œæœ‰ $w_1,w_2,w_3,â€¦â€¦,w_m âˆˆW $ ã€‚æˆ‘ä»¬ç°åœ¨ä»¥è®¡ç®—è¯ $w_i$ åœ¨æ–‡æ¡£ $d_j$ ä¸­çš„ TFâˆ’IDF æŒ‡ä¸ºä¾‹ã€‚TFçš„è®¡ç®—å…¬å¼ä¸ºï¼š T F=\\frac{f r e q(i, j)}{\\max _{l e n}(j)} åœ¨è¿™é‡Œ $freq(i,j)$ ä¸º $wi$ åœ¨ $d_j$ ä¸­å‡ºç°çš„é¢‘ç‡ï¼Œ$max{len}(j)$ ä¸º $d_j$ é•¿åº¦ã€‚ TF åªèƒ½æ˜¯æè¿°è¯åœ¨æ–‡æ¡£ä¸­çš„é¢‘ç‡ï¼Œä½†å‡è®¾ç°åœ¨æœ‰ä¸ªè¯ä¸º â€ æˆ‘ä»¬ â€œï¼Œè¿™ä¸ªè¯å¯èƒ½åœ¨æ–‡æ¡£é›† D ä¸­æ¯ç¯‡æ–‡æ¡£ä¸­éƒ½ä¼šå‡ºç°ï¼Œå¹¶ä¸”æœ‰è¾ƒé«˜çš„é¢‘ç‡ã€‚é‚£ä¹ˆè¿™ä¸€ç±»è¯å°±ä¸å…·æœ‰å¾ˆå¥½çš„åŒºåˆ†æ–‡æ¡£çš„èƒ½åŠ›ï¼Œä¸ºäº†é™ä½è¿™ç§é€šç”¨è¯çš„ä½œç”¨ï¼Œå¼•å…¥äº† IDF ã€‚ IDFçš„è¡¨è¾¾å¼å¦‚ä¸‹ï¼š IDF = \\log (\\frac {len(D)} {n(i)}) åœ¨è¿™é‡Œ $len(D)$ è¡¨ç¤ºæ–‡æ¡£é›†åˆ $D$ ä¸­æ–‡æ¡£çš„æ€»æ•°ï¼Œ$n(i)$ è¡¨ç¤ºå«æœ‰ $w_i$ è¿™ä¸ªè¯çš„æ–‡æ¡£çš„æ•°é‡ã€‚ å¾—åˆ° TF å’Œ IDF ä¹‹åï¼Œæˆ‘ä»¬å°†è¿™ä¸¤ä¸ªå€¼ç›¸ä¹˜å¾—åˆ° TFâˆ’IDF çš„å€¼ï¼š TF-IDF = TF * IDF TF å¯ä»¥è®¡ç®—åœ¨ä¸€ç¯‡æ–‡æ¡£ä¸­è¯å‡ºç°çš„é¢‘ç‡ï¼Œè€Œ IDF å¯ä»¥é™ä½ä¸€äº›é€šç”¨è¯çš„ä½œç”¨ã€‚å› æ­¤å¯¹äºä¸€ç¯‡æ–‡æ¡£æˆ‘ä»¬å¯ä»¥ç”¨æ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„ TFâˆ’IDF ç»„æˆçš„å‘é‡æ¥è¡¨ç¤ºè¯¥æ–‡æ¡£ï¼Œå†æ ¹æ®ä½™å¼¦ç›¸ä¼¼åº¦è¿™ç±»çš„æ–¹æ³•æ¥è®¡ç®—æ–‡æ¡£ä¹‹é—´çš„ç›¸å…³æ€§ã€‚ ä»£ç å®ç°import mathimport jiebaclass TFIDF(object): def __init__(self, docs): self.D = len(docs) self.docs = docs self.f = [] # åˆ—è¡¨çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªdictï¼Œdictå­˜å‚¨ç€ä¸€ä¸ªæ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„å‡ºç°æ¬¡æ•° self.df = &#123;&#125; # å­˜å‚¨æ¯ä¸ªè¯åŠå‡ºç°äº†è¯¥è¯çš„æ–‡æ¡£æ•°é‡ self.idf = &#123;&#125; # å­˜å‚¨æ¯ä¸ªè¯çš„idfå€¼ self.init() def init(self): for doc in self.docs: tmp = &#123;&#125; for word in [item for item in jieba.cut(doc, cut_all=True)]: tmp[word] = tmp.get(word, 0) + 1 # å­˜å‚¨æ¯ä¸ªæ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„å‡ºç°æ¬¡æ•° self.f.append(tmp) for k in tmp.keys(): self.df[k] = self.df.get(k, 0) + 1 for k, v in self.df.items(): self.idf[k] = math.log(self.D) - math.log(v) def get_tfidf(self, index): tf_idf = [] for word, count in self.f[index].items(): tf = count / len(self.f[index].keys()) tf_idf.append(tf * self.idf[word]) return tf_idf BM25 ç®—æ³•ç†è®º BM25 ç®—æ³•é€šå¸¸ç”¨æ¥åšæœç´¢ç›¸å…³æ€§è¯„åˆ†çš„ï¼Œä¹Ÿæ˜¯ ES ä¸­çš„æœç´¢ç®—æ³•ï¼Œé€šå¸¸ç”¨æ¥è®¡ç®— query å’Œæ–‡æœ¬é›†åˆ D ä¸­æ¯ç¯‡æ–‡æœ¬ä¹‹é—´çš„ç›¸å…³æ€§ã€‚æˆ‘ä»¬ç”¨ Q è¡¨ç¤º queryï¼Œåœ¨è¿™é‡Œ Q ä¸€èˆ¬æ˜¯ä¸€ä¸ªå¥å­ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬è¦å¯¹ Q è¿›è¡Œè¯­ç´ è§£æï¼ˆä¸€èˆ¬æ˜¯åˆ†è¯ï¼‰ï¼Œåœ¨è¿™é‡Œä»¥åˆ†è¯ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯¹ Q è¿›è¡Œåˆ†è¯ï¼Œå¾—åˆ° $q_1, q_2,â€¦â€¦, q_t$ è¿™æ ·ä¸€ä¸ªè¯åºåˆ—ã€‚ç»™å®šæ–‡æœ¬ $d \\in D$ï¼Œç°åœ¨ä»¥è®¡ç®— Q å’Œ d ä¹‹é—´çš„åˆ†æ•°ï¼ˆç›¸å…³æ€§ï¼‰ï¼Œå…¶è¡¨è¾¾å¼å¦‚ä¸‹ï¼š Score(Q, d) = \\sum_{i = 1}^t w_i * R(q_i, d) ä¸Šé¢å¼å­ä¸­ $w_i$ è¡¨ç¤º $q_i$ çš„æƒé‡ï¼Œ$R(q_i, d)$ ä¸º $q_i$ å’Œ $d$ çš„ç›¸å…³æ€§ï¼Œ$Score(Q, d)$ å°±æ˜¯æ¯ä¸ªè¯­ç´  $q_i$ å’Œ $d$ çš„ç›¸å…³æ€§çš„åŠ æƒå’Œã€‚ $w_i$ çš„è®¡ç®—æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¸€èˆ¬æ˜¯ç”¨ $IDF$ æ¥è¡¨ç¤ºçš„ï¼Œä½†è¿™é‡Œçš„ $IDF$ è®¡ç®—å’Œä¸Šé¢çš„æœ‰æ‰€ä¸åŒï¼Œå…·ä½“çš„è¡¨è¾¾å¼å¦‚ä¸‹ï¼š IDF(q_i) = \\log \\frac {N - n(q_i) + 0.5} {n(q_i) + 0.5} ä¸Šé¢å¼å­ä¸­ $N$ è¡¨ç¤ºæ–‡æœ¬é›†åˆä¸­æ–‡æœ¬çš„æ€»æ•°é‡ï¼Œ$n(q_i)$ è¡¨ç¤ºåŒ…å« $q_i$ è¿™ä¸ªè¯çš„æ–‡æœ¬çš„æ•°é‡ï¼Œ$0.5$ ä¸»è¦æ˜¯åšå¹³æ»‘å¤„ç†ã€‚ $R(q_i, d)$ çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š R(q_i, d) = \\frac {f_i * (k_1 + 1)} {f_i + K} * \\frac {qf_i * (k_2 + 1)} {qf_i + k_2} å…¶ä¸­ K = k_1 * (1 - b + b * \\frac {dl} {avg dl}) ä¸Šé¢å¼å­ä¸­ $f_i$ ä¸º $q_i$ åœ¨æ–‡æœ¬ $d$ ä¸­å‡ºç°çš„é¢‘ç‡ï¼Œ$qf_i$ ä¸º $q_i$ åœ¨ $Q$ ä¸­å‡ºç°çš„é¢‘ç‡ï¼Œ$k_1, k_2, b$éƒ½æ˜¯å¯è°ƒèŠ‚çš„å‚æ•°ï¼Œ$dl, avg dl$åˆ†åˆ«ä¸ºæ–‡æœ¬ $d$ çš„é•¿åº¦å’Œæ–‡æœ¬é›† $D$ ä¸­æ‰€æœ‰æ–‡æœ¬çš„å¹³å‡é•¿åº¦ã€‚ ä¸€èˆ¬ $qf_i = 1$ ï¼Œå– $k_2 = 0$ ï¼Œåˆ™å¯ä»¥å»é™¤åä¸€é¡¹ï¼Œå°†ä¸Šé¢å¼å­æ”¹å†™æˆï¼š R(q_i, d) = \\frac {f_i * (k_1 + 1)} {f_i + K} é€šå¸¸è®¾ç½® $k_1 = 2, b = 0.75$ã€‚å‚æ•° $b$ çš„ä½œç”¨ä¸»è¦æ˜¯è°ƒèŠ‚æ–‡æœ¬é•¿åº¦å¯¹ç›¸å…³æ€§çš„å½±å“ã€‚ ä»£ç å®ç°import mathimport jiebaclass BM25(object): def __init__(self, docs): self.D = len(docs) self.avgdl = sum([len(doc) for doc in docs]) / self.D self.docs = docs self.f = [] # åˆ—è¡¨çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªdictï¼Œdictå­˜å‚¨ç€ä¸€ä¸ªæ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„å‡ºç°æ¬¡æ•° self.df = &#123;&#125; # å­˜å‚¨æ¯ä¸ªè¯åŠå‡ºç°äº†è¯¥è¯çš„æ–‡æ¡£æ•°é‡ self.idf = &#123;&#125; # å­˜å‚¨æ¯ä¸ªè¯çš„idfå€¼ self.k1 = 2.0 self.b = 0.75 self.init() def init(self): for doc in self.docs: tmp = &#123;&#125; for word in [item for item in jieba.cut(doc, cut_all=True)]: tmp[word] = tmp.get(word, 0) + 1 # å­˜å‚¨æ¯ä¸ªæ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„å‡ºç°æ¬¡æ•° self.f.append(tmp) for k in tmp.keys(): self.df[k] = self.df.get(k, 0) + 1 for k, v in self.df.items(): self.idf[k] = math.log(self.D-v+0.5) - math.log(v+0.5) def get_score(self, doc, index): ''' :param doc: å¾…æŸ¥è¯¢çš„æ–‡æœ¬ :param index: å·²çŸ¥æ–‡æ¡£é›†åˆçš„ç´¢å¼•ï¼Œindex=0 è¡¨ç¤ºè®¡ç®—å¾…æŸ¥è¯¢æ–‡æœ¬ä¸ç¬¬ä¸€ä¸ªæ–‡æœ¬ä¹‹é—´çš„åˆ†æ•°ã€‚ :return: åˆ†æ•° ''' score = 0 for word in [item for item in jieba.cut(doc, cut_all=True)]: if word not in self.f[index]: continue d = len(self.docs[index]) score += (self.idf[word]*self.f[index][word]*(self.k1+1) / (self.f[index][word]+self.k1*(1-self.b+self.b*d / self.avgdl))) # print(score) return score def get_scores(self, doc): scores = [] for index in range(self.D): score = self.get_score(doc, index) scores.append(score) return scores","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"åƒåœ¾é‚®ä»¶åˆ†ç±»","slug":"email-category","date":"2019-06-14T06:41:26.939Z","updated":"2019-06-14T06:43:56.838Z","comments":true,"path":"2019/06/14/email-category/","link":"","permalink":"http://lucas0625.github.io/blog/2019/06/14/email-category/","excerpt":"åˆ©ç”¨ æœ´ç´ è´å¶æ–¯ æ–¹æ³•ï¼Œå¯¹åƒåœ¾é‚®ä»¶è¿›è¡Œåˆ†ç±»ã€‚","text":"åˆ©ç”¨ æœ´ç´ è´å¶æ–¯ æ–¹æ³•ï¼Œå¯¹åƒåœ¾é‚®ä»¶è¿›è¡Œåˆ†ç±»ã€‚ æ•°æ®é›†ç›®æ ‡å¤„ç†æµç¨‹ä»£ç ç»“è®º","categories":[{"name":"å°å‹é¡¹ç›®","slug":"å°å‹é¡¹ç›®","permalink":"http://lucas0625.github.io/blog/categories/å°å‹é¡¹ç›®/"}],"tags":[{"name":"å®æˆ˜","slug":"å®æˆ˜","permalink":"http://lucas0625.github.io/blog/tags/å®æˆ˜/"}]},{"title":"åŸºæœ¬å¾ªç¯ç¥ç»ç½‘è·¯-RNNï¼ŒLSTMï¼ŒGRU","slug":"classic-RNN-LSTM-GRU","date":"2019-05-31T08:32:59.359Z","updated":"2019-05-31T09:17:36.691Z","comments":true,"path":"2019/05/31/classic-RNN-LSTM-GRU/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/31/classic-RNN-LSTM-GRU/","excerpt":"å¾ªç¯ç¥ç»ç½‘ç»œRNN,LSTM,GRUçš„ä½¿ç”¨","text":"å¾ªç¯ç¥ç»ç½‘ç»œRNN,LSTM,GRUçš„ä½¿ç”¨ RNN è°ƒç”¨æ–¹å¼ï¼š torch.nn.RNNCell() torch.nn.RNN() åŒºåˆ«ï¼šRNNCell() åªèƒ½æ¥å—åºåˆ—ä¸­å•æ­¥çš„è¾“å…¥ï¼Œä¸”å¿…é¡»ä¼ å…¥éšè—çŠ¶æ€ï¼Œè€Œ RNN() å¯ä»¥æ¥å—ä¸€ä¸ªåºåˆ—çš„è¾“å…¥ï¼Œé»˜è®¤ä¼šä¼ å…¥å…¨ 0 çš„éšè—çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ç”³æ˜éšè—çŠ¶æ€ä¼ å…¥ã€‚ RNNCell() å‚æ•° å‚æ•° å«ä¹‰ input_size è¡¨ç¤ºè¾“å…¥ $x_t$ çš„ç‰¹å¾ç»´åº¦ hidden_size è¡¨ç¤ºè¾“å‡ºçš„ç‰¹å¾ç»´åº¦ bias è¡¨ç¤ºæ˜¯å¦ä½¿ç”¨åç½®ï¼Œé»˜è®¤ä½¿ç”¨ nonlinearity è¡¨ç¤ºé€‰ç”¨çš„éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œé»˜è®¤æ˜¯ â€˜tanhâ€™ RNN() å‚æ•° å‚æ•° å«ä¹‰ input_size è¡¨ç¤ºè¾“å…¥ $x_t$ çš„ç‰¹å¾ç»´åº¦ hidden_size è¡¨ç¤ºè¾“å‡ºçš„ç‰¹å¾ç»´åº¦ num_layers è¡¨ç¤ºç½‘ç»œçš„å±‚æ•° nonlinearity è¡¨ç¤ºé€‰ç”¨çš„éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œé»˜è®¤æ˜¯ â€˜tanhâ€™ bias è¡¨ç¤ºæ˜¯å¦ä½¿ç”¨åç½®ï¼Œé»˜è®¤ä½¿ç”¨ batch_first è¡¨ç¤ºè¾“å…¥æ•°æ®çš„å½¢å¼ï¼Œé»˜è®¤æ˜¯ Falseï¼Œå°±æ˜¯è¿™æ ·å½¢å¼ï¼Œ(seq, batch, feature)ï¼Œä¹Ÿå°±æ˜¯å°†åºåˆ—é•¿åº¦æ”¾åœ¨ç¬¬ä¸€ä½ï¼Œbatch æ”¾åœ¨ç¬¬äºŒä½ dropout è¡¨ç¤ºæ˜¯å¦åœ¨è¾“å‡ºå±‚åº”ç”¨ dropout bidirectional è¡¨ç¤ºæ˜¯å¦ä½¿ç”¨åŒå‘çš„ RNNï¼Œé»˜è®¤æ˜¯ False import torchfrom torch.autograd import Variablefrom torch import nn # å®šä¹‰ä¸€ä¸ªå•æ­¥çš„ rnnrnn_single = nn.RNNCell(input_size=100, hidden_size=200) # è®¿é—®å…¶ä¸­çš„å‚æ•°rnn_single.weight_hh Parameter containing: tensor([[-0.0017, -0.0512, -0.0353, ..., 0.0567, 0.0081, 0.0408], [ 0.0489, 0.0315, 0.0233, ..., 0.0467, -0.0075, 0.0536], [ 0.0581, 0.0614, -0.0220, ..., -0.0251, 0.0210, -0.0058], ..., [-0.0100, 0.0681, -0.0473, ..., -0.0219, -0.0165, -0.0567], [-0.0447, 0.0149, 0.0063, ..., -0.0212, -0.0591, -0.0601], [-0.0382, -0.0337, -0.0404, ..., -0.0365, -0.0420, 0.0293]], requires_grad=True) å°±æ˜¯ä¸Šå›¾çš„çŸ©é˜µ A # æ„é€ ä¸€ä¸ªåºåˆ—ï¼Œé•¿ä¸º 6ï¼Œ batch æ˜¯ 5ï¼Œ ç‰¹å¾æ˜¯ 100x = Variable(torch.randn(6, 5, 100)) # RNN çš„è¾“å…¥æ ¼å¼ x tensor([[[-2.0104, 0.2796, 1.5232, ..., -1.8635, 0.0042, 0.5422], [ 1.2934, -0.4782, -1.1989, ..., -0.6775, 0.4277, -0.3155], [ 0.4077, -0.3299, 0.0967, ..., -1.0189, 0.0975, 0.7678], [-1.6604, -0.7599, -0.3706, ..., -0.2911, 2.4880, 0.4783], [-1.5688, 1.1583, -0.3489, ..., 0.3275, 1.0333, -1.2397]], [[ 0.6300, 0.5252, 0.7385, ..., 0.2579, -0.0397, -1.1270], [ 1.3801, 0.7126, -0.2537, ..., -0.4507, 2.1889, 0.7648], [-0.9598, -0.0850, 0.6514, ..., 0.7625, 1.0525, -0.2042], [ 0.1205, 0.0997, 0.7736, ..., 0.5133, -1.9996, 0.2184], [-2.4407, 0.2622, 0.6602, ..., 0.4392, -0.3943, -0.5903]], [[-2.0361, 0.3635, -0.2484, ..., -0.2929, -1.0250, -0.9464], [-1.1445, -0.7474, 1.3661, ..., -0.0825, -0.9291, -1.2322], [ 1.2757, 0.5088, -0.0305, ..., 1.0552, -1.7565, -0.9720], [ 1.0957, 1.7836, 1.2204, ..., -0.4245, -0.3996, -0.5425], [ 0.2476, 0.2516, -0.9161, ..., 1.0104, 0.8708, -1.5077]], [[-0.5922, -0.1151, -0.8730, ..., 2.0240, 0.0284, 0.4642], [ 0.8369, -0.0199, 1.4351, ..., 0.8096, -1.4119, 0.4124], [ 0.1630, -1.3134, -0.1717, ..., 0.9940, 1.4097, -1.0362], [ 2.1787, 0.8273, -0.4433, ..., -0.6921, -1.7547, 0.8085], [ 0.3586, 0.6565, 1.6782, ..., 0.1528, -1.7319, 0.2215]], [[-1.1259, 1.8154, -0.6593, ..., 1.5540, 1.4334, -1.5127], [ 1.3139, 0.8352, 1.4495, ..., 0.8871, 0.0298, 0.5145], [ 0.3252, 0.3663, 0.3321, ..., -1.9635, -0.0162, 1.8176], [-0.3583, 1.0319, 0.9324, ..., -0.0877, 0.5046, 0.8212], [ 0.0805, -0.5177, 0.6721, ..., -0.2758, -1.7134, 0.6457]], [[ 0.6160, -0.2190, 0.1615, ..., 0.0088, 1.0142, 0.1040], [-0.6514, -0.5932, -0.1138, ..., 2.3709, 0.9282, 1.5059], [ 1.7666, 0.5471, 0.6585, ..., 0.4704, 0.7371, 0.7960], [ 1.2190, -0.4006, 1.7100, ..., -0.5754, 0.5801, 0.9159], [-0.8331, -0.5066, -0.3903, ..., -0.2636, -0.8551, 1.0103]]]) # å®šä¹‰åˆå§‹çš„è®°å¿†çŠ¶æ€h_t = Variable(torch.zeros(5, 200)) # ä¼ å…¥ RNNout = []# é€šè¿‡ 6 æ¬¡å¾ªç¯ä½œç”¨åœ¨æ•´ä¸ªåºåˆ—ä¸Šfor i in range(6): h_t = rnn_single(x[i], h_t) out.append(h_t) len(out) 6 out[0].shape # æ¯ä¸ªè¾“å‡ºçš„çº¬åº¦ torch.Size([5, 200]) # ç›´æ¥ä½¿ç”¨ RNNrnn_seq = nn.RNN(100, 200) # è®¿é—®å…¶ä¸­çš„å‚æ•°rnn_seq.weight_hh_l0 Parameter containing: tensor([[ 0.0367, -0.0456, 0.0555, ..., -0.0535, 0.0080, 0.0198], [ 0.0440, 0.0042, 0.0356, ..., -0.0534, -0.0374, 0.0550], [-0.0172, -0.0028, -0.0425, ..., 0.0308, 0.0062, -0.0474], ..., [-0.0336, -0.0054, 0.0188, ..., -0.0328, 0.0329, 0.0065], [-0.0484, -0.0571, 0.0554, ..., 0.0681, 0.0305, -0.0171], [ 0.0591, -0.0093, -0.0581, ..., 0.0669, -0.0276, -0.0002]], requires_grad=True) out, h_t = rnn_seq(x) # ä½¿ç”¨é»˜è®¤çš„å…¨ 0 éšè—çŠ¶æ€# h_t æ˜¯ç½‘ç»œæœ€åçš„éšè—çŠ¶æ€ len(out) 6 # è‡ªå·±å®šä¹‰åˆå§‹çš„éšè—çŠ¶æ€# ä¸‰ä¸ªçº¬åº¦ (nums_layers * num_direction, batch, hidden_size)h_0 = Variable(torch.randn(1, 5, 200)) out, h_t = rnn_seq(x, h_0) # è¾“å‡ºç»“æœ(seq, batch, feature)out.shape torch.Size([6, 5, 200]) LSTMå’Œ RNNç±»ä¼¼ lstm_seq = nn.LSTM(50, 100, num_layers=2) # è¾“å…¥çº¬åº¦ 100ï¼Œ è¾“å‡º 200ï¼Œ ä¸¤å±‚ lstm_seq.weight_hh_l0 # ç¬¬ä¸€å±‚çš„ h_t æƒé‡ Parameter containing: tensor([[ 0.0144, 0.0360, 0.0436, ..., 0.0026, 0.0195, -0.0283], [-0.0724, -0.0119, -0.0976, ..., 0.0060, 0.0651, -0.0557], [ 0.0106, -0.0049, -0.0543, ..., -0.0541, 0.0663, 0.0701], ..., [-0.0481, 0.0589, -0.0284, ..., 0.0673, -0.0895, -0.0900], [ 0.0466, -0.0856, 0.0445, ..., -0.0995, 0.0051, -0.0333], [-0.0520, 0.0953, 0.0334, ..., -0.0382, 0.0038, 0.0300]], requires_grad=True) lstm_input = Variable(torch.randn(10, 3, 50)) # åºåˆ— 10ï¼Œ batch æ˜¯ 3ï¼Œè¾“å…¥çº¬åº¦ 50 out, (h, c) = lstm_seq(lstm_input) # ä½¿ç”¨é»˜è®¤å…¨ 0 éšè—çŠ¶æ€ LSTM è¾“å‡ºçš„éšè—çŠ¶æ€æœ‰ä¸¤ä¸ªï¼Œ h å’Œ cï¼Œ æŒ‡ä¸Šå›¾ä¸­æ¯ä¸ª cell ä¹‹é—´çš„ä¸¤ä¸ªç®­å¤´ï¼Œè¿™ä¸¤ä¸ªéšè—çŠ¶æ€çš„å¤§å°éƒ½æ˜¯ç›¸åŒçš„ï¼Œ(num_layers * direction, batch, feature) h.shape # ä¸¤å±‚ï¼Œ batch æ˜¯ 3ï¼Œ ç‰¹å¾æ˜¯ 100 torch.Size([2, 3, 100]) c.shape torch.Size([2, 3, 100]) # å¦‚æœä¸ä½¿ç”¨é»˜è®¤éšè—çŠ¶æ€ï¼Œéœ€è¦ä¼ å…¥ä¸¤ä¸ªå¼ é‡h_init = Variable(torch.randn(2, 3, 100))c_init = Variable(torch.randn(2, 3, 100)) out, (h, c) = lstm_seq(lstm_input, (h_init, c_init)) h.shape torch.Size([2, 3, 100]) c.shape torch.Size([2, 3, 100]) out.shape torch.Size([10, 3, 100]) GRU gru_seq = nn.GRU(10, 20)gru_input = Variable(torch.randn(3, 32, 10))out, h = gru_seq(gru_input) gru_seq.weight_hh_l0 Parameter containing: tensor([[-0.1429, 0.2029, 0.0808, ..., -0.1313, -0.0468, -0.2004], [ 0.1702, 0.1171, -0.0227, ..., 0.1935, 0.0337, 0.1462], [-0.0190, 0.1536, 0.1593, ..., -0.1864, 0.1081, -0.1402], ..., [ 0.0619, 0.0313, -0.0003, ..., -0.1213, -0.0944, 0.1185], [ 0.0532, -0.1704, 0.1925, ..., -0.1551, 0.0528, -0.1263], [ 0.1027, 0.2233, 0.0538, ..., 0.2153, -0.0864, -0.1121]], requires_grad=True) h.shape torch.Size([1, 32, 20]) out.shape torch.Size([3, 32, 20])","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"å¾ªç¯ç¥ç»ç½‘ç»œåŸºç¡€æ¦‚å¿µ","slug":"RNN-base","date":"2019-05-31T06:46:55.594Z","updated":"2019-06-05T03:39:07.605Z","comments":true,"path":"2019/05/31/RNN-base/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/31/RNN-base/","excerpt":"å¾ªç¯ç¥ç»ç½‘ç»œæ¦‚å¿µ","text":"å¾ªç¯ç¥ç»ç½‘ç»œæ¦‚å¿µ RNNåŸç†å…·æœ‰è®°å¿†æ•ˆæœçš„ç½‘ç»œä¸æ–­å°†å½“å‰åºåˆ—çš„ä¸­çš„æ•°æ®ç‚¹ä¼ å…¥ç½‘ç»œã€‚é‡‡ç”¨å‚æ•°å…±äº«çš„æ–¹å¼ å…¬å¼ h_{t}=\\tanh \\left(w_{i h} x_{t}+b_{i h}+w_{h h} h_{t-1}+b_{h n}\\right)å…¶ä¸­ $h_{t-1}$ è¡¨ç¤ºæ­‰æ„ä¸çš„è®°å¿†çŠ¶æ€ï¼Œ$x_t$ è¡¨ç¤ºå½“å‰æ­¥çš„è¾“å…¥ï¼Œæœ€åå¾—åˆ°è¾“å‡º $h_t$ï¼ŒåŒæ—¶å°†å…¶ä¼ å…¥åé¢ä½œä¸ºè¿™ä¸€æ­¥çš„è®°å¿†çŠ¶æ€ã€‚ å­˜åœ¨çš„é—®é¢˜å½“å‚æ•°å°äº 1 çš„æ—¶å€™ï¼Œåå‘ä¼ æ’­è¶Šä¹˜è¶Šå°ï¼Œé€ æˆæ¢¯åº¦æ¶ˆå¤±å½“å‚æ•°å¤§äº 1 çš„æ—¶å€™ï¼Œåå‘ä¼ æ’­è¶Šä¹˜è¶Šå¤§ï¼Œé€ æˆæ¢¯åº¦çˆ†ç‚¸ LSTMåŸç†LSTM ç”±ä¸‰ä¸ªé—¨æ¥æ§åˆ¶ï¼Œåˆ†åˆ«æ˜¯è¾“å…¥é—¨ï¼Œé—å¿˜é—¨å’Œè¾“å‡ºé—¨ï¼Œè¾“å…¥é—¨å’Œè¾“å‡ºé—¨é™åˆ¶ç€è¾“å…¥å’Œè¾“å‡ºçš„å¤§å°ï¼Œè€Œé—å¿˜é—¨æ§åˆ¶ç€è®°å¿†çš„ä¿ç•™åº¦ï¼Œå¯¹äºä¸€ä¸ªä»»åŠ¡ï¼Œé—å¿˜é—¨èƒ½å¤Ÿè‡ªå·±å­¦ä¹ åˆ°è¯¥ä¿ç•™å¤šå°‘ä»¥å‰çš„è®°å¿†ï¼Œä¸éœ€è¦äººä¸ºè¿›è¡Œå¹²æ‰°ï¼Œæ‰€ä»¥å…·å¤‡é•¿æ—¶è®°å¿†çš„åŠŸèƒ½ã€‚ å…¬å¼ f_{t}=\\sigma\\left(W_{f} \\cdot\\left[h_{t-1}, x_{t}\\right]+b_{f}\\right)é¦–å…ˆç»“åˆ$t-1$æ—¶åˆ»çš„ç½‘ç»œè¾“å‡ºå’Œ$t$æ—¶åˆ»çš„ç½‘ç»œè¾“å…¥ï¼Œé€šè¿‡çº¿æ€§å˜æ¢å’Œ sigmoid å‡½æ•°å¾—åˆ°ä¸€ä¸ª 0-1 ä¹‹é—´çš„å€¼$f_t$ï¼Œè¿™ä¸ªå€¼ç§°ä¸ºè¡°å‡ç³»æ•°ï¼Œè¡¨ç¤ºä¿ç•™è¿‡å»ä¿¡æ¯çš„å¤šå°‘ã€‚ \\begin{aligned} i_{t} &=\\sigma\\left(W_{i} \\cdot\\left[h_{t-1}, x_{t}\\right]+b_{i}\\right) \\\\ \\tilde{C}_{t} &=\\tanh \\left(W_{C} \\cdot\\left[h_{t-1}, x_{t}\\right]+b_{C}\\right) \\end{aligned}ç„¶åç»“åˆ$t-1$æ—¶åˆ»çš„è¾“å‡ºå’Œ$t$æ—¶åˆ»çš„è¾“å…¥åˆ†åˆ«è®¡ç®—å‡ºå¦å¤–ä¸€ä¸ªç³»æ•° $it$ å’Œæ–°æ¥å—çš„ä¿¡æ¯ $\\tilde{C}{t}$,å…¶ä¸­ $i_t$ è¡¨ç¤ºä¿ç•™æ¥å—çš„æ–°ä¿¡æ¯çš„å¤šå°‘ã€‚ C_{t}=f_{t} * C_{t-1}+i_{t} * \\tilde{C}_{t}ç„¶åå°†å‰é¢å¾—åˆ°çš„ä¸¤ä¸ªè¡°å‡ç³»æ•°åˆ†åˆ«ä¹˜ä¸Šè¿‡å»çš„ä¿¡æ¯å’Œç°åœ¨çš„æ–°ä¿¡æ¯æ¥ç¡®å®š$t$æ—¶åˆ»çœŸæ­£çš„è®°å¿†çŠ¶æ€$C_t$ã€‚ \\begin{aligned} o_{t} &=\\sigma\\left(W_{o}\\left[h_{t-1}, x_{t}\\right]+b_{o}\\right) \\\\ h_{t} &=o_{t} * \\tanh \\left(C_{t}\\right) \\end{aligned}æœ€åä½¿ç”¨$t-1$æ—¶åˆ»çš„è¾“å‡ºå’Œ$t$æ—¶åˆ»çš„è¾“å…¥è®¡ç®—ä¸€ä¸ªç³»æ•°ï¼Œè¿™ä¸ªç³»æ•°è¡¨ç¤º$t$æ—¶åˆ»åˆ°åº•è¾“å‡ºå¤šå°‘çš„è®°å¿†çŠ¶æ€$C_t$å¾—åˆ°çœŸæ­£çš„æ¨¡å‹è¾“å‡º$h_t$ GRUGRU å’Œ LSTM æœ€å¤§çš„ä¸åŒæ˜¯ï¼Œ GRU å°†é—å¿˜é—¨å’Œè¾“å…¥é—¨åˆå¹¶æˆäº†ä¸€ä¸ªæ›´æ–°é—¨ï¼ŒåŒæ—¶ç½‘ç»œä¸å†é¢å¤–ç»™å‡ºè®°å¿†çŠ¶æ€$C_t$ï¼Œè€Œæ˜¯å°†è¾“å‡ºç»“æœä½œä¸ºè®°å¿†çŠ¶æ€ä¸æ–­å¾€åä¼ ã€‚ \\begin{aligned} z_{t} &=\\sigma\\left(W_{z} \\cdot\\left[h_{t-1}, x_{t}\\right]\\right) \\\\ r_{t} &=\\sigma\\left(W_{r} \\cdot\\left[h_{t-1}, x_{t}\\right]\\right) \\\\ \\tilde{h}_{t} &=\\tanh \\left(W \\cdot\\left[r_{t} * h_{t-1}, x_{t}\\right]\\right) \\\\ h_{t} &=\\left(1-z_{t}\\right) * h_{t-1}+z_{t} * \\tilde{h}_{t} \\end{aligned}","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"ç¥ç»ç½‘ç»œè®­ç»ƒæŠ€å·§","slug":"network-train","date":"2019-05-29T06:59:17.774Z","updated":"2019-05-29T07:00:48.903Z","comments":true,"path":"2019/05/29/network-train/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/29/network-train/","excerpt":"ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹ä¸­çš„ä¸€äº›æŠ€å·§","text":"ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹ä¸­çš„ä¸€äº›æŠ€å·§ å·ç§¯ç¥ç»ç½‘ç»œè®­ç»ƒæŠ€å·§æ•°æ®å¢å¼ºå›è¯‘æ³• æ•°æ®è¯»å–Datasetçµæ´»çš„æ•°æ®è¯»å…¥ï¼Œç”¨åˆ° torch.utils.data.Dataset()ã€‚å¯ä»¥å…ˆçœ‹çœ‹ Dataset çš„æ–‡æ¡£ å¦‚æœæˆ‘ä»¬å¸Œæœ›å®šä¹‰è‡ªå·±çš„æ•°æ®è¯»å…¥å‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªå­ç±»ç»§æ‰¿äº Datasetï¼Œç„¶åé‡æ–°å®šä¹‰ __getitem__() å’Œ __len__() è¿™ä¸¤ä¸ªå‡½æ•°å°±å¯ä»¥äº†ï¼Œ__getitem__() è¡¨ç¤ºæŒ‰ç…§ä¸‹æ ‡å–å‡ºå…¶ä¸­ä¸€ä¸ªæ•°æ®ï¼Œ__len__ è¡¨ç¤ºæ‰€æœ‰æ•°æ®çš„æ€»æ•°/ æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š from torch.utils.data import Dataset # å®šä¹‰ä¸€ä¸ªå­ç±»å« custom_datasetï¼Œç»§æ‰¿äº Datasetclass Custom_dataset(Dataset): def __init__(self, txt_path, transform=None): self.transform = transform # ä¼ å…¥æ•°æ®é¢„å¤„ç† with open(txt_path, 'r') as f: lines = f.readlines() self.img_list = [i.split()[0] for i in lines] # å¾—åˆ°æ‰€æœ‰çš„å›¾åƒåå­— self.label_list = [i.split()[1] for i in lines] # å¾—åˆ°æ‰€æœ‰çš„label def __getitem__(self, idx): # æ ¹æ® idx å–å‡ºä¸€ä¸ª img = self.img_list[idx] label = self.label_list[idx] if self.transform is not None: img = self.transform(img) return img, label def __len__(self): # æ€»æ•°æ®æ˜¯å¤šå°‘ return len(self.label_list) # æµ‹è¯•è¯»å–å‡½æ•°txt_dataset = Custom_dataset('./train.txt') # è¯»å…¥ txt æ–‡ä»¶# å–å¾—å…¶ä¸­ä¸€ä¸ªæ•°æ®data, label = txt_dataset[0]print(data)print(label) 1009_2.png YOU é€šè¿‡ä¸Šè¯‰æ–¹å¼æˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿéå¸¸æ–¹ä¾¿çš„å®šä¹‰ä¸€ä¸ªæ•°æ®è¯»å…¥ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿæ–¹ä¾¿çš„å®šä¹‰æ•°æ®é¢„å¤„ç† DataLoaderå®ç°äº†ä¸€ä¸ª batch çš„å¤„ç†æ•°æ®ï¼ŒDataLoader æ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹è¿­ä»£å™¨ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ä¸€ä¸ª batch çš„è¯»å…¥æ¨¡å‹ï¼ŒåŒæ—¶ä½¿ç”¨å¤šçº¿ç¨‹é€Ÿåº¦æ›´å¿«ã€‚DataLoader çš„æ–‡æ¡£ DataLoader ä¸­æœ‰å‡ ä¸ªä½¿ç”¨æœ€å¤šçš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ datasetï¼Œå°±æ˜¯æˆ‘ä»¬å‰é¢å®šä¹‰çš„æ•°æ®è¯»å…¥ï¼Œå¯ä»¥ä½¿ç”¨ ImageFolderï¼Œå¯ä»¥ä½¿ç”¨è‡ªå·±å®šä¹‰çš„æ•°æ®è¯»å…¥å­ç±»ï¼Œç¬¬äºŒä¸ªæ˜¯ batch_sizeï¼Œè¿™å°±æ˜¯ä¸€æ‰¹å¤šå°‘ä¸ªæ•°æ®ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ shuffleï¼Œè¡¨ç¤ºæ˜¯å¦æ‰“ä¹±æ•°æ®ï¼Œç¬¬å››ä¸ªæ˜¯ num_workersï¼Œè¡¨ç¤ºä½¿ç”¨å‡ ä¸ªçº¿ç¨‹ï¼Œé»˜è®¤ä½¿ç”¨ä¸»çº¿ç¨‹ï¼Œç¬¬äº”ä¸ªæ˜¯ drop_lastï¼Œè¡¨ç¤ºæ˜¯å¦æ‰”æ‰æœ€åæ— æ³•æ„æˆä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®ã€‚ é™¤äº†è¿™äº›å‚æ•°ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå‚æ•°å« collate_fn , èƒ½å¤Ÿæ–¹ä¾¿çš„å¤„ç†ä¸€ä¸ª batch ä¸­çš„æ•°æ®ã€‚è¿™ä¸ªæ˜¯åœ¨ DataLoader ä¸­å·²ç»æœ‰é»˜è®¤å®šä¹‰äº†ï¼Œå¯ä»¥çœ‹æºç å¦‚æœå¸Œæœ›å°† batch è¾“å‡ºçš„ label è¡¥æˆç›¸åŒçš„é•¿åº¦ï¼ŒçŸ­çš„ label ç”¨ 0 å¡«å……ï¼Œè¿™å…¶å®æ˜¯åœ¨æœºå™¨ç¿»è¯‘ä¸­çš„ä¸€ä¸ªéœ€æ±‚ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ collate_fn æ¥è‡ªå®šä¹‰æˆ‘ä»¬ batch çš„å¤„ç†æ–¹å¼ï¼Œ from torch.utils.data import DataLoader train_data1 = DataLoader(txt_dataset, batch_size=100, shuffle=True) # å°† 2 ä¸ªæ•°æ®ä½œä¸ºä¸€ä¸ªbatchfor im, label in train_data1: print(label) break (&#39;JOHN&#39;, &#39;2009&#39;, &#39;7&#39;, &#39;WRIGHT&#39;, &#39;NELSON&#39;, &#39;IS&#39;, &#39;HOUSE&#39;, &#39;TOM&#39;, &#39;8275&#39;, &#39;MAID&#39;, &#39;AH&#39;, &#39;RESIST&#39;, &#39;SALESDCMOBILEADSCOM&#39;, &#39;ONGC&#39;, &#39;AUR&#39;, &#39;BIG&#39;, &#39;THE&#39;, &#39;OF&#39;, &#39;YOU&#39;, &#39;UP&#39;, &#39;BUTTE&#39;, &#39;YOU&#39;, &#39;CROFT&#39;, &#39;SHIPPING&#39;, &#39;PINE&#39;, &#39;ENEMIES&#39;, &#39;816527&#39;, &#39;18&#39;, &#39;ASSOCIATE&#39;, &#39;DEPOSITPHOTOS&#39;, &#39;KANTOR&#39;, &#39;IS&#39;, &#39;2008&#39;, &#39;APPLE&#39;, &#39;GEBRUIK&#39;, &#39;SWAYAMVARA&#39;, &#39;IN&#39;, &#39;SHORT&#39;, &#39;COFFEE&#39;, &#39;2010&#39;, &#39;55&#39;, &#39;ROGEN&#39;, &#39;TOO&#39;, &#39;RENTON&#39;, &#39;SHORT&#39;, &#39;IS&#39;, &#39;FINAL&#39;, &#39;AWARD&#39;, &#39;AND&#39;, &#39;KURT&#39;, &#39;VS&#39;, &#39;HUDGENS&#39;, &#39;CROFT&#39;, &#39;DAY&#39;, &#39;22&#39;, &#39;SWAN&#39;, &#39;WE&#39;, &#39;SEPTEMBER&#39;, &#39;COM&#39;, &#39;YOUR&#39;, &#39;EN&#39;, &#39;STRATEGIC&#39;, &#39;TOTAL&#39;, &#39;SPOTLIGHT&#39;, &#39;GUILDHALL&#39;, &#39;PERFORMANCE&#39;, &#39;FREE&#39;, &#39;CARL&#39;, &#39;FAST&#39;, &#39;103&#39;, &#39;OPENING&#39;, &#39;BANKS&#39;, &#39;150&#39;, &#39;MEDIA&#39;, &#39;ZAPORIZHIA&#39;, &#39;AC&#39;, &#39;VAL&#39;, &#39;STATE&#39;, &#39;SHOAH&#39;, &#39;SRI&#39;, &#39;GREAT&#39;, &#39;CLEARANCE&#39;, &#39;ONE&#39;, &#39;THE&#39;, &#39;HOSTING&#39;, &#39;REWARDS&#39;, &#39;LIFE&#39;, &#39;SBI&#39;, &#39;SCALES&#39;, &#39;SPACE&#39;, &#39;YOU&#39;, &#39;THERE&#39;, &#39;THE&#39;, &#39;FOUND&#39;, &#39;70304&#39;, &#39;SO&#39;, &#39;HELT&#39;, &#39;7749&#39;, &#39;PRICES&#39;, &#39;UFO&#39;) def collate_fn(batch): batch.sort(key=lambda x: len(x[1]), reverse=True) # å°†æ•°æ®é›†æŒ‰ç…§ label çš„é•¿åº¦ä»å¤§åˆ°å°æ’åº img, label = zip(*batch) # å°†æ•°æ®å’Œ label é…å¯¹å–å‡º pad_label = [] lens = [] max_len = len(label[0]) for i in range(len(label)): temp_label = label[i] temp_label += '0' * (max_len - len(label[i])) pad_label.append(temp_label) lens.append(len(label[i])) return img, pad_label, lens # è¾“å‡º label çš„çœŸå®é•¿åº¦ # ä½¿ç”¨è‡ªå®šä¹‰çš„ collate_fntrain_data3 = DataLoader(txt_dataset, 10, True, collate_fn=collate_fn)im, label, lens = next(iter(train_data3)) im (&#39;2292_1.png&#39;, &#39;857_23.png&#39;, &#39;2433_6.png&#39;, &#39;2539_1.png&#39;, &#39;2314_9.png&#39;, &#39;5142_4.png&#39;, &#39;2497_6.png&#39;, &#39;325_16.png&#39;, &#39;2202_1.png&#39;, &#39;940_1.png&#39;) label [&#39;HAZELMERR&#39;, &#39;PORTABLE0&#39;, &#39;PRIVATE00&#39;, &#39;827500000&#39;, &#39;HERE00000&#39;, &#39;BALE00000&#39;, &#39;VIEW00000&#39;, &#39;HOW000000&#39;, &#39;FOR000000&#39;, &#39;300000000&#39;] lens [9, 8, 7, 4, 4, 4, 4, 3, 3, 2] å¯ä»¥çœ‹åˆ°ä¸€ä¸ª batch ä¸­æ‰€æœ‰çš„ label éƒ½ä»é•¿åˆ°çŸ­è¿›è¡Œæ’åˆ—ï¼ŒåŒæ—¶çŸ­çš„ label éƒ½è¢«è¡¥é•¿äº†ï¼Œæ‰€ä»¥ä½¿ç”¨ collate_fn èƒ½å¤Ÿéå¸¸æ–¹ä¾¿çš„å¤„ç†ä¸€ä¸ª batch ä¸­çš„æ•°æ®ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ²¡æœ‰ç‰¹åˆ«çš„è¦æ±‚ï¼Œä½¿ç”¨ pytorch ä¸­å†…ç½®çš„ collate_fn å°±å¯ä»¥æ»¡è¶³è¦æ±‚äº† å­¦ä¹ ç‡è¡°å‡åœ¨ pytorch ä¸­å­¦ä¹ ç‡è¡°å‡éå¸¸æ–¹ä¾¿ï¼Œä½¿ç”¨ torch.optim.lr_schedulerï¼Œæ›´å¤šçš„ä¿¡æ¯å¯ä»¥ç›´æ¥æŸ¥çœ‹æ–‡æ¡£ ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢è¿™ç§æ–¹å¼æ¥åšå­¦ä¹ ç‡è¡°å‡ï¼Œæ›´åŠ ç›´è§‚ import numpy as npimport torchfrom torch import nnimport torch.nn.functional as Ffrom torch.autograd import Variable class Net(nn.Module): def __init__(self): pass def forward(self,): pass net = Net() # optimizer = torch.optim.SGD(net,lr=0.01, weight_decay=1e-4) å¯ä»¥é€šè¿‡ optimizer.param_groupsæ¥å¾—åˆ°æ‰€æœ‰å‚æ•°ç»„å’Œå…¶å¯¹åº”çš„å±æ€§, å‚æ•°ç»„æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥å°†æ¨¡å‹çš„å‚æ•°åˆ†æˆå‡ ä¸ªç»„ï¼Œæ¯ä¸ªç»„å®šä¹‰ä¸€ä¸ªå­¦ä¹ ç‡ï¼Œè¿™é‡Œæ¯”è¾ƒå¤æ‚ï¼Œä¸€èˆ¬æ¥è®²å¦‚æœä¸åšç‰¹åˆ«ä¿®æ”¹ï¼Œå°±åªæœ‰ä¸€ä¸ªå‚æ•°ç»„.è¿™ä¸ªå‚æ•°ç»„æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œé‡Œé¢æœ‰å¾ˆå¤šå±æ€§ï¼Œæ¯”å¦‚å­¦ä¹ ç‡ï¼Œæƒé‡è¡°å‡ç­‰ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ä»¥ä¸‹ # print('learning rate: &#123;&#125;'.format(optimizer.param_groups[0]['lr']))# print('weight decay: &#123;&#125;'.format(optimizer.param_groups[0]['weight_decay'])) # learning rate: 0.01# weight decay: 0.0001 # å¯ä»¥é€šè¿‡ä¿®æ”¹è¿™ä¸ªå±æ€§æ¥æ”¹å˜æˆ‘ä»¬è®­ç»ƒè¿‡ç¨‹ä¸­çš„å­¦ä¹ ç‡# optimizer.param_groups[0]['lr'] = 1e-5# ä¸ºäº†é˜²æ­¢æœ‰å¤šä¸ªå‚æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¾ªç¯# for param_group in optimizer.param_groups: # param_group['lr'] = 1e-1 # åœ¨ä»»æ„ä½ç½®æ”¹å˜å­¦ä¹ ç‡def set_learning_rate(optimizer, lr): for param_group in optimizer.param_groups: param_group['lr'] = lr æ‰¹æ ‡å‡†åŒ–# å®ç°ä¸€ç»´çš„æƒ…å†µimport torchdef simple_batch_norm_1d(x, gamma, beta): eps = 1e-5 x_mean = torch.mean(x, dim=0, keepdim=True) # ä¿ç•™çº¬åº¦è¿›è¡Œ broadcast x_var = torch.mean((x - x_mean) ** 2, dim=0, keepdim=True) x_hat = (x - x_mean) / torch.sqrt(x_var + eps) return gamma.view_as(x_mean) * x_hat + beta.view_as(x_mean) # éªŒè¯å¯¹äºä»»ä½•è¾“å…¥ä¼šä¸ä¼šè¢«æ ‡å‡†åŒ–x = torch.arange(15, dtype=torch.float).view(5, 3)gamma = torch.ones(x.shape[1])beta = torch.zeros(x.shape[1])print('before bn:')print(x)y = simple_batch_norm_1d(x, gamma, beta)print('after bn:')print(y) before bn: tensor([[ 0., 1., 2.], [ 3., 4., 5.], [ 6., 7., 8.], [ 9., 10., 11.], [12., 13., 14.]]) after bn: tensor([[-1.4142, -1.4142, -1.4142], [-0.7071, -0.7071, -0.7071], [ 0.0000, 0.0000, 0.0000], [ 0.7071, 0.7071, 0.7071], [ 1.4142, 1.4142, 1.4142]]) å¯ä»¥çœ‹åˆ°è¿™é‡Œä¸€å…±æ˜¯ 5 ä¸ªæ•°æ®ç‚¹ï¼Œä¸‰ä¸ªç‰¹å¾ï¼Œæ¯ä¸€åˆ—è¡¨ç¤ºä¸€ä¸ªç‰¹å¾çš„ä¸åŒæ•°æ®ç‚¹ï¼Œä½¿ç”¨æ‰¹æ ‡å‡†åŒ–ä¹‹åï¼Œæ¯ä¸€åˆ—éƒ½å˜æˆäº†æ ‡å‡†çš„æ­£æ€åˆ†å¸ƒ è¿™ä¸ªæ—¶å€™ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æµ‹è¯•çš„æ—¶å€™è¯¥ä½¿ç”¨æ‰¹æ ‡å‡†åŒ–å—ï¼Ÿ ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œå› ä¸ºè®­ç»ƒçš„æ—¶å€™ä½¿ç”¨äº†ï¼Œè€Œæµ‹è¯•çš„æ—¶å€™ä¸ä½¿ç”¨è‚¯å®šä¼šå¯¼è‡´ç»“æœå‡ºç°åå·®ï¼Œä½†æ˜¯æµ‹è¯•çš„æ—¶å€™å¦‚æœåªæœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œé‚£ä¹ˆå‡å€¼ä¸å°±æ˜¯è¿™ä¸ªå€¼ï¼Œæ–¹å·®ä¸º 0 å—ï¼Ÿè¿™æ˜¾ç„¶æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æµ‹è¯•çš„æ—¶å€™ä¸èƒ½ç”¨æµ‹è¯•çš„æ•°æ®é›†å»ç®—å‡å€¼å’Œæ–¹å·®ï¼Œè€Œæ˜¯ç”¨è®­ç»ƒçš„æ—¶å€™ç®—å‡ºçš„ç§»åŠ¨å¹³å‡å‡å€¼å’Œæ–¹å·®å»ä»£æ›¿ ä¸‹é¢æˆ‘ä»¬å®ç°ä»¥ä¸‹èƒ½å¤ŸåŒºåˆ†è®­ç»ƒçŠ¶æ€å’Œæµ‹è¯•çŠ¶æ€çš„æ‰¹æ ‡å‡†åŒ–æ–¹æ³• def batch_norm_1d(x, gamma, beta, is_training, moving_mean, moving_var, moving_momentum=0.1): eps = 1e-5 x_mean = torch.mean(x, dim=0, keepdim=True) # ä¿ç•™ç»´åº¦è¿›è¡Œ broadcast x_var = torch.mean((x - x_mean) ** 2, dim=0, keepdim=True) if is_training: x_hat = (x - x_mean) / torch.sqrt(x_var + eps) moving_mean[:] = moving_momentum * moving_mean + (1. - moving_momentum) * x_mean moving_var[:] = moving_momentum * moving_var + (1. - moving_momentum) * x_var else: x_hat = (x - moving_mean) / torch.sqrt(moving_var + eps) return gamma.view_as(x_mean) * x_hat + beta.view_as(x_mean) ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è‡ªå·±å®ç°äº† 2 ç»´æƒ…å†µçš„æ‰¹æ ‡å‡†åŒ–ï¼Œå¯¹åº”äºå·ç§¯çš„ 4 ç»´æƒ…å†µçš„æ ‡å‡†åŒ–æ˜¯ç±»ä¼¼çš„ï¼Œåªéœ€è¦æ²¿ç€é€šé“çš„ç»´åº¦è¿›è¡Œå‡å€¼å’Œæ–¹å·®çš„è®¡ç®—ï¼Œä½†æ˜¯æˆ‘ä»¬è‡ªå·±å®ç°æ‰¹æ ‡å‡†åŒ–æ˜¯å¾ˆç´¯çš„ï¼Œpytorch å½“ç„¶ä¹Ÿä¸ºæˆ‘ä»¬å†…ç½®äº†æ‰¹æ ‡å‡†åŒ–çš„å‡½æ•°ï¼Œä¸€ç»´å’ŒäºŒç»´åˆ†åˆ«æ˜¯ torch.nn.BatchNorm1d() å’Œ torch.nn.BatchNorm2d()ï¼Œä¸åŒäºæˆ‘ä»¬çš„å®ç°ï¼Œpytorch ä¸ä»…å°† $\\gamma$ å’Œ $\\beta$ ä½œä¸ºè®­ç»ƒçš„å‚æ•°ï¼Œä¹Ÿå°† moving_mean å’Œ moving_var ä¹Ÿä½œä¸ºå‚æ•°è¿›è¡Œè®­ç»ƒ æ­£åˆ™åŒ–ä½¿ç”¨æ­£åˆ™åŒ–ä¹‹åï¼Œæ›´æ–°å‚æ•°å˜ä¸ºï¼š p_j \\rightarrow p_j - \\eta (\\frac{\\partial loss}{\\partial p_j} + 2 \\lambda p_j) = p_j - \\eta \\frac{\\partial loss}{\\partial p_j} - 2 \\eta \\lambda p_jå¦‚æœæƒ³åœ¨éšæœºæ¢¯åº¦ä¸‹é™æ³•ä¸­ä½¿ç”¨æ­£åˆ™é¡¹ï¼Œæˆ–è€…è¯´æƒé‡è¡°å‡ï¼Œtorch.optim.SGD(net.parameters(), lr=0.1, weight_decay=1e-4) å°±å¯ä»¥äº†ï¼Œè¿™ä¸ª weight_decay ç³»æ•°å°±æ˜¯ä¸Šé¢å…¬å¼ä¸­çš„ $\\lambda$ï¼Œéå¸¸æ–¹ä¾¿ TensorBoard å¯è§†åŒ–tensorboard æ˜¯ tensorflow ä¸­éå¸¸å¥½ç”¨çš„å¯è§†åŒ–å·¥å…·ï¼Œä½¿ç”¨è¿™ä¸ªå·¥å…·github å¯ä»¥åœ¨ pytorch ä¸­å®ç°å¯è§†åŒ–. éœ€è¦å®‰è£…ä»¥ä¸‹æ¨¡å— pip install tensorflow pip install tensorboradX from tensorboardX import SummaryWriter writer = SummaryWriter() # ================ Öµä½¿ç”¨ tensorboard =============== # writer.add_scalars('Loss', &#123;'train': train_loss / len(train_data), 'valid': valid_loss / len(valid_data)&#125;, epoch) # writer.add_scalars('Acc', &#123;'train': train_acc / len(train_data), 'valid': valid_acc / len(valid_data)&#125;, epoch) # =================================================","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ-DenseNet","slug":"classic-DenseNet","date":"2019-05-28T07:16:17.093Z","updated":"2019-05-28T07:17:45.988Z","comments":true,"path":"2019/05/28/classic-DenseNet/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/28/classic-DenseNet/","excerpt":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ DenseNet ç»“æ„ä¸å®ç°","text":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ DenseNet ç»“æ„ä¸å®ç° DenseNetç½‘ç»œç»“æ„ ä»£ç å®ç°# DenseNet ä¸»è¦ç”± dense block æ„æˆï¼Œ å®ç° dense blockimport numpy as npimport torchfrom torch import nnfrom torch.autograd import Variablefrom torchvision.datasets import CIFAR10 # å…ˆå®šä¹‰å·ç§¯å—def conv_block(in_channel, out_channel): layer = nn.Sequential( nn.BatchNorm2d(in_channel), nn.ReLU(True), nn.Conv2d(in_channel, out_channel, 3, padding=1, bias=False) ) return layer # å®šä¹‰ dense block, dense block å°†æ¯æ¬¡çš„å·ç§¯çš„è¾“å‡ºç§°ä¸º growth_rate, å› ä¸ºå¦‚æœè¾“å…¥æ˜¯ in_channel, æœ‰ n å±‚ï¼Œ é‚£ä¹ˆè¾“å‡ºå°±æ˜¯# in_channel + n * growth_rateclass Dense_block(nn.Module): def __init__(self, in_channel, growth_rate, num_layers): super(Dense_block, self).__init__() block = [] channel = in_channel for i in range(num_layers): block.append(conv_block(channel, growth_rate)) channel += growth_rate self.net = nn.Sequential(*block) def forward(self, x): for layer in self.net: out = layer(x) x = torch.cat((out, x), dim=1) return x # éªŒè¯è¾“å‡ºçš„ channel æ˜¯å¦æ­£ç¡®test_net = Dense_block(3, 12, 3)test_x = Variable(torch.zeros(1, 3, 96, 96))print('input shape: &#123;&#125; x &#123;&#125; x &#123;&#125;'.format(test_x.shape[1], test_x.shape[2], test_x.shape[3]))test_y = test_net(test_x)print('output shape: &#123;&#125; x &#123;&#125; x &#123;&#125;'.format(test_y.shape[1], test_y.shape[2], test_y.shape[3])) input shape: 3 x 96 x 96 output shape: 39 x 96 x 96 é™¤äº† dense block ä¹‹å¤–ï¼Œ DenseNet è¿˜æœ‰ä¸€ä¸ªæ¨¡å—å«è¿‡æ¸¡å±‚(transition block)ï¼Œå› ä¸º DenseNet ä¼šä¸æ–­åœ°å¯¹çº¬åº¦è¿›è¡Œæ‹¼æ¥ï¼Œ æ‰€ä»¥å½“å±‚æ•°å¾ˆé«˜çš„æ—¶å€™ï¼Œè¾“å‡ºçš„é€šé“æ•°å°±ä¼šè¶Šå˜è¶Šå¤§ï¼Œå‚æ•°å’Œè®¡ç®—é‡ä¹Ÿä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å¼•å…¥è¿‡æ¸¡å±‚å°†è¾“å‡ºé€šé“é™ä½ä¸‹æ¥ï¼ŒåŒæ—¶ä¹Ÿå°†è¾“å…¥çš„é•¿å®½å‡åŠï¼Œè¿™ä¸ªè¿‡æ¸¡å±‚å¯ä»¥ä½¿ç”¨ 1x1 çš„å·ç§¯ # å®šä¹‰ transition blockdef transition(in_channel, out_channel): trans_layer = nn.Sequential( nn.BatchNorm2d(in_channel), nn.ReLU(True), nn.Conv2d(in_channel, out_channel, 1), nn.AvgPool2d(2, 2) ) return trans_layer # éªŒè¯è¿‡æ¸¡å±‚ transition block æ˜¯å¦æ­£ç¡®test_net = transition(3, 12)test_x = Variable(torch.zeros(1, 3, 96, 96))print('input shape: &#123;&#125; x &#123;&#125; x &#123;&#125;'.format(test_x.shape[1], test_x.shape[2], test_x.shape[3]))test_y = test_net(test_x)print('output shape: &#123;&#125; x &#123;&#125; x &#123;&#125;'.format(test_y.shape[1], test_y.shape[2], test_y.shape[3])) input shape: 3 x 96 x 96 output shape: 12 x 48 x 48 # å®šä¹‰ DenseNetclass DenseNet(nn.Module): def __init__(self, in_channel, num_classes, growth_rate=32, block_layers=[6, 12, 24, 16]): super(DenseNet, self).__init__() self.block1 = nn.Sequential( nn.Conv2d(in_channel, 64, 7, 2, 3), nn.BatchNorm2d(64), nn.ReLU(True), nn.MaxPool2d(3, 2, padding=1) ) channels = 64 block = [] for i, layers in enumerate(block_layers): block.append(Dense_block(channels, growth_rate, layers)) channels += layers * growth_rate if i != len(block_layers) - 1: block.append(transition(channels, channels // 2)) # é€šè¿‡ transiton å±‚æ•°å¤§å°å‡åŠï¼Œé€šé“æ•°å‡åŠ channels = channels // 2 self.block2 = nn.Sequential(*block) self.block2.add_module('bn', nn.BatchNorm2d(channels)) self.block2.add_module('relu', nn.ReLU(True)) self.block2.add_module('avg_pool', nn.AvgPool2d(3)) self.classifier = nn.Linear(channels, num_classes) def forward(self, x): x = self.block1(x) x = self.block2(x) x = x.view(x.shape[0], -1) x = self.classifier(x) return x # æµ‹è¯• DenseNettest_net = DenseNet(3, 10)test_x = Variable(torch.zeros(1, 3, 96, 96))test_y = test_net(test_x)print('output: &#123;&#125;'.format(test_y.shape)) output: torch.Size([1, 10])","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ-ResNet","slug":"classic-ResNet","date":"2019-05-27T08:23:35.439Z","updated":"2019-05-27T08:24:38.492Z","comments":true,"path":"2019/05/27/classic-ResNet/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/27/classic-ResNet/","excerpt":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ ResNet ç»“æ„ä¸å®ç°","text":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ ResNet ç»“æ„ä¸å®ç° ResNetç½‘ç»œç»“æ„ResNet é€šè¿‡å¼•å…¥è·¨å±‚è¿æ¥ï¼Œè§£å†³äº†æ¢¯åº¦å›ä¼ æ¶ˆå¤±çš„é—®é¢˜ã€‚åœ¨å‚æ•°å‡ ä¹ä¸€æ ·çš„æƒ…å†µä¸‹ï¼Œå¢åŠ æ¨¡å‹é€šé“æ•°ï¼Œé‡‡ç”¨ 1x1 å·ç§¯æ ¸ ä»£ç å®ç°å‚å·®ç½‘ç»œçš„ç»“æ„å°±æ˜¯ä¸Šé¢è¿™ç§å‚å·®å—çš„å †å ï¼Œå®ç°ä¸€ä¸ª residual block import numpy as npimport torchfrom torch import nnimport torch.nn.functional as Ffrom torch.autograd import Variablefrom torchvision.datasets import CIFAR10 def conv3x3(in_channel, out_channel, stride=1): return nn.Conv2d(in_channel, out_channel, 3, stride=stride, padding=1, bias=False) class Residual_block(nn.Module): def __init__(self, in_channel, out_channel, same_shape=True): super(Residual_block, self).__init__() self.same_shape = same_shape stride = 1 if self.same_shape else 2 self.conv1 = conv3x3(in_channel, out_channel, stride=stride) self.bn1 = nn.BatchNorm2d(out_channel) self.conv2 = conv3x3(out_channel, out_channel) self.bn2 = nn.BatchNorm2d(out_channel) if not self.same_shape: self.conv3 = nn.Conv2d(in_channel, out_channel, 1, stride=stride) def forward(self, x): out = self.conv1(x) out = F.relu(self.bn1(out), True) out = self.conv2(out) out = F.relu(self.bn2(out), True) if not self.same_shape: x = self.conv3(x) return F.relu(x+out, True) # æµ‹è¯• redidual block çš„è¾“å‡º# è¾“å…¥è¾“å‡ºå½¢çŠ¶ç›¸åŒtest_net = Residual_block(32, 32)test_x = Variable(torch.zeros(1, 32, 96, 96))print('input: &#123;&#125;'.format(test_x.shape))test_y = test_net(test_x) print('output: &#123;&#125;'.format(test_y.shape)) input: torch.Size([1, 32, 96, 96]) output: torch.Size([1, 32, 96, 96]) # è¾“å…¥è¾“å‡ºå½¢çŠ¶ä¸åŒtest_net = Residual_block(3, 32, False) test_x = Variable(torch.zeros(1, 3, 96, 96)) print('input: &#123;&#125;'.format(test_x.shape)) test_y = test_net(test_x) print('output: &#123;&#125;'.format(test_y.shape)) input: torch.Size([1, 3, 96, 96]) output: torch.Size([1, 32, 48, 48]) # å®ç° ResNet class ResNet(nn.Module): def __init__(self, in_channels, num_classes, verbose=False): super(ResNet, self).__init__() self.verbose = verbose self.block1 = nn.Conv2d(in_channels, 64, 7, 2) self.block2 = nn.Sequential( nn.MaxPool2d(3, 2), Residual_block(64, 64), Residual_block(64,64) ) self.block3 = nn.Sequential( Residual_block(64, 128, False), Residual_block(128, 128) ) self.block4 = nn.Sequential( Residual_block(128, 256, False), Residual_block(256, 256) ) self.block5 = nn.Sequential( Residual_block(256, 512, False), Residual_block(512, 512), nn.AvgPool2d(3) ) self.classifier = nn.Linear(512, num_classes) def forward(self, x): x = self.block1(x) if self.verbose: print('block 1 output: &#123;&#125;'.format(x.shape)) x = self.block2(x) if self.verbose: print('block 2 output: &#123;&#125;'.format(x.shape)) x = self.block3(x) if self.verbose: print('block 3 output: &#123;&#125;'.format(x.shape)) x = self.block4(x) if self.verbose: print('block 4 output: &#123;&#125;'.format(x.shape)) x = self.block5(x) if self.verbose: print('block 5 output: &#123;&#125;'.format(x.shape)) x = x.view(x.shape[0], -1) x = self.classifier(x) return x # æ¨¡å‹æµ‹è¯•test_net = ResNet(3, 10, True) test_x = Variable(torch.zeros(1, 3, 96, 96)) test_y = test_net(test_x) print('output: &#123;&#125;'.format(test_y.shape)) block 1 output: torch.Size([1, 64, 45, 45]) block 2 output: torch.Size([1, 64, 22, 22]) block 3 output: torch.Size([1, 128, 11, 11]) block 4 output: torch.Size([1, 256, 6, 6]) block 5 output: torch.Size([1, 512, 1, 1]) output: torch.Size([1, 10])","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ-GoogleNet","slug":"classic-GoogleNet","date":"2019-05-24T07:21:10.833Z","updated":"2019-05-24T11:22:12.426Z","comments":true,"path":"2019/05/24/classic-GoogleNet/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/24/classic-GoogleNet/","excerpt":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ GoogleNet ç»“æ„ä¸å®ç°","text":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ GoogleNet ç»“æ„ä¸å®ç° GoogleNetç½‘ç»œç»“æ„é‡‡ç”¨äº†éå¸¸æœ‰æ•ˆçš„ inception æ¨¡å—ï¼Œ å¾—åˆ°äº†æ¯” VGG æ›´æ·±çš„ç½‘ç»œç»“æ„ï¼Œ ä½†æ˜¯å´æ¯” VGG çš„å‚æ•°å°‘ï¼Œå› ä¸ºå»æ‰äº†åé¢çš„å…¨è¿æ¥å±‚ï¼Œå‚æ•°å¤§å¤§å‡å°‘ï¼Œæé«˜äº†è®¡ç®—æ•ˆç‡ Inception æ¨¡å—ä¸€ä¸ª Inception æ¨¡å—æœ‰å››æ¡å¹¶è¡Œçº¿è·¯ã€‚ ä¸€ä¸ª 1x1 çš„å·ç§¯ï¼Œä¸€ä¸ªå°çš„æ„Ÿå—é‡è¿›è¡Œå·ç§¯ç‰¹å¾æå–ã€‚ ä¸€ä¸ª 1x1 çš„å·ç§¯ï¼ŒåŠ ä¸Šä¸€ä¸ª 3x3 çš„å·ç§¯ï¼Œ 1x1 çš„å·ç§¯é™ä½è¾“å…¥çš„ç‰¹å¾é€šé“ï¼Œå‡å°‘å‚æ•°è®¡ç®—é‡ï¼Œç„¶åæ¥ä¸€ä¸ª 3x3 çš„å·ç§¯åšä¸€ä¸ªè¾ƒå¤§æ„Ÿå—é‡çš„å·ç§¯ã€‚ ä¸€ä¸ª 1x1 çš„å·ç§¯åŠ ä¸Šä¸€ä¸ª 5x5 çš„å·ç§¯ï¼Œ ä½œç”¨å’Œç¬¬äºŒä¸ªé€šé“ä¸€æ ·ã€‚ ä¸€ä¸ª 3x3 çš„æœ€å¤§å€¼æ± åŒ–ï¼ŒåŠ ä¸Š 1x1 çš„å·ç§¯ï¼Œæœ€å¤§å€¼æ± åŒ–æ”¹å˜è¾“å…¥çš„ç‰¹å¾æ’åˆ—ï¼Œ 1x1 çš„å·ç§¯è¿›è¡Œç‰¹å¾æå–ã€‚æœ€åå°†å››ä¸ªå¹¶è¡Œçº¿è·¯å¾—åˆ°çš„ç‰¹å¾åœ¨é€šé“è¿™ä¸ªçº¬åº¦ä¸Šæ‹¼æ¥åœ¨ä¸€èµ· ä»£ç å®ç°import numpy as npimport torchfrom torch import nnfrom torch.autograd import Variablefrom torchvision.datasets import CIFAR10 # å®šä¹‰ä¸€ä¸ªå·ç§¯åŠ ä¸€ä¸ª relu æ¿€æ´»å‡½æ•°å’Œä¸€ä¸ª batchnorm ä½œä¸ºä¸€ä¸ªåŸºæœ¬çš„å±‚ç»“æ„def conv_relu(in_channel, out_channel, kernel, stride=1, padding=0): layer = nn.Sequential( nn.Conv2d(in_channel, out_channel, kernel, stride, padding), nn.BatchNorm2d(out_channel, eps=1e-3), nn.ReLU(True) ) return layer # å®šä¹‰ inception æœºæ„class inception(nn.Module): def __init__(self, in_channel, out1_1, out2_1, out2_3, out3_1, out3_5, out4_1): super(inception, self).__init__() # å®šä¹‰ç¬¬ä¸€æ¡çº¿è·¯ self.branch1x1 = conv_relu(in_channel, out1_1, 1) # å®šä¹‰ç¬¬äºŒæ¡çº¿è·¯ self.branch3x3 = nn.Sequential( conv_relu(in_channel, out2_1, 1), conv_relu(out2_1, out2_3, 3, padding=1) ) # å®šä¹‰ç¬¬ä¸‰æ¡çº¿è·¯ self.branch5x5 = nn.Sequential( conv_relu(in_channel, out3_1, 1), conv_relu(out3_1, out3_5, 5, padding=2) ) # å®šä¹‰ç¬¬å››æ¡çº¿è·¯ self.branch_pool = nn.Sequential( nn.MaxPool2d(3, stride=1, padding=1), conv_relu(in_channel, out4_1, 1) ) def forward(self, x): f1 = self.branch1x1(x) f2 = self.branch3x3(x) f3 = self.branch5x5(x) f4 = self.branch_pool(x) output = torch.cat((f1, f2, f3, f4),dim=1) return output # æµ‹è¯• inception æ¨¡å—test_net = inception(3, 64, 48, 64, 64, 96, 32)test_x = Variable(torch.zeros(1, 3, 96, 96))print('input shape: &#123;&#125; x &#123;&#125; x &#123;&#125;'.format(test_x.shape[1], test_x.shape[2], test_x.shape[3]))test_y = test_net(test_x) print('output shape: &#123;&#125; x &#123;&#125; x &#123;&#125;'.format(test_y.shape[1], test_y.shape[2], test_y.shape[3])) input shape: 3 x 96 x 96 output shape: 256 x 96 x 96 å¯ä»¥çœ‹åˆ°ï¼Œè¾“å…¥ç»è¿‡ inception æ¨¡å—ä¹‹åï¼Œ å¤§å°æ²¡æœ‰å˜åŒ–ï¼Œé€šé“çš„çº¬åº¦å˜å¤šäº†ï¼Œ ä¸‹é¢å®šä¹‰ GoogleNetï¼Œ GoogleNetç›¸å½“äºå¤šä¸ª inception æ¨¡å—çš„ä¸²è”, åŸè®ºæ–‡ä¸­ä½¿ç”¨å¤šä¸ªè¾“å‡ºæ¥è§£å†³æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼Œ è¿™é‡Œæˆ‘ä»¬åªå®šä¹‰ä¸€ä¸ªç®€å•ç‰ˆæœ¬çš„ GoogleNetï¼Œç®€åŒ–ä¸ºä¸€ä¸ªè¾“å‡º class GoogleNet(nn.Module): def __init__(self, in_channel, num_classes, verbose=False): super(GoogleNet, self).__init__() self.verbose = verbose self.block1 = nn.Sequential( conv_relu(in_channel, out_channel=64, kernel=7, stride=2, padding=3), nn.MaxPool2d(3, 2) ) self.block2 = nn.Sequential( conv_relu(64, 64, kernel=1), conv_relu(64, 192, kernel=3, padding=1), nn.MaxPool2d(3, 2) ) self.block3 = nn.Sequential( inception(192, 64, 96, 128, 16, 32, 32), inception(256, 128, 128, 192, 32, 96, 64), nn.MaxPool2d(3, 2) ) self.block4 = nn.Sequential( inception(480, 192, 96, 208, 16, 48, 64), inception(512, 160, 112, 224, 24, 64, 64), inception(512, 128, 128, 256, 24, 64, 64), inception(512, 112, 144, 288, 32, 64, 64), inception(528, 256, 160, 320, 32, 128, 128), nn.MaxPool2d(3, 2) ) self.block5 = nn.Sequential( inception(832, 256, 160, 320, 32, 128, 128), inception(832, 384, 182, 384, 48, 128, 128), nn.AvgPool2d(2) ) self.classifer = nn.Linear(1024, num_classes) def forward(self, x): x = self.block1(x) if self.verbose: print('block 1 output: &#123;&#125;'.format(x.shape)) x = self.block2(x) if self.verbose: print('block 2 output: &#123;&#125;'.format(x.shape)) x = self.block3(x) if self.verbose: print('block 3 output: &#123;&#125;'.format(x.shape)) x = self.block4(x) if self.verbose: print('block 4 output: &#123;&#125;'.format(x.shape)) x = self.block5(x) if self.verbose: print('block 5 output: &#123;&#125;'.format(x.shape)) x = x.view(x.shape[0], -1) x = self.classifer(x) return x # éªŒè¯ GoogleNettest_net = GoogleNet(3, 10, True) test_x = Variable(torch.zeros(1, 3, 96, 96)) test_y = test_net(test_x) print('output: &#123;&#125;'.format(test_y.shape)) block 1 output: torch.Size([1, 64, 23, 23]) block 2 output: torch.Size([1, 192, 11, 11]) block 3 output: torch.Size([1, 480, 5, 5]) block 4 output: torch.Size([1, 832, 2, 2]) block 5 output: torch.Size([1, 1024, 1, 1]) output: torch.Size([1, 10]) å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„å°ºå¯¸ä¸æ–­å‡å°ï¼Œ é€šé“çº¬åº¦ä¸æ–­å¢åŠ , å®ç°äº†ç®€æ˜“ç‰ˆçš„ GoogleNet","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ-VGGNet","slug":"classic-VGGNet","date":"2019-05-21T08:12:43.468Z","updated":"2019-05-21T08:14:14.978Z","comments":true,"path":"2019/05/21/classic-VGGNet/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/21/classic-VGGNet/","excerpt":"ç»å…¸å·ç§¯ç½‘ç»œ VGGNet ç»“æ„ä¸å®ç°","text":"ç»å…¸å·ç§¯ç½‘ç»œ VGGNet ç»“æ„ä¸å®ç° VGGNetç½‘ç»œç»“æ„ ä»£ç å®ç°import numpy as npimport torchfrom torch import nnfrom torch.autograd import Variablefrom torchvision.datasets import CIFAR10 # VGG ä½¿ç”¨äº†å¾ˆå¤šå±‚ 3*3 çš„å·ç§¯ ç„¶åå†ä½¿ç”¨ä¸€ä¸ªæœ€å¤§æ± åŒ–å±‚ï¼Œè¿™ä¸ªæ¨¡å—è¢«ä½¿ç”¨äº†å¾ˆå¤šæ¬¡ï¼Œå®šä¹‰ä¸€ä¸ª vgg çš„ block æ¥å®ç°è¿™ä¸ªç»“æ„def vgg_block(num_convs, in_channels, out_channels): # å®šä¹‰ç¬¬ä¸€å±‚ net = [nn.Conv2d(in_channels, out_channels, kernel_size=3, padding=1), nn.ReLU(True)] # å®šä¹‰åé¢å¾ˆå¤šå±‚ for i in range(num_convs - 1): net.append(nn.Conv2d(out_channels, out_channels, kernel_size=3, padding=1)) net.append(nn.ReLU(True)) net.append(nn.MaxPool2d(2, 2)) # å®šä¹‰æ± åŒ–å±‚ return nn.Sequential(*net) # æ‰“å°æ¨¡å‹ï¼ŒæŸ¥çœ‹ç»“æ„block_demo = vgg_block(3, 64, 128)block_demo Sequential( (0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): ReLU(inplace) (2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (3): ReLU(inplace) (4): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (5): ReLU(inplace) (6): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False) ) # å®šä¹‰è¾“å…¥ä¸º (1ï¼Œ 64ï¼Œ 300ï¼Œ 300)input_demo = Variable(torch.zeros(1, 64, 300, 300))output_demo = block_demo(input_demo)print(output_demo.shape) torch.Size([1, 128, 150, 150]) å¯ä»¥çœ‹åˆ°è¾“å‡ºå˜æˆäº†(1, 128, 150, 150)ï¼Œ å¯ä»¥çœ‹åˆ°ç»è¿‡è¿™ä¸ªvgg blockï¼Œ è¾“å…¥å¤§å°å‡åŠï¼Œ é€šé“æ•°å˜æˆäº†128 # å®šä¹‰ä¸€ä¸ªå‡½æ•°å¯¹è¿™ä¸ª vgg block è¿›è¡Œå †å def vgg_stack(nums_convs, channels): net = [] for n, c in zip(nums_convs, channels): in_c = c[0] out_c = c[1] net.append(vgg_block(n, in_c, out_c)) return nn.Sequential(*net)# å®šä¹‰ä¸€ä¸ªç®€å•çš„ VGG ç»“æ„vgg_net = vgg_stack((1, 1, 2, 2, 2), ((3, 64), (64, 128), (128, 256), (256, 512), (512, 512)))vgg_net Sequential( (0): Sequential( (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): ReLU(inplace) (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False) ) (1): Sequential( (0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): ReLU(inplace) (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False) ) (2): Sequential( (0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): ReLU(inplace) (2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (3): ReLU(inplace) (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False) ) (3): Sequential( (0): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): ReLU(inplace) (2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (3): ReLU(inplace) (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False) ) (4): Sequential( (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (1): ReLU(inplace) (2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)) (3): ReLU(inplace) (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False) ) ) ä¸Šè¯‰ç½‘ç»œç»“æ„ä¸­æœ‰ 5 ä¸ªæœ€å¤§å€¼æ± åŒ–ï¼Œè¯´æ˜å›¾ç‰‡å¤§å°ä¼šå‡å°‘ 5 å€ï¼Œ éªŒè¯å¦‚ä¸‹ test_x = Variable(torch.zeros(1, 3, 256, 256))test_y = vgg_net(test_x)print(test_y.shape) torch.Size([1, 512, 8, 8]) å¯ä»¥çœ‹åˆ°å›¾ç‰‡å¤§å°å‡å°‘äº† $2^{5}$ å€, æœ€åå†åŠ ä¸Šå‡ å±‚å…¨è¿æ¥ï¼Œ å°±èƒ½å¤Ÿå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„åˆ†ç±»è¾“å‡º # å®šä¹‰ VGGNet æ¨¡å‹class VGGNet(nn.Module): def __init__(self): super(vgg, self).__init__() self.feature = vgg_net self.fc = nn.Sequential( nn.Linear(512, 100), nn.ReLU(True), nn.Linear(100, 10) ) def forward(self, x): x = self.feature(x) x = x.view(x.shape[0], -1) x = self.fc(x) return x","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œ-AlexNet","slug":"classic-AlexNet","date":"2019-05-20T08:02:07.825Z","updated":"2019-05-21T08:18:55.194Z","comments":true,"path":"2019/05/20/classic-AlexNet/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/20/classic-AlexNet/","excerpt":"ç»å…¸å·ç§¯ç½‘ç»œ AlexNet ç»“æ„ä¸å®ç°","text":"ç»å…¸å·ç§¯ç½‘ç»œ AlexNet ç»“æ„ä¸å®ç° AlexNetç½‘ç»œç»“æ„å‡ ä¸ªå·ç§¯æ± åŒ–å †å åè¿æ¥ä»‹ä¸ªå…¨é“¾æ¥å±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ä»£ç å®ç°import torchfrom torch import nnimport numpy as npfrom torch.autograd import Variablefrom torchvision.datasets import CIFAR10 # ç”¨å°çš„æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œå·ç§¯å±‚è®¾è®¡ä¸æ¨¡å‹ä¸å®Œå…¨ç›¸åŒclass AlexNet(nn.Module): def __init__(self): super().__init__() # ç¬¬ä¸€å±‚æ˜¯ 5*5 çš„å·ç§¯ ï¼Œè¾“å…¥çš„ channels æ˜¯ 3ï¼Œ è¾“å‡ºçš„ channels æ˜¯64ï¼Œ æ­¥é•¿ä¸º 1ï¼Œ æ²¡æœ‰ padding self.conv1 = nn.Sequential( nn.Conv2d(3, 64, 5), nn.ReLU(True), ) # ç¬¬äºŒå±‚æ˜¯ 3*3 çš„æ± åŒ–ï¼Œ æ­¥é•¿ä¸º 2ï¼Œ æ²¡æœ‰ padding self.max_pool1 = nn.MaxPool2d(3, 2) #ç¬¬ä¸‰å±‚æ˜¯ 5*5 çš„å·ç§¯ï¼Œ è¾“å…¥çš„ channels æ˜¯ 64ï¼Œè¾“å‡ºçš„ channels æ˜¯ 64ï¼Œ æ­¥é•¿ä¸º 1ï¼Œ æ²¡æœ‰ padding self.conv2 = nn.Sequential( nn.Conv2d(64, 64, 5, 1), nn.ReLU(True), ) # ç¬¬å››å±‚æ˜¯ 3*3 çš„æ± åŒ–ï¼Œ æ­¥é•¿ä¸º 2ï¼Œ æ²¡æœ‰ padding self.max_pool2 = nn.MaxPool2d(3, 2) # ç¬¬äº”å±‚æ˜¯å…¨è¿æ¥å±‚, è¾“å…¥æ˜¯ 1204ï¼Œ è¾“å‡ºæ˜¯ 384 self.fc1 = nn.Sequential( nn.Linear(1024, 384), nn.ReLU(True) ) # ç¬¬å…­å±‚æ˜¯å…¨è¿æ¥å±‚, è¾“å…¥æ˜¯ 384, è¾“å‡ºæ˜¯ 192 self.fc2 = nn.Linear(384, 192) # ç¬¬ä¸ƒå±‚æ˜¯å…¨è¿æ¥å±‚ï¼Œ è¾“å…¥æ˜¯ 192ï¼Œ è¾“å‡ºæ˜¯ 10 self.fc3 = nn.Linear(192, 10) def forward(self, x): x = self.conv1(x) x = self.max_pool1(x) x = self.conv2(x) x = self.max_pool2(x) # å°†çŸ©é˜µæ‹‰å¹³ x = x.view(x.shape[0], -1) x = self.fc1(x) x = self.fc2(x) x = self.fc3(x) return x alexnet = AlexNet() # æŸ¥çœ‹ç½‘ç»œç»“æ„alexnet AlexNet( (conv1): Sequential( (0): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1)) (1): ReLU(inplace) ) (max_pool1): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False) (conv2): Sequential( (0): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1)) (1): ReLU(inplace) ) (max_pool2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False) (fc1): Sequential( (0): Linear(in_features=1024, out_features=384, bias=True) (1): ReLU(inplace) ) (fc2): Linear(in_features=384, out_features=192, bias=True) (fc3): Linear(in_features=192, out_features=10, bias=True) ) # éªŒè¯ç½‘ç»œç»“æ„æ˜¯å¦æ­£ç¡®ï¼Œ è¾“å…¥ä¸€å¼  32*32 çš„å›¾ç‰‡ # å®šä¹‰è¾“å…¥ä¸º(1, 3, 32, 32)input_demo = Variable(torch.zeros(1, 3, 32, 32))output_demo = alexnet(input_demo)print(output_demo.shape) torch.Size([1, 10])","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"ç™¾å®ç®±","slug":"kinds","date":"2019-05-17T10:55:02.081Z","updated":"2019-05-17T10:58:32.364Z","comments":true,"path":"2019/05/17/kinds/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/17/kinds/","excerpt":"è®°å½•è‡ªå·±å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›å°çŸ¥è¯†","text":"è®°å½•è‡ªå·±å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›å°çŸ¥è¯† è¿”å›æœ¬æœºIPåœ°å€ https://utool.fun/ip/ https://api.ip.la/ https://httpbin.org/ip","categories":[{"name":"å…¶ä»–","slug":"å…¶ä»–","permalink":"http://lucas0625.github.io/blog/categories/å…¶ä»–/"}],"tags":[{"name":"å…¶ä»–","slug":"å…¶ä»–","permalink":"http://lucas0625.github.io/blog/tags/å…¶ä»–/"}]},{"title":"Linux å¸¸ç”¨æ“ä½œ","slug":"linux","date":"2019-05-17T01:26:51.213Z","updated":"2019-06-14T09:02:11.993Z","comments":true,"path":"2019/05/17/linux/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/17/linux/","excerpt":"è®°å½•å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›linuxå‘½ä»¤","text":"è®°å½•å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›linuxå‘½ä»¤ æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶å¤¹çš„å¤§å°du -h â€”max-depth=1 åˆ†å‰²ï¼Œåˆå¹¶æ–‡ä»¶ åˆ†å‰²: sed -n â€˜1, 100pâ€™ file &gt; file_part1 åˆå¹¶: cat file1 file2 &gt; file æ›¿æ¢sed -i â€œs/ //gâ€ test æ›¿æ¢ç©ºæ ¼ä¸ºç©º æ–‡ä»¶ç¼–ç  æŸ¥çœ‹æ–‡ä»¶ç¼–ç : file filename è½¬æ¢æ–‡ä»¶ç¼–ç : iconv -f åŸç¼–ç  -t æ–°ç¼–ç  åŸæ–‡ä»¶ -o æ–°æ–‡ä»¶ æ‰¹é‡è½¬æ¢æ–‡ä»¶ç¼–ç : ç¬¬ä¸€æ­¥ï¼šå…ˆå…‹éš†åŸæ–‡ä»¶å¤¹å¾—ç›®å½•ç»“æ„ ç¬¬äºŒæ­¥ï¼šå¼€å§‹æ‰¹é‡è½¬æ¢ find æ–‡ä»¶å¤¹å -type d -exec sh -c â€œmkdir -p new/{}â€ \\; find æ–‡ä»¶å¤¹å -type f -exec sh -c â€œiconv -f GBK -t UTF-8 {} &gt; new/{}â€ \\; æ–‡ä»¶æŸ¥æ‰¾grep -rn â€˜wordsâ€™ * : è¡¨ç¤ºå½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯æŸä¸ªæ–‡ä»¶å-r æ˜¯é€’å½’æŸ¥æ‰¾-n æ˜¯æ˜¾ç¤ºè¡Œå·-R æŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶åŒ…å«å­ç›®å½•-i å¿½ç•¥å¤§å°å†™ ç»Ÿè®¡æ–‡ä»¶å¤§å° wc -l file è®¡ç®—æ–‡ä»¶è¡Œæ•° wc -w file è®¡ç®—æ–‡ä»¶ä¸­çš„å•è¯æ•° wc -c file è®¡ç®—æ–‡ä»¶ä¸­çš„å­—ç¬¦æ•° æ–‡ä»¶æ“ä½œ cp sourcefile destfile æ–‡ä»¶æ‹·è´ mv oldname newname é‡å‘½åæˆ–è€…æ–‡ä»¶ç§»åŠ¨ rm file åˆ é™¤æ–‡ä»¶ grep â€˜patternâ€™ file åœ¨æ–‡ä»¶å†…æœç´¢å­—ç¬¦ä¸² cut -b colnum file æŒ‡å®šæ¬²æ˜¾ç¤ºçš„æ–‡ä»¶å†…å®¹èŒƒå›´ cat file è¾“å‡ºæ–‡ä»¶å†…å®¹ file somefile å¾—åˆ°æ–‡ä»¶ç±»å‹","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://lucas0625.github.io/blog/categories/å·¥å…·/"}],"tags":[{"name":"åŸºç¡€","slug":"åŸºç¡€","permalink":"http://lucas0625.github.io/blog/tags/åŸºç¡€/"}]},{"title":"vim å¸¸ç”¨æŠ€å·§","slug":"vim","date":"2019-05-17T01:26:29.091Z","updated":"2019-05-17T01:33:37.304Z","comments":true,"path":"2019/05/17/vim/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/17/vim/","excerpt":"è®°å½•å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›vimå‘½ä»¤","text":"è®°å½•å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›vimå‘½ä»¤ è§†å›¾æ¨¡å¼ä¸‹å¸¸ç”¨è®¾ç½® set invlist æ˜¾ç¤ºä¸å¯è§å­—ç¬¦ set nu / nonu æ˜¾ç¤ºè¡Œå·ï¼Œä¸æ˜¾ç¤ºè¡Œå· s/old/new/g æ›¿æ¢oldä¸ºnew, 1, 100s/old/new/g å°†1-100è¡Œä¹‹é—´çš„oldæ›¿æ¢ä¸ºnew set hlsearch æŸ¥æ‰¾é«˜äº® set nohlsearch å–æ¶ˆæŸ¥æ‰¾é«˜äº® æ‰“å¼€å¤šä¸ªç¼–è¾‘å™¨vim -O2 file1 file2 æ‰“å¼€ä¸¤ä¸ªvimç¼–è¾‘å™¨ctrl+w+l/h å·¦å³åˆ‡æ¢å…‰æ ‡ å¼ºåˆ¶å†™å…¥tabcrtl + v + i å¼ºåˆ¶å†™å…¥\\tï¼Œå³^I","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://lucas0625.github.io/blog/categories/å·¥å…·/"}],"tags":[{"name":"åŸºç¡€","slug":"åŸºç¡€","permalink":"http://lucas0625.github.io/blog/tags/åŸºç¡€/"}]},{"title":"CNN åŸºç¡€","slug":"CNN-base","date":"2019-05-16T06:21:13.849Z","updated":"2019-05-31T07:38:17.822Z","comments":true,"path":"2019/05/16/CNN-base/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/16/CNN-base/","excerpt":"æœ¬æ–‡ä»‹ç»äº†CNNåŸºç¡€ã€‚","text":"æœ¬æ–‡ä»‹ç»äº†CNNåŸºç¡€ã€‚ å·ç§¯æ¦‚å¿µ å·ç§¯æ¨¡å—å·ç§¯å·ç§¯åœ¨ PyTorch ä¸­æœ‰ä¸¤ç§æ–¹å¼ï¼Œ ä¸€ç§æ˜¯torch.nn.Conv2d(), ä¸€ç§æ˜¯torch.nn.functional.conv2d()ï¼Œ è¿™ä¸¤ç§å½¢å¼æœ¬è´¨ä¸Šéƒ½æ˜¯ä½¿ç”¨ä¸€ä¸ªå·ç§¯æ“ä½œã€‚è¿™ä¸¤ç§å½¢å¼çš„å·ç§¯å¯¹äºè¾“å…¥è¦æ±‚æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯è¾“å…¥torch.autograd.Variable()ï¼Œå¤§å°æ˜¯(batch, channel, H, W), å…¶ä¸­ batch è¡¨ç¤ºè¾“å…¥çš„ä¸€æ‰¹æ•°æ®çš„æ•°ç›® channel è¡¨ç¤ºè¾“å…¥çš„é€šé“æ•°ï¼Œä¸€èˆ¬ä¸€å¼ å½©è‰²å›¾ç‰‡çš„é€šé“æ•°ä¸º3ï¼Œç°åº¦å›¾æ˜¯1 H è¡¨ç¤ºè¾“å…¥å›¾ç‰‡çš„é«˜åº¦ W è¡¨ç¤ºè¾“å…¥å›¾ç‰‡çš„å®½åº¦ # å®é™…æ“ä½œimport numpy as np import torch from torch import nn from torch.autograd import Variable import torch.nn.functional as F from PIL import Image import matplotlib.pyplot as plt %matplotlib inline im = Image.open('./cat.png').convert('L') # è¯»å…¥ä¸€å¼ ç°åº¦å›¾çš„å›¾ç‰‡im = np.array(im, dtype='float32') # å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªçŸ©é˜µim array([[122., 122., 121., ..., 93., 90., 88.], [124., 124., 123., ..., 96., 93., 91.], [126., 126., 125., ..., 100., 97., 95.], ..., [161., 161., 161., ..., 0., 0., 0.], [160., 160., 161., ..., 0., 0., 0.], [160., 160., 160., ..., 0., 0., 0.]], dtype=float32) # å¯è§†åŒ–å›¾ç‰‡plt.imshow(im.astype('uint8'), cmap='gray') &lt;matplotlib.image.AxesImage at 0x1183e2518&gt; im.shape (224, 224) # å°†å›¾ç‰‡çŸ©é˜µè½¬åŒ–ä¸º pytorh tensorï¼Œ å¹¶é€‚é…å·ç§¯è¾“å…¥çš„è¦æ±‚im = torch.from_numpy(im.reshape((1, 1, im.shape[0], im.shape[1]))) im tensor([[[[122., 122., 121., ..., 93., 90., 88.], [124., 124., 123., ..., 96., 93., 91.], [126., 126., 125., ..., 100., 97., 95.], ..., [161., 161., 161., ..., 0., 0., 0.], [160., 160., 161., ..., 0., 0., 0.], [160., 160., 160., ..., 0., 0., 0.]]]]) # å®šä¹‰ä¸€ä¸ªç®—å­ï¼Œå¯¹å…¶è¿›è¡Œè½®å»“æ£€æµ‹# ä½¿ç”¨ nn.Conv2d'''torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride=1, padding=0, dilation=1, groups=1, bias=True, padding_mode='zeros')'''conv1 = nn.Conv2d(1, 1, 3, bias=True) # å®šä¹‰å·ç§¯sobel_kernel = np.array([[-1, -1, -1], [-1, 8, -1], [-1, -1, -1]], dtype='float32') # å®šä¹‰è½®å»“æ£€æµ‹ç®—å­sobel_kernel = sobel_kernel.reshape((1, 1, 3, 3)) # é€‚é…å·ç§¯çš„è¾“å…¥è¾“å‡ºconv1.weight.data = torch.from_numpy(sobel_kernel) # ç»™å·ç§¯çš„ kernel èµ‹å€¼edge1 = conv1(Variable(im)) # ä½œç”¨åœ¨å›¾ç‰‡ä¸Šedge1 = edge1.data.squeeze().numpy() # å°†è¾“å‡ºè½¬æ¢ä¸ºå›¾ç‰‡çš„æ ¼å¼ # å¯è§†åŒ–è¾¹ç¼˜æ£€æµ‹ä¹‹åçš„ç»“æœplt.imshow(edge1, cmap='gray') &lt;matplotlib.image.AxesImage at 0x119dce9e8&gt; # ä½¿ç”¨ F.conv2dsobel_kernek = np.array([[-1, -1, -1], [-1, 8, -1], [-1, -1, -1]], dtype='float32') # å®šä¹‰è½®å»“æ£€æµ‹ç®—å­sobel_kernel = sobel_kernel.reshape((1, 1, 3, 3)) # é€‚é…å·ç§¯çš„è¾“å…¥è¾“å‡ºweight = Variable(torch.from_numpy(sobel_kernel))edge2 = F.conv2d(Variable(im), weight) # ä½œç”¨åœ¨å›¾ç‰‡ä¸Šedge2 = edge2.data.squeeze().numpy() # å°†è¾“å‡ºè½¬åŒ–ä¸ºå›¾ç‰‡çš„æ ¼å¼plt.imshow(edge2, cmap='gray') &lt;matplotlib.image.AxesImage at 0x119c46da0&gt; ä¸¤ç§å·ç§¯æ–¹å¼çš„åŒºåˆ« nn.Conv2d() ç›¸å½“äºç›´æ¥å®šä¹‰äº†ä¸€å±‚å·ç§¯ç½‘ç»œç»“æ„, é»˜è®¤å®šä¹‰ä¸€ä¸ªéšæœºåˆå§‹åŒ–çš„ weight, éœ€è¦ä¿®æ”¹çš„è¯ï¼Œå–å‡ºå…¶ä¸­çš„å€¼å¯¹å…¶ä¿®æ”¹ torch.nn.functional.conv2d() ç›¸å½“äºå®šä¹‰äº†ä¸€ä¸ªå·ç§¯çš„æ“ä½œï¼Œéœ€è¦å†é¢å¤–å®šä¹‰ä¸€ä¸ª weight ï¼Œweight ä¹Ÿå¿…é¡»æ˜¯ä¸€ä¸ª Varibale å®é™…ä½¿ç”¨ä¸­ï¼ŒåŸºæœ¬éƒ½ä½¿ç”¨ nn.Conv2d() æ± åŒ–æ¨¡å—æ± åŒ–æ± åŒ–å±‚ å¯ä»¥é™ä½çŸ©é˜µçš„å¤§å°ï¼Œéå¸¸å¥½åœ°æå‡è®¡ç®—æ•ˆç‡ï¼Œæ± åŒ–å±‚æ²¡æœ‰å‚æ•°ï¼Œæ± åŒ–çš„æ–¹å¼æœ‰å¾ˆå¤šç§ã€‚ æœ€å¤§å€¼æ± åŒ– å‡å€¼æ± åŒ– åœ¨å·ç§¯ç½‘ç»œä¸­ä¸€èˆ¬ä½¿ç”¨æœ€å¤§å€¼æ± åŒ–ã€‚PyTorch ä¸­ä¸¤ç§æ± åŒ–æ–¹å¼ï¼Œ nn.MaxPool2d() torch.nn.functional.max_pool2d() å‚æ•°å’Œå·ç§¯å‚æ•°ä¸€è‡´ # ä½¿ç”¨ nn.MaxPool2dpool1 = nn.MaxPool2d(2, 2)print('before max pool, image shape: &#123;&#125; x &#123;&#125;'.format(im.shape[2], im.shape[3]))small_im1 = pool1(Variable(im))small_im1 = small_im1.data.squeeze().numpy()print('after max pool, image shape: &#123;&#125; x &#123;&#125; '.format(small_im1.shape[0], small_im1.shape[1])) before max pool, image shape: 224 x 224 after max pool, image shape: 112 x 112 # å›¾ç‰‡å¤§å°å‡å°‘äº†ä¸€èˆ¬ï¼Œçœ‹ä¸€ä¸‹å›¾åƒçš„è¡¨ç°plt.imshow(small_im1, cmap='gray') &lt;matplotlib.image.AxesImage at 0x119e82780&gt; # ç¬¬äºŒç§æ–¹å¼ F.max_pool2dprint('before max pool, image shape: &#123;&#125; x &#123;&#125;'.format(im.shape[2], im.shape[3]))small_im2 = F.max_pool2d(Variable(im), 2, 2)small_im2 = small_im2.data.squeeze().numpy()print('after max pool, image shape: &#123;&#125; x &#123;&#125; '.format(small_im1.shape[0], small_im1.shape[1]))plt.imshow(small_im2, cmap='gray') before max pool, image shape: 224 x 224 after max pool, image shape: 112 x 112 &lt;matplotlib.image.AxesImage at 0x11a074898&gt; ä¸¤ç§æ–¹å¼ç»“æœä¸€æ ·ï¼Œä¸€èˆ¬ä½¿ç”¨ nn.MaxPool2d()","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"å¤šå±‚ç¥ç»ç½‘ç»œ","slug":"multilayer-neural-network","date":"2019-05-14T06:20:23.740Z","updated":"2019-05-14T06:29:26.450Z","comments":true,"path":"2019/05/14/multilayer-neural-network/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/14/multilayer-neural-network/","excerpt":"PyTorch å®ç°å¤šå±‚ç¥ç»ç½‘ç»œ","text":"PyTorch å®ç°å¤šå±‚ç¥ç»ç½‘ç»œ å¤šå±‚ç¥ç»ç½‘ç»œæ¦‚å¿µdemo å¤šå±‚ç¥ç»ç½‘ç»œå®ç°æ‰‹åŠ¨æ„å»ºæ¨¡å‹import torchimport numpy as npfrom torch import nnfrom torch.autograd import Variableimport torch.nn.functional as Fimport matplotlib.pyplot as plt%matplotlib inline def plot_decision_boundary(model, x, y): # Set min and max values and give it some padding x_min, x_max = x[:, 0].min() - 1, x[:, 0].max() + 1 y_min, y_max = x[:, 1].min() - 1, x[:, 1].max() + 1 h = 0.01 # Generate a grid of points with distance h between them xx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h)) # Predict the function value for the whole grid Z = model(np.c_[xx.ravel(), yy.ravel()]) Z = Z.reshape(xx.shape) # Plot the contour and training examples plt.contourf(xx, yy, Z, cmap=plt.cm.Spectral) plt.ylabel('x2') plt.xlabel('x1') plt.scatter(x[:, 0], x[:, 1], c=y.reshape(-1), s=40, cmap=plt.cm.Spectral) # è¿™æ¬¡ä»å¤„ç†äºŒåˆ†ç±»é—®é¢˜ï¼Œä½†æ˜¯æ¯”ä¹‹å‰çš„logisticå›å½’æ›´åŠ å¤æ‚np.random.seed(1)m = 400 # æ ·æœ¬æ•°é‡N = int(m/2) # æ¯ä¸€ç±»çš„ç‚¹çš„ä¸ªæ•°D = 2 # çº¬åº¦x = np.zeros((m, D))y = np.zeros((m, 1), dtype='uint8') # label å‘é‡ï¼Œ 0 è¡¨ç¤ºçº¢è‰²ï¼Œ 1 è¡¨ç¤ºè“è‰²a = 4 for j in range(2): ix = range(N*j,N*(j+1)) t = np.linspace(j*3.12,(j+1)*3.12,N) + np.random.randn(N)*0.2 # theta r = a*np.sin(4*t) + np.random.randn(N)*0.2 # radius x[ix] = np.c_[r*np.sin(t), r*np.cos(t)] y[ix] = j plt.scatter(x[:, 0], x[:, 1], c=y.reshape(-1), s=40, cmap=plt.cm.Spectral) &lt;matplotlib.collections.PathCollection at 0x120b352b0&gt; # å…ˆå°è¯•ä½¿ç”¨ logistic å›å½’è§£å†³è¿™ä¸ªé—®é¢˜x = torch.from_numpy(x).float()y = torch.from_numpy(y).float()w = nn.Parameter(torch.randn(2, 1))b = nn.Parameter(torch.zeros(1))optimizer = torch.optim.SGD([w, b], 1e-1)def logistic_regression(x): return torch.mm(x, w) + bcriterion = nn.BCEWithLogitsLoss() for e in range(100): out = logistic_regression(Variable(x)) loss = criterion(out, Variable(y)) optimizer.zero_grad() loss.backward() optimizer.step() if (e + 1) % 20 == 0: print('epoch: &#123;&#125;, loss: &#123;&#125;'.format(e+1, loss.item())) epoch: 20, loss: 0.7704809308052063 epoch: 40, loss: 0.6776716113090515 epoch: 60, loss: 0.6732792854309082 epoch: 80, loss: 0.6731553673744202 epoch: 100, loss: 0.6731488108634949 def plot_logistic(x): x = Variable(torch.from_numpy(x).float()) out = torch.sigmoid(logistic_regression(x)) out = (out &gt; 0.5) * 1 return out.data.numpy() plot_decision_boundary(lambda x: plot_logistic(x), x.numpy(), y.numpy())plt.title('logistic regression') Text(0.5,1,&#39;logistic regression&#39;) å¯ä»¥çœ‹åˆ° logistic å¹¶ä¸èƒ½å¾ˆå¥½çš„åŒºåˆ†å¼€ï¼Œå› ä¸º logistic æ˜¯çº¿æ€§åˆ†ç±»å™¨ï¼Œ ç°åœ¨é‡‡ç”¨ ç¥ç»ç½‘ç»œæ¨¡å‹ # å®šä¹‰ä¸¤å±‚ç¥ç»ç½‘ç»œw1 = nn.Parameter(torch.randn(2, 4) * 0.01) # éšè—ç¥ç»å…ƒä¸ªæ•° 2b1 = nn.Parameter(torch.zeros(4))w2 = nn.Parameter(torch.randn(4, 1) * 0.01)b2 = nn.Parameter(torch.zeros(1))# å®šä¹‰æ¨¡å‹def two_netword(x): x1 = torch.mm(x, w1) + b1 x1 = torch.tanh(x1) # ä½¿ç”¨ PyTorch è‡ªå¸¦çš„ tanh æ¿€æ´»å‡½æ•° x2 = torch.mm(x1, w2) + b2 return x2optimizer = torch.optim.SGD([w1, w2, b1, b2], 1.)criterion = nn.BCEWithLogitsLoss() # è®­ç»ƒ 10000 æ¬¡for e in range(10000): out = two_netword(Variable(x)) loss = criterion(out, Variable(y)) optimizer.zero_grad() loss.backward() optimizer.step() if (e + 1) % 1000 == 0: print('epoch: &#123;&#125;, loss: &#123;&#125;'.format(e+1, loss.item())) epoch: 1000, loss: 0.2847880423069 epoch: 2000, loss: 0.27225854992866516 epoch: 3000, loss: 0.26519426703453064 epoch: 4000, loss: 0.2597326934337616 epoch: 5000, loss: 0.23362228274345398 epoch: 6000, loss: 0.2255781590938568 epoch: 7000, loss: 0.22193390130996704 epoch: 8000, loss: 0.21951931715011597 epoch: 9000, loss: 0.2176773101091385 epoch: 10000, loss: 0.21617043018341064 def plot_network(x): x = Variable(torch.from_numpy(x).float()) x1 = torch.mm(x, w1) + b1 x1 = torch.tanh(x1) x2 = torch.mm(x1, w2) + b2 out = torch.sigmoid(x2) out = (out &gt; 0.5) * 1 return out.data.numpy() plot_decision_boundary(lambda x: plot_network(x), x.numpy(), y.numpy())plt.title('2 layer network') Text(0.5,1,&#39;2 layer network&#39;) å¯ä»¥çœ‹åˆ°ï¼Œ ç¥ç»ç½‘ç»œèƒ½å¾ˆå¥½çš„åˆ†ç±»è¿™ä¸ªå¤æ‚çš„æ•°æ®ï¼Œ å’Œå‰é¢çš„logisticå›å½’ç›¸æ¯”ï¼Œç¥ç»ç½‘ç»œå› ä¸ºæœ‰äº†æ¿€æ´»å‡½æ•°çš„å­˜åœ¨ï¼Œæˆäº†ä¸€ä¸ªéçº¿æ€§åˆ†ç±»å™¨ï¼Œæ‰€ä»¥ç¥ç»ç½‘ç»œåˆ†ç±»çš„è¾¹ç•Œæ›´åŠ å¤æ‚ è‡ªåŠ¨æ„å»ºä¸€ä¸ªå®Œæ•´çš„ PyTorch æ¨¡å‹æ‰‹åŠ¨æ„å»ºæ¨¡å‹å¯¹äºæ¯”è¾ƒå°çš„æ¨¡å‹æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å¯¹äºå¤§æ¨¡å‹ï¼Œæ¯”å¦‚ 100 å±‚çš„ç¥ç»ç½‘ç»œï¼Œè¿™ä¸ªæ—¶å€™æ‰‹åŠ¨å®šä¹‰æ¨¡å‹å°±ä¼šéå¸¸éº»çƒ¦ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨ PyTorch æä¾›çš„æ¨¡å—æ¥æ„å»ºæ¨¡å‹ ä½¿ç”¨ Sequential æ„å»ºæ¨¡å‹# Sequentialseq_net = nn.Sequential( nn.Linear(2, 4), # PyTorch ä¸­çš„çº¿æ€§å±‚ï¼Œ wx + b nn.Tanh(), nn.Linear(4, 1))# åºåˆ—æ¨¡å—å¯ä»¥é€šè¿‡ç´¢å¼•è®¿é—®æ¯ä¸€å±‚seq_net[0] # ç¬¬ä¸€å±‚ Linear(in_features=2, out_features=4, bias=True) # æ‰“å°å‡ºç¬¬ä¸€å±‚çš„æƒé‡w0 = seq_net[0].weightprint(w0) Parameter containing: tensor([[-0.5508, 0.2882], [ 0.0028, -0.5731], [-0.1803, 0.5680], [-0.5479, 0.0248]], requires_grad=True) # é€šè¿‡ parameters å¯ä»¥å–å¾—æ¨¡å‹çš„å‚æ•°param = seq_net.parameters()# å®šä¹‰ä¼˜åŒ–å™¨optim = torch.optim.SGD(param, 1.) # æˆ‘ä»¬è®­ç»ƒ 10000 æ¬¡for e in range(10000): out = seq_net(Variable(x)) loss = criterion(out, Variable(y)) optim.zero_grad() loss.backward() optim.step() if (e + 1) % 1000 == 0: print('epoch: &#123;&#125;, loss: &#123;&#125;'.format(e+1, loss.item())) epoch: 1000, loss: 0.28492191433906555 epoch: 2000, loss: 0.27243772149086 epoch: 3000, loss: 0.2653190791606903 epoch: 4000, loss: 0.25978708267211914 epoch: 5000, loss: 0.2339320182800293 epoch: 6000, loss: 0.22560137510299683 epoch: 7000, loss: 0.22195379436016083 epoch: 8000, loss: 0.21954353153705597 epoch: 9000, loss: 0.2177024632692337 epoch: 10000, loss: 0.2161943018436432 def plot_seq(x): out = torch.sigmoid(seq_net(Variable(torch.from_numpy(x).float()))).data.numpy() out = (out &gt; 0.5) * 1 return out plot_decision_boundary(lambda x: plot_seq(x), x.numpy(), y.numpy()) plt.title('sequential') Text(0.5,1,&#39;sequential&#39;) æ¨¡å‹ä¿å­˜çš„ä¸¤ç§æ–¹å¼ï¼š å°†æ¨¡å‹ç»“æ„å’Œå‚æ•°éƒ½ä¿å­˜åœ¨ä¸€èµ· åªå°†å‚æ•°ä¿å­˜ä¸‹æ¥ # ç¬¬ä¸€ç§ä¿å­˜æ–¹å¼ï¼Œå°†æ¨¡å‹å’Œå‚æ•°ä¿å­˜åœ¨ä¸€èµ·torch.save(seq_net, 'save_seq_net.model') # è¦ä¿å­˜çš„æ¨¡å‹ï¼Œä¿å­˜è·¯å¾„ # è¯»å–ä¿å­˜çš„æ¨¡å‹seq_net1 = torch.load('save_seq_net.model')seq_net1 Sequential( (0): Linear(in_features=2, out_features=4, bias=True) (1): Tanh() (2): Linear(in_features=4, out_features=1, bias=True) ) # ç¬¬äºŒç§ä¿å­˜æ–¹å¼ï¼Œåªä¿å­˜å‚æ•°torch.save(seq_net.state_dict(), 'save_seq_net_params.pth') # æ¨¡å‹çš„è¯»å–, éœ€è¦å…ˆé‡æ–°å®šä¹‰ä¸€æ¬¡æ¨¡å‹seq_net2 = nn.Sequential( nn.Linear(2, 4), nn.Tanh(), nn.Linear(4, 1))seq_net2.load_state_dict(torch.load('save_seq_net_params.pth'))seq_net2 Sequential( (0): Linear(in_features=2, out_features=4, bias=True) (1): Tanh() (2): Linear(in_features=4, out_features=1, bias=True) ) ç¬¬äºŒç§æ¨¡å‹ä¿å­˜æ–¹å¼ç›¸æ¯”è¾ƒç¬¬ä¸€ç§å¯ç§»æ¤æ€§æ›´å¼º ä½¿ç”¨ Module æ„å»ºæ¨¡å‹# ä½¿ç”¨ Module çš„æ¨¡ç‰ˆ ï¼Œ ä¸­æ–‡çš„åœ°æ–¹æ˜¯éœ€è¦è‡ªå·±å®šä¹‰çš„ï¼Œä»»ä½•å¤æ‚çš„æ“ä½œéƒ½å¯ä»¥åœ¨ forward ä¸­å®šä¹‰class ç½‘ç»œåå­—(nn.Module): def __init__(self, ä¸€äº›å®šä¹‰çš„å‚æ•°): super(ç½‘ç»œåå­—ï¼Œ self).__init__() self.layer1 = nn.Linear(num_input, num_hidden) self.layer2 = nn.Sequential(...) ... å®šä¹‰éœ€è¦çš„ç½‘ç»œå±‚ def forward(self, x): # å®šä¹‰å‰å‘ä¼ æ’­ x1 = self.layer(x) x2 = self.layer(x) x = x1 + x2 ... return x # åˆ©ç”¨ä¸Šè¿°æ¨¡ç‰ˆå®ç°å‰é¢çš„ç¥ç»ç½‘ç»œclass module_net(nn.Module): def __init__(self, num_input, num_hidden, num_output): super(module_net, self).__init__() self.layer1 = nn.Linear(num_input, num_hidden) self.layer2 = nn.Tanh() self.layer3 = nn.Linear(num_hidden, num_output) def forward(self, x): x = self.layer1(x) x = self.layer2(x) x = self.layer3(x) return x mo_net = module_net(2, 4, 1) # è®¿é—®æ¨¡å‹ä¸­çš„æŸå±‚å¯ä»¥ç›´æ¥é€šè¿‡åå­—# ç¬¬ä¸€å±‚l1 = mo_net.layer1print(l1) Linear(in_features=2, out_features=4, bias=True) # æ‰“å°ç¬¬ä¸€å±‚çš„æƒé‡print(l1.weight) Parameter containing: tensor([[ 0.5183, 0.2359], [ 0.3867, 0.6806], [ 0.4755, -0.4971], [-0.4460, -0.6820]], requires_grad=True) # å®šä¹‰ä¼˜åŒ–å™¨optim = torch.optim.SGD(mo_net.parameters(), 1.) # è®­ç»ƒ 10000 æ¬¡for e in range(10000): out = mo_net(Variable(x)) loss = criterion(out, Variable(y)) optim.zero_grad() loss.backward() optim.step() if (e + 1) % 1000 == 0: print('epoch: &#123;&#125;, loss: &#123;&#125;'.format(e+1, loss.item())) epoch: 1000, loss: 0.283423513174057 epoch: 2000, loss: 0.2715207040309906 epoch: 3000, loss: 0.26463547348976135 epoch: 4000, loss: 0.2599412798881531 epoch: 5000, loss: 0.25658532977104187 epoch: 6000, loss: 0.2540966272354126 epoch: 7000, loss: 0.25219157338142395 epoch: 8000, loss: 0.2506936192512512 epoch: 9000, loss: 0.2494892179965973 epoch: 10000, loss: 0.2485022097826004 å¯ä»¥çœ‹åˆ°å¾—åˆ°äº†ç›¸åŒçš„ç»“æœï¼Œè¿™ç§ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥ä¼˜åŒ–å‚æ•°çš„æ–¹æ³•ï¼Œåœ¨æ·±åº¦å­¦ä¹ ä¸­å«åšåå‘ä¼ æ’­ç®—æ³• æ¥ä¸‹æ¥ï¼Œå®šä¹‰ä¸€ä¸ª5å±‚çš„ç¥ç»ç½‘ç»œ class module_net(nn.Module): def __init__(self, num_input, num_hidden1, num_hidden2, num_hidden3, num_hidden4, num_output): super(module_net, self).__init__() self.layer_activation = nn.Tanh() self.layer_input = nn.Linear(num_input, num_hidden1) self.layer_hidden1 = nn.Linear(num_hidden1, num_hidden2) self.layer_hidden2 = nn.Linear(num_hidden2, num_hidden3) self.layer_hidden3 = nn.Linear(num_hidden3, num_hidden4) self.layer_output = nn.Linear(num_hidden4, num_output) def forward(self, x): x = self.layer_input(x) x = self.layer_activation(x) x = self.layer_hidden1(x) x = self.layer_activation(x) x = self.layer_hidden2(x) x = self.layer_activation(x) x = self.layer_hidden3(x) x = self.layer_activation(x) x = self.layer_output(x) return xmo_net5 = module_net(2, 10, 10, 10, 10, 1)optim = torch.optim.SGD(mo_net5.parameters(), 0.1)# è®­ç»ƒ 20000 æ¬¡for e in range(20000): out = mo_net5(Variable(x)) loss = criterion(out, Variable(y)) optim.zero_grad() loss.backward() optim.step() if (e + 1) % 1000 == 0: print('epoch: &#123;&#125;, loss: &#123;&#125;'.format(e+1, loss.item())) epoch: 1000, loss: 0.2958005964756012 epoch: 2000, loss: 0.219310462474823 epoch: 3000, loss: 0.19828572869300842 epoch: 4000, loss: 0.18876363337039948 epoch: 5000, loss: 0.18029095232486725 epoch: 6000, loss: 0.16922634840011597 epoch: 7000, loss: 0.16025283932685852 epoch: 8000, loss: 0.1556335687637329 epoch: 9000, loss: 0.15196143090724945 epoch: 10000, loss: 0.14857107400894165 epoch: 11000, loss: 0.1452614665031433 epoch: 12000, loss: 0.13823415338993073 epoch: 13000, loss: 0.13576728105545044 epoch: 14000, loss: 0.13504637777805328 epoch: 15000, loss: 0.13344115018844604 epoch: 16000, loss: 0.13231371343135834 epoch: 17000, loss: 0.1298571079969406 epoch: 18000, loss: 0.1285153031349182 epoch: 19000, loss: 0.12435487657785416 epoch: 20000, loss: 0.1194448247551918 def plot_net5(x): out = torch.sigmoid(mo_net5(Variable(torch.from_numpy(x).float()))).data.numpy() out = (out &gt; 0.5) * 1 return out plot_decision_boundary(lambda x: plot_net5(x), x.numpy(), y.numpy()) plt.title('sequential') Text(0.5,1,&#39;sequential&#39;) å¯ä»¥çœ‹å‡ºå¤šå±‚ç¥ç»ç½‘ç»œæ‹Ÿåˆæ•ˆæœä¼šæ›´å¥½","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†","slug":"deeplearning-base","date":"2019-05-09T05:52:55.739Z","updated":"2019-06-10T07:59:10.799Z","comments":true,"path":"2019/05/09/deeplearning-base/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/09/deeplearning-base/","excerpt":"ä»‹ç»æ·±åº¦å­¦ä¹ ä¸­å¸¸ç”¨çš„ä¸€äº›æ¦‚å¿µ","text":"ä»‹ç»æ·±åº¦å­¦ä¹ ä¸­å¸¸ç”¨çš„ä¸€äº›æ¦‚å¿µ æ¢¯åº¦ä¸‹é™æ¢¯åº¦ä¸‹é™ æ¢¯åº¦ä¸‹é™æ³• æ¢¯åº¦ä¸‹é™ä»£ç (PyTorch)æ¢¯åº¦ä¸‹é™åœ¨çº¿æ€§æ¨¡å‹ä¸­çš„åº”ç”¨import torchimport numpy as npfrom torch.autograd import Variable torch.manual_seed(2019) &lt;torch._C.Generator at 0x10c9b39f0&gt; # è¯»å– x å’Œ yx_train = np.array([[3.3], [4.4], [5.5], [6.71], [6.93], [4.168], [9.779], [6.182], [7.59], [2.167], [7.042], [10.791], [5.313], [7.997], [3.1]], dtype=np.float32)y_train = np.array([[1.7], [2.76], [2.09], [3.19], [1.694], [1.573], [3.366], [2.596], [2.53], [1.221], [2.827], [3.465], [1.65], [2.904], [1.3]], dtype=np.float32) # ç”»å‡ºå›¾åƒimport matplotlib.pyplot as plt%matplotlib inlineplt.plot(x_train, y_train, 'bo') [&lt;matplotlib.lines.Line2D at 0x11ca8cfd0&gt;] # è½¬æ¢æˆ Tensorx_train = torch.from_numpy(x_train)y_train = torch.from_numpy(y_train)# å®šä¹‰å‚æ•° w å’Œ bw = Variable(torch.randn(1), requires_grad=True) # éšæœºåˆå§‹åŒ– wb = Variable(torch.zeros(1), requires_grad=True) # ä½¿ç”¨ 0 åˆå§‹åŒ– b # æ„å»ºçº¿æ€§å›å½’æ¨¡å‹x_train = Variable(x_train)y_train = Variable(y_train)def liner_model(x): return x * w + b y_ = liner_model(x_train) # åœ¨æ›´æ–°å‚æ•°ä¹‹å‰ï¼Œæ¨¡å‹è¾“å‡ºç»“æœplt.plot(x_train.data.numpy(), y_train.data.numpy(), 'bo', label='real')plt.plot(x_train.data.numpy(), y_.data.numpy(), 'ro', label='estimated')plt.legend() &lt;matplotlib.legend.Legend at 0x11cc6beb8&gt; è®¡ç®—è¯¯å·®å‡½æ•°ï¼š \\frac{1}{n} \\sum_{i=1}^{n}\\left(\\hat{y}_{i}-y_{i}\\right)^{2}# è®¡ç®—è¯¯å·®def get_loss(y_, y): return torch.mean((y_-y) ** 2)loss = get_loss(y_, y_train) # æŸ¥çœ‹ loss çš„å¤§å°loss tensor(10.2335, grad_fn=&lt;MeanBackward1&gt;) è®¡ç®— w å’Œ b çš„æ¢¯åº¦ï¼Œé‡‡ç”¨PyTorchçš„è‡ªåŠ¨æ±‚å¯¼ï¼Œä¸éœ€è¦æ‰‹åŠ¨å–è®¡ç®—æ¢¯åº¦ã€‚w å’Œ b çš„æ¢¯åº¦åˆ†åˆ«æ˜¯ï¼š \\frac{\\partial}{\\partial w}=\\frac{2}{n} \\sum_{i=1}^{n} x_{i}\\left(w x_{i}+b-y_{i}\\right)\\frac{\\partial}{\\partial b}=\\frac{2}{n} \\sum_{i=1}^{n}\\left(w x_{i}+b-y_{i}\\right)# è‡ªåŠ¨æ±‚å¯¼loss.backward() # æŸ¥çœ‹ w å’Œ b çš„æ¢¯åº¦print(w.grad)print(b.grad) tensor([-41.1289]) tensor([-6.0890]) # æ›´æ–°ä¸€æ¬¡å‚æ•°w.data = w.data - 1e-2 * w.grad.datab.data = b.data - 1e-2 * b.grad.data # æ›´æ–°ä¸€æ¬¡å‚æ•°åï¼Œæ¨¡å‹è¾“å‡ºç»“æœy_ = liner_model(x_train)plt.plot(x_train.data.numpy(), y_train.data.numpy(), 'bo', label='real')plt.plot(x_train.data.numpy(), y_.data.numpy(), 'ro', label='estimated')plt.legend() &lt;matplotlib.legend.Legend at 0x11cbd84e0&gt; # å¤šæ¬¡æ›´æ–°for e in range(20): y_ = liner_model(x_train) loss = get_loss(y_, y_train) w.grad.zero_() # æ¢¯åº¦å½’é›¶ b.grad.zero_() # æ¢¯åº¦å½’é›¶ loss.backward() w.data = w.data - 1e-2 * w.grad.data # æ›´æ–° w b.data = b.data - 1e-2 * b.grad.data # æ›´æ–° b print('epoch: &#123;&#125;, loss: &#123;&#125;'.format(e, loss.data.item())) epoch: 0, loss: 0.23505009710788727 epoch: 1, loss: 0.23023782670497894 epoch: 2, loss: 0.2298405021429062 epoch: 3, loss: 0.22952641546726227 epoch: 4, loss: 0.22921547293663025 epoch: 5, loss: 0.22890615463256836 epoch: 6, loss: 0.22859837114810944 epoch: 7, loss: 0.22829222679138184 epoch: 8, loss: 0.227987602353096 epoch: 9, loss: 0.2276846319437027 epoch: 10, loss: 0.2273831069469452 epoch: 11, loss: 0.22708319127559662 epoch: 12, loss: 0.22678478062152863 epoch: 13, loss: 0.2264879196882248 epoch: 14, loss: 0.2261926382780075 epoch: 15, loss: 0.22589880228042603 epoch: 16, loss: 0.22560644149780273 epoch: 17, loss: 0.225315660238266 epoch: 18, loss: 0.22502633929252625 epoch: 19, loss: 0.2247384935617447 # å‚æ•°æ›´æ–°20æ¬¡ä¹‹åçš„ç»“æœy_ = liner_model(x_train)plt.plot(x_train.data.numpy(), y_train.data.numpy(), 'bo', label='real')plt.plot(x_train.data.numpy(), y_.data.numpy(), 'ro', label='estimated')plt.legend() &lt;matplotlib.legend.Legend at 0x11cb5fc18&gt; ç»è¿‡ 20 æ¬¡æ›´æ–°ï¼Œ çº¢è‰²çš„é¢„æµ‹ç»“æœå·²ç»æ¯”è¾ƒå¥½çš„æ‹Ÿåˆäº†è“è‰²çš„çœŸå®å€¼ æ¢¯åº¦ä¸‹é™åœ¨å¤šé¡¹å¼æ¨¡å‹ä¸­çš„åº”ç”¨# å®šä¹‰ä¸€ä¸ªå¤šå˜é‡å‡½æ•°w_target = np.array([0.5, 3, 2.4]) # å®šä¹‰å‚æ•°b_target = np.array([0.9]) # å®šä¹‰å‚æ•°f_des = 'y = &#123;:.2f&#125; + &#123;:.2f&#125; * x + &#123;:.2f&#125; * x^2 + &#123;:.2f&#125; * x^3'.format( b_target[0], w_target[0], w_target[1], w_target[2]) # æ‰“å°å‡ºå‡½æ•°çš„æ ·å¼print(f_des) y = 0.90 + 0.50 * x + 3.00 * x^2 + 2.40 * x^3 # å…ˆç”»å‡ºè¿™ä¸ªå‡½æ•°çš„å›¾åƒx_sample = np.arange(-3, 3, 0.1)y_sample = b_target[0] + w_target[0] * x_sample + w_target[1] * x_sample **2 + w_target[2] * x_sample ** 3plt.plot(x_sample, y_sample, label='real curve')plt.legend() &lt;matplotlib.legend.Legend at 0x11c8255f8&gt; # æ„å»ºè®­ç»ƒæ•°æ® x å’Œ y# x æ˜¯ä¸€ä¸ªå¦‚ä¸‹çŸ©é˜µ [x, x^2, x^3]# y æ˜¯å‡½æ•°çš„ç»“æœ [y]x_train = np.stack([x_sample **i for i in range(1, 4)], axis=1)x_train = torch.from_numpy(x_train).float() # è½¬æ¢æˆ float tensory_train = torch.from_numpy(y_sample).float().unsqueeze(1) # è½¬æ¢ä¸º åˆ—å‘é‡ # å®šä¹‰è¦ä¼˜åŒ–çš„å‚æ•° w å’Œ bw = Variable(torch.randn(3,1), requires_grad=True)b = Variable(torch.zeros(1), requires_grad=True)# å°† x å’Œ y è½¬æ¢æˆ Variabelx_train = Variable(x_train)y_train = Variable(y_train)# å®šä¹‰å¤šå…ƒçº¿æ€§æ¨¡å‹def multi_model(x): return torch.mm(x, w) + b # torch.mm çŸ©é˜µç›¸ä¹˜ # ç”»å‡ºæ²¡æœ‰å‚æ•°æ²¡æœ‰æ›´æ–°ä¹‹å‰çš„æ¨¡å‹ä¸çœŸå®æ¨¡å‹ä¹‹é—´çš„å¯¹æ¯”y_pred = multi_model(x_train)plt.plot(x_train.data.numpy()[:, 0], y_pred.data.numpy(), color='r', label='fitting curve')plt.plot(x_train.data.numpy()[:, 0], y_sample, color='b', label='real curve')plt.legend() &lt;matplotlib.legend.Legend at 0x11cf3f390&gt; loss = get_loss(y_pred, y_train)print(loss) tensor(142.2003, grad_fn=&lt;MeanBackward1&gt;) # è‡ªåŠ¨æ±‚å¯¼loss.backward() # æŸ¥çœ‹ w å’Œ b çš„æ¢¯åº¦print(w.grad)print(b.grad) tensor([[ -36.4598], [ -13.2381], [-236.6262]]) tensor([-3.9543]) # æ›´æ–°ä¸€æ¬¡å‚æ•°w.data = w.data - 0.001 * w.grad.datab.data = b.data - 0.001 * b.grad.data # ç”»å‡ºæ›´æ–°ä¸€æ¬¡å‚æ•°ä¹‹åæ¨¡å‹y_pred = multi_model(x_train)plt.plot(x_train.data.numpy()[:, 0], y_pred.data.numpy(), color='r', label='fitting curve')plt.plot(x_train.data.numpy()[:, 0], y_sample, color='b', label='real curve')plt.legend() &lt;matplotlib.legend.Legend at 0x11ccc1b70&gt; # æ›´æ–° 100 æ¬¡for e in range(100): y_pred = multi_model(x_train) loss = get_loss(y_pred, y_train) w.grad.data.zero_() b.grad.data.zero_() loss.backward() # æ›´æ–°å‚æ•° w.data = w.data - 0.001 * w.grad.data b.data = b.data - 0.001 * b.grad.data if (e + 1) % 20 == 0: print('epoch &#123;&#125;, Loss:&#123;:.5f&#125;'.format(e+1, loss.data.item())) epoch 20, Loss:2.84467 epoch 40, Loss:1.08338 epoch 60, Loss:0.61722 epoch 80, Loss:0.48439 epoch 100, Loss:0.43824 # æ›´æ–° 100 æ¬¡ä¹‹åçš„æ¨¡å‹ç»“æœy_pred = multi_model(x_train)plt.plot(x_train.data.numpy()[:, 0], y_pred.data.numpy(), label='fitting curve', color='r') plt.plot(x_train.data.numpy()[:, 0], y_sample, label='real curve', color='b') plt.legend() &lt;matplotlib.legend.Legend at 0x11cf335c0&gt; # è¾“å‡ºæ­¤æ—¶çš„å‚æ•° w å’Œ bprint(w.data)print(b.data) tensor([[1.1381], [3.1028], [2.3013]]) tensor([0.1931]) å¯ä»¥çœ‹åˆ°æ¨¡å‹è¿­ä»£100æ¬¡ä¹‹åå·²ç»éå¸¸æ¥è¿‘åŸå§‹æ•°æ®äº† æ¿€æ´»å‡½æ•°å®šä¹‰ç±»æ¯”äººè„‘ç¥ç»å…ƒï¼Œè§£é‡Šå¦‚ä¸‹æ¿€æ´»å‡½æ•°åœ¨ç¥ç»ç½‘ç»œä¸­éå¸¸é‡è¦ï¼Œåªæœ‰é€šè¿‡æ¿€æ´»å‡½æ•°æ‰ä¼šè¿›å…¥ä¸‹ä¸€å±‚ç»§ç»­ä¼ æ’­ï¼Œå¦‚æœä¸ä½¿ç”¨æ¿€æ´»å‡½æ•°ï¼Œæ— è®ºå¤šå°‘å±‚ç¥ç»ç½‘ç»œï¼Œæœ€åéƒ½ä¼šå˜æˆå•å±‚ç¥ç»ç½‘ç»œï¼Œæ‰€ä»¥æ¯ä¸€å±‚å¿…é¡»ä½¿ç”¨æ¿€æ´»å‡½æ•° å¸¸è§çš„æ¿€æ´»å‡½æ•°sigmoid å‡½æ•°f(z)=\\frac{1}{1+\\exp (-z)}å¯¼å‡½æ•°: f^{\\prime}(z)=f(z)(1-f(z))å›¾åƒï¼š tanh å‡½æ•°f(z)=\\tanh (z)=\\frac{\\mathrm{e}^{z}-\\mathrm{e}^{-z}}{\\mathrm{e}^{z}+\\mathrm{e}^{-z}}å¯¼å‡½æ•°ï¼š f^{\\prime}(z)=1-(f(z))^{2}å›¾åƒ: ReLU å‡½æ•°f(z)=\\max (0, z)å¯¼å‡½æ•°: f^{\\prime}(z)=\\left\\{\\begin{array}{l}{1, z>0} \\\\ {0, z \\leqslant 0}\\end{array}\\right.å›¾åƒ: æ¿€æ´»å‡½æ•°çš„é€‰æ‹© ç°åœ¨çš„ç¥ç»ç½‘ç»œä¸­ï¼Œ90%éƒ½ä½¿ç”¨ReLUæ¿€æ´»å‡½æ•°ï¼Œè¯¥æ¿€æ´»å‡½æ•°èƒ½å¤ŸåŠ å¿«æ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦ï¼Œå¯¹æ¯”å…¶ä»–æ¿€æ´»å‡½æ•°è®¡ç®—æ›´åŠ ç®€å•ã€‚ Sigmoidå’ŒTanhä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼Œå½“zå¾ˆå¤§æ—¶ï¼Œsigmoidå‡½æ•°çš„å¯¼å‡½æ•°ä¼š=è¶‹è¿‘äº0ï¼Œé€ æˆæ¢¯åº¦æ¶ˆå¤±ï¼ŒTanhç›¸å½“äºSigmoidå‡½æ•°çš„å¹³ç§»ï¼ŒåŸç†ç±»ä¼¼ã€‚ RuLUçš„ä¼˜åŠ¿ï¼Œä»¥åŠå±€é™æ€§ï¼š ä¼˜ç‚¹ï¼šè®¡ç®—ç®€å•ï¼Œé¿å…æ¢¯åº¦æ¶ˆå¤±ï¼Œå•ä¾§æŠ‘åˆ¶æä¾›äº†ç½‘ç»œçš„ç¨€ç–æ€§è¡¨è¾¾èƒ½åŠ› å±€é™æ€§ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šå¯¼è‡´ç¥ç»å…ƒæ­»äº¡é—®é¢˜ï¼Œè¿™æ˜¯ç”±äºå‡½æ•°è´Ÿæ¢¯åº¦åœ¨ç»è¿‡ReLUå•å…ƒæ—¶è¢«ç½®ä¸º0ï¼Œä¸”ä¹‹åä¹Ÿä¸è¢«ä»»ä½•æ•°æ®æ¿€æ´»ï¼Œå³æ”¹ç¥ç»å…ƒæ¢¯åº¦æ°¸è¿œä¸º0ï¼Œä¸å¯¹ä»»ä½•æ•°æ®äº§ç”Ÿæ•ˆåº”ã€‚åœ¨å®ä¹ è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¦‚æœå­¦ä¹ ç‡è®¾ç½®è¾ƒå¤§ï¼Œä¼šå¯¼è‡´ä¸€å®šæ¯”ä¾‹çš„ç¥ç»å…ƒä¸å¯é€†æ­»äº¡ã€‚å¯¼è‡´å‚æ•°æ¢¯åº¦æ— æ³•æ›´æ–°ï¼Œæ•´ä¸ªè®­ç»ƒè¿‡ç¨‹å¤±è´¥ã€‚ ä¼˜åŒ–ï¼šé‡‡ç”¨Leaky ReLU è¡¨è¾¾å¼ f(z)=\\left\\{\\begin{array}{cl}{z,} & {z>0} \\\\ {a z,} & {z \\leqslant 0}\\end{array}\\right. åå‘ä¼ æ’­ç®—æ³•å®šä¹‰åå‘ä¼ æ’­æœ¬è´¨ä¸Šæ˜¯é“¾å¼æ±‚å¯¼æ³•åˆ™çš„ä¸€ä¸ªåº”ç”¨ã€‚åå‘ä¼ æ’­ç®—æ³•æ˜¯ä¸€ä¸ªä¼˜é›…çš„å±€éƒ¨è¿‡ç¨‹ï¼Œæ¯æ¬¡æ±‚å¯¼åªæ˜¯å¯¹å½“å‰çš„è¿ç®—æ±‚å¯¼ï¼Œæ±‚è§£æ¯å±‚ç½‘ç»œçš„å‚æ•°éƒ½æ˜¯é€šè¿‡é“¾å¼æ³•åˆ™å°†å‰é¢çš„ç»“æœæ±‚å‡ºä¸æ–­è¿­ä»£åˆ°è¿™ä¸€å±‚ï¼Œæ‰€ä»¥è¯´æ˜¯ä¸€ä¸ªä¼ æ’­è¿‡ç¨‹ã€‚ æ±‚è§£è¿‡ç¨‹ æ±‚è§£ä¸‹å›¾çš„åå‘ä¼ æ’­è¿‡ç¨‹è¡¨è¾¾å¼ï¼š \\begin{array}{l}{q=x+y=-2+5=3} \\\\ {f=q z=3(-4)=-12}\\end{array}æ±‚è§£ä¸­é—´è¿‡ç¨‹ï¼š \\begin{array}{ll}{\\frac{\\partial f}{\\partial q}=z=-4} & {\\frac{\\partial f}{\\partial z}=q=3} \\\\ {\\frac{\\partial q}{\\partial x}=1} & {\\frac{\\partial q}{\\partial y}=1}\\end{array}æ±‚è§£æ¢¯åº¦ï¼š \\begin{aligned} \\frac{\\partial f}{\\partial x} &=\\frac{\\partial f}{\\partial q} \\frac{\\partial q}{\\partial x}=z \\times 1=-4 \\\\ \\frac{\\partial f}{\\partial y} &=\\frac{\\partial f}{\\partial q} \\frac{\\partial q}{\\partial y}=z \\times 1=-4 \\end{aligned} Sigmoid å‡½æ•°æ±‚è§£åå‘ä¼ æ’­è¡¨è¾¾å¼ï¼š f(w, x)=\\frac{1}{1+e^{-\\left(w_{0} x_{0}+w_{1} x_{1}+w_{2}\\right)}}æ±‚è§£ï¼š \\frac{\\partial f}{\\partial w_{0}}, \\frac{\\partial f}{\\partial w_{1}}, \\frac{\\partial f}{\\partial w_{2}}æ„å»ºè®¡ç®—å›¾ï¼š \\begin{array}{l}{f(x)=\\frac{1}{x}} \\\\ {f_{c}(x)=1+x} \\\\ {f_{e}(x)=e^{x}} \\\\ {f_{w}(x)=-\\left(w_{0} x_{0}+w_{1} x_{1}+w_{2}\\right)}\\end{array}æ±‚è§£è¿‡ç¨‹ï¼šä¸Šå›¾ä¸­ç»¿è‰²æ•°å­—è¡¨ç¤ºæ•°å€¼ï¼Œçº¢è‰²æ•°å­—è¡¨ç¤ºæ¢¯åº¦ã€‚ä»åå‘å‰è®¡ç®—å„ä¸ªå‚æ•°çš„æ¢¯åº¦ã€‚ æœ€åé¢æ¢¯åº¦ä¸º 1 ç»è¿‡ $\\frac{1}{x}$ è¿™ä¸ªå‡½æ•°ï¼Œæ¢¯åº¦æ˜¯ $-\\frac{1}{x^{2}}$ ï¼Œ æ‰€ä»¥å¾€å‰ä¼ æ’­çš„æ¢¯åº¦æ˜¯ $1 \\times-\\frac{1}{1.37^{2}}=-0.53$ã€‚ ç»è¿‡ +1 æ“ä½œï¼Œæ¢¯åº¦ä¸å˜ ç»è¿‡ $e^{x}$, æ¢¯åº¦å˜ä¸º $-0.53 \\times e^{-1}=-0.2$ã€‚ ç»è¿‡ *-1ï¼Œ æ¢¯åº¦ä¸å˜ã€‚ ä¸æ–­å‘åä¼ æ’­å°±èƒ½å¤Ÿæ±‚å¾—æ¯ä¸€ä¸ªå‚æ•°çš„æ¢¯åº¦ã€‚ ä¼˜åŒ–ç®—æ³•å®šä¹‰åŸºäºåå‘ä¼ æ’­ç®—æ³•è®¡ç®—å‡ºæ¢¯åº¦ï¼Œæ¥ä¸‹æ¥å°±ä¼šåˆ©ç”¨å„ç§ä¼˜åŒ–ç®—æ³•å¯¹å‚æ•°è¿›è¡Œä¼˜åŒ–ã€‚ å¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•SGD éšæœºæ¢¯åº¦ä¸‹é™å®šä¹‰\\theta_{i+1}=\\theta_{i}-\\eta \\nabla L(\\theta)$\\eta$ ä»£è¡¨å­¦ä¹ ç‡ï¼Œ$\\nabla L(\\theta)$ ä»£è¡¨æ¢¯åº¦ å®ç°# è‡ªå®šä¹‰å®ç°def sgd_update(parameters, lr): for param in parameters: param.data = param.data - lr * param.grad.data # PyTorch å®ç°optimzier = torch.optim.SGD(net.parameters(), 1e-2) Momentum åŸºäºåŠ¨é‡çš„æ¢¯åº¦ä¸‹é™å®šä¹‰\\begin{array}{c}{v_{i}=\\gamma v_{i-1}+\\eta \\nabla L(\\theta)} \\\\ {\\theta_{i}=\\theta_{i-1}-v_{i}}\\end{array}$v_{i}$ æ˜¯å½“å‰é€Ÿåº¦ï¼Œ$\\gamma$ æ˜¯åŠ¨é‡å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå°äº 1 çš„æ­£æ•°ï¼Œ $\\eta$ æ˜¯å­¦ä¹ ç‡ç›¸å½“äºæ¯æ¬¡åœ¨è¿›è¡Œå‚æ•°æ›´æ–°çš„æ—¶å€™ï¼Œéƒ½ä¼šå°†ä¹‹å‰çš„é€Ÿåº¦è€ƒè™‘è¿›æ¥ï¼Œæ¯ä¸ªå‚æ•°åœ¨å„æ–¹å‘ä¸Šçš„ç§»åŠ¨å¹…åº¦ä¸ä»…å–å†³äºå½“å‰çš„æ¢¯åº¦ï¼Œè¿˜å–å†³äºè¿‡å»å„ä¸ªæ¢¯åº¦åœ¨å„ä¸ªæ–¹å‘ä¸Šæ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸€ä¸ªæ¢¯åº¦ä¸€è‡´æ²¿ç€å½“å‰æ–¹å‘è¿›è¡Œæ›´æ–°ï¼Œé‚£ä¹ˆæ¯æ¬¡æ›´æ–°çš„å¹…åº¦å°±è¶Šæ¥è¶Šå¤§ï¼Œå¦‚æœä¸€ä¸ªæ¢¯åº¦åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šä¸æ–­å˜åŒ–ï¼Œé‚£ä¹ˆå…¶æ›´æ–°å¹…åº¦å°±ä¼šè¢«è¡°å‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¾ƒå¤§çš„å­¦ä¹ ç‡ï¼Œä½¿å¾—æ”¶æ•›æ›´å¿«ï¼ŒåŒæ—¶æ¢¯åº¦æ¯”è¾ƒå¤§çš„æ–¹å‘å°±ä¼šå› ä¸ºåŠ¨é‡çš„å…³ç³»æ¯æ¬¡æ›´æ–°çš„å¹…åº¦å‡å°‘ã€‚ å®ç°# è‡ªå®šä¹‰å®ç°def sgd_momentum(parameters, vs, lr, gamma): for param, v in zip(parameters, vs): v[:] = gamma * v + lr * param.grad.data param.data = param.data - v # PyTorch å®ç°# åŠ åŠ¨é‡optimizer = torch.optim.SGD(net.parameters(), lr=1e-2, momentum=0.9) Adagrad è‡ªé€‚åº”æ¢¯åº¦ä¸‹é™å®šä¹‰å­¦ä¹ ç‡åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ä¸æ–­æ”¹å˜ã€‚å­¦ä¹ ç‡ä¸ºï¼š \\frac{\\eta}{\\sqrt{s+\\epsilon}}æ¯æ¬¡ä½¿ç”¨ä¸€ä¸ª batch sizeçš„æ•°æ®è¿›è¡Œå‚æ•°æ›´æ–°çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ‰€æœ‰å‚æ•°çš„æ¢¯åº¦ï¼Œå¯¹äºæ¯ä¸ªå‚æ•°ï¼Œåˆå§‹åŒ–ä¸€ä¸ªå˜é‡ s ä¸º 0ï¼Œç„¶åæ¯æ¬¡å°†è¯¥å‚æ•°çš„æ¢¯åº¦å¹³æ–¹å’Œç´¯åŠ åˆ°è¿™ä¸ªå˜é‡ s ä¸Šï¼Œç„¶åå†æ›´æ–°å‚æ•°çš„æ—¶å€™ï¼Œå­¦ä¹ ç‡å˜ä¸ºä¸Šå¼çš„æ ·å­ã€‚$\\epsilon$ æ˜¯ä¸ºäº†æ•°å€¼ç¨³å®šæ€§è€ŒåŠ ä¸Šçš„ï¼Œå› ä¸ºæœ‰å¯èƒ½ s ä¸º 0ï¼Œé‚£ä¹ˆ 0 å‡ºç°åœ¨åˆ†æ¯å°±ä¼šå‡ºç°æ— ç©·å¤§çš„æƒ…å†µï¼Œé€šå¸¸å– $10^{-10}$ ,è¿™æ ·ä¸åŒçš„å‚æ•°ç”±äºæ¢¯åº¦ä¸åŒï¼Œå®ƒä»¬å¯¹åº”çš„ s å¤§å°ä¹Ÿå°±ä¸åŒï¼Œå¾—åˆ°çš„å­¦ä¹ ç‡ä¹Ÿå°±ä¸åŒï¼Œå®ç°äº†è‡ªé€‚åº”çš„å­¦ä¹ ç‡ã€‚Adagrad çš„ æ ¸å¿ƒæƒ³æ³•æ˜¯ï¼šå¦‚æœä¸€ä¸ªå‚æ•°çš„æ¢¯åº¦ä¸€ç›´éƒ½éå¸¸å¤§ï¼Œé‚£ä¹ˆå…¶å¯¹åº”çš„å­¦ä¹ ç‡å°±å˜å°ä¸€ç‚¹ï¼Œé˜²æ­¢éœ‡è¡ã€‚è€Œä¸€ä¸ªå‚æ•°çš„æ¢¯åº¦ä¸€ç›´éƒ½éå¸¸å°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°çš„å­¦ä¹ ç‡å°±å˜å¤§ä¸€ç‚¹ï¼Œä½¿å¾—å…¶èƒ½å¤Ÿå¿«é€Ÿçš„æ›´æ–°ã€‚ç¼ºç‚¹æ˜¯è®­ç»ƒåæœŸï¼Œå­¦ä¹ ç‡è¿‡å°ï¼Œå› ä¸º Adagrad ç´¯åŠ ä¹‹å‰æ‰€æœ‰çš„æ¢¯åº¦å¹³æ–¹ä½œä¸ºåˆ†æ¯ã€‚ å®ç°# è‡ªå®šä¹‰å®ç°def sgd_adagrad(parameters, sqrs, lr): â€˜â€™â€˜ sqrs: æ¢¯åº¦å¹³æ–¹å’Œ â€™â€˜â€™ eps = 1e-10 for param, sqr in zip(parameters, sqrs): sqr[:] = sqr + param.grad.data ** 2 div = lr / torch.sqrt(sqr + eps) * param.grad.data param.data = param.data - div # PyTorch å®ç°optimizer = torch.optim.Adagrad(net.parameters(), lr=1e-2) RMSProp RMSpropæ–¹æ³•å®šä¹‰RMSPropçš„æå‡ºï¼Œä¸ºäº†è§£å†³Adagradè®­ç»ƒåæœŸï¼Œå­¦ä¹ ç‡è¿‡å°çš„é—®çš„ã€‚RMSProp ä½¿ç”¨ä¸€ä¸ªæŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡æ¥è®¡ç®— sï¼Œå¦‚ä¸‹å¼ï¼š s_{i}=\\alpha s_{i-1}+(1-\\alpha) g^{2}å­¦ä¹ ç‡æ›´æ–°å…¬å¼ï¼š \\frac{\\eta}{\\sqrt{s+\\epsilon}}$g$ è¡¨ç¤ºå½“å‰æ±‚å‡ºçš„å‚æ•°æ¢¯åº¦ï¼Œ$\\alpha$ æ˜¯ä¸€ä¸ªç§»åŠ¨å¹³å‡çš„ç³»æ•°ï¼Œè¿™ä¸ªç³»æ•°ä½¿ç”¨ RMSProp æ›´æ–°åˆ°åæœŸç´¯åŠ çš„æ¢¯åº¦å¹³æ–¹è¾ƒå°ï¼Œä»è€Œä¿è¯ s ä¸ä¼šå¤ªå¤§ï¼Œä¹Ÿå°±æ˜¯ä½¿å¾—æ¨¡å‹åæœŸä¾ç„¶èƒ½æ‰¾åˆ°æ¯”è¾ƒä¼˜çš„ç»“æœã€‚ å®ç°# è‡ªå®šä¹‰å®ç°def rmsprop(parameters, sqrs, lr, alpha): eps = 1e-10 for param, sqr in zip(parameters, sqrs): sqr[:] = alpha * sqr + (1 - alpha) * param.grad.data ** 2 div = lr / torch.sqrt(sqr + eps) * param.grad.data param.data = param.data - div # PyTorch å®ç°optimizer = torch.optim.RMSprop(net.parameters(), lr=1e-3, alpha=0.9) Adadelta Adaedltaæ–¹æ³•å®šä¹‰ä¹Ÿæ˜¯ä¸ºäº†è§£å†³Adagradä¸­å­¦ä¹ ç‡ä¸æ–­å‡å°çš„é—®é¢˜ã€‚å…ˆä½¿ç”¨ç§»åŠ¨å¹³å‡æ¥è®¡ç®— s s=\\rho s+(1-\\rho) g^{2}$\\rho$ ç§»åŠ¨å¹³å‡ç³»æ•°ï¼Œ$g$ å‚æ•°çš„æ¢¯åº¦ï¼Œè®¡ç®—éœ€è¦æ›´æ–°çš„å‚æ•°çš„å˜åŒ–é‡ï¼š g^{\\prime}=\\frac{\\sqrt{\\Delta \\theta+\\epsilon}}{\\sqrt{s+\\epsilon}} g$\\Delta \\theta$ åˆå§‹ä¸º 0 å¼ é‡ï¼Œæ¯ä¸€æ­¥åšå¦‚ä¸‹æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡æ›´æ–°ï¼š \\Delta \\theta=\\rho \\Delta \\theta+(1-\\rho) g^{\\prime 2}æœ€åå‚æ•°æ›´æ–°ä¸ºï¼š \\theta=\\theta-g^{\\prime}å®ç°# è‡ªå®šä¹‰å®ç°def adadelta(parameters, sqrs, deltas, rho): eps = 1e-6 for param, sqr, delta in zip(parameters, sqrs, deltas): sqr[:] = rho * sqr + (1 - rho) * param.grad.data ** 2 cur_delta = torch.sqrt(delta + eps) / torch.sqrt(sqr + eps) * param.grad.data delta[:] = rho * delta + (1 - rho) * cur_delta ** 2 param.data = param.data - cur_delta # PyTorch å®ç°optimizer = torch.optim.Adadelta(net.parameters(), rho=0.9) Adam Adamæ–¹æ³•å®šä¹‰Adam æ˜¯ä¸€ä¸ªç»“åˆäº†åŠ¨é‡æ³•å’ŒRMSPropçš„ä¼˜åŒ–ç®—æ³•ï¼Œç»“åˆäº†ä¸¤è€…çš„ä¼˜ç‚¹ã€‚ä½¿ç”¨ä¸€ä¸ªåŠ¨é‡å˜é‡ v å’Œä¸€ä¸ª RMSProp ä¸­çš„æ¢¯åº¦å…ƒç´ å¹³æ–¹çš„ç§»åŠ¨æŒ‡æ•°åŠ æƒå¹³å‡ sï¼Œä¼˜å…ˆå°†ä»–ä»¬å…¨éƒ¨åˆå§‹åŒ–ä¸º 0ï¼Œç„¶åå†æ¯æ¬¡è¿­ä»£ä¸­ï¼Œè®¡ç®—ä»–ä»¬çš„ç§»åŠ¨åŠ æƒå¹³å‡è¿›è¡Œæ›´æ–°ã€‚ \\begin{aligned} v &=\\beta_{1} v+\\left(1-\\beta_{1}\\right) g \\\\ s &=\\beta_{2} s+\\left(1-\\beta_{2}\\right) g^{2} \\end{aligned}ä¸ºäº†å‡è½» v å’Œ s è¢«åˆå§‹åŒ–ä¸º 0 çš„åˆæœŸå¯¹è®¡ç®—æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡çš„å½±å“ï¼Œæ¯æ¬¡ v å’Œ s éƒ½åšä¸‹é¢çš„ä¿®æ­£ã€‚ \\begin{aligned} \\hat{v} &=\\frac{v}{1-\\beta_{1}^{t}} \\\\ \\hat{s} &=\\frac{s}{1-\\beta_{2}^{t}} \\end{aligned}$t$è¿­ä»£æ¬¡æ•°ï¼Œå½“$0\\leq\\beta{1},\\beta{2}\\leq1$æ—¶ï¼Œè¿­ä»£åˆ°åæœŸ$t$æ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆ$\\beta{1}^{t}$å’Œ$\\beta{2}^{t}$å°±å‡ ä¹ä¸º 0ï¼Œä¸ä¼šå¯¹ v å’Œ s æœ‰ä»»ä½•å½±å“äº†ï¼Œç®—æ³•ä½œè€…å»ºè®®$\\beta{1}=0.9,\\beta{2}=0.999$ã€‚ä½¿ç”¨ä¿®æ­£ä¹‹åçš„$\\hat{v}$å’Œ$\\hat{s}$è¿›è¡Œå­¦ä¹ ç‡çš„é‡æ–°è®¡ç®—ã€‚ g^{\\prime}=\\frac{\\eta\\hat{v}}{\\sqrt{\\hat{s}+\\epsilon}}$\\eta$æ˜¯å­¦ä¹ ç‡ï¼Œ $\\epsilon$æ˜¯ä¸ºäº†æ•°å€¼ç¨³å®šè€Œæ·»åŠ çš„å¸¸æ•°ã€‚æ›´æ–°å‚æ•°ï¼š \\theta_{i}=\\theta_{i-1}-g^{\\prime}å®ç°# è‡ªå®šä¹‰å®ç°def adam(parameters, vs, sqrs, lr, t, beta1=0.9, beta2=0.999): eps = 1e-8 for param, v, sqr in zip(parameters, vs, sqrs): v[:] = beta1 * v + (1 - beta1) * param.grad.data sqr[:] = beta2 * sqr + (1 - beta2) * param.grad.data ** 2 v_hat = v / (1 - beta1 ** t) s_hat = sqr / (1 - beta2 ** t) param.data = param.data - lr * v_hat / torch.sqrt(s_hat + eps) # PyTorch å®ç°optimizer = torch.optim.Adam(net.parameters(), lr=1e-3)","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"åŸºç¡€æ¦‚å¿µ","slug":"åŸºç¡€æ¦‚å¿µ","permalink":"http://lucas0625.github.io/blog/tags/åŸºç¡€æ¦‚å¿µ/"}]},{"title":"ç®—æ³•é¢è¯•ç¼–ç¨‹è¯•é¢˜é›†é”¦","slug":"interviewCode","date":"2019-05-05T08:34:34.929Z","updated":"2019-09-22T13:37:31.548Z","comments":true,"path":"2019/05/05/interviewCode/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/05/interviewCode/","excerpt":"[toc] é¢è¯•å‡†å¤‡(ç¼–ç¨‹ç¯‡)","text":"[toc] é¢è¯•å‡†å¤‡(ç¼–ç¨‹ç¯‡) ä½è¿ç®—leetcode-78.Subsetsdesc: Given a set of distinct integers, nums, return all possible subsets (the power set)Note: The solution set must not contain duplicate subsets.è¿”å›åˆ—è¡¨ä¸­çš„æ‰€æœ‰å­é›† thought: N ä¸ªæ•°çš„é›†åˆæœ‰ 2*N ä¸ªå­é›†ï¼Œå°†æšä¸¾å­é›†è½¬æ¢æˆæšä¸¾ç»„åˆæ•°ï¼Œå¯¹åº”ä½ç½®ä¸º1ï¼Œåˆ™åŒ…å«è¿™ä¸ªæ•°ã€‚æ—¶é—´å¤æ‚åº¦O(n 2^n), ç©ºé—´å¤æ‚åº¦O(1)ã€‚ solution class Solution: # æ—¶é—´å¤æ‚åº¦O(n * 2^n), ç©ºé—´å¤æ‚åº¦O(1) def subsets(self, nums: List[int]) -&gt; List[List[int]]: N = len(nums) res = [] # N ä¸ªæ•°, æœ‰ 2**N ç§ç»„åˆ, æšä¸¾æ‰€æœ‰å­é›†è½¬åŒ–ä¸ºæšä¸¾æ‰€æœ‰ ç»„åˆæ•° for i in range(pow(2, N)): tmp = [] for j in range(N): # æ£€æµ‹ i çš„ç¬¬ j ä½æ˜¯å¦ä¸º 1 # 1 åŒ…å« 0 ä¸åŒ…å« if (i &gt;&gt; j) % 2 == 1: tmp.append(nums[j]) res.append(tmp) return res leetcode-762.Prime Number of Set Bits in Binary Representationdesc:Given two integers L and R, find the count of numbers in the range [L, R] (inclusive) having a prime number of set bits in their binary representation. (Recall that the number of set bits an integer has is the number of 1s present when written in binary. For example, 21 written in binary is 10101 which has 3 set bits. Also, 1 is not a prime.)ç»™å®šçš„[L,R]ä¸­ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶å1çš„ä¸ªæ•°æ˜¯è´¨æ•°çš„ä¸ªæ•°ã€‚ thought:æš´åŠ›è§£æ³•ï¼Œå…ˆæ±‚å‡ºç»™å®šæ•°çš„äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°ï¼Œåœ¨åˆ¤æ–­æ˜¯å¦ä¸ºè´¨æ•° solution:class Solution &#123;public: int countPrimeSetBits(int L, int R) &#123; int ans=0; for(int n=L; n&lt;=R; ++n)&#123; if(isPrime(bits(n)))&#123; ans++; &#125; &#125; return ans; &#125;private: int bits(int n)&#123; int s=0; while(n)&#123; s += n&amp;1; n &gt;&gt;= 1; &#125; return s; &#125; bool isPrime(int n)&#123; if(n&lt;=1) return false; if(n==2) return true; for(int i=2; i&lt;=sqrt(n); ++i)&#123; if(n%i == 0) return false; &#125; return true; &#125;&#125;; class Solution: def countPrimeSetBits(self, L: int, R: int) -&gt; int: res = 0 for i in range(L, R+1): if self.isPrime(self.bits(i)): res += 1 return res def bits(self, n): s = 0 while n: s += n &amp; 1 n &gt;&gt;=1 return s def isPrime(self, n): if n &lt;= 1: return False if n == 2: return True import math for i in range(2, int(math.sqrt(n))+1): if n % i == 0: return False return True leetcode-136. Single Numberdescï¼šGiven a non-empty array of integers, every element appears twice except for one. Find that single one.Note: Your algorithm should have a linear runtime complexity. Could you implement it without using extra memory?ä¸€ä¸ªåˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ å‡ºç°ä¸€æ¬¡ï¼Œå…¶ä½™éƒ½å‡ºç°ä¸¤æ¬¡ï¼Œæ‰¾åˆ°å‡ºç°ä¸€æ¬¡çš„å…ƒç´ ã€‚ thoughtï¼šè§£æ³•ä¸€ï¼šä½¿ç”¨hashmapè®¡æ•°ï¼Œè¿”å›å‡ºç°ä¸€æ¬¡çš„å…ƒç´ ï¼Œä½†æ˜¯ç”¨åˆ°äº†é¢å¤–ç©ºé—´ï¼Œä¸ç¬¦åˆé¢˜ç›®è¦æ±‚ã€‚è§£æ³•äºŒï¼šé‡‡ç”¨å¼‚æˆ–è¿ç®—ã€‚åˆ©ç”¨å¼‚æˆ–è¿ç®—çš„ä¸‹åˆ—æ€§è´¨ï¼š n ^ n = 0 0 ^ n = n solutionï¼šclass Solution: def singleNumber(self, nums: List[int]) -&gt; int: res = 0 for i in nums: res ^= i return res è®¡ç®—pow(x, y)desc: å®ç°ä¸€ä¸ªæ±‚å¹‚æ¬¡çš„è¿ç®—ã€‚ thought:å¦‚æœç›´æ¥ç”¨å¾ªç¯è¿ä¹˜çš„è¯ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N)ã€‚è§£æ³•ä¸€ï¼šé‡‡ç”¨ä½è¿ç®—ï¼Œå½“å‰ä½ä¸º1çš„ä¹˜åˆ°ç»“æœä¸­ï¼Œå½“å‰ä½ä¸º0çš„ä¸ä¹˜åˆ°ç»“æœä¸­ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(logN) solution:def my_pow(x, y): # x ** y ans = 1 while y: if y&amp;1: ans = ans * x x = x * x y &gt;&gt;= 1 return ans äºŒåˆ†æœç´¢leetcode-69. Sqrt(x)desc: Implement int sqrt(int x).Compute and return the square root of x, where x is guaranteed to be a non-negative integer.Since the return type is an integer, the decimal digits are truncated and only the integer part of the result is returned.å®ç°ä¸€ä¸ªå¼€æ–¹å‡½æ•°thought:è§£æ³•ä¸€: ç»™å®š y ,æ±‚ $y=x^2$ x çš„å€¼ï¼Œå¯ä»¥åœ¨[0,y]ä¹‹é—´äºŒåˆ†æœç´¢ï¼Œé€šè¿‡è®¾å®šè¯¯å·®å€¼ï¼Œæ¥æ±‚å‡ºæ»¡è¶³æ¡ä»¶çš„ x ã€‚è§£æ³•äºŒ: é€šè¿‡ç‰›é¡¿æ³•é€¼è¿‘ã€‚ x_{n+1}=x_{n}-\\frac{f\\left(x_{n}\\right)}{fâ€™\\left(x_{n}\\right)}ã€‚ solution:# è§£æ³•ä¸€class Solution: def mySqrt(self, x: int) -&gt; int: if x == 0 or x == 1: return x l, r = 0, x while l &lt; r: mid = (l + r) / 2 x_hat = mid * mid if abs(x - x_hat) &lt; 0.01: return int(mid) elif x_hat &lt; x: l = mid else: r = mid åˆ†æ²»æ•°ç»„leetcode-121. Best Time to Buy and Sell Stockdesc:Say you have an array for which the ith element is the price of a given stock on day i.If you were only permitted to complete at most one transaction (i.e., buy one and sell one share of the stock), design an algorithm to find the maximum profit.Note that you cannot sell a stock before you buy one.åªèƒ½è¿›è¡Œä¸€æ¬¡ä¹°å–ï¼Œæ±‚å‡ºæœ€å¤§çš„åˆ©æ¶¦ã€‚ thought: åªéœ€è¦éå†ä¸€æ¬¡æ•°ç»„ï¼Œä¸€ä¸ªå˜é‡è®°å½•éå†åˆ°è¯¥å…ƒç´ ä¹‹å‰çš„æœ€å°å€¼ï¼Œå¦ä¸€ä¸ªå˜é‡è®°å½•å½“å‰å€¼ä¸æœ€å°å€¼çš„å·®å€¼ä½œä¸ºåˆ©æ¶¦ï¼Œä¿ç•™æœ€å¤§çš„håˆ©æ¶¦ã€‚ solution:def maxProfit(prices): ''' å‚æ•°è¯´æ˜: prices_min : æ‰«è¿‡çš„ä»·æ ¼ä¸­çš„æœ€å°å€¼ ''' if not prices: return 0 prices_min = float('inf') res = 0 for item in prices: prices_min = min(item, prices_min) res = max(res, item - prices_min) return res ç”Ÿæˆæ–°æ•°ç»„desc: ç»™å®šä¸€ä¸ªæ•°ç»„ï¼ŒæŒ‰è¦æ±‚ç”Ÿæˆæ–°æ•°ç»„ ç”Ÿæˆçš„æ–°æ•°ç»„æ¯ä¸€ä½ä¸ºåŸæ•°ç»„ä¸åŒ…æ‹¬æ­¤ä½çš„å’Œã€‚ ä¸èƒ½ä½¿ç”¨å‡æ³•ã€‚ æ—¶é—´å¤æ‚åº¦O(N), ç©ºé—´å¤æ‚åº¦O(1) thought: nä»1å¼€å§‹ä¸¤æ¬¡å¾ªç¯ï¼Œå‰å‘ä¸€æ¬¡ï¼Œåå‘ä¸€æ¬¡ã€‚ å‰å‘ b[i] = b[i-1] + a[i-1] åå‘ b[i] = b[i] + a[i+1:n] leetcode-54.èºæ—‹æ•°ç»„çš„æ‰“å°desc:Given a matrix of m x n elements (m rows, n columns), return all elements of the matrix in spiral order. thought: ä¸€å…±æœ‰å››ç§å¯èƒ½å‰è¿›çš„æ–¹å‘ï¼Œå‘ç”Ÿä»¥ä¸‹æƒ…å†µæ”¹å˜æ–¹å‘ã€‚ æ•°ç»„ä¸‹æ ‡è¶Šç•Œã€‚ ä¸‹ä¸€ä¸ªåæ ‡çš„å€¼å·²ç»è¢«æ‰“å°è¿‡ã€‚ solution:class Solution: def __init__(self): ''' self.mark æ–¹å‘æ ‡è¯†ä½ self.row è¡Œåæ ‡ self.col åˆ—åæ ‡ self.res è¾“å‡ºçš„ç»“æœ self.all_i å·²ç»éå†è¿‡çš„åæ ‡é›†åˆ ''' self.mark = 0 self.row = 0 self.col = 0 self.res = list() self.all_i = set() self.all_i.add((0,0)) # å®šä¹‰å››ç§å¯èƒ½çš„æ–¹å‘ def derection(self, mark): around = [ [self.row, self.col + 1], [self.row + 1, self.col], [self.row, self.col - 1], [self.row - 1, self.col], ] return around[mark % 4] def next(self): # å…ƒç´ å…¨éƒ¨éå†å®Œæˆï¼Œé€€å‡º if len(self.all_i) == self.row_len * self.col_len: return # ä¸‹ä¸€ä¸ªåæ ‡ i = self.derection(self.mark) # åˆ¤æ–­ä¸‹æ ‡æ˜¯å¦è¶Šç•Œ if -1 not in i and self.row_len != i[0] and self.col_len != i[1]: # åˆ¤æ–­å½“å‰åæ ‡æ˜¯å¦éå†è¿‡ if tuple(i) not in self.all_i: self.row, self.col = i self.all_i.add(tuple(i)) return None # å¦‚æœä¸‹æ ‡è¶Šç•Œæˆ–è€…å½“å‰åæ ‡è¢«éå†è¿‡ï¼Œé‚£ä¹ˆæ”¹å˜æ–¹å‘,ç»§ç»­éå† self.mark += 1 return self.next() def spiralOrder(self, matrix: List[List[int]]) -&gt; List[int]: if not matrix: return [] self.row_len = len(matrix) self.col_len = len(matrix[0]) for _ in range(self.row_len * self.col_len): self.res.append(matrix[self.row][self.col]) self.next() return self.res leetcode-59.ç”Ÿæˆèºæ—‹æ•°ç»„desc:Given a positive integer n, generate a square matrix filled with elements from 1 to n2 in spiral order. thought: ä¸€å…±æœ‰å››ç§å¯èƒ½å‰è¿›çš„æ–¹å‘ï¼Œå‘ç”Ÿä»¥ä¸‹æƒ…å†µæ”¹å˜æ–¹å‘ã€‚ æ•°ç»„ä¸‹æ ‡è¶Šç•Œã€‚ ä¸‹ä¸€ä¸ªåæ ‡çš„å€¼å·²ç»å­˜åœ¨ã€‚ solution:class Solution: def __init__(self): ''' self.row è¡Œåæ ‡ self.col åˆ—åæ ‡ self.mark æ–¹å‘æ”¹å˜æ ‡è¯†ä½ ''' self.row = 0 self.col = 0 self.mark = 0 def derection(self, mark): around = [ [self.row, self.col + 1], [self.row + 1, self.col], [self.row, self.col - 1], [self.row - 1, self.col], ] return around[mark % 4] def next(self): i = self.derection(self.mark) # æ˜¯å¦è¶…å‡ºè¾¹ç•Œ if -1 not in i and self.row_max not in i: # ä¸‹ä¸€ä¸ªåæ ‡çš„å€¼æ˜¯å¦ä¸ºç©º if not self.matrix[i[0]][i[1]]: self.row, self.col = i return # è¶…å‡ºè¾¹ç•Œæˆ–è€…ä¸‹ä¸€ä¸ªåæ ‡å€¼ä¸ä¸ºç©º, æ”¹å˜ä½ç½® self.mark += 1 return self.next() def generateMatrix(self, n: int) -&gt; List[List[int]]: if not n: return [] self.matrix = [[None for _ in range(n)] for _ in range(n)] self.row_max = n for i in range(1, n**2 + 1): self.matrix[self.row][self.col] = i # é€€å‡ºæ¡ä»¶ if i == self.row_max ** 2: break self.next() return self.matrix å­—ç¬¦ä¸²leetcode-14.Longest Common Prefixdesc: Write a function to find the longest common prefix string amongst an array of strings.If there is no common prefix, return an empty string â€œâ€æŸ¥æ‰¾å­—ç¬¦ä¸²æ•°ç»„ä¸­çš„æœ€é•¿å…¬å…±å‰ç¼€ thoughtï¼šè§£æ³•ä¸€ï¼šåˆ©ç”¨ä¸¤ä¸ªæŒ‡é’ˆè¿›è¡Œéå†ï¼Œä¸€ä¸ªæŒ‡é’ˆéå†æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆéå†å­—ç¬¦æ•°ç»„ã€‚ç±»ä¼¼äºä¸€ä¸ªé•¿åº¦ä¸ç›¸ç­‰çš„äºŒç»´çŸ©é˜µï¼Œå›ºå®šæ¯ä¸€åˆ—ï¼Œéå†æ¯ä¸€è¡Œï¼Œå½“å‘ç°æŸä¸€åˆ—ä¸­å¯¹åº”çš„æŸè¡Œä¸å…¶ä»–è¡Œå…ƒç´ ä¸ç›¸ç­‰ï¼Œç»ˆæ­¢éå†ï¼Œè¿”å›ç»“æœã€‚ è§£æ³•äºŒï¼šå…ˆå°†å­—ç¬¦ä¸²æ•°ç»„æ’åºï¼Œæœ€é•¿å…¬å…±å‰ç¼€è‚¯å®šå­˜åœ¨äºé¦–å°¾å­—ç¬¦ä¸²ä¸­ï¼Œæ±‚å‡ºé¦–å°¾å­—ç¬¦ä¸²çš„å…¬å…±å‰ç¼€å³å¯ã€‚ solutionï¼š# è§£æ³•ä¸€class Solution: def longestCommonPrefix(self, strs: List[str]) -&gt; str: if not strs: return '' min_str = min(strs, key=lambda x: len(x)) min_str_len = len(min_str) res = '' flag = True for i in range(min_str_len): for str in strs: if str[i] == min_str[i]: continue else: flag = False break if flag: res += min_str[i] else: break return res # è§£æ³•äºŒclass Solution: def longestCommonPrefix(self, strs: List[str]) -&gt; str: if not strs: return '' strs_sort = sorted(strs) head = strs_sort[0] tail = strs_sort[-1] res = '' str_len = min(len(head), len(tail)) for i in range(str_len): if head[i] == tail[i]: res += head[i] else: break return res leetcode-8.String to Integer (atoi)descï¼šImplement atoi which converts a string to an integer.Note: Only the space character â€˜ â€˜ is considered as whitespace character. Assume we are dealing with an environment which could only store integers within the 32-bit signed integer range: [âˆ’231, 231 âˆ’ 1]. If the numerical value is out of the range of representable values, INT_MAX (231 âˆ’ 1) or INT_MIN (âˆ’231) is returned.å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•° thoughtï¼šä¸»è¦è€ƒè™‘ä¸€äº›è¾¹ç•Œæ¡ä»¶ï¼Œè¿™é‡Œåˆ©ç”¨æ­£åˆ™æ¥åŒ¹é…å­—ç¬¦ä¸²ä¸­çš„æ•°å­—ã€‚ solutionï¼šclass Solution: def myAtoi(self, str: str) -&gt; int: import re pattern = re.compile('[+-]?\\d+') str = str.strip() res = re.match(pattern, str) if res: res = int(res.group()) if res &gt; pow(2, 31) - 1: return pow(2, 31) - 1 elif res &lt; pow(-2, 31): return pow(-2, 31) else: return res else: return 0 leetcode-227. Basic Calculator IIdesc:Implement a basic calculator to evaluate a simple expression string.The expression string contains only non-negative integers, +, -, , / operators and empty spaces . The integer division should truncate toward zero.å®ç°åªåŒ…å« + - / ç©ºæ ¼çš„å­—ç¬¦ä¸²çš„æ•°å€¼å¤§å°ï¼Œç±»ä¼¼äºè‡ªå¸¦å‡½æ•° eval çš„åŠŸèƒ½ã€‚ thought: é‡‡ç”¨æ ˆæ•°æ®ç»“æ„ã€‚æ“ä½œç¬¦ä¸º + ï¼Œæ“ä½œç¬¦åä¸€ä¸ªå…ƒç´ å…¥æ ˆæ“ä½œç¬¦ä¸º - ï¼Œæ“ä½œç¬¦åä¸€ä¸ªå…ƒç´ ç›¸åæ•°å…¥æ ˆæ“ä½œç¬¦ä¸º * ï¼Œå–å‡ºæ ˆé¡¶å…ƒç´ ï¼Œä¸æ“ä½œç¬¦åä¸€ä¸ªå…ƒç´ åšè¿ç®—åå…¥æ ˆæ“ä½œç¬¦ä¸º / ï¼Œå–å‡ºæ ˆé¡¶å…ƒç´ ï¼Œä¸æ“ä½œç¬¦åä¸€ä¸ªå…ƒç´ åšè¿ç®—åå…¥æ ˆæœ€åå°†æ ˆå†…å…ƒç´ æ±‚å’Œã€‚ solution:class Solution: def calculate(self, s: str) -&gt; int: ''' å‚æ•°è¯´æ˜ï¼š pro_op:è®°å½•å‰ä¸€ä¸ªæ“ä½œç¬¦ï¼Œä¸ºäº†ä¿è¯é€»è¾‘è¿ç»­æ€§ï¼Œäººä¸ºåœ¨ç¬¬ä¸€ä¸ªæ•°å­—å‰é¢å¼•å…¥æ“ä½œç¬¦ + num: è®°å½•å‰ä¸€ä¸ªæ•°å­— ''' # å°†æ¯ä¸€ä¸ªå…ƒç´ é¡ºåºå…¥æ ˆ stack = [] pre_op = '+' num = 0 # æœ€ååŠ  + ä¿è¯æœ€åä¸€ä¸ªæ•°å­—å‚ä¸äº†è¿ç®—ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»»ä¸€ä¸ªå­—ç¬¦ã€‚ s = s.replace(' ', '') + '+' for c in s: if c.isdigit(): # è€ƒè™‘è¿ç»­æ•°å­—å‡ºç°çš„æƒ…å†µ num = num * 10 + int(c) continue if pre_op == '+': stack.append(int(num)) if pre_op == '-': stack.append(int(-num)) if pre_op == '*': val = stack.pop() stack.append(int(val * num)) if pre_op == '/': val = stack.pop() stack.append(int(val / num)) num = 0 pre_op = c return sum(stack) ä¸é‡å¤å­—ç¬¦ä¸²çš„æ‰€æœ‰æ’åˆ—ç»„åˆdesc: ä¾‹å¦‚è¾“å…¥ abc è¾“å‡º abc, acb, bac, bca, cba, cabthought: é‡‡ç”¨é€’å½’ï¼Œå…ˆå›ºå®šç¬¬ä¸€ä¸ªå­—æ¯ï¼Œå¯¹åç»­å­—ç¬¦ä¸²è¿›è¡Œå…¨æ’åˆ—ï¼Œç„¶åäº¤æ¢å­—æ¯ã€‚solution:def permutation(s, start): s = list(s) if not s or start &lt; 0: return # å®Œæˆæ’åˆ—å è¾“å‡ºå½“å‰æ’åˆ—çš„å­—ç¬¦ä¸² if start == len(s) - 1: print(''.join(s)) else: i = start while i &lt; len(s): # äº¤æ¢ i ä¸ start æ‰€åœ¨ä½ç½®çš„å­—ç¬¦ s[start], s[i] = s[i], s[start] permutation(s, start+1) # è¿˜åŸ i ä¸ start æ‰€åœ¨ä½ç½®å­—ç¬¦ s[start], s[i] = s[i], s[start] i += 1 å«æœ‰é‡å¤å­—ç¬¦ä¸²çš„æ‰€æœ‰æ’åˆ—ç»„åˆdesc: è¾“å…¥ abb è¾“å‡º abb, bab, bbathought:è§£æ³•ä¸€ï¼šæ±‚å‡ºæ‰€æœ‰æ’åˆ—ç»„åˆä¹‹åå»é‡ã€‚è§£æ³•äºŒï¼šåœ¨äº¤æ¢å…ƒç´ çš„æ—¶å€™ï¼Œåˆ¤æ–­äº¤æ¢çš„ä¸¤ä¸ªå…ƒç´ æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰åˆ™ä¸äº¤æ¢ã€‚solutionï¼š```## leetcode-46. Permutations**desc**: Given a collection of distinct integers, return all possible permutations.![](http://pangfu.oss-cn-beijing.aliyuncs.com/markdown/2019-07-10-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202019-07-10%20%E4%B8%8B%E5%8D%884.01.52.png)ç»™å®šä¸€ä¸ªä¸é‡å¤å…ƒç´ çš„åˆ—è¡¨ï¼Œè¿”å›å…¨æ’åˆ—åˆ—è¡¨**thought**: é€’å½’å®ç°**solution**ï¼š```pythonclass Solution: def __init__(self): self.res = list() def _permute(self, nums, start): if not nums or start &lt; 0: return if start == len(nums) - 1: from copy import deepcopy tmp = deepcopy(nums) self.res.append(tmp) else: i = start while i &lt; len(nums): nums[start], nums[i] = nums[i], nums[start] self._permute(nums, start+1) nums[start], nums[i] = nums[i], nums[start] i += 1 def permute(self, nums: List[int]) -&gt; List[List[int]]: self._permute(nums, 0) return self.res æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²desc:Given two strings, find the longest common substring.Return the length of it.æ±‚ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²ï¼Œæ³¨æ„å­ä¸²æ˜¯è¿ç»­çš„ã€‚ thought:åŠ¨æ€è§„åˆ’æ–¹æ³•ã€‚solution:class Solution: \"\"\" @param A: A string @param B: A string @return: the length of the longest common substring. \"\"\" def longestCommonSubstring(self, A, B): # write your code here if not A or not B: return 0 len_A = len(A) len_B = len(B) sb = '' maxs = 0 maxI = 0 M = [([None] * (len_B + 1)) for i in range(len_A + 1)] i = 0 while i &lt; len_A + 1: M[i][0] = 0 i += 1 j = 0 while j &lt; len_B + 1: M[0][j] = 0 j += 1 i = 1 while i &lt; len_A + 1: j = 1 while j &lt; len_B + 1: if list(A)[i-1] == list(B)[j-1]: M[i][j] = M[i-1][j-1] + 1 if M[i][j] &gt; maxs: maxs = M[i][j] maxI = i else: M[i][j] = 0 j += 1 i += 1 i = maxI - maxs while i &lt; maxI: sb = sb + list(A)[i] i += 1 return len(sb) leetcode-72. ç¼–è¾‘è·ç¦»desc: ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²s1å’Œs2ï¼Œè®¡ç®—å‡ºå°†s1è½¬åŒ–ä¸ºs2æ‰€éœ€è¦ä½¿ç”¨çš„æœ€å°æ“ä½œæ•°ã€‚å¯ä»¥å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²æ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š æ’å…¥ä¸€ä¸ªå­—ç¬¦ã€‚ åˆ é™¤ä¸€ä¸ªå­—ç¬¦ã€‚ æ›¿æ¢ä¸€ä¸ªå­—ç¬¦ã€‚ thoughtï¼šif s1[i] == s2[j]: å•¥éƒ½ä¸åš(skip) i, j åŒæ—¶å‘å‰ç§»åŠ¨else: ä¸‰é€‰ä¸€ æ’å…¥ï¼ˆinsertï¼‰ åˆ é™¤ï¼ˆdeleteï¼‰ æ›¿æ¢ï¼ˆreplaceï¼‰ solution:# é€’å½’è§£æ³•class Solution: def minDistance(self, word1: str, word2: str) -&gt; int: def dp(i, j) -&gt; int: # è¿”å› s1[:i] å’Œ s2[:j] çš„æœ€å°ç¼–è¾‘è·ç¦» if i == -1: return j + 1 if j == -1: return i + 1 if word1[i] == word2[j]: return dp(i - 1, j - 1) else: return min( dp(i, j - 1) + 1, # æ’å…¥ dp(i - 1, j) + 1, # åˆ é™¤ dp(i - 1, j - 1) + 1, # æ›¿æ¢ ) return dp(len(word1) - 1, len(word2) - 1) # åŠ¨æ€è§„åˆ’ä¼˜åŒ– å‡ ä½•é“¾è¡¨leetcode-2. Add Two Numbersdesc:You are given two non-empty linked lists representing two non-negative integers. The digits are stored in reverse order and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.You may assume the two numbers do not contain any leading zero, except the number 0 itself.å°†ä»¥é“¾è¡¨å½¢å¼è¡¨ç¤ºçš„ä¸¤ä¸ªæ•°åŠ èµ·æ¥ thought: éœ€è¦è€ƒè™‘è¿›ä½ï¼Œç„¶åä¾æ¬¡å°†ä¸¤ä¸ªé“¾è¡¨å¯¹åº”çš„å€¼å’Œè¿›ä½åŠ èµ·æ¥ã€‚solution:class ListNode: def __init__(self, x): self.val = x self.next = Noneclass Solution: def addTwoNumbers(self, l1: ListNode, l2: ListNode) -&gt; ListNode: ''' å˜é‡è§£é‡Š: left : è¡¨ç¤ºè¿›ä½ sm : è¡¨ç¤ºå½“å‰ä½ç½®æ±‚å’Œçš„ç»“æœ ''' left = 0 dummy = cur = ListNode(-1) while l1 or l2 or left: # l and l.val or 0 # lä¸ºçœŸï¼Œè¿”å›l.val # lä¸ºå‡ï¼Œè¿”å› 0 left, sm = divmod(sum(l and l.val or 0 for l in (l1, l2)) + left, 10) # cur.next ä¸­çš„ cur ä»£è¡¨æœªèµ‹æ–°å€¼ä¹‹å‰çš„cur cur.next = cur = ListNode(sm) # l = l and l.next # lä¸ºçœŸï¼Œè¿”å›l.next # lä¸ºå‡ï¼Œè¿”å›l l1 = l1 and l1.next l2 = l2 and l2.next return dummy.next leetcode-206. Reverse Linked Listdesc: Reverse a singly linked liståè½¬ä¸€ä¸ªå•é“¾è¡¨ thought: é‡‡ç”¨ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œæ¯æ¬¡å°†å½“å‰èŠ‚ç‚¹æ·»åŠ è‡³è¯¥èŠ‚ç‚¹ä¹‹å solutionï¼š# Definition for singly-linked list.# class ListNode:# def __init__(self, x):# self.val = x# self.next = Noneclass Solution: def reverseList(self, head): \"\"\" :type head: ListNode :rtype: ListNode \"\"\" prev = None current = head while current: current.next, prev, current = prev, current, current.next return prev leetcode-141. Linked List Cycledesc: Given a linked list, determine if it has a cycle in it.To represent a cycle in the given linked list, we use an integer pos which represents the position (0-indexed) in the linked list where tail connects to. If pos is -1, then there is no cycle in the linked list.åˆ¤æ–­ä¸€ä¸ªå•é“¾è¡¨æ˜¯å¦æœ‰ç¯ thought:è§£æ³•ä¸€ï¼šéå†é“¾è¡¨ï¼Œå¹¶è®°å½•ä¸‹é“¾è¡¨å½“å‰çš„å€¼ï¼Œåˆ¤æ–­ä¹‹åçš„é“¾è¡¨æ˜¯å¦åœ¨å·²è®°å½•ä¸‹çš„é“¾è¡¨çš„é›†åˆä¸­ã€‚è§£æ³•äºŒï¼šé‡‡ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œçœ‹ä¸¤ä¸ªæŒ‡é’ˆæ˜¯å¦ç›¸ç­‰ solution:# Definition for singly-linked list.# class ListNode(object):# def __init__(self, x):# self.val = x# self.next = Noneclass Solution(object): # è§£æ³•ä¸€ def hasCycle(self, head): \"\"\" :type head: ListNode :rtype: bool \"\"\" node_set = set() while head and head.next: if head in node_set: return True node_set.add(head) head = head.next return False #è§£æ³•äºŒ def hasCycle(self, head): \"\"\" :type head: ListNode :rtype: bool \"\"\" slow, fast = head, head while fast and fast.next: slow = slow.next fast = fast.next.next if slow == fast: return True return False è´ªå¿ƒå“ˆå¸Œè¡¨åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯æ¢ä½å­—ç¬¦ä¸²desc: Given two strings s and t , write a function to determine if t is an anagram of s.ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯å­—ç¬¦ç›¸åŒä½†æ˜¯ä½ç½®ä¸åŒ thought: æš´åŠ›æ³•å¯ä»¥å°†ä¸¤ä¸ªå­—ç¬¦ä¸²æ’åºï¼Œç„¶åæ¯”è¾ƒå¤§å°é‡‡ç”¨æ•£åˆ—è¡¨å¯ä»¥å…ˆç»Ÿè®¡æ¯ä¸ªå­—ç¬¦ä¸²çš„å„å­—ç¬¦çš„ä¸ªæ•°ï¼Œç„¶åæ¯”è¾ƒã€‚ solution # è§£æ³•ä¸€ æ—¶é—´å¤æ‚åº¦Nlog(N)calss Solution: def isAnagram(self, s: str, t: str) -&gt; bool: return sorted(s) == sorted(t) # è§£æ³•äºŒ æ—¶é—´å¤æ‚åº¦O(N)class Solution: def isAnagram(self, s: str, t: str) -&gt; bool: dic1, dic2 = &#123;&#125;, &#123;&#125; for item in s: dic1[item] = dic1.get(item, 0) + 1 for item in t: dic2[item] = dic2.get(item, 0) + 1 return dic1 == dic2 leetcode-1.Two Sumdesc: Given an array of integers, return indices of the two numbers such that they add up to a specific target.You may assume that each input would have exactly one solution, and you may not use the same element twice.æ‰¾åˆ°åˆ—è¡¨ä¸­çš„ä¸¤ä¸ªæ•°aï¼Œ b ä½¿ a+b=targetï¼Œ è¿”å› aï¼Œb çš„ä¸‹æ ‡ thought é‡‡ç”¨å“ˆå¸Œè¡¨çš„æ€æƒ³ï¼Œæšä¸¾åˆ—è¡¨ï¼Œåˆ¤æ–­ target-a æ˜¯å¦åœ¨é™¤å»æ­¤æšä¸¾å…ƒç´ çš„å“ˆå¸Œè¡¨ä¸­ solution class Solution: def twoSum(self, nums: List[int], target: int) -&gt; List[int]: hash_map = dict() for i, item in enumerate(nums): if target - item in hash_map: return [hash_map[target - item], i] hash_map[item] = i leetcode-15.3Sumdesc: Given an array nums of n integers, are there elements a, b, c in nums such that a + b + c = 0? Find all unique triplets in the array which gives the sum of zero.The solution set must not contain duplicate triplets.è¿”å›ä¸‰æ•°ä¹‹å’Œä¸º0çš„æ‰€æœ‰å­åˆ—è¡¨ thought: ä¸€ç§æ–¹æ³•æ˜¯è›®åŠ›æ³•ï¼ŒåµŒå¥—ä¸‰å±‚å¾ªç¯ã€‚ç¬¬äºŒç§æ–¹æ³•æ˜¯ï¼Œå“ˆå¸Œå‡½æ•°çš„æ€æƒ³ï¼ŒåµŒå¥—ä¸¤æ¬¡å¾ªç¯ï¼Œå¤–å±‚å¾ªç¯æšä¸¾ a ï¼Œå†…å±‚å¾ªç¯åˆ¤æ–­ -b-c æ˜¯å¦åœ¨é™¤æšä¸¾å…ƒç´ ä¹‹å¤–çš„æ•£åˆ—è¡¨ä¸­ã€‚ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯å…ˆæ’åºï¼Œç„¶ååµŒå¥—ä¸¤æ¬¡å¾ªç¯ï¼Œå¤–å±‚å¾ªç¯æšä¸¾ aï¼Œ å†…å±‚å¾ªç¯ä½¿ç”¨é¦–å°¾æŒ‡é’ˆè¿›è¡Œç§»ä½åˆ¤æ–­ã€‚ solution: # è§£æ³•ä¸€ æ•£åˆ—è¡¨ æ—¶é—´å¤æ‚åº¦O(N^2), ç©ºé—´å¤æ‚åº¦O(N)class Solution: def threeSum(self, nums: List[int]) -&gt; List[List[int]]: if len(nums) &lt; 3: return [] nums.sort() res = set() for i, v in enumerate(nums[:-2]): if i&gt;= 1 and v == nums[i-1]: continue d = &#123;&#125; for x in nums[i+1:]: if x not in d: d[-v-x] = 1 else: res.add((v, -v-x, x)) return [list(item) for item in res] # è§£æ³•äºŒ é¦–å°¾æŒ‡é’ˆ æ—¶é—´å¤æ‚åº¦O(N^2), ç©ºé—´å¤æ‚åº¦O(1)class Solution: def threeSum(self, nums: List[int]) -&gt; List[List[int]]: res = [] nums.sort() for i in range(len(nums)-2): if i &gt; 0 and nums[i] == nums[i-1]: continue l, r = i+1, len(nums)-1 while l &lt; r: s = nums[i] + nums[l] + nums[r] if s &lt; 0 :l += 1 elif s &gt; 0 : r -= 1 else: res.append([nums[i], nums[l], nums[r]]) while l &lt; r and nums[l] == nums[l+1]: l += 1 while l&lt; r and nums[r] == nums[r-1]: r -= 1 l += 1 r -= 1 return res leetcode-3.Longest Substring Without Repeating Charactersdesc: Given a string, find the length of the longest substring without repeating characters.æ±‚æœ€å¤§æ— é‡å¤å­ä¸²çš„é•¿åº¦ thought: é‡‡ç”¨æ»‘åŠ¨çª—å£ï¼Œæ»‘åŠ¨çª—å£ä»æœ€å¤§ä¾æ¬¡å˜å°ï¼Œåˆ©ç”¨hashè¡¨ï¼Œåˆ¤æ–­çª—å£å†…çš„å…ƒç´ æ•°é‡æ˜¯å¦ç­‰äºhashä¹‹åçš„å…ƒç´ æ•°é‡ï¼Œç›¸ç­‰å³ä¸ºæœ€å¤§å­ä¸²çš„é•¿åº¦ sulution: class Solution: def lengthOfLongestSubstring(self, s: str) -&gt; int: if len(s) == 0: return 0 s_len = len(s) # çª—å£æœ€å¤§å€¼ max_slide = len(set(s)) # çª—å£ä¾æ¬¡å‡å° while max_slide: if max_slide == 1: return 1 i =0 # ä»å­—ç¬¦ä¸²å¼€å§‹ä½ç½®æ»‘åŠ¨çª—å£ while i + max_slide &lt;= s_len: sub_s = s[i:i+max_slide] sub_s_set = set(sub_s) if len(sub_s) == len(sub_s_set): return len(sub_s) i += 1 max_slide -= 1 å›¾æœç´¢leetcode-22. Generate Parenthesesdesc: Given n pairs of parentheses, write a function to generate all combinations of well-formed parentheses.ç»™å®šnå¯¹æ‹¬å·ï¼Œç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„æ‹¬å·å¯¹ç»„åˆ thought:ç›¸å½“äºåœ¨å¤§å°ä¸º 2n çš„æ ¼å­ä¸­å¡«å…¥ç›¸åº”çš„æ‹¬å·ï¼ŒåŠ å…¥æ‹¬å·çš„æ—¶å€™è¿›è¡Œå‰ªææ“ä½œã€‚ å¦‚æœå³æ‹¬å·åœ¨å‰ï¼Œåˆ™ä¸ç¬¦åˆ å·¦æ‹¬å· == å³æ‹¬å· == n solution:class Solution: def generateParenthesis(self, n: int) -&gt; List[str]: self.list = [] self._gen(0, 0, n, '') return self.list def _gen(self, left, right, n, result): ''' left: å·¦æ‹¬å·å·²ç”¨æ¬¡æ•° right: å³æ‹¬å·å·²ç”¨æ¬¡æ•° n: è¾“å…¥çš„æ‹¬å·å¯¹ result: æ­¤æ—¶å¡«å……åçš„ç»“æœ ''' if left == n and right == n: self.list.append(result) return if left &lt; n: self._gen(left+1, right, n, result+'(') if right &lt; left and right &lt; n: self._gen(left, right+1, n, result+')') leetcode-51. N-Queensdesc:The n-queens puzzle is the problem of placing n queens on an nÃ—n chessboard such that no two queens attack each other.Given an integer n, return all distinct solutions to the n-queens puzzle. Each solution contains a distinct board configuration of the n-queensâ€™ placement, where â€˜Qâ€™ and â€˜.â€™ both indicate a queen and an empty space respectively.Nçš‡åé—®é¢˜ï¼Œçš‡åå¯ä»¥æ”»å‡»æ‰€åœ¨çš„è¡Œï¼Œæ‰€åœ¨çš„åˆ—ï¼Œä»¥åŠæ’‡å’Œæºã€‚å°†çš‡åæ”¾åœ¨å®‰å…¨çš„åœ°æ–¹ thought: é‡‡ç”¨DFSï¼Œä¸€å±‚ä¸€å±‚çš„éå†ï¼Œåœ¨æ¯ä¸€å±‚ä¸­éå†æ¯ä¸€åˆ—ï¼Œå¦‚æœä¸åœ¨çš‡åçš„æ”»å‡»èŒƒå›´å†…ï¼Œåˆ™å°†çš‡ååˆšä¸‹ï¼Œå¼€å§‹éå†ä¸‹ä¸€å±‚ solution:class Solution: def solveNQueens(self, n: int) -&gt; List[List[str]]: if n &lt; 1: return [] self.result = [] self.cols = set() self.pie = set() self.na = set() self.DFS(n, 0, []) return self._generate_result(n) def DFS(self, n, row, cur_state): if row &gt;= n: self.result.append(cur_state) return for col in range(n): if col in self.cols or row+col in self.pie or row-col in self.na: continue self.cols.add(col) self.pie.add(row+col) self.na.add(row-col) self.DFS(n, row+1, cur_state+[col]) self.cols.remove(col) self.pie.remove(row+col) self.na.remove(row-col) def _generate_result(self, n): board = [] for res in self.result: for i in res: board.append('.' * i + 'Q' + '.' * (n-i-1)) return [board[i:i+n] for i in range(0, len(board), n)] æ ‘leetcode-98.Validate Binary Search Treedesc: Given a binary tree, determine if it is a valid binary search tree (BST).Assume a BST is defined as follows:The left subtree of a node contains only nodes with keys less than the nodeâ€™s key.The right subtree of a node contains only nodes with keys greater than the nodeâ€™s key.Both the left and right subtrees must also be binary search trees.éªŒè¯ç»™å®šçš„äºŒå‰æ ‘æ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘ thought:1. å°†ç»™å®šçš„äºŒå‰æ ‘ä¸­åºéå†ï¼Œå¦‚æœéå†ä¹‹åæ˜¯å‡åºçš„ï¼Œåˆ™æ˜¯äºŒå‰æœç´¢æ ‘ã€‚æ—¶é—´å¤æ‚åº¦O(n)2.é€’å½’ï¼ŒæŸ¥æ‰¾å·¦å­æ ‘æœ€å¤§å€¼maxï¼Œ æŸ¥æ‰¾å³å­æ ‘æœ€å°å€¼minï¼Œæ¯æ¬¡é€’å½’éƒ½ä¿è¯ max &lt; root &lt; minï¼Œåˆ™æ˜¯äºŒå‰æœç´¢æ ‘ã€‚æ—¶é—´å¤æ‚åº¦O(n) solution: # ç¬¬ä¸€ç§æ–¹æ³•# Definition for a binary tree node.# class TreeNode:# def __init__(self, x):# self.val = x# self.left = None# self.right = Noneclass Solution: def isValidBST(self, root: TreeNode) -&gt; bool: inorder = self.inorder(root) return inorder == list(sorted(set(inorder))) def inorder(self, root): if root is None: return [] return self.inorder(root.left) + [root.val] + self.inorder(root.right) # ç¬¬äºŒç§æ–¹æ³• äºŒå‰æ ‘éå†leetcode-144. Binary Tree Preorder Traversaldesc: Given a binary tree, return the preorder traversal of its nodesâ€™ values.äºŒå‰æ ‘å‰åºéå† thought: éå†é¡ºåº root &gt; left &gt; right solution:# Definition for a binary tree node.# class TreeNode:# def __init__(self, x):# self.val = x# self.left = None# self.right = Noneclass Solution: def __init__(self): self.l = [] # æ—¶é—´å¤æ‚åº¦ O(N)ï¼Œ ç©ºé—´å¤æ‚åº¦O(1) def preorderTraversal(self, root: TreeNode) -&gt; List[int]: '''åˆ©ç”¨é€’å½’å®ç°å‰åºéå†''' if not root: return [] self.l.append(root.val) self.preorderTraversal(root.left) self.preorderTraversal(root.right) return self.l # æ—¶é—´å¤æ‚åº¦ O(N), ç©ºé—´å¤æ‚åº¦O(N) def preorderTraversal(self, root: TreeNode) -&gt; List[int]: '''åˆ©ç”¨å¾ªç¯å®ç°å‰åºéå†''' if not root: return [] mystack = [] # å­˜å‚¨æ ¹èŠ‚ç‚¹ out = [] cur = root while cur or mystack: # ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¸€ç›´æ‰¾å®ƒçš„å·¦å­æ ‘ while cur: mystack.append(cur) out.append(cur.val) cur = cur.left # å¾ªç¯ç»“æŸï¼Œè¡¨ç¤ºå‰ä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰å·¦å­æ ‘äº†ï¼Œå¼€å§‹æŸ¥çœ‹å³å­æ ‘ cur = mystack.pop().right return out leetcode-94. Binary Tree Inorder Traversaldesc: Given a binary tree, return the inorder traversal of its nodesâ€™ values.äºŒå‰æ ‘ä¸­åºéå† thought: éå†é¡ºåº left &gt; root &gt; right solution:# Definition for a binary tree node.# class TreeNode:# def __init__(self, x):# self.val = x# self.left = None# self.right = Noneclass Solution: def __init__(self): self.l = [] # æ—¶é—´å¤æ‚åº¦ O(N)ï¼Œ ç©ºé—´å¤æ‚åº¦O(1) def inorderTraversal(self, root: TreeNode) -&gt; List[int]: '''åˆ©ç”¨é€’å½’å®ç°å‰åºéå†''' if not root: return [] self.inorderTraversal(root.left) self.l.append(root.val) self.inorderTraversal(root.right) return self.l # æ—¶é—´å¤æ‚åº¦ O(N), ç©ºé—´å¤æ‚åº¦O(N) def inorderTraversal(self, root: TreeNode) -&gt; List[int]: '''åˆ©ç”¨å¾ªç¯å®ç°ä¸­åºéå†''' if not root: return [] mystack = [] out = [] cur = root while cur or mystack: while cur: mystack.append(cur) cur = cur.left tmp = mystack.pop() out.append(tmp.val) cur = tmp.right return out leetcode-145. Binary Tree Postorder Traversaldesc: Given a binary tree, return the postorder traversal of its nodesâ€™ values.äºŒå‰æ ‘ååºéå† thought: éå†é¡ºåº left &gt; right &gt; root, å·¦å³æ ¹ æ˜¯ æ ¹å³å·¦çš„åè½¬ï¼Œå¯ä»¥å‚è€ƒå‰åºéå†çš„åšæ³• solution:# Definition for a binary tree node.# class TreeNode:# def __init__(self, x):# self.val = x# self.left = None# self.right = Noneclass Solution: def __init__(self): self.l = [] # æ—¶é—´å¤æ‚åº¦ O(N)ï¼Œ ç©ºé—´å¤æ‚åº¦O(1) def postorderTraversal(self, root: TreeNode) -&gt; List[int]: '''åˆ©ç”¨é€’å½’å®ç°ååºéå†''' if not root: return [] self.postorderTraversal(root.left) self.postorderTraversal(root.right) self.l.append(root.val) return self.l # æ—¶é—´å¤æ‚åº¦ O(N), ç©ºé—´å¤æ‚åº¦O(N) def postorderTraversal(self, root: TreeNode) -&gt; List[int]: '''åˆ©ç”¨å¾ªç¯å®ç°ååºéå†''' if not root: return [] cur = root mystack = [] out = [] # å‚è€ƒå‰åºéå†çš„åšæ³•ï¼Œå…ˆéå†å‡ºå³å·¦æ ¹ï¼Œæœ€ååè½¬ç»“æœ-&gt;æ ¹å·¦å³ while cur or mystack: while cur: out.append(cur.val) mystack.append(cur) cur = cur.right cur = mystack.pop().left return out[::-1] leetcode-102. Binary Tree Level Order Traversaldesc: Given a binary tree, return the level order traversal of its nodesâ€™ values. (ie, from left to right, level by level).äºŒå‰æ ‘å±‚æ¬¡éå† thought: éå†é¡ºåºä¸€å±‚ä¸€å±‚çš„éå†ï¼Œå¯ä»¥é‡‡ç”¨BFS, ä¹Ÿå¯ä»¥é‡‡ç”¨DFS solution:# Definition for a binary tree node.# class TreeNode:# def __init__(self, x):# self.val = x# self.left = None# self.right = None# å¼•å…¥åŒç«¯é˜Ÿåˆ—from collections import deque# BFSclass Solution: def levelOrder(self, root: TreeNode) -&gt; List[List[int]]: if not root: return [] queue = deque() result = [] queue.append(root) # å¦‚æœä¸æ˜¯æ ‘ï¼Œæ˜¯å›¾çš„è¯ï¼Œå°±éœ€è¦åˆ¤æ–­æ˜¯å¦è®¿é—®è¿‡ # visited = set(root) while queue: level_size = len(queue) current_level = [] # å¾ªç¯éå†æ¯ä¸€å±‚çš„å…ƒç´  for _ in range(level_size): # åŒç«¯é˜Ÿåˆ— å³è¿› å·¦å‡º node = queue.popleft() current_level.append(node.val) if node.left: queue.append(node.left) if node.right: queue.append(node.right) result.append(current_level) return result # DFSclass Solution: def levelOrder(self, root: TreeNode) -&gt; List[List[int]]: if not root: return [] self.result = [] self._dfs(root, 0) return self.result def _dfs(self, node, level): if not node: return if len(self.result) &lt; level + 1: self.result.append([]) self.result[level].append(node.val) self._dfs(node.left, level+1) self._dfs(node.right, level+1) leetcode-236. Lowest Common Ancestor of a Binary Treedesc: Given a binary tree, find the lowest common ancestor (LCA) of two given nodes in the tree. According to the definition of LCA on Wikipedia: â€œThe lowest common ancestor is defined between two nodes p and q as the lowest node in T that has both p and q as descendants (where we allow a node to be a descendant of itself).â€ Given the following binary tree: root = [3,5,1,6,2,0,8,null,null,7,4]æ±‚äºŒå‰æ ‘æœ€å°å…¬å…±çˆ¶èŠ‚ç‚¹ thought:é‡‡ç”¨é€’å½’ solution:# Definition for a binary tree node.class TreeNode: def __init__(self, x): self.val = x self.left = None self.right = Noneclass Solution: def lowestCommonAncestor(self, root: 'TreeNode', p: 'TreeNode', q: 'TreeNode') -&gt; 'TreeNode': if any((not root, root==p, root==q)): return root left = self.lowestCommonAncestor(root.left, p, q) right = self.lowestCommonAncestor(root.right, p, q) if not left or not right: return left if left else right return root é€’å½’åŠ¨æ€è§„åˆ’ç”Ÿæˆæ–æ³¢é‚£å¥‘æ•°åˆ—desc: thought:è§£æ³•ä¸€ï¼šå›æº¯æ³•(é€’å½’)ï¼ŒåŒ…å«å¤§é‡é‡å¤è®¡ç®—ï¼Œæ—¶é—´å¤æ‚åº¦O(N*N)è§£æ³•äºŒ: åŠ¨æ€è§„åˆ’ï¼Œæ—¶é—´å¤æ‚åº¦O(N),ç©ºé—´å¤æ‚åº¦O(N)è§£æ³•ä¸‰ï¼šåŠ¨æ€è§„åˆ’ä¼˜åŒ–ï¼Œåªè®°å½•å‰ä¸¤ä¸ªå€¼ï¼Œæ—¶é—´å¤æ‚åº¦O(N) solution:#è§£æ³•ä¸€def fib(n): if n &lt;= 1: return n return fib(n-1) + fib(n-2) #è§£æ³•äºŒdef fib(n): if n &lt;= 1 :return n nums = [0] * (n+1) nums[0] = 0 nums[1] = 1 for i in range(2, n+1): nums[i] = nums[i-1] + nums[i-2] return nums[-1] #è§£æ³•ä¸‰def fib(n): if n &lt;= 1: return n a, b = 0, 1 for i in range(2, n+1): sum = a + b a = b b = sum return b leetcode-62. Unique Pathsdesc: A robot is located at the top-left corner of a m x n grid (marked â€˜Startâ€™ in the diagram below).The robot can only move either down or right at any point in time. The robot is trying to reach the bottom-right corner of the grid (marked â€˜Finishâ€™ in the diagram below). How many possible unique paths are there?æœºå™¨äººåªèƒ½å‘å³æˆ–è€…å‘ä¸‹èµ°ï¼Œé—®åˆ°è¾¾ç»ˆç‚¹æœ‰å¤šå°‘ç§èµ°æ³•ã€‚ thought: é‡‡ç”¨DPæ–¹æ³•ï¼Œä»ç»ˆç‚¹å¾€å›é€’å½’ï¼Œæ—¶é—´å¤æ‚åº¦O(N*M) solution:class Solution: def uniquePaths(self, m: int, n: int) -&gt; int: res = [[0 for _ in range(n)] for _ in range(m)] for i in range(m): for j in range(n): if i == 0 or j == 0: res[i][j] = 1 else: res[i][j] = res[i-1][j] + res[i][j-1] return res[m-1][n-1] æ•°å­¦é¢˜å…¶ä»–leetcode-703.Kth Largest Element in a Streamdesc: Design a class to find the kth largest element in a stream. Note that it is the kth largest element in the sorted order, not the kth distinct element.Your KthLargest class will have a constructor which accepts an integer k and an integer array nums, which contains initial elements from the stream. For each call to the method KthLargest.add, return the element representing the kth largest element in the stream.è¿”å›æ•°æ®æµä¸­ç¬¬Kå¤§çš„å…ƒç´  thought:é‡‡ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼Œç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸ºKçš„æœ€å°å † solution class KthLargest &#123;public: KthLargest(int k, vector&lt;int&gt;&amp; nums):k_(k) &#123; for(int num : nums) &#123; add(num); &#125; &#125; int add(int val) &#123; s_.push(val); if(s_.size() &gt; k_) &#123; s_.pop(); &#125; return s_.top(); &#125;private: const int k_; priority_queue&lt;int, vector&lt;int&gt;, greater&lt;int&gt;&gt; s_;&#125;;/** * Your KthLargest object will be instantiated and called as such: * KthLargest* obj = new KthLargest(k, nums); * int param_1 = obj-&gt;add(val); */ æ‘©å°”è®¡æ•°æ³•desc: æ‰¾å‡ºä¸€ä¸ªåˆ—è¡¨ä¸­å‡ºç°æ¬¡æ•°å¤§äºåˆ—è¡¨é•¿åº¦ä¸€åŠçš„æ•°ï¼Œè¿™ä¸ªæ•°ä¸€å®šå­˜åœ¨ã€‚thought: ä¸é‡‡ç”¨é¢å¤–ç©ºé—´çš„è¯ï¼Œæœ‰ä¸€ç§æŠ€å·§æ˜¯é‡‡ç”¨æ‘©å°”è®¡æ•°æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ•°åªæœ‰ä¸€ä¸ªï¼Œéå†æ•°ç»„ï¼Œæ¯æ¬¡éå†ä¸¤ä¸ªæ•°ï¼Œä¸¤ä¸ªæ•°ä¸ç›¸åŒï¼Œåˆ™åˆ é™¤ã€‚ é«˜é¢‘è€ƒç‚¹å¦‚ä½•åœ¨æµ·é‡æ•°æ®ä¸­å¿«é€ŸæŸ¥æ‰¾æœ€ç›¸ä¼¼çš„æ–‡æœ¬é€†åºåŒå‘é“¾è¡¨å»æ‰å­—ç¬¦ä¸²ä¸­è¿æ³•çš„å•æ‹¬å·leetcode-7. Reverse Integerdesc: Given a 32-bit signed integer, reverse digits of an integer.åè½¬ä¸€ä¸ªæ•´æ•°thought: ä¾æ¬¡å¯¹10å–ä½™å…¥æ ˆï¼Œç„¶åä¾æ¬¡ä¹˜10å‡ºæ ˆsolution:class Solution: def reverse(self, x: int) -&gt; int: y = -1 * x if x &lt; 0 else x tmp = [] while y: tmp.append(y%10) y //= 10 res = 0 i = 1 while tmp: res += tmp.pop() * i i *= 10 res = -1 * res if x &lt; 0 else res if res &lt; pow(-2, 31) or res &gt; pow(2, 31): return 0 else: return res åè½¬å­—ç¬¦ä¸²desc: åè½¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸èƒ½ä½¿ç”¨ç³»ç»Ÿå†…ç½®æ–¹æ³•ã€‚thought: é‡‡ç”¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘å¤´å°¾ï¼Œäº¤æ¢å¤´ä¸ºæŒ‡é’ˆå…ƒç´ ï¼Œå¹¶å°†å¤´å°¾æŒ‡é’ˆå‘ä¸­é—´é æ‹¢ã€‚äº¤æ¢çš„æ—¶å€™å¯ä»¥é‡‡ç”¨ä¸¤ç§æ–¹æ³•ï¼šæ–¹æ³•ä¸€ï¼šé‡‡ç”¨ä¸­é—´å˜é‡ã€‚æ–¹æ³•äºŒï¼šé‡‡ç”¨å¼‚æˆ–çš„æ–¹å¼ã€‚solution:class Solution: # æ–¹æ³•ä¸€ def reverseString(self, s: List[str]) -&gt; None: \"\"\" Do not return anything, modify s in-place instead. \"\"\" i = 0 j = len(s) - 1 while i &lt; j: tmp = s[i] s[i] = s[j] s[j] = tmp i += 1 j -= 1 return s # æ–¹æ³•äºŒ def reverseString(self, s: List[str]) -&gt; None: \"\"\" Do not return anything, modify s in-place instead. \"\"\" i = 0 j = len(s) - 1 while i &lt; j: s[i] = chr(ord(s[i]) ^ ord(s[j])) s[j] = chr(ord(s[i]) ^ ord(s[j])) s[i] = chr(ord(s[i]) ^ ord(s[j])) i += 1 j -= 1 return s å®ç°å•è¯åè½¬desc: å®ç°ä¸€å¥è¯ä¸­å•è¯åè½¬ã€‚how are you åè½¬åä¸º you are howthought: é‡‡ç”¨ä¸¤æ¬¡å­—ç¬¦ä¸²åè½¬ï¼Œç¬¬ä¸€æ¬¡åè½¬å®Œä¸º uoy era woh ç„¶åå¯¹æ¯ä¸€ä¸ªå•è¯å†è¿›è¡Œä¸€æ¬¡å­—ç¬¦ä¸²åè½¬å³å¯ã€‚soulution:class Solution: def reverseWords(self, s: str) -&gt; str: def reverseStr(s_list, front, end): while front &lt; end: tmp = s_list[front] s_list[front] = s_list[end] s_list[end] = tmp front += 1 end -= 1 # åˆ é™¤é¦–å°¾ç©ºæ ¼ï¼Œæ›¿æ¢å¤šä¸ªç©ºæ ¼ä¸ºä¸€ä¸ª s = ' '.join(s.strip().split()) lens = len(s) s_list = list(s) # åè½¬å…¨éƒ¨å­—ç¬¦ä¸² reverseStr(s_list, 0, lens-1) # åè½¬æ¯ä¸ªå•è¯ begin = 0 i = 1 while i &lt; lens: if s_list[i] == ' ': reverseStr(s_list, begin, i-1) begin = i + 1 i += 1 reverseStr(s_list, begin, lens-1) return ''.join(s_list) åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åŒ…å«å…³ç³»desc: åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æœ‰åŒ…å«å…³ç³»ã€‚s1=â€™abcdfgâ€™, s2=â€™bfgâ€™ï¼Œåˆ™s1åŒ…å«s2thought: éå†ä¸€æ¬¡çŸ­å­—ç¬¦ä¸²ï¼Œè®°å½•ä¸åŒå­—ç¬¦å‡ºç°çš„æ¬¡æ•°,éå†é•¿å­—ç¬¦ä¸²ï¼Œå¯¹çŸ­å­—ç¬¦ä¸²ä¸­å‡ºç°çš„å­—ç¬¦æ€»æ•°å‡ä¸€ï¼Œç»“æœä¸ºé›¶åˆ™åŒ…å«ã€‚solution:def strContain(s1, s2): len1 = len(s1) len2 = len(s2) short_str = s1 if len1 &lt; len2 else s2 long_str = s1 if len1 &gt; len2 else s2 flag = [0 for _ in range(52)] count = 0 i = 0 while i &lt; len(short_str): if ord(list(short_str)[i]) &gt;= ord('A') and ord(list(short_str)[i]) &lt;= ord('Z'): k = ord(list(short_str)[i]) - ord('A') else: k = ord(list(short_str)[i]) - ord('a') + 26 if flag[k] == 0: flag[k] = 1 count += 1 i += 1 j = 0 while j &lt; len(long_str): if ord(list(long_str)[j]) &gt; ord('A') and ord(list(long_str)[j]) &lt;= ord('Z'): k = ord(list(long_str)[j]) - ord('A') else: k = ord(list(long_str)[j]) - ord('a') + 26 if flag[k] == 1: flag[k] = 0 count -= 1 if count == 0: return True j += 1 return False æ¶ˆé™¤å­—ç¬¦ä¸²ä¸­çš„å†…åµŒæ‹¬å·desc:ç»™å®šä¸€ä¸ªå¦‚ä¸‹æ ¼å¼çš„å­—ç¬¦ä¸²:(1,(2,3,(4,(5,6),7))ï¼Œ æ‹¬å·å†…çš„å…ƒç´ å¯ä»¥æ˜¯æ•°å­—ï¼Œä¹Ÿå¯èƒ½æ˜¯å¦ä¸€ä¸ªæ‹¬å·ï¼Œå®ç°ä¸€ä¸ªç®—æ³•æ¶ˆé™¤åµŒå¥—çš„æ‹¬å· ï¼Œä¾‹å¦‚æŠŠä¸Šé¢çš„è¡¨è¾¾å¼å˜æˆ(1,2,3,4,5,6,7),å¦‚æœè¡¨è¾¾å¼æœ‰è¯¯ï¼Œé‚£ä¹ˆæŠ¥é”™ã€‚ thought: ç”¨ä¸€ä¸ªå˜é‡è®°å½•æ‹¬å·ï¼Œé‡åˆ°â€™(â€˜ åŠ ä¸€ï¼Œé‡åˆ°â€™)â€™å‡ä¸€ï¼Œå¦‚æœå˜é‡æœ€åä¸ºé›¶ï¼Œåˆ™æ‹¬å·åˆæ³•ã€‚ solution:def removeNestedPare(s): if not s: return None if s[0] != '(' or s[-1] != ')': return None parantheses_num = 0 res = '(' for char in s: if char == '(': parantheses_num += 1 elif char == ')': parantheses_num -= 1 else: res = res + char if parantheses_num == 0: return res + ')' else: return None å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°desc:ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°†å…¶è½¬åŒ–ä¸ºæ•´æ•°thought: éœ€è¦è€ƒè™‘æ­£è´Ÿï¼Œæ•´æ•°0å¯¹åº”å½“asciiç ä¸º48ï¼Œä¾æ¬¡åˆ¤æ–­æ¯ä¸€ä½çš„å€¼ï¼Œå¹¶è®¡ç®—ã€‚solution:def str2int(s): if not s: return -1 res, flag, mult = 0, 1, 1 if s[0] == '+' or s[0] == '-': if s[0] == '-': flag = -1 s = s[1:] for char in range(len(s)-1, -1, -1): if s[char] &gt;= '0' and s[char] &lt;= '9': res += (ord(s[char]) - 48) * mult mult *= 10 else: return -1 return flag * res","categories":[{"name":"æ±‚èŒé¢è¯•","slug":"æ±‚èŒé¢è¯•","permalink":"http://lucas0625.github.io/blog/categories/æ±‚èŒé¢è¯•/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"http://lucas0625.github.io/blog/tags/é¢è¯•/"}]},{"title":"ç®—æ³•é¢è¯•ç†è®ºè¯•é¢˜é›†é”¦","slug":"interviewTheory","date":"2019-05-05T08:31:43.372Z","updated":"2019-08-16T02:47:19.446Z","comments":true,"path":"2019/05/05/interviewTheory/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/05/interviewTheory/","excerpt":"é¢è¯•å‡†å¤‡(ç†è®ºç¯‡)","text":"é¢è¯•å‡†å¤‡(ç†è®ºç¯‡) Pythonè‡ªç„¶è¯­è¨€å¤„ç†LR ä¸ºä»€ä¹ˆä½¿ç”¨ sigmoidç®€è¿° Dropout çš„åŸç†Dropout æ˜¯æŒ‡åœ¨æ·±åº¦ç½‘ç»œçš„è®­ç»ƒä¸­ï¼Œä»¥ä¸€å®šçš„æ¦‚ç‡éšæœºåœ°â€˜ä¸´æ—¶ä¸¢å¼ƒâ€™ä¸€éƒ¨åˆ†ç¥ç»å…ƒèŠ‚ç‚¹ã€‚Dropout ä½œç”¨äºæ¯ä»½å°æ‰¹é‡è®­ç»ƒæ•°æ®ï¼Œç”±äºéšæœºä¸¢å»éƒ¨åˆ†ç¥ç»å…ƒçš„æœºåˆ¶ï¼Œç›¸å½“äºæ¯æ¬¡è¿­ä»£éƒ½åœ¨è®­ç»ƒä¸åŒç»“æ„çš„ç¥ç»ç½‘ç»œã€‚Dropout å¯è¢«è®¤ä¸ºæ˜¯ä¸€ç§å¤§è§„æ¨¡æ·±åº¦ç¥ç»ç½‘ç»œçš„é›†æˆç®—æ³•ï¼Œåœ¨åŒ…å« N ä¸ªç¥ç»å…ƒèŠ‚ç‚¹çš„ç½‘ç»œä¸­ï¼ŒDropout å¯ä»¥çœ‹ä½œæ˜¯ $2^n$ ä¸ªæ¨¡å‹çš„é›†æˆã€‚ä¸€å®šç¨‹åº¦ä¸ŠæŠ‘åˆ¶è¿‡æ‹Ÿåˆã€‚æ–¹æ³•æ˜¯å‰å‘ä¼ æ’­çš„æ—¶å€™ä»¥æ¦‚ç‡ P ç”Ÿæˆ 0 æˆ– 1 ä½œç”¨äºç¥ç»å…ƒä¸Šã€‚ LSTMLSTM å‚æ•°é‡LSTM ç»“æ„ï¼š ç¬¬ä¸€å±‚æ˜¯ä¸€ä¸ª embedding å±‚ï¼Œè¾“å‡ºæ˜¯ 100 ç»´çš„ã€‚ ç¬¬äºŒå±‚æ˜¯ä¸€ä¸ª LSTM å±‚ï¼Œè¾“å‡ºæ˜¯ 512 ç»´çš„ã€‚ è®¾ LSTM è¾“å…¥ç»´åº¦ä¸º x_dimï¼Œ è¾“å‡ºç»´åº¦ä¸º y_dimï¼Œé‚£ä¹ˆå‚æ•°ä¸ªæ•° n ä¸ºï¼šn = 4 x ((x_dim + y_dim) * y_dim + y_dim)å¯¹åº”ä¸Šè¿°ç½‘ç»œç»“æ„å°±æ˜¯ï¼šn = 4 x ((100 + 512) * 512 + 512) = 1255424 LSTM èƒ½è§£å†³ RNN ä»€ä¹ˆé—®é¢˜ï¼Œå¹¶é€šè¿‡æ•°å­¦å…¬å¼æ¨å¯¼è§£å†³ RNN æ¢¯åº¦æ¶ˆå¤±ï¼Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚ åŒå‘ LSTM æ¯” LSTM å¥½åœ¨å“ªä»‹ç»ä¸€ä¸‹ LSTM çš„å„ä¸ªé—¨ä¼˜åŒ–æ–¹æ³•Adamçš„ç‰¹ç‚¹word2vecä»‹ç»ä¸€ä¸‹è¯åµŒå…¥ï¼Œone-hotå’Œword2vecçš„åŒºåˆ«ï¼Œword2vecå¦‚ä½•å®ç°çš„word2vec å“ˆå¤«æ›¼æ–¹å¼æ—¶çš„è¯å‘é‡æ€ä¹ˆè·å–ä»‹ç»å“ˆå¤«æ›¼æ ‘ä¸è´Ÿé‡‡æ ·CBOW çš„æŸå¤±å‡½æ•°bertå¦‚ä½•æ”¹è¿› åœ¨é¢„è®­ç»ƒä¸­ï¼Œå…ˆç”¨å·¥å…·è¯†åˆ«å‡ºå¥å­ä¸­çš„çŸ­è¯­ï¼Œç„¶åmaskçŸ­è¯­ï¼Œç„¶åé¢„æµ‹maskæ‰çš„çŸ­è¯­ä¸­çš„wordï¼Œä»¥wordä¸ºé¢„æµ‹å•å…ƒã€‚ â€˜æ”¾ä½ ä¸€é©¬â€™ åœ¨é¢„è®­ç»ƒä¸­ï¼Œå…ˆç”¨å·¥å…·è¯†åˆ«å‡ºå¥å­ä¸­çš„å®ä½“ï¼Œç„¶åmaskå®ä½“ï¼Œç„¶åé¢„æµ‹maskæ‰çš„çŸ­è¯­ä¸­çš„wordï¼Œä»¥wordä¸ºé¢„æµ‹å•å…ƒã€‚ â€˜é»‘é¾™æ±Ÿç¬¬åå±Šå†°é›ªå¤§ä¸–ç•Œâ€™. ä¸ºäº†ä½¿æ¨¡å‹èƒ½è¡¨ç¤ºå¤šè½®å¯¹è¯ï¼Œå¯ä»¥é‡‡ç”¨QQRï¼ŒQRQï¼ŒQRRä½œä¸ºè¾“å…¥ã€‚ ä½¿ç”¨å¤šæºé¢„æ–™ã€‚ Transformer vs LSTM å¹¶æ€§èƒ½åŠ›ã€‚Transformeræ˜¯å¹¶è¡Œè¿è¡Œï¼ŒLSTMæ˜¯ä¸²è¡Œè¿è¡Œï¼Œå¯¹äºå¤§è§„æ¨¡çš„è¯­æ–™ï¼Œå¦‚æœæ— æ³•å¹¶è¡Œè¿è¡Œï¼Œé‚£ä¹ˆæ—¶é—´å°±æ˜¯ä¸€ä¸ªå™©æ¢¦ï¼Œè¿™æ˜¯RNNæ— æ³•è½åœ°çš„ä¸»è¦åŸå› ã€‚ LSTM ä¾æ—§æ— æ³•æ‘†è„±é•¿è·ç¦»ä¾èµ–çš„é—®é¢˜ï¼Œä¸»è¦æ˜¯å› ä¸ºå…¶æ˜¯é€šè¿‡ç»´æŠ¤ä¸€ä¸ªå…¨å±€çš„å‘é‡ä¿¡æ¯æ¥åšä¿¡æ¯èåˆï¼Œå¯èƒ½ä¸€äº›é‡è¦ä¿¡æ¯åœ¨èåˆè¿‡ç¨‹ä¸­ä¸¢å¤±äº†ï¼Œè·ç¦»è¶Šé•¿ï¼Œè¿™ç§é—®é¢˜å¯èƒ½è¶Šä¸¥é‡ã€‚ LSTM ä¸æ˜¯çœŸæ­£çš„åŒå‘ï¼Œä¼šæŸå¤±ä¸€éƒ¨åˆ†ä¿¡æ¯ï¼Œè¿˜æ˜¯å› ä¸ºå•ä¸€å‘é‡ç»´æŠ¤å…¨å±€ä¿¡æ¯ï¼Œè¿™ä½¿å¾—åŒå‘LSTMåœ¨ç‰¹å¾æå–æ–¹é¢ä¸å¦‚Transformerã€‚ ElasticSearchelasticsearch çš„å€’æ’ç´¢å¼•æ˜¯ä»€ä¹ˆå€’æ’ç´¢å¼•ï¼Œæ˜¯é€šè¿‡åˆ†è¯ç­–ç•¥ï¼Œå½¢æˆäº†è¯å’Œæ–‡ç« çš„æ˜ å°„å…³ç³»è¡¨ï¼Œè¿™ç§è¯å…¸ + æ˜ å°„è¡¨å³ä¸ºå€’æ’ç´¢å¼•ã€‚æœ‰äº†å€’æ’ç´¢å¼•ï¼Œå°±èƒ½å®ç°oï¼ˆ1ï¼‰æ—¶é—´å¤æ‚åº¦ çš„æ•ˆç‡æ£€ç´¢æ–‡ç« äº†ï¼Œæå¤§çš„æé«˜äº†æ£€ç´¢æ•ˆç‡ã€‚ å€’æ’ç´¢å¼•åº•å±‚å®ç°æ–¹å¼å€’æ’ç´¢å¼•çš„åº•å±‚å®ç°æ˜¯åŸºäºï¼šFSTï¼ˆFinite State Transducerï¼‰æœ‰é™çŠ¶æ€è½¬ç§»æœºï¼Œæ•°æ®ç»“æ„ã€‚lucene ä» 4 + ç‰ˆæœ¬åå¼€å§‹å¤§é‡ä½¿ç”¨çš„æ•°æ®ç»“æ„æ˜¯ FSTã€‚FST æœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼š 1ï¼‰ç©ºé—´å ç”¨å°ã€‚é€šè¿‡å¯¹è¯å…¸ä¸­å•è¯å‰ç¼€å’Œåç¼€çš„é‡å¤åˆ©ç”¨ï¼Œå‹ç¼©äº†å­˜å‚¨ç©ºé—´ï¼› 2ï¼‰æŸ¥è¯¢é€Ÿåº¦å¿«ã€‚O(len(str)) çš„æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ã€‚ elasticsearch ä¸­_scoreçš„è¯„åˆ†æœºåˆ¶5.0 ç‰ˆæœ¬ä¹‹å‰æ ‡å‡†çš„ç®—æ³•æ˜¯ Term Frequency/Inverse Document Frequency, ç®€å†™ä¸º TF/IDFã€‚5.0 ç‰ˆæœ¬ä¹‹åæ ‡å‡†çš„ç®—æ³•æ˜¯ BM25(Best Match 25), åŸºäº TF/IDF è¿›åŒ–æ¥çš„ã€‚ elasticsearch ç´¢å¼•æ•°æ®å¤šäº†æ€ä¹ˆåŠï¼Œå¦‚ä½•è°ƒä¼˜ï¼Œéƒ¨ç½²ç´¢å¼•æ•°æ®çš„è§„åˆ’ï¼Œåº”åœ¨å‰æœŸåšå¥½è§„åˆ’ï¼Œæ­£æ‰€è°“ â€œè®¾è®¡å…ˆè¡Œï¼Œç¼–ç åœ¨åâ€ï¼Œè¿™æ ·æ‰èƒ½æœ‰æ•ˆçš„é¿å…çªå¦‚å…¶æ¥çš„æ•°æ®æ¿€å¢å¯¼è‡´é›†ç¾¤å¤„ç†èƒ½åŠ›ä¸è¶³å¼•å‘çš„çº¿ä¸Šå®¢æˆ·æ£€ç´¢æˆ–è€…å…¶ä»–ä¸šåŠ¡å—åˆ°å½±å“ã€‚ 1ï¼‰åŠ¨æ€ç´¢å¼•ï¼Œå»ºç«‹blogindexæ—¶é—´æˆ³çš„å½¢å¼ï¼Œæ¯å¤©é€’å¢æ•°æ®ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ä¸è‡³äºæ•°æ®é‡æ¿€å¢å¯¼è‡´å•ä¸ªç´¢å¼•æ•°æ®é‡éå¸¸å¤§ã€‚ 2ï¼‰å†·çƒ­æ•°æ®åˆ†ç¦»ã€‚å®šæœŸå‹ç¼©å†·æ•°æ®ã€‚ 3ï¼‰åŠ¨æ€æ‰©å®¹ã€‚","categories":[{"name":"æ±‚èŒé¢è¯•","slug":"æ±‚èŒé¢è¯•","permalink":"http://lucas0625.github.io/blog/categories/æ±‚èŒé¢è¯•/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"http://lucas0625.github.io/blog/tags/é¢è¯•/"}]},{"title":"ç®—æ³•é¢è¯•å¼€æ”¾è¯•é¢˜é›†é”¦","slug":"interviewQues","date":"2019-04-30T16:00:00.000Z","updated":"2019-06-13T09:59:30.075Z","comments":true,"path":"2019/05/01/interviewQues/","link":"","permalink":"http://lucas0625.github.io/blog/2019/05/01/interviewQues/","excerpt":"é¢è¯•å‡†å¤‡(å¼€æ”¾é—®é¢˜ç¯‡)","text":"é¢è¯•å‡†å¤‡(å¼€æ”¾é—®é¢˜ç¯‡) åé—®æŠ€æœ¯é¢è¯•å®˜ å¯¹æ–°äººçš„åŸ¹å…»æ–¹å¼ä»¥åŠå¯¹æ–°äººçš„æœŸæœ›ï¼ŒåŸ¹å…»æ–¹å¼ï¼Œå­¦ä¹ ç©ºé—´ï¼Œä¸Šå‡æ¸ é“ã€‚ ç»„é‡Œç›®å‰ä¸»è¦çš„ä¸šåŠ¡ä»¥åŠæœ€å¤§çš„æŒ‘æˆ˜ã€‚ å¸Œæœ›äº†è§£ä¸€ä¸‹ç»„å†…çš„æŠ€æœ¯æ ˆï¼Œæ¯”å¦‚è¯´ä½¿ç”¨çš„æŠ€æœ¯ï¼Œæ¡†æ¶ï¼Œè¯­è¨€ã€‚ æ„Ÿè§‰è‡ªå·±å·²ç»è¢«æŒ‚æ‰äº†ï¼Œå¯ä»¥é—®éœ€è¦ç€é‡å­¦ä¹ å“ªä¸€æ–¹é¢çš„çŸ¥è¯†ã€‚ åé—®HRé¢è¯•å®˜ è–ªèµ„æ„æˆã€‚ å…¬å¸æ˜¯å¦æœ‰æ¿€åŠ±æœºåˆ¶ã€‚ é¢„è®¡å¤šä¹…ä¼šæ”¶åˆ°é¢è¯•ç»“æœã€‚ æ—©ä¸Šä¸Šç­æ—¶é—´ã€‚ ä¸ªäººèŒä¸šè§„åˆ’æ—…è¡Œå»è¿‡çš„æœ€å–œæ¬¢åŸå¸‚ä¸¤ä¸ªè¯å½¢å®¹è‡ªå·±ä»‹ç»ä¸¤ä¸ªæœ‹å‹è¯´ä¸€ä¸‹è‡ªå·±çš„ç¼ºç‚¹","categories":[{"name":"æ±‚èŒé¢è¯•","slug":"æ±‚èŒé¢è¯•","permalink":"http://lucas0625.github.io/blog/categories/æ±‚èŒé¢è¯•/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"http://lucas0625.github.io/blog/tags/é¢è¯•/"}]},{"title":"ElasticSearch","slug":"ElasticSearch","date":"2019-04-29T07:18:55.059Z","updated":"2019-04-29T07:18:55.060Z","comments":true,"path":"2019/04/29/ElasticSearch/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/29/ElasticSearch/","excerpt":"ElasticSearch åŸç†ä¸åº”ç”¨","text":"ElasticSearch åŸç†ä¸åº”ç”¨ ç¬¬ä¸€èŠ‚ ElasticSearchæ¦‚è¿°1.1 ElasticSearchç®€ä»‹ElasticSearchæ˜¯ä¸€ä¸ªåŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨ã€‚å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTfulwebæ¥å£ã€‚ElasticSearchæ˜¯ç”¨Javaå¼€å‘çš„ï¼Œå¹¶ä½œä¸ºApacheè®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚è®¾è®¡ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œèƒ½å¤Ÿè¾¾åˆ°å®æ—¶æœç´¢ï¼Œç¨³å®šï¼Œå¯é ï¼Œå¿«é€Ÿï¼Œå®‰è£…ä½¿ç”¨æ–¹ä¾¿ã€‚æ„å»ºåœ¨å…¨æ–‡æ£€ç´¢å¼€æºè½¯ä»¶Luceneä¹‹ä¸Šçš„Elasticsearchï¼Œä¸ä»…èƒ½å¯¹æµ·é‡è§„æ¨¡çš„æ•°æ®å®Œæˆåˆ†å¸ƒå¼ç´¢å¼•ä¸æ£€ç´¢ï¼Œè¿˜èƒ½æä¾›æ•°æ®èšåˆåˆ†æã€‚æ®å›½é™…æƒå¨çš„æ•°æ®åº“äº§å“è¯„æµ‹æœºæ„çš„ç»Ÿè®¡ï¼Œåœ¨2016å¹´1æœˆï¼ŒElasticsearchå·²è¶…è¿‡Solrç­‰ï¼Œæˆä¸ºæ’åç¬¬ä¸€çš„æœç´¢å¼•æ“ç±»åº”ç”¨æ¦‚æ‹¬ï¼šåŸºäºRestfulæ ‡å‡†çš„é«˜æ‰©å±•é«˜å¯ç”¨çš„å®æ—¶æ•°æ®åˆ†æçš„å…¨æ–‡æœç´¢å·¥å…· 1.2 ElasticSearchçš„åŸºæœ¬æ¦‚å¿µ Index:ç±»ä¼¼äºmysqlæ•°æ®åº“ä¸­çš„database Type: ç±»ä¼¼äºmysqlæ•°æ®åº“ä¸­çš„tableè¡¨ï¼Œesä¸­å¯ä»¥åœ¨Indexä¸­å»ºç«‹typeï¼ˆtableï¼‰ï¼Œé€šè¿‡mappingè¿›è¡Œæ˜ å°„ã€‚ Document: ç”±äºeså­˜å‚¨çš„æ•°æ®æ˜¯æ–‡æ¡£å‹çš„ï¼Œä¸€æ¡æ•°æ®å¯¹åº”ä¸€ç¯‡æ–‡æ¡£å³ç›¸å½“äºmysqlæ•°æ®åº“ä¸­çš„ä¸€è¡Œæ•°æ®rowï¼Œä¸€ä¸ªæ–‡æ¡£ä¸­å¯ä»¥æœ‰å¤šä¸ªå­—æ®µä¹Ÿå°±æ˜¯mysqlæ•°æ®åº“ä¸€è¡Œå¯ä»¥æœ‰å¤šåˆ—ã€‚ Field: esä¸­ä¸€ä¸ªæ–‡æ¡£ä¸­å¯¹åº”çš„å¤šä¸ªåˆ—ä¸mysqlæ•°æ®åº“ä¸­æ¯ä¸€åˆ—å¯¹åº” Mapping: å¯ä»¥ç†è§£ä¸ºmysqlæˆ–è€…solrä¸­å¯¹åº”çš„schemaï¼Œåªä¸è¿‡æœ‰äº›æ—¶å€™esä¸­çš„mappingå¢åŠ äº†åŠ¨æ€è¯†åˆ«åŠŸèƒ½ï¼Œæ„Ÿè§‰å¾ˆå¼ºå¤§çš„æ ·å­ï¼Œå…¶å®å®é™…ç”Ÿäº§ç¯å¢ƒä¸Šä¸å»ºè®®ä½¿ç”¨ï¼Œæœ€å¥½è¿˜æ˜¯å¼€å§‹åˆ¶å®šå¥½äº†å¯¹åº”çš„schemaä¸ºä¸»ã€‚ indexed: å°±æ˜¯åä¹‰ä¸Šçš„å»ºç«‹ç´¢å¼•ã€‚mysqlä¸­ä¸€èˆ¬ä¼šå¯¹ç»å¸¸ä½¿ç”¨çš„åˆ—å¢åŠ ç›¸åº”çš„ç´¢å¼•ç”¨äºæé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œè€Œåœ¨esä¸­é»˜è®¤éƒ½æ˜¯ä¼šåŠ ä¸Šç´¢å¼•çš„ï¼Œé™¤éä½ ç‰¹æ®Šåˆ¶å®šä¸å»ºç«‹ç´¢å¼•åªæ˜¯è¿›è¡Œå­˜å‚¨ç”¨äºå±•ç¤ºï¼Œè¿™ä¸ªéœ€è¦çœ‹ä½ å…·ä½“çš„éœ€æ±‚å’Œä¸šåŠ¡è¿›è¡Œè®¾å®šäº†ã€‚ Query DSL: ç±»ä¼¼äºmysqlçš„sqlè¯­å¥ï¼Œåªä¸è¿‡åœ¨esä¸­æ˜¯ä½¿ç”¨çš„jsonæ ¼å¼çš„æŸ¥è¯¢è¯­å¥ï¼Œä¸“ä¸šæœ¯è¯­å°±å«ï¼šQueryDSL GET/PUT/POST/DELETE: åˆ†åˆ«ç±»ä¼¼ä¸mysqlä¸­çš„select/update/deleteâ€¦â€¦ 1.3 Elasticsearchçš„æ¶æ„ Gatewayå±‚ esç”¨æ¥å­˜å‚¨ç´¢å¼•æ–‡ä»¶çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸”å®ƒæ”¯æŒå¾ˆå¤šç±»å‹ï¼Œä¾‹å¦‚ï¼šæœ¬åœ°ç£ç›˜ã€å…±äº«å­˜å‚¨ï¼ˆåšsnapshotçš„æ—¶å€™éœ€è¦ç”¨åˆ°ï¼‰ã€hadoopçš„hdfsåˆ†å¸ƒå¼å­˜å‚¨ã€äºšé©¬é€Šçš„S3ã€‚å®ƒçš„ä¸»è¦èŒè´£æ˜¯ç”¨æ¥å¯¹æ•°æ®è¿›è¡Œé•¿æŒä¹…åŒ–ä»¥åŠæ•´ä¸ªé›†ç¾¤é‡å¯ä¹‹åå¯ä»¥é€šè¿‡gatewayé‡æ–°æ¢å¤æ•°æ®ã€‚ Distributed Lucene Directory Gatewayä¸Šå±‚å°±æ˜¯ä¸€ä¸ªluceneçš„åˆ†å¸ƒå¼æ¡†æ¶ï¼Œluceneæ˜¯åšæ£€ç´¢çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ä¸ªå•æœºçš„æœç´¢å¼•æ“ï¼Œåƒè¿™ç§esåˆ†å¸ƒå¼æœç´¢å¼•æ“ç³»ç»Ÿï¼Œè™½ç„¶åº•å±‚ç”¨luceneï¼Œä½†æ˜¯éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œluceneè¿›è¡Œç›¸åº”çš„ç´¢å¼•ã€æŸ¥è¯¢ä»¥åŠæ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦åšæˆä¸€ä¸ªåˆ†å¸ƒå¼çš„è¿è¡Œæ¡†æ¶æ¥æ»¡è¶³ä¸šåŠ¡çš„éœ€è¦ã€‚ å››å¤§æ¨¡å—ç»„ä»¶ districted lucene directoryä¹‹ä¸Šå°±æ˜¯ä¸€äº›esçš„æ¨¡å— Index Moduleæ˜¯ç´¢å¼•æ¨¡å—ï¼Œå°±æ˜¯å¯¹æ•°æ®å»ºç«‹ç´¢å¼•ä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„å»ºç«‹ä¸€äº›å€’æ’ç´¢å¼•ç­‰ï¼› Search Moduleæ˜¯æœç´¢æ¨¡å—ï¼Œå°±æ˜¯å¯¹æ•°æ®è¿›è¡ŒæŸ¥è¯¢æœç´¢ï¼› Mappingæ¨¡å—æ˜¯æ•°æ®æ˜ å°„ä¸è§£ææ¨¡å—ï¼Œå°±æ˜¯ä½ çš„æ•°æ®çš„æ¯ä¸ªå­—æ®µå¯ä»¥æ ¹æ®ä½ å»ºç«‹çš„è¡¨ç»“æ„é€šè¿‡mappingè¿›è¡Œæ˜ å°„è§£æï¼Œå¦‚æœä½ æ²¡æœ‰å»ºç«‹è¡¨ç»“æ„ï¼Œeså°±ä¼šæ ¹æ®ä½ çš„æ•°æ®ç±»å‹æ¨æµ‹ä½ çš„æ•°æ®ç»“æ„ä¹‹åè‡ªå·±ç”Ÿæˆä¸€ä¸ªmappingï¼Œç„¶åéƒ½æ˜¯æ ¹æ®è¿™ä¸ªmappingè¿›è¡Œè§£æä½ çš„æ•°æ®ï¼› Riveræ¨¡å—åœ¨es2.0ä¹‹ååº”è¯¥æ˜¯è¢«å–æ¶ˆäº†ï¼Œå®ƒçš„æ„æ€è¡¨ç¤ºæ˜¯ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œä¾‹å¦‚å¯ä»¥é€šè¿‡ä¸€äº›è‡ªå®šä¹‰çš„è„šæœ¬å°†ä¼ ç»Ÿçš„æ•°æ®åº“ï¼ˆmysqlï¼‰ç­‰æ•°æ®æºé€šè¿‡æ ¼å¼åŒ–è½¬æ¢åç›´æ¥åŒæ­¥åˆ°esé›†ç¾¤é‡Œï¼Œè¿™ä¸ªriverå¤§éƒ¨åˆ†æ˜¯è‡ªå·±å†™çš„ï¼Œå†™å‡ºæ¥çš„ä¸œè¥¿è´¨é‡å‚å·®ä¸é½ï¼Œå°†è¿™äº›ä¸œè¥¿é›†æˆåˆ°esä¸­ä¼šå¼•å‘å¾ˆå¤šå†…éƒ¨bugï¼Œä¸¥é‡å½±å“äº†esçš„æ­£å¸¸åº”ç”¨ï¼Œæ‰€ä»¥åœ¨es2.0ä¹‹åè€ƒè™‘å°†å…¶å»æ‰ã€‚ Discoveryã€Script es4å¤§æ¨¡å—ç»„ä»¶ä¹‹ä¸Šæœ‰ Discoveryæ¨¡å—ï¼šesæ˜¯ä¸€ä¸ªé›†ç¾¤åŒ…å«å¾ˆå¤šèŠ‚ç‚¹ï¼Œå¾ˆå¤šèŠ‚ç‚¹éœ€è¦äº’ç›¸å‘ç°å¯¹æ–¹ï¼Œç„¶åç»„æˆä¸€ä¸ªé›†ç¾¤åŒ…æ‹¬é€‰ä¸»çš„ï¼Œè¿™äº›eséƒ½æ˜¯ç”¨çš„discoveryæ¨¡å—ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ Zenï¼Œä¹Ÿå¯æ˜¯ä½¿ç”¨EC2ï¼›esæŸ¥è¯¢è¿˜å¯ä»¥æ”¯æ’‘å¤šç§scriptå³è„šæœ¬è¯­è¨€ï¼ŒåŒ…æ‹¬mvelã€jsã€pythonç­‰ç­‰ã€‚ Transportåè®®å±‚ å†ä¸Šä¸€å±‚å°±æ˜¯esçš„é€šè®¯æ¥å£Transportï¼Œæ”¯æŒçš„ä¹Ÿæ¯”è¾ƒå¤šï¼šThriftã€Memcachedä»¥åŠHttpï¼Œé»˜è®¤çš„æ˜¯httpï¼ŒJMXå°±æ˜¯javaçš„ä¸€ä¸ªè¿œç¨‹ç›‘æ§ç®¡ç†æ¡†æ¶ï¼Œå› ä¸ºesæ˜¯é€šè¿‡javaå®ç°çš„ã€‚ RESTfulæ¥å£å±‚ æœ€ä¸Šå±‚å°±æ˜¯esæš´éœ²ç»™æˆ‘ä»¬çš„è®¿é—®æ¥å£ï¼Œå®˜æ–¹æ¨èçš„æ–¹æ¡ˆå°±æ˜¯è¿™ç§Restfulæ¥å£ï¼Œç›´æ¥å‘é€httpè¯·æ±‚ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨nginxåšä»£ç†ã€åˆ†å‘åŒ…æ‹¬å¯èƒ½åç»­ä¼šåšæƒé™çš„ç®¡ç†ï¼Œé€šè¿‡httpå¾ˆå®¹æ˜“åšè¿™æ–¹é¢çš„ç®¡ç†ã€‚å¦‚æœä½¿ç”¨javaå®¢æˆ·ç«¯å®ƒæ˜¯ç›´æ¥è°ƒç”¨apiï¼Œåœ¨åšè´Ÿè½½å‡è¡¡ä»¥åŠæƒé™ç®¡ç†è¿˜æ˜¯ä¸å¤ªå¥½åšã€‚ 1.4 RESTfull APIä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ã€è®¾è®¡é£æ ¼ï¼Œè€Œä¸æ˜¯æ ‡å‡†ï¼Œåªæ˜¯æä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ã€‚å®ƒä¸»è¦ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤äº’ç±»çš„è½¯ä»¶ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶ã€‚åœ¨ç›®å‰ä¸»æµçš„ä¸‰ç§WebæœåŠ¡äº¤äº’æ–¹æ¡ˆä¸­ï¼ŒRESTç›¸æ¯”äºSOAPï¼ˆSimple Object Access protocolï¼Œç®€å•å¯¹è±¡è®¿é—®åè®®ï¼‰ä»¥åŠXML-RPCæ›´åŠ ç®€å•æ˜äº† (Representational State Transfer æ„æ€æ˜¯ï¼šè¡¨è¿°æ€§çŠ¶æ€ä¼ é€’) å®ƒä½¿ç”¨å…¸å‹çš„HTTPæ–¹æ³•ï¼Œè¯¸å¦‚GET,POST.DELETE,PUTæ¥å®ç°èµ„æºçš„è·å–ï¼Œæ·»åŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤ç­‰æ“ä½œã€‚å³é€šè¿‡HTTPåŠ¨è¯æ¥å®ç°èµ„æºçš„çŠ¶æ€æ‰­è½¬å¤åˆ¶ä»£ç  GET ç”¨æ¥è·å–èµ„æº POST ç”¨æ¥æ–°å»ºèµ„æºï¼ˆä¹Ÿå¯ä»¥ç”¨äºæ›´æ–°èµ„æºï¼‰ PUT ç”¨æ¥æ›´æ–°èµ„æº DELETE ç”¨æ¥åˆ é™¤èµ„æº 1.5 CRULå‘½ä»¤ä»¥å‘½ä»¤çš„æ–¹å¼æ‰§è¡ŒHTTPåè®®çš„è¯·æ±‚GET/POST/PUT/DELETE ç¤ºä¾‹ï¼š è®¿é—®ä¸€ä¸ªç½‘é¡µ curl www.baidu.com curl -o tt.html www.baidu.com æ˜¾ç¤ºå“åº”çš„å¤´ä¿¡æ¯ curl -i www.baidu.com æ˜¾ç¤ºä¸€æ¬¡HTTPè¯·æ±‚çš„é€šä¿¡è¿‡ç¨‹ curl -v www.baidu.com æ‰§è¡ŒGET/POST/PUT/DELETEæ“ä½œ curl -X GET/POST/PUT/DELETE url 1.6 CentOS7ä¸‹å®‰è£…ElasticSearch6.2.4(1)é…ç½®JDKç¯å¢ƒ é…ç½®ç¯å¢ƒå˜é‡ export JAVA_HOME=&quot;/opt/jdk1.8.0_144&quot;export PATH=&quot;$JAVA_HOME/bin:$PATH&quot;export CLASSPATH=&quot;.:$JAVA_HOME/lib&quot; (2)å®‰è£…ElasticSearch6.2.4 ä¸‹è½½åœ°å€ï¼šhttps://www.elastic.co/cn/downloads/elasticsearch å¯åŠ¨æŠ¥é”™ï¼š è§£å†³æ–¹å¼ï¼šbin/elasticsearch -Des.insecure.allow.root=true æˆ–è€…ä¿®æ”¹bin/elasticsearchï¼ŒåŠ ä¸ŠES_JAVA_OPTSå±æ€§ï¼šES_JAVA_OPTS=â€-Des.insecure.allow.root=trueâ€ å†æ¬¡å¯åŠ¨ï¼š è¿™æ˜¯å‡ºäºç³»ç»Ÿå®‰å…¨è€ƒè™‘è®¾ç½®çš„æ¡ä»¶ã€‚ç”±äºElasticSearchå¯ä»¥æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„è„šæœ¬å¹¶ä¸”æ‰§è¡Œï¼Œä¸ºäº†ç³»ç»Ÿå®‰å…¨è€ƒ è™‘ï¼Œå»ºè®®åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ç”¨æˆ·ç”¨æ¥è¿è¡ŒElasticSearchã€‚ åˆ›å»ºç”¨æˆ·ç»„å’Œç”¨æˆ·ï¼š groupadd esgroup useradd esuser -g esgroup -p espassword æ›´æ”¹elasticsearchæ–‡ä»¶å¤¹åŠå†…éƒ¨æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·åŠç»„ï¼š cd /opt chown -R esuser:esgroup elasticsearch-6.2.4 åˆ‡æ¢ç”¨æˆ·å¹¶è¿è¡Œï¼š su esuser ./bin/elasticsearch å†æ¬¡å¯åŠ¨æ˜¾ç¤ºå·²æ€æ­»ï¼š éœ€è¦è°ƒæ•´JVMçš„å†…å­˜å¤§å°ï¼š vi bin/elasticsearch ES_JAVA_OPTS=â€-Xms512m -Xmx512mâ€ å†æ¬¡å¯åŠ¨ï¼šå¯åŠ¨æˆåŠŸ å¦‚æœæ˜¾ç¤ºå¦‚ä¸‹ç±»ä¼¼ä¿¡æ¯ï¼š [INFO ][o.e.c.r.a.DiskThresholdMonitor] [ZAds5FP] low disk watermark [85%] exceeded on [ZAds5FPeTY-ZUKjXd7HJKA][ZAds5FP][/opt/elasticsearch-6.2.4/data/nodes/0] free: 1.2gb[14.2%], replicas will not be assigned to this node éœ€è¦æ¸…ç†ç£ç›˜ç©ºé—´ã€‚ åå°è¿è¡Œï¼š./bin/elasticsearch -d æµ‹è¯•è¿æ¥ï¼šcurl 127.0.0.1:9200 ä¼šçœ‹åˆ°ä¸€ä¸‹JSONæ•°æ®ï¼š [root@localhost ~]# curl 127.0.0.1:9200 &#123; &quot;name&quot; : &quot;rBrMTNx&quot;, &quot;cluster_name&quot; : &quot;elasticsearch&quot;, &quot;cluster_uuid&quot; : &quot;-noR5DxFRsyvAFvAzxl07g&quot;, &quot;version&quot; : &#123; &quot;number&quot; : &quot;5.1.1&quot;, &quot;build_hash&quot; : &quot;5395e21&quot;, &quot;build_date&quot; : &quot;2016-12-06T12:36:15.409Z&quot;, &quot;build_snapshot&quot; : false, &quot;lucene_version&quot; : &quot;6.3.0&quot; &#125;, &quot;tagline&quot; : &quot;You Know, for Search&quot;&#125; å®ç°è¿œç¨‹è®¿é—®ï¼šéœ€è¦å¯¹config/elasticsearch.ymlè¿›è¡Œ é…ç½®ï¼š network.host: 192.168.25.131 å†æ¬¡å¯åŠ¨æŠ¥é”™ï¼š å¤„ç†ç¬¬ä¸€ä¸ªé”™è¯¯ï¼š vim /etc/security/limits.conf //æ–‡ä»¶æœ€ååŠ å…¥ esuser soft nofile 65536 esuser hard nofile 65536 esuser soft nproc 4096 esuser hard nproc 4096 å¤„ç†ç¬¬äºŒä¸ªé”™è¯¯ï¼š è¿›å…¥limits.dç›®å½•ä¸‹ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚ vim /etc/security/limits.d/20-nproc.confä¿®æ”¹ä¸º esuser soft nproc 4096 å¤„ç†ç¬¬ä¸‰ä¸ªé”™è¯¯ï¼š vim /etc/sysctl.conf vm.max_map_count=655360 æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæ•ˆï¼šsysctl -p å…³é—­é˜²ç«å¢™ï¼šsystemctl stop firewalld.service å†æ¬¡å¯åŠ¨æˆåŠŸï¼ 1.7 å®‰è£…Headæ’ä»¶Headæ˜¯elasticsearchçš„é›†ç¾¤ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ç”¨äºæ•°æ®çš„æµè§ˆå’ŒæŸ¥è¯¢ (1)elasticsearch-headæ˜¯ä¸€æ¬¾å¼€æºè½¯ä»¶ï¼Œè¢«æ‰˜ç®¡åœ¨githubä¸Šé¢ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨å®ƒï¼Œå¿…é¡»å…ˆå®‰è£…gitï¼Œé€šè¿‡gitè·å–elasticsearch-head (2)è¿è¡Œelasticsearch-headä¼šç”¨åˆ°gruntï¼Œè€Œgruntéœ€è¦npmåŒ…ç®¡ç†å™¨ï¼Œæ‰€ä»¥nodejsæ˜¯å¿…é¡»è¦å®‰è£…çš„ (3)elasticsearch5.0ä¹‹åï¼Œelasticsearch-headä¸åšä¸ºæ’ä»¶æ”¾åœ¨å…¶pluginsç›®å½•ä¸‹äº†ã€‚ä½¿ç”¨gitæ‹·è´elasticsearch-headåˆ°æœ¬åœ° cd /usr/local/ git clone git://github.com/mobz/elasticsearch-head.git (4)å®‰è£…elasticsearch-headä¾èµ–åŒ… [root@localhost local]# npm install -g grunt-cli [root@localhost _site]# cd /usr/local/elasticsearch-head/ [root@localhost elasticsearch-head]# cnpm install (5)ä¿®æ”¹Gruntfile.js [root@localhost _site]# cd /usr/local/elasticsearch-head/ [root@localhost elasticsearch-head]# vi Gruntfile.js åœ¨connectâ€”&gt;serverâ€”&gt;optionsä¸‹é¢æ·»åŠ ï¼šhostname:â€™*â€™ï¼Œå…è®¸æ‰€æœ‰IPå¯ä»¥è®¿é—® (6)ä¿®æ”¹elasticsearch-headé»˜è®¤è¿æ¥åœ°å€[root@localhost elasticsearch-head]# cd /usr/local/elasticsearch-head/_site/ [root@localhost _site]# vi app.js å°†this.base_uri = this.config.base_uri || this.prefs.get(â€œapp-base_uriâ€) || â€œhttp://localhost:9200&quot;;ä¸­çš„localhostä¿®æ”¹æˆä½ esçš„æœåŠ¡å™¨åœ°å€ (7)é…ç½®elasticsearchå…è®¸è·¨åŸŸè®¿é—® æ‰“å¼€elasticsearchçš„é…ç½®æ–‡ä»¶elasticsearch.ymlï¼Œåœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸‹é¢ä¸¤è¡Œä»£ç å³å¯ï¼š http.cors.enabled: true http.cors.allow-origin: â€œ*â€ (8)æ‰“å¼€9100ç«¯å£ [root@localhost elasticsearch-head]# firewall-cmd â€”zone=public â€”add-port=9100/tcp â€”permanent é‡å¯é˜²ç«å¢™ [root@localhost elasticsearch-head]# firewall-cmd â€”reload (9)å¯åŠ¨elasticsearch (10)å¯åŠ¨elasticsearch-head [root@localhost _site]# cd /usr/local/elasticsearch-head/ [root@localhost elasticsearch-head]# node_modules/grunt/bin/grunt server (11)è®¿é—®elasticsearch-head å…³é—­é˜²ç«å¢™ï¼šsystemctl stop firewalld.service æµè§ˆå™¨è¾“å…¥ç½‘å€ï¼šhttp://192.168.25.131:9100/ 1.8 å®‰è£…KibanaKibanaæ˜¯ä¸€ä¸ªé’ˆå¯¹Elasticsearchçš„å¼€æºåˆ†æåŠå¯è§†åŒ–å¹³å°ï¼Œä½¿ç”¨Kibanaå¯ä»¥æŸ¥è¯¢ã€æŸ¥çœ‹å¹¶ä¸å­˜å‚¨åœ¨ESç´¢å¼•çš„æ•°æ®è¿›è¡Œäº¤äº’æ“ä½œï¼Œä½¿ç”¨Kibanaèƒ½æ‰§è¡Œé«˜çº§çš„æ•°æ®åˆ†æï¼Œå¹¶èƒ½ä»¥å›¾è¡¨ã€è¡¨æ ¼å’Œåœ°å›¾çš„å½¢å¼æŸ¥çœ‹æ•°æ® (1)ä¸‹è½½Kibanahttps://www.elastic.co/downloads/kibana (2)æŠŠä¸‹è½½å¥½çš„å‹ç¼©åŒ…æ‹·è´åˆ°/softç›®å½•ä¸‹ (3)è§£å‹ç¼©ï¼Œå¹¶æŠŠè§£å‹åçš„ç›®å½•ç§»åŠ¨åˆ°/user/local/kibana (4)ç¼–è¾‘kibanaé…ç½®æ–‡ä»¶ [root@localhost /]# vi /usr/local/kibana/config/kibana.yml å°†server.host,elasticsearch.urlä¿®æ”¹æˆæ‰€åœ¨æœåŠ¡å™¨çš„ipåœ°å€ (5)å¼€å¯5601ç«¯å£ Kibanaçš„é»˜è®¤ç«¯å£æ˜¯5601 å¼€å¯é˜²ç«å¢™:systemctl start firewalld.service å¼€å¯5601ç«¯å£:firewall-cmd â€”permanent â€”zone=public â€”add-port=5601/tcp é‡å¯é˜²ç«å¢™ï¼šfirewall-cmd â€“reload (6)å¯åŠ¨Kibana [root@localhost /]# /usr/local/kibana/bin/kibana æµè§ˆå™¨è®¿é—®ï¼šhttp://192.168.25.131:5601 1.9 å®‰è£…ä¸­æ–‡åˆ†è¯å™¨(1)ä¸‹è½½ä¸­æ–‡åˆ†è¯å™¨https://github.com/medcl/elasticsearch-analysis-ik ä¸‹è½½elasticsearch-analysis-ik-master.zip (2)è§£å‹elasticsearch-analysis-ik-master.zip unzip elasticsearch-analysis-ik-master.zip (3)è¿›å…¥elasticsearch-analysis-ik-masterï¼Œç¼–è¯‘æºç  mvn clean install -Dmaven.test.skip=true (4)åœ¨esçš„pluginsæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºç›®å½•ik (5)å°†ç¼–è¯‘åç”Ÿæˆçš„elasticsearch-analysis-ik-ç‰ˆæœ¬.zipç§»åŠ¨åˆ°ikä¸‹ï¼Œå¹¶è§£å‹ (6)è§£å‹åçš„å†…å®¹ç§»åŠ¨åˆ°ikç›®å½•ä¸‹ ç¬¬äºŒèŠ‚ ElasticSearchåŸºæœ¬æ“ä½œ2.1 å€’æ’ç´¢å¼•Elasticsearch ä½¿ç”¨ä¸€ç§ç§°ä¸º å€’æ’ç´¢å¼• çš„ç»“æ„ï¼Œå®ƒé€‚ç”¨äºå¿«é€Ÿçš„å…¨æ–‡æœç´¢ã€‚ä¸€ä¸ªå€’æ’ç´¢å¼•ç”±æ–‡æ¡£ä¸­æ‰€æœ‰ä¸é‡å¤è¯çš„åˆ—è¡¨æ„æˆï¼Œå¯¹äºå…¶ä¸­æ¯ä¸ªè¯ï¼Œæœ‰ä¸€ä¸ªåŒ…å«å®ƒçš„æ–‡æ¡£åˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š (1)ï¼šå‡è®¾æ–‡æ¡£é›†åˆåŒ…å«äº”ä¸ªæ–‡æ¡£ï¼Œæ¯ä¸ªæ–‡æ¡£å†…å®¹å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨å›¾ä¸­æœ€å·¦ç«¯ä¸€æ æ˜¯æ¯ä¸ªæ–‡æ¡£å¯¹åº”çš„æ–‡æ¡£ç¼–å·ã€‚æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯å¯¹è¿™ä¸ªæ–‡æ¡£é›†åˆå»ºç«‹å€’æ’ç´¢å¼•ã€‚ (2):ä¸­æ–‡å’Œè‹±æ–‡ç­‰è¯­è¨€ä¸åŒï¼Œå•è¯ä¹‹é—´æ²¡æœ‰æ˜ç¡®åˆ†éš”ç¬¦å·ï¼Œæ‰€ä»¥é¦–å…ˆè¦ç”¨åˆ†è¯ç³»ç»Ÿå°†æ–‡æ¡£è‡ªåŠ¨åˆ‡åˆ†æˆå•è¯åºåˆ—ã€‚è¿™æ ·æ¯ä¸ªæ–‡æ¡£å°±è½¬æ¢ä¸ºç”±å•è¯åºåˆ—æ„æˆçš„æ•°æ®æµï¼Œä¸ºäº†ç³»ç»Ÿåç»­å¤„ç†æ–¹ä¾¿ï¼Œéœ€è¦å¯¹æ¯ä¸ªä¸åŒçš„å•è¯èµ‹äºˆå”¯ä¸€çš„å•è¯ç¼–å·ï¼ŒåŒæ—¶è®°å½•ä¸‹å“ªäº›æ–‡æ¡£åŒ…å«è¿™ä¸ªå•è¯ï¼Œåœ¨å¦‚æ­¤å¤„ç†ç»“æŸåï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æœ€ç®€å•çš„å€’æ’ç´¢å¼•â€œå•è¯IDâ€ä¸€æ è®°å½•äº†æ¯ä¸ªå•è¯çš„å•è¯ç¼–å·ï¼Œç¬¬äºŒæ æ˜¯å¯¹åº”çš„å•è¯ï¼Œç¬¬ä¸‰æ å³æ¯ä¸ªå•è¯å¯¹åº”çš„å€’æ’åˆ—è¡¨ (3):ç´¢å¼•ç³»ç»Ÿè¿˜å¯ä»¥è®°å½•é™¤æ­¤ä¹‹å¤–çš„æ›´å¤šä¿¡æ¯,ä¸‹å›¾è¿˜è®°è½½äº†å•è¯é¢‘ç‡ä¿¡æ¯ï¼ˆTFï¼‰å³è¿™ä¸ªå•è¯åœ¨æŸä¸ªæ–‡æ¡£ä¸­çš„å‡ºç°æ¬¡æ•°ï¼Œä¹‹æ‰€ä»¥è¦è®°å½•è¿™ä¸ªä¿¡æ¯ï¼Œæ˜¯å› ä¸ºè¯é¢‘ä¿¡æ¯åœ¨æœç´¢ç»“æœæ’åºæ—¶ï¼Œè®¡ç®—æŸ¥è¯¢å’Œæ–‡æ¡£ç›¸ä¼¼åº¦æ˜¯å¾ˆé‡è¦çš„ä¸€ä¸ªè®¡ç®—å› å­ï¼Œæ‰€ä»¥å°†å…¶è®°å½•åœ¨å€’æ’åˆ—è¡¨ä¸­ï¼Œä»¥æ–¹ä¾¿åç»­æ’åºæ—¶è¿›è¡Œåˆ†å€¼è®¡ç®—ã€‚ (4):å€’æ’åˆ—è¡¨ä¸­è¿˜å¯ä»¥è®°å½•å•è¯åœ¨æŸä¸ªæ–‡æ¡£å‡ºç°çš„ä½ç½®ä¿¡æ¯ (1,,1),(2,,1),(3,,2) æœ‰äº†è¿™ä¸ªç´¢å¼•ç³»ç»Ÿï¼Œæœç´¢å¼•æ“å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å“åº”ç”¨æˆ·çš„æŸ¥è¯¢ï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥æŸ¥è¯¢è¯â€œFacebookâ€ï¼Œæœç´¢ç³»ç»ŸæŸ¥æ‰¾å€’æ’ç´¢å¼•ï¼Œä»ä¸­å¯ä»¥è¯»å‡ºåŒ…å«è¿™ä¸ªå•è¯çš„æ–‡æ¡£ï¼Œè¿™äº›æ–‡æ¡£å°±æ˜¯æä¾›ç»™ç”¨æˆ·çš„æœç´¢ç»“æœï¼Œè€Œåˆ©ç”¨å•è¯é¢‘ç‡ä¿¡æ¯ã€æ–‡æ¡£é¢‘ç‡ä¿¡æ¯å³å¯ä»¥å¯¹è¿™äº›å€™é€‰æœç´¢ç»“æœè¿›è¡Œæ’åºï¼Œè®¡ç®—æ–‡æ¡£å’ŒæŸ¥è¯¢çš„ç›¸ä¼¼æ€§ï¼ŒæŒ‰ç…§ç›¸ä¼¼æ€§å¾—åˆ†ç”±é«˜åˆ°ä½æ’åºè¾“å‡ºï¼Œæ­¤å³ä¸ºæœç´¢ç³»ç»Ÿçš„éƒ¨åˆ†å†…éƒ¨æµç¨‹ã€‚ 2.1.1 å€’æ’ç´¢å¼•åŸç†1.The quick brown fox jumped over the lazy dog 2.Quick brown foxes leap over lazy dogs in summer å€’æ’ç´¢å¼•ï¼š Term Doc_1 Doc_2 Quick X The X brown X X dog X dogs X fox X foxes X in X jumped X lazy X X leap X over X X quick X summer X the X æœç´¢quick brown ï¼š Term Doc_1 Doc_2 brown X X quick X Total 2 1 è®¡ç®—ç›¸å…³åº¦åˆ†æ•°æ—¶ï¼Œæ–‡æ¡£1çš„åŒ¹é…åº¦é«˜ï¼Œåˆ†æ•°ä¼šæ¯”æ–‡æ¡£2é«˜ é—®é¢˜ï¼š Quick å’Œ quick ä»¥ç‹¬ç«‹çš„è¯æ¡å‡ºç°ï¼Œç„¶è€Œç”¨æˆ·å¯èƒ½è®¤ä¸ºå®ƒä»¬æ˜¯ç›¸åŒçš„è¯ã€‚ fox å’Œ foxes éå¸¸ç›¸ä¼¼, å°±åƒ dog å’Œ dogs ï¼›ä»–ä»¬æœ‰ç›¸åŒçš„è¯æ ¹ã€‚ jumped å’Œ leap, å°½ç®¡æ²¡æœ‰ç›¸åŒçš„è¯æ ¹ï¼Œä½†ä»–ä»¬çš„æ„æ€å¾ˆç›¸è¿‘ã€‚ä»–ä»¬æ˜¯åŒä¹‰è¯ã€‚ æœç´¢å«æœ‰ Quick foxçš„æ–‡æ¡£æ˜¯æœç´¢ä¸åˆ°çš„ ä½¿ç”¨æ ‡å‡†åŒ–è§„åˆ™(normalization)ï¼šå»ºç«‹å€’æ’ç´¢å¼•çš„æ—¶å€™ï¼Œä¼šå¯¹æ‹†åˆ†å‡ºçš„å„ä¸ªå•è¯è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œä»¥æå‡åé¢æœç´¢çš„æ—¶å€™èƒ½å¤Ÿæœç´¢åˆ°ç›¸å…³è”çš„æ–‡æ¡£çš„æ¦‚ç‡ Term Doc_1 Doc_2 brown X X dog X X fox X X in X jump X X lazy X X over X X quick X X summer X the X X 2.1.2 åˆ†è¯å™¨ä»‹ç»åŠå†…ç½®åˆ†è¯å™¨åˆ†è¯å™¨ï¼šä»ä¸€ä¸²æ–‡æœ¬ä¸­åˆ‡åˆ†å‡ºä¸€ä¸ªä¸€ä¸ªçš„è¯æ¡ï¼Œå¹¶å¯¹æ¯ä¸ªè¯æ¡è¿›è¡Œæ ‡å‡†åŒ– åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š character filterï¼šåˆ†è¯ä¹‹å‰çš„é¢„å¤„ç†ï¼Œè¿‡æ»¤æ‰HTMLæ ‡ç­¾ï¼Œç‰¹æ®Šç¬¦å·è½¬æ¢ç­‰ tokenizerï¼šåˆ†è¯ token filterï¼šæ ‡å‡†åŒ– å†…ç½®åˆ†è¯å™¨ï¼š standard åˆ†è¯å™¨ï¼š(é»˜è®¤çš„)ä»–ä¼šå°†è¯æ±‡å•å…ƒè½¬æ¢æˆå°å†™å½¢å¼ï¼Œå¹¶å»é™¤åœç”¨è¯å’Œæ ‡ç‚¹ç¬¦å·ï¼Œæ”¯æŒä¸­æ–‡é‡‡ç”¨çš„æ–¹æ³•ä¸ºå•å­—åˆ‡åˆ† simple åˆ†è¯å™¨ï¼šé¦–å…ˆä¼šé€šè¿‡éå­—æ¯å­—ç¬¦æ¥åˆ†å‰²æ–‡æœ¬ä¿¡æ¯ï¼Œç„¶åå°†è¯æ±‡å•å…ƒç»Ÿä¸€ä¸ºå°å†™å½¢å¼ã€‚è¯¥åˆ†æå™¨ä¼šå»æ‰æ•°å­—ç±»å‹çš„å­—ç¬¦ã€‚ Whitespace åˆ†è¯å™¨ï¼šä»…ä»…æ˜¯å»é™¤ç©ºæ ¼ï¼Œå¯¹å­—ç¬¦æ²¡æœ‰lowcaseåŒ–,ä¸æ”¯æŒä¸­æ–‡ï¼›å¹¶ä¸”ä¸å¯¹ç”Ÿæˆçš„è¯æ±‡å•å…ƒè¿›è¡Œå…¶ä»–çš„æ ‡å‡†åŒ–å¤„ç†ã€‚ language åˆ†è¯å™¨ï¼šç‰¹å®šè¯­è¨€çš„åˆ†è¯å™¨ï¼Œä¸æ”¯æŒä¸­æ–‡ 2.2 ä½¿ç”¨ElasticSearch API å®ç°CRUDæ·»åŠ ç´¢å¼•ï¼š PUT /lib/ &#123; &quot;settings&quot;:&#123; &quot;index&quot;:&#123; &quot;number_of_shards&quot;: 5, &quot;number_of_replicas&quot;: 1 &#125; &#125;&#125; PUT lib æŸ¥çœ‹ç´¢å¼•ä¿¡æ¯: GET /lib/_settings GET _all/_settings æ·»åŠ æ–‡æ¡£: PUT /lib/user/1 &#123; &quot;first_name&quot; : &quot;Jane&quot;, &quot;last_name&quot; : &quot;Smith&quot;, &quot;age&quot; : 32, &quot;about&quot; : &quot;I like to collect rock albums&quot;, &quot;interests&quot;: [ &quot;music&quot; ]&#125; POST /lib/user/ &#123; &quot;first_name&quot; : &quot;Douglas&quot;, &quot;last_name&quot; : &quot;Fir&quot;, &quot;age&quot; : 23, &quot;about&quot;: &quot;I like to build cabinets&quot;, &quot;interests&quot;: [ &quot;forestry&quot; ] &#125; æŸ¥çœ‹æ–‡æ¡£: GET /lib/user/1 GET /lib/user/ GET /lib/user/1?_source=age,interests æ›´æ–°æ–‡æ¡£: PUT /lib/user/1 &#123; &quot;first_name&quot; : &quot;Jane&quot;, &quot;last_name&quot; : &quot;Smith&quot;, &quot;age&quot; : 36, &quot;about&quot; : &quot;I like to collect rock albums&quot;, &quot;interests&quot;: [ &quot;music&quot; ]&#125; POST /lib/user/1/_update &#123; &quot;doc&quot;:&#123; &quot;age&quot;:33 &#125;&#125; åˆ é™¤ä¸€ä¸ªæ–‡æ¡£: DELETE /lib/user/1 åˆ é™¤ä¸€ä¸ªç´¢å¼•: DELETE /lib 2.3 æ‰¹é‡è·å–æ–‡æ¡£ä½¿ç”¨esæä¾›çš„Multi Get APIï¼š ä½¿ç”¨Multi Get APIå¯ä»¥é€šè¿‡ç´¢å¼•åã€ç±»å‹åã€æ–‡æ¡£idä¸€æ¬¡å¾—åˆ°ä¸€ä¸ªæ–‡æ¡£é›†åˆï¼Œæ–‡æ¡£å¯ä»¥æ¥è‡ªåŒä¸€ä¸ªç´¢å¼•åº“ï¼Œä¹Ÿå¯ä»¥æ¥è‡ªä¸åŒç´¢å¼•åº“ ä½¿ç”¨curlå‘½ä»¤ï¼š curl &apos;http://192.168.25.131:9200/_mget&apos; -d &apos;&#123;&quot;docs&quot;ï¼š[ &#123; &quot;_index&quot;: &quot;lib&quot;, &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: 1 &#125;, &#123; &quot;_index&quot;: &quot;lib&quot;, &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: 2 &#125; ]&#125;&apos; åœ¨å®¢æˆ·ç«¯å·¥å…·ä¸­ï¼š GET /_mget &#123; &quot;docs&quot;:[ &#123; &quot;_index&quot;: &quot;lib&quot;, &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: 1 &#125;, &#123; &quot;_index&quot;: &quot;lib&quot;, &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: 2 &#125;, &#123; &quot;_index&quot;: &quot;lib&quot;, &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: 3 &#125; ]&#125; å¯ä»¥æŒ‡å®šå…·ä½“çš„å­—æ®µï¼š GET /_mget &#123; &quot;docs&quot;:[ &#123; &quot;_index&quot;: &quot;lib&quot;, &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: 1, &quot;_source&quot;: &quot;interests&quot; &#125;, &#123; &quot;_index&quot;: &quot;lib&quot;, &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: 2, &quot;_source&quot;: [&quot;age&quot;,&quot;interests&quot;] &#125; ]&#125; è·å–åŒç´¢å¼•åŒç±»å‹ä¸‹çš„ä¸åŒæ–‡æ¡£ï¼š GET /lib/user/_mget &#123; &quot;docs&quot;:[ &#123; &quot;_id&quot;: 1 &#125;, &#123; &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: 2, &#125; ]&#125; GET /lib/user/_mget &#123; &quot;ids&quot;: [&quot;1&quot;,&quot;2&quot;] &#125; 2.4 ä½¿ç”¨Bulk API å®ç°æ‰¹é‡æ“ä½œbulkçš„æ ¼å¼ï¼š {action:{metadata}}\\n {requstbody}\\n action:(è¡Œä¸º) createï¼šæ–‡æ¡£ä¸å­˜åœ¨æ—¶åˆ›å»º update:æ›´æ–°æ–‡æ¡£ index:åˆ›å»ºæ–°æ–‡æ¡£æˆ–æ›¿æ¢å·²æœ‰æ–‡æ¡£ delete:åˆ é™¤ä¸€ä¸ªæ–‡æ¡£ metadataï¼š_index,_type,_id createå’Œindexçš„åŒºåˆ« å¦‚æœæ•°æ®å­˜åœ¨ï¼Œä½¿ç”¨createæ“ä½œå¤±è´¥ï¼Œä¼šæç¤ºæ–‡æ¡£å·²ç»å­˜åœ¨ï¼Œä½¿ç”¨indexåˆ™å¯ä»¥æˆåŠŸæ‰§è¡Œã€‚ ç¤ºä¾‹ï¼š {â€œdeleteâ€:{â€œ_indexâ€:â€libâ€,â€_typeâ€:â€userâ€,â€_idâ€:â€1â€}} æ‰¹é‡æ·»åŠ : POST /lib2/books/_bulk &#123;&quot;index&quot;:&#123;&quot;_id&quot;:1&#125;&#125;&#123;&quot;title&quot;:&quot;Java&quot;,&quot;price&quot;:55&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:2&#125;&#125;&#123;&quot;title&quot;:&quot;Html5&quot;,&quot;price&quot;:45&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:3&#125;&#125;&#123;&quot;title&quot;:&quot;Php&quot;,&quot;price&quot;:35&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:4&#125;&#125;&#123;&quot;title&quot;:&quot;Python&quot;,&quot;price&quot;:50&#125; æ‰¹é‡è·å–: GET /lib2/books/_mget &#123;&quot;ids&quot;: [&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;]&#125; åˆ é™¤ï¼šæ²¡æœ‰è¯·æ±‚ä½“ POST /lib2/books/_bulk &#123;&quot;delete&quot;:&#123;&quot;_index&quot;:&quot;lib2&quot;,&quot;_type&quot;:&quot;books&quot;,&quot;_id&quot;:4&#125;&#125;&#123;&quot;create&quot;:&#123;&quot;_index&quot;:&quot;tt&quot;,&quot;_type&quot;:&quot;ttt&quot;,&quot;_id&quot;:&quot;100&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;lisi&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;tt&quot;,&quot;_type&quot;:&quot;ttt&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;zhaosi&quot;&#125;&#123;&quot;update&quot;:&#123;&quot;_index&quot;:&quot;lib2&quot;,&quot;_type&quot;:&quot;books&quot;,&quot;_id&quot;:&quot;4&quot;&#125;&#125;&#123;&quot;doc&quot;:&#123;&quot;price&quot;:58&#125;&#125; bulkä¸€æ¬¡æœ€å¤§å¤„ç†å¤šå°‘æ•°æ®é‡: bulkä¼šæŠŠå°†è¦å¤„ç†çš„æ•°æ®è½½å…¥å†…å­˜ä¸­ï¼Œæ‰€ä»¥æ•°æ®é‡æ˜¯æœ‰é™åˆ¶çš„ï¼Œæœ€ä½³çš„æ•°æ®é‡ä¸æ˜¯ä¸€ä¸ªç¡®å®šçš„æ•°å€¼ï¼Œå®ƒå–å†³äºä½ çš„ç¡¬ä»¶ï¼Œä½ çš„æ–‡æ¡£å¤§å°ä»¥åŠå¤æ‚æ€§ï¼Œä½ çš„ç´¢å¼•ä»¥åŠæœç´¢çš„è´Ÿè½½ã€‚ ä¸€èˆ¬å»ºè®®æ˜¯1000-5000ä¸ªæ–‡æ¡£ï¼Œå¤§å°å»ºè®®æ˜¯5-15MBï¼Œé»˜è®¤ä¸èƒ½è¶…è¿‡100Mï¼Œå¯ä»¥åœ¨esçš„é…ç½®æ–‡ä»¶ï¼ˆå³$ES_HOMEä¸‹çš„configä¸‹çš„elasticsearch.ymlï¼‰ä¸­ã€‚ 2.5 ç‰ˆæœ¬æ§åˆ¶ElasticSearché‡‡ç”¨äº†ä¹è§‚é”æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç”¨æˆ·å¯¹documentè¿›è¡Œæ“ä½œæ—¶ï¼Œå¹¶ä¸éœ€è¦å¯¹è¯¥documentä½œåŠ é”å’Œè§£é”çš„æ“ä½œï¼Œåªéœ€è¦æŒ‡å®šè¦æ“ä½œçš„ç‰ˆæœ¬å³å¯ã€‚å½“ç‰ˆæœ¬å·ä¸€è‡´æ—¶ï¼ŒElasticSearchä¼šå…è®¸è¯¥æ“ä½œé¡ºåˆ©æ‰§è¡Œï¼Œè€Œå½“ç‰ˆæœ¬å·å­˜åœ¨å†²çªæ—¶ï¼ŒElasticSearchä¼šæç¤ºå†²çªå¹¶æŠ›å‡ºå¼‚å¸¸ï¼ˆVersionConflictEngineExceptionå¼‚å¸¸ï¼‰ã€‚ ElasticSearchçš„ç‰ˆæœ¬å·çš„å–å€¼èŒƒå›´ä¸º1åˆ°2^63-1ã€‚ å†…éƒ¨ç‰ˆæœ¬æ§åˆ¶ï¼šä½¿ç”¨çš„æ˜¯_version å¤–éƒ¨ç‰ˆæœ¬æ§åˆ¶ï¼šelasticsearchåœ¨å¤„ç†å¤–éƒ¨ç‰ˆæœ¬å·æ—¶ä¼šä¸å¯¹å†…éƒ¨ç‰ˆæœ¬å·çš„å¤„ç†æœ‰äº›ä¸åŒã€‚å®ƒä¸å†æ˜¯æ£€æŸ¥versionæ˜¯å¦ä¸è¯·æ±‚ä¸­æŒ‡å®šçš„æ•°å€¼ç›¸åŒ_,è€Œæ˜¯æ£€æŸ¥å½“å‰çš„_versionæ˜¯å¦æ¯”æŒ‡å®šçš„æ•°å€¼å°ã€‚å¦‚æœè¯·æ±‚æˆåŠŸï¼Œé‚£ä¹ˆå¤–éƒ¨çš„ç‰ˆæœ¬å·å°±ä¼šè¢«å­˜å‚¨åˆ°æ–‡æ¡£ä¸­çš„_versionä¸­ã€‚ ä¸ºäº†ä¿æŒ_versionä¸å¤–éƒ¨ç‰ˆæœ¬æ§åˆ¶çš„æ•°æ®ä¸€è‡´ä½¿ç”¨version_type=external 2.6 ä»€ä¹ˆæ˜¯MappingPUT /myindex/article/1 &#123; &quot;post_date&quot;: &quot;2018-05-10&quot;, &quot;title&quot;: &quot;Java&quot;, &quot;content&quot;: &quot;java is the best language&quot;, &quot;author_id&quot;: 119&#125; PUT /myindex/article/2 &#123; &quot;post_date&quot;: &quot;2018-05-12&quot;, &quot;title&quot;: &quot;html&quot;, &quot;content&quot;: &quot;I like html&quot;, &quot;author_id&quot;: 120&#125; PUT /myindex/article/3 &#123; &quot;post_date&quot;: &quot;2018-05-16&quot;, &quot;title&quot;: &quot;es&quot;, &quot;content&quot;: &quot;Es is distributed document store&quot;, &quot;author_id&quot;: 110&#125; GET /myindex/article/_search?q=2018-05 GET /myindex/article/_search?q=2018-05-10 GET /myindex/article/_search?q=html GET /myindex/article/_search?q=java 2.6.1 æŸ¥çœ‹esè‡ªåŠ¨åˆ›å»ºçš„mappingGET /myindex/article/_mapping esè‡ªåŠ¨åˆ›å»ºäº†indexï¼Œtypeï¼Œä»¥åŠtypeå¯¹åº”çš„mapping(dynamic mapping) ä»€ä¹ˆæ˜¯æ˜ å°„ï¼šmappingå®šä¹‰äº†typeä¸­çš„æ¯ä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ä»¥åŠè¿™äº›å­—æ®µå¦‚ä½•åˆ†è¯ç­‰ç›¸å…³å±æ€§ &#123; &quot;myindex&quot;: &#123; &quot;mappings&quot;: &#123; &quot;article&quot;: &#123; &quot;properties&quot;: &#123; &quot;author_id&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;content&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;post_date&quot;: &#123; &quot;type&quot;: &quot;date&quot; &#125;, &quot;title&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125; &#125; &#125; &#125; &#125;&#125; åˆ›å»ºç´¢å¼•çš„æ—¶å€™,å¯ä»¥é¢„å…ˆå®šä¹‰å­—æ®µçš„ç±»å‹ä»¥åŠç›¸å…³å±æ€§ï¼Œè¿™æ ·å°±èƒ½å¤ŸæŠŠæ—¥æœŸå­—æ®µå¤„ç†æˆæ—¥æœŸï¼ŒæŠŠæ•°å­—å­—æ®µå¤„ç†æˆæ•°å­—ï¼ŒæŠŠå­—ç¬¦ä¸²å­—æ®µå¤„ç†å­—ç¬¦ä¸²å€¼ç­‰ æ”¯æŒçš„æ•°æ®ç±»å‹ï¼š (1)æ ¸å¿ƒæ•°æ®ç±»å‹ï¼ˆCore datatypesï¼‰ å­—ç¬¦å‹ï¼šstringï¼Œstringç±»å‹åŒ…æ‹¬ text å’Œ keyword textç±»å‹è¢«ç”¨æ¥ç´¢å¼•é•¿æ–‡æœ¬ï¼Œåœ¨å»ºç«‹ç´¢å¼•å‰ä¼šå°†è¿™äº›æ–‡æœ¬è¿›è¡Œåˆ†è¯ï¼Œè½¬åŒ–ä¸ºè¯çš„ç»„åˆï¼Œå»ºç«‹ç´¢å¼•ã€‚å…è®¸esæ¥æ£€ç´¢è¿™äº›è¯è¯­ã€‚textç±»å‹ä¸èƒ½ç”¨æ¥æ’åºå’Œèšåˆã€‚ Keywordç±»å‹ä¸éœ€è¦è¿›è¡Œåˆ†è¯ï¼Œå¯ä»¥è¢«ç”¨æ¥æ£€ç´¢è¿‡æ»¤ã€æ’åºå’Œèšåˆã€‚keyword ç±»å‹å­—æ®µåªèƒ½ç”¨æœ¬èº«æ¥è¿›è¡Œæ£€ç´¢ æ•°å­—å‹ï¼šlong, integer, short, byte, double, float æ—¥æœŸå‹ï¼šdate å¸ƒå°”å‹ï¼šboolean äºŒè¿›åˆ¶å‹ï¼šbinary (2)å¤æ‚æ•°æ®ç±»å‹ï¼ˆComplex datatypesï¼‰ æ•°ç»„ç±»å‹ï¼ˆArray datatypeï¼‰ï¼šæ•°ç»„ç±»å‹ä¸éœ€è¦ä¸“é—¨æŒ‡å®šæ•°ç»„å…ƒç´ çš„typeï¼Œä¾‹å¦‚ï¼š å­—ç¬¦å‹æ•°ç»„: [ &quot;one&quot;, &quot;two&quot; ] æ•´å‹æ•°ç»„ï¼š[ 1, 2 ] æ•°ç»„å‹æ•°ç»„ï¼š[ 1, [ 2, 3 ]] ç­‰ä»·äº[ 1, 2, 3 ] å¯¹è±¡æ•°ç»„ï¼š[ { &quot;name&quot;: &quot;Mary&quot;, &quot;age&quot;: 12 }, { &quot;name&quot;: &quot;John&quot;, &quot;age&quot;: 10 }] å¯¹è±¡ç±»å‹ï¼ˆObject datatypeï¼‰ï¼š_ object _ ç”¨äºå•ä¸ªJSONå¯¹è±¡ï¼› åµŒå¥—ç±»å‹ï¼ˆNested datatypeï¼‰ï¼š_ nested _ ç”¨äºJSONæ•°ç»„ï¼› (3)åœ°ç†ä½ç½®ç±»å‹ï¼ˆGeo datatypesï¼‰ åœ°ç†åæ ‡ç±»å‹ï¼ˆGeo-point datatypeï¼‰ï¼š_ geo_point _ ç”¨äºç»çº¬åº¦åæ ‡ï¼› åœ°ç†å½¢çŠ¶ç±»å‹ï¼ˆGeo-Shape datatypeï¼‰ï¼š_ geo_shape _ ç”¨äºç±»ä¼¼äºå¤šè¾¹å½¢çš„å¤æ‚å½¢çŠ¶ï¼› (4)ç‰¹å®šç±»å‹ï¼ˆSpecialised datatypesï¼‰ IPv4 ç±»å‹ï¼ˆIPv4 datatypeï¼‰ï¼š_ ip _ ç”¨äºIPv4 åœ°å€ï¼› Completion ç±»å‹ï¼ˆCompletion datatypeï¼‰ï¼š_ completion _æä¾›è‡ªåŠ¨è¡¥å…¨å»ºè®®ï¼› Token count ç±»å‹ï¼ˆToken count datatypeï¼‰ï¼š_ token_count _ ç”¨äºç»Ÿè®¡åšäº†æ ‡è®°çš„å­—æ®µçš„indexæ•°ç›®ï¼Œè¯¥å€¼ä¼šä¸€ç›´å¢åŠ ï¼Œä¸ä¼šå› ä¸ºè¿‡æ»¤æ¡ä»¶è€Œå‡å°‘ã€‚ mapper-murmur3 ç±»å‹ï¼šé€šè¿‡æ’ä»¶ï¼Œå¯ä»¥é€šè¿‡ _ murmur3 _ æ¥è®¡ç®— index çš„ hash å€¼ï¼› é™„åŠ ç±»å‹ï¼ˆAttachment datatypeï¼‰ï¼šé‡‡ç”¨ mapper-attachments æ’ä»¶ï¼Œå¯æ”¯æŒ_ attachments _ ç´¢å¼•ï¼Œä¾‹å¦‚ Microsoft Office æ ¼å¼ï¼ŒOpen Document æ ¼å¼ï¼ŒePub, HTML ç­‰ã€‚ æ”¯æŒçš„å±æ€§ï¼š â€œstoreâ€:false//æ˜¯å¦å•ç‹¬è®¾ç½®æ­¤å­—æ®µçš„æ˜¯å¦å­˜å‚¨è€Œä»_sourceå­—æ®µä¸­åˆ†ç¦»ï¼Œé»˜è®¤æ˜¯falseï¼Œåªèƒ½æœç´¢ï¼Œä¸èƒ½è·å–å€¼ â€œindexâ€: true//åˆ†è¯ï¼Œä¸åˆ†è¯æ˜¯ï¼šfalse ï¼Œè®¾ç½®æˆfalseï¼Œå­—æ®µå°†ä¸ä¼šè¢«ç´¢å¼• â€œanalyzerâ€:â€ikâ€//æŒ‡å®šåˆ†è¯å™¨,é»˜è®¤åˆ†è¯å™¨ä¸ºstandard analyzer â€œboostâ€:1.23//å­—æ®µçº§åˆ«çš„åˆ†æ•°åŠ æƒï¼Œé»˜è®¤å€¼æ˜¯1.0 â€œdoc_valuesâ€:false//å¯¹not_analyzedå­—æ®µï¼Œé»˜è®¤éƒ½æ˜¯å¼€å¯ï¼Œåˆ†è¯å­—æ®µä¸èƒ½ä½¿ç”¨ï¼Œå¯¹æ’åºå’Œèšåˆèƒ½æå‡è¾ƒå¤§æ€§èƒ½ï¼ŒèŠ‚çº¦å†…å­˜ â€œfielddataâ€:{â€œformatâ€:â€disabledâ€}//é’ˆå¯¹åˆ†è¯å­—æ®µï¼Œå‚ä¸æ’åºæˆ–èšåˆæ—¶èƒ½æé«˜æ€§èƒ½ï¼Œä¸åˆ†è¯å­—æ®µç»Ÿä¸€å»ºè®®ä½¿ç”¨doc_value â€œfieldsâ€:{â€œrawâ€:{â€œtypeâ€:â€stringâ€,â€indexâ€:â€not_analyzedâ€}} //å¯ä»¥å¯¹ä¸€ä¸ªå­—æ®µæä¾›å¤šç§ç´¢å¼•æ¨¡å¼ï¼ŒåŒä¸€ä¸ªå­—æ®µçš„å€¼ï¼Œä¸€ä¸ªåˆ†è¯ï¼Œä¸€ä¸ªä¸åˆ†è¯ â€œignore_aboveâ€:100 //è¶…è¿‡100ä¸ªå­—ç¬¦çš„æ–‡æœ¬ï¼Œå°†ä¼šè¢«å¿½ç•¥ï¼Œä¸è¢«ç´¢å¼• â€œinclude_in_allâ€:ture//è®¾ç½®æ˜¯å¦æ­¤å­—æ®µåŒ…å«åœ¨_allå­—æ®µä¸­ï¼Œé»˜è®¤æ˜¯trueï¼Œé™¤éindexè®¾ç½®æˆnoé€‰é¡¹ â€œindex_optionsâ€:â€docsâ€//4ä¸ªå¯é€‰å‚æ•°docsï¼ˆç´¢å¼•æ–‡æ¡£å·ï¼‰ ,freqsï¼ˆæ–‡æ¡£å·+è¯é¢‘ï¼‰ï¼Œpositionsï¼ˆæ–‡æ¡£å·+è¯é¢‘+ä½ç½®ï¼Œé€šå¸¸ç”¨æ¥è·ç¦»æŸ¥è¯¢ï¼‰ï¼Œoffsetsï¼ˆæ–‡æ¡£å·+è¯é¢‘+ä½ç½®+åç§»é‡ï¼Œé€šå¸¸è¢«ä½¿ç”¨åœ¨é«˜äº®å­—æ®µï¼‰åˆ†è¯å­—æ®µé»˜è®¤æ˜¯positionï¼Œå…¶ä»–çš„é»˜è®¤æ˜¯docs â€œnormsâ€:{â€œenableâ€:true,â€loadingâ€:â€lazyâ€}//åˆ†è¯å­—æ®µé»˜è®¤é…ç½®ï¼Œä¸åˆ†è¯å­—æ®µï¼šé»˜è®¤{â€œenableâ€:false}ï¼Œå­˜å‚¨é•¿åº¦å› å­å’Œç´¢å¼•æ—¶boostï¼Œå»ºè®®å¯¹éœ€è¦å‚ä¸è¯„åˆ†å­—æ®µä½¿ç”¨ ï¼Œä¼šé¢å¤–å¢åŠ å†…å­˜æ¶ˆè€—é‡ â€œnull_valueâ€:â€NULLâ€//è®¾ç½®ä¸€äº›ç¼ºå¤±å­—æ®µçš„åˆå§‹åŒ–å€¼ï¼Œåªæœ‰stringå¯ä»¥ä½¿ç”¨ï¼Œåˆ†è¯å­—æ®µçš„nullå€¼ä¹Ÿä¼šè¢«åˆ†è¯ â€œposition_increament_gapâ€:0//å½±å“è·ç¦»æŸ¥è¯¢æˆ–è¿‘ä¼¼æŸ¥è¯¢ï¼Œå¯ä»¥è®¾ç½®åœ¨å¤šå€¼å­—æ®µçš„æ•°æ®ä¸Šç«åˆ†è¯å­—æ®µä¸Šï¼ŒæŸ¥è¯¢æ—¶å¯æŒ‡å®šslopé—´éš”ï¼Œé»˜è®¤å€¼æ˜¯100 â€œsearch_analyzerâ€:â€ikâ€//è®¾ç½®æœç´¢æ—¶çš„åˆ†è¯å™¨ï¼Œé»˜è®¤è·Ÿananlyzeræ˜¯ä¸€è‡´çš„ï¼Œæ¯”å¦‚indexæ—¶ç”¨standard+ngramï¼Œæœç´¢æ—¶ç”¨standardç”¨æ¥å®Œæˆè‡ªåŠ¨æç¤ºåŠŸèƒ½ â€œsimilarityâ€:â€BM25â€//é»˜è®¤æ˜¯TF/IDFç®—æ³•ï¼ŒæŒ‡å®šä¸€ä¸ªå­—æ®µè¯„åˆ†ç­–ç•¥ï¼Œä»…ä»…å¯¹å­—ç¬¦ä¸²å‹å’Œåˆ†è¯ç±»å‹æœ‰æ•ˆ â€œterm_vectorâ€:â€noâ€//é»˜è®¤ä¸å­˜å‚¨å‘é‡ä¿¡æ¯ï¼Œæ”¯æŒå‚æ•°yesï¼ˆtermå­˜å‚¨ï¼‰ï¼Œwith_positionsï¼ˆterm+ä½ç½®ï¼‰,with_offsetsï¼ˆterm+åç§»é‡ï¼‰ï¼Œwith_positions_offsets(term+ä½ç½®+åç§»é‡) å¯¹å¿«é€Ÿé«˜äº®fast vector highlighterèƒ½æå‡æ€§èƒ½ï¼Œä½†å¼€å¯åˆä¼šåŠ å¤§ç´¢å¼•ä½“ç§¯ï¼Œä¸é€‚åˆå¤§æ•°æ®é‡ç”¨ æ˜ å°„çš„åˆ†ç±»ï¼š (1)åŠ¨æ€æ˜ å°„ï¼š å½“ESåœ¨æ–‡æ¡£ä¸­ç¢°åˆ°ä¸€ä¸ªä»¥å‰æ²¡è§è¿‡çš„å­—æ®µæ—¶ï¼Œå®ƒä¼šåˆ©ç”¨åŠ¨æ€æ˜ å°„æ¥å†³å®šè¯¥å­—æ®µçš„ç±»å‹ï¼Œå¹¶è‡ªåŠ¨åœ°å¯¹è¯¥å­—æ®µæ·»åŠ æ˜ å°„ã€‚ å¯ä»¥é€šè¿‡dynamicè®¾ç½®æ¥æ§åˆ¶è¿™ä¸€è¡Œä¸ºï¼Œå®ƒèƒ½å¤Ÿæ¥å—ä»¥ä¸‹çš„é€‰é¡¹ï¼š trueï¼šé»˜è®¤å€¼ã€‚åŠ¨æ€æ·»åŠ å­—æ®µ falseï¼šå¿½ç•¥æ–°å­—æ®µ strictï¼šå¦‚æœç¢°åˆ°é™Œç”Ÿå­—æ®µï¼ŒæŠ›å‡ºå¼‚å¸¸ dynamicè®¾ç½®å¯ä»¥é€‚ç”¨åœ¨æ ¹å¯¹è±¡ä¸Šæˆ–è€…objectç±»å‹çš„ä»»æ„å­—æ®µä¸Šã€‚ POST /lib2 2.6.2 ç»™ç´¢å¼•lib2åˆ›å»ºæ˜ å°„ç±»å‹&#123; &quot;settings&quot;:&#123; &quot;number_of_shards&quot; : 3, &quot;number_of_replicas&quot; : 0 &#125;, &quot;mappings&quot;:&#123; &quot;books&quot;:&#123; &quot;properties&quot;:&#123; &quot;title&quot;:&#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;name&quot;:&#123;&quot;type&quot;:&quot;text&quot;,&quot;index&quot;:false&#125;, &quot;publish_date&quot;:&#123;&quot;type&quot;:&quot;date&quot;,&quot;index&quot;:false&#125;, &quot;price&quot;:&#123;&quot;type&quot;:&quot;double&quot;&#125;, &quot;number&quot;:&#123;&quot;type&quot;:&quot;integer&quot;&#125; &#125; &#125; &#125;&#125; POST /lib2 2.6.3 ç»™ç´¢å¼•lib2åˆ›å»ºæ˜ å°„ç±»å‹&#123; &quot;settings&quot;:&#123; &quot;number_of_shards&quot; : 3, &quot;number_of_replicas&quot; : 0 &#125;, &quot;mappings&quot;:&#123; &quot;books&quot;:&#123; &quot;properties&quot;:&#123; &quot;title&quot;:&#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;name&quot;:&#123;&quot;type&quot;:&quot;text&quot;,&quot;index&quot;:false&#125;, &quot;publish_date&quot;:&#123;&quot;type&quot;:&quot;date&quot;,&quot;index&quot;:false&#125;, &quot;price&quot;:&#123;&quot;type&quot;:&quot;double&quot;&#125;, &quot;number&quot;:&#123; &quot;type&quot;:&quot;object&quot;, &quot;dynamic&quot;:true &#125; &#125; &#125; &#125;&#125; 2.7åŸºæœ¬æŸ¥è¯¢(QueryæŸ¥è¯¢)2.7.1æ•°æ®å‡†å¤‡PUT /lib3 &#123; &quot;settings&quot;:&#123; &quot;number_of_shards&quot; : 3, &quot;number_of_replicas&quot; : 0 &#125;, &quot;mappings&quot;:&#123; &quot;user&quot;:&#123; &quot;properties&quot;:&#123; &quot;name&quot;: &#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;address&quot;: &#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;age&quot;: &#123;&quot;type&quot;:&quot;integer&quot;&#125;, &quot;interests&quot;: &#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;birthday&quot;: &#123;&quot;type&quot;:&quot;date&quot;&#125; &#125; &#125; &#125;&#125; GET /lib3/user/_search?q=name:lisi GET /lib3/user/_search?q=name:zhaoliu&amp;sort=age:desc 2.7.2 termæŸ¥è¯¢å’ŒtermsæŸ¥è¯¢term queryä¼šå»å€’æ’ç´¢å¼•ä¸­å¯»æ‰¾ç¡®åˆ‡çš„termï¼Œå®ƒå¹¶ä¸çŸ¥é“åˆ†è¯å™¨çš„å­˜åœ¨ã€‚è¿™ç§æŸ¥è¯¢é€‚åˆkeyword ã€numericã€dateã€‚ term:æŸ¥è¯¢æŸä¸ªå­—æ®µé‡Œå«æœ‰æŸä¸ªå…³é”®è¯çš„æ–‡æ¡£ GET /lib3/user/_search/ &#123; &quot;query&quot;: &#123; &quot;term&quot;: &#123;&quot;interests&quot;: &quot;changge&quot;&#125; &#125;&#125; terms:æŸ¥è¯¢æŸä¸ªå­—æ®µé‡Œå«æœ‰å¤šä¸ªå…³é”®è¯çš„æ–‡æ¡£ GET /lib3/user/_search &#123; &quot;query&quot;:&#123; &quot;terms&quot;:&#123; &quot;interests&quot;: [&quot;hejiu&quot;,&quot;changge&quot;] &#125; &#125;&#125; 2.7.3 æ§åˆ¶æŸ¥è¯¢è¿”å›çš„æ•°é‡fromï¼šä»å“ªä¸€ä¸ªæ–‡æ¡£å¼€å§‹sizeï¼šéœ€è¦çš„ä¸ªæ•° GET /lib3/user/_search &#123; &quot;from&quot;:0, &quot;size&quot;:2, &quot;query&quot;:&#123; &quot;terms&quot;:&#123; &quot;interests&quot;: [&quot;hejiu&quot;,&quot;changge&quot;] &#125; &#125;&#125; 2.7.4 è¿”å›ç‰ˆæœ¬å·GET /lib3/user/_search &#123; &quot;version&quot;:true, &quot;query&quot;:&#123; &quot;terms&quot;:&#123; &quot;interests&quot;: [&quot;hejiu&quot;,&quot;changge&quot;] &#125; &#125;&#125; 2.7.5 matchæŸ¥è¯¢match queryçŸ¥é“åˆ†è¯å™¨çš„å­˜åœ¨ï¼Œä¼šå¯¹filedè¿›è¡Œåˆ†è¯æ“ä½œï¼Œç„¶åå†æŸ¥è¯¢ GET /lib3/user/_search &#123; &quot;query&quot;:&#123; &quot;match&quot;:&#123; &quot;name&quot;: &quot;zhaoliu&quot; &#125; &#125;&#125; GET /lib3/user/_search &#123; &quot;query&quot;:&#123; &quot;match&quot;:&#123; &quot;age&quot;: 20 &#125; &#125;&#125; match_all:æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£ GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;&#125; multi_match:å¯ä»¥æŒ‡å®šå¤šä¸ªå­—æ®µ GET /lib3/user/_search &#123; &quot;query&quot;:&#123; &quot;multi_match&quot;: &#123; &quot;query&quot;: &quot;lvyou&quot;, &quot;fields&quot;: [&quot;interests&quot;,&quot;name&quot;] &#125; &#125;&#125; match_phrase:çŸ­è¯­åŒ¹é…æŸ¥è¯¢ ElasticSearchå¼•æ“é¦–å…ˆåˆ†æï¼ˆanalyzeï¼‰æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œä»åˆ†æåçš„æ–‡æœ¬ä¸­æ„å»ºçŸ­è¯­æŸ¥è¯¢ï¼Œè¿™æ„å‘³ç€å¿…é¡»åŒ¹é…çŸ­è¯­ä¸­çš„æ‰€æœ‰åˆ†è¯ï¼Œå¹¶ä¸”ä¿è¯å„ä¸ªåˆ†è¯çš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼š GET lib3/user/_search &#123; &quot;query&quot;:&#123; &quot;match_phrase&quot;:&#123; &quot;interests&quot;: &quot;duanlianï¼Œshuoxiangsheng&quot; &#125; &#125;&#125; 2.7.6 æŒ‡å®šè¿”å›çš„å­—æ®µGET /lib3/user/_search &#123; &quot;_source&quot;: [&quot;address&quot;,&quot;name&quot;], &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;interests&quot;: &quot;changge&quot; &#125; &#125;&#125; 2.7.7æ§åˆ¶åŠ è½½çš„å­—æ®µGET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;_source&quot;: &#123; &quot;includes&quot;: [&quot;name&quot;,&quot;address&quot;], &quot;excludes&quot;: [&quot;age&quot;,&quot;birthday&quot;] &#125;&#125; ä½¿ç”¨é€šé…ç¬¦* GET /lib3/user/_search &#123; &quot;_source&quot;: &#123; &quot;includes&quot;: &quot;addr*&quot;, &quot;excludes&quot;: [&quot;name&quot;,&quot;bir*&quot;] &#125;, &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;&#125; 2.7.8 æ’åºä½¿ç”¨sortå®ç°æ’åºï¼šdesc:é™åºï¼Œasc:å‡åº GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;sort&quot;: [ &#123; &quot;age&quot;: &#123; &quot;order&quot;:&quot;asc&quot; &#125; &#125; ] &#125; GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;sort&quot;: [ &#123; &quot;age&quot;: &#123; &quot;order&quot;:&quot;desc&quot; &#125; &#125; ] &#125; 2.7.9 å‰ç¼€åŒ¹é…æŸ¥è¯¢GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;match_phrase_prefix&quot;: &#123; &quot;name&quot;: &#123; &quot;query&quot;: &quot;zhao&quot; &#125; &#125; &#125;&#125; 2.7.10 èŒƒå›´æŸ¥è¯¢range:å®ç°èŒƒå›´æŸ¥è¯¢ å‚æ•°ï¼šfrom,to,include_lower,include_upper,boost include_lower:æ˜¯å¦åŒ…å«èŒƒå›´çš„å·¦è¾¹ç•Œï¼Œé»˜è®¤æ˜¯true include_upper:æ˜¯å¦åŒ…å«èŒƒå›´çš„å³è¾¹ç•Œï¼Œé»˜è®¤æ˜¯true GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;range&quot;: &#123; &quot;birthday&quot;: &#123; &quot;from&quot;: &quot;1990-10-10&quot;, &quot;to&quot;: &quot;2018-05-01&quot; &#125; &#125; &#125;&#125; GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;range&quot;: &#123; &quot;age&quot;: &#123; &quot;from&quot;: 20, &quot;to&quot;: 25, &quot;include_lower&quot;: true, &quot;include_upper&quot;: false &#125; &#125; &#125;&#125; 2.7.11 wildcardæŸ¥è¯¢å…è®¸ä½¿ç”¨é€šé…ç¬¦* å’Œ ?æ¥è¿›è¡ŒæŸ¥è¯¢ *ä»£è¡¨0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ ï¼Ÿä»£è¡¨ä»»æ„ä¸€ä¸ªå­—ç¬¦ GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;wildcard&quot;: &#123; &quot;name&quot;: &quot;zhao*&quot; &#125; &#125;&#125; GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;wildcard&quot;: &#123; &quot;name&quot;: &quot;li?i&quot; &#125; &#125;&#125; 2.7.12 fuzzyå®ç°æ¨¡ç³ŠæŸ¥è¯¢valueï¼šæŸ¥è¯¢çš„å…³é”®å­— boostï¼šæŸ¥è¯¢çš„æƒå€¼ï¼Œé»˜è®¤å€¼æ˜¯1.0 min_similarity:è®¾ç½®åŒ¹é…çš„æœ€å°ç›¸ä¼¼åº¦ï¼Œé»˜è®¤å€¼ä¸º0.5ï¼Œå¯¹äºå­—ç¬¦ä¸²ï¼Œå–å€¼ä¸º0-1(åŒ…æ‹¬0å’Œ1);å¯¹äºæ•°å€¼ï¼Œå–å€¼å¯èƒ½å¤§äº1;å¯¹äºæ—¥æœŸå‹å–å€¼ä¸º1d,1mç­‰ï¼Œ1då°±ä»£è¡¨1å¤© prefix_length:æŒ‡æ˜åŒºåˆ†è¯é¡¹çš„å…±åŒå‰ç¼€é•¿åº¦ï¼Œé»˜è®¤æ˜¯0 max_expansions:æŸ¥è¯¢ä¸­çš„è¯é¡¹å¯ä»¥æ‰©å±•çš„æ•°ç›®ï¼Œé»˜è®¤å¯ä»¥æ— é™å¤§ GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;fuzzy&quot;: &#123; &quot;interests&quot;: &quot;chagge&quot; &#125; &#125;&#125; GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;fuzzy&quot;: &#123; &quot;interests&quot;: &#123; &quot;value&quot;: &quot;chagge&quot; &#125; &#125; &#125;&#125; 2.7.13 é«˜äº®æœç´¢ç»“æœGET /lib3/user/_search &#123; &quot;query&quot;:&#123; &quot;match&quot;:&#123; &quot;interests&quot;: &quot;changge&quot; &#125; &#125;, &quot;highlight&quot;: &#123; &quot;fields&quot;: &#123; &quot;interests&quot;: &#123;&#125; &#125; &#125;&#125; 2.8 FilteræŸ¥è¯¢filteræ˜¯ä¸è®¡ç®—ç›¸å…³æ€§çš„ï¼ŒåŒæ—¶å¯ä»¥cacheã€‚å› æ­¤ï¼Œfilteré€Ÿåº¦è¦å¿«äºqueryã€‚ POST /lib4/items/_bulk &#123;&quot;index&quot;: &#123;&quot;_id&quot;: 1&#125;&#125;&#123;&quot;price&quot;: 40,&quot;itemID&quot;: &quot;ID100123&quot;&#125;&#123;&quot;index&quot;: &#123;&quot;_id&quot;: 2&#125;&#125;&#123;&quot;price&quot;: 50,&quot;itemID&quot;: &quot;ID100124&quot;&#125;&#123;&quot;index&quot;: &#123;&quot;_id&quot;: 3&#125;&#125;&#123;&quot;price&quot;: 25,&quot;itemID&quot;: &quot;ID100124&quot;&#125;&#123;&quot;index&quot;: &#123;&quot;_id&quot;: 4&#125;&#125;&#123;&quot;price&quot;: 30,&quot;itemID&quot;: &quot;ID100125&quot;&#125;&#123;&quot;index&quot;: &#123;&quot;_id&quot;: 5&#125;&#125;&#123;&quot;price&quot;: null,&quot;itemID&quot;: &quot;ID100127&quot;&#125; 2.8.1 ç®€å•çš„è¿‡æ»¤æŸ¥è¯¢GET /lib4/items/_search &#123; &quot;post_filter&quot;: &#123; &quot;term&quot;: &#123; &quot;price&quot;: 40 &#125; &#125;&#125; GET /lib4/items/_search &#123; &quot;post_filter&quot;: &#123; &quot;terms&quot;: &#123; &quot;price&quot;: [25,40] &#125; &#125;&#125; GET /lib4/items/_search &#123; &quot;post_filter&quot;: &#123; &quot;term&quot;: &#123; &quot;itemID&quot;: &quot;ID100123&quot; &#125; &#125;&#125; æŸ¥çœ‹åˆ†è¯å™¨åˆ†æçš„ç»“æœï¼š GET /lib4/_mapping ä¸å¸Œæœ›å•†å“idå­—æ®µè¢«åˆ†è¯ï¼Œåˆ™é‡æ–°åˆ›å»ºæ˜ å°„ DELETE lib4 PUT /lib4 &#123; &quot;mappings&quot;: &#123; &quot;items&quot;: &#123; &quot;properties&quot;: &#123; &quot;itemID&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;index&quot;: false &#125; &#125; &#125; &#125;&#125; 2.8.2 boolè¿‡æ»¤æŸ¥è¯¢å¯ä»¥å®ç°ç»„åˆè¿‡æ»¤æŸ¥è¯¢ æ ¼å¼ï¼š &#123; &quot;bool&quot;: &#123; &quot;must&quot;: [], &quot;should&quot;: [], &quot;must_not&quot;: [] &#125;&#125; must:å¿…é¡»æ»¡è¶³çš„æ¡ä»¶â€”-and shouldï¼šå¯ä»¥æ»¡è¶³ä¹Ÿå¯ä»¥ä¸æ»¡è¶³çš„æ¡ä»¶â€”or must_not:ä¸éœ€è¦æ»¡è¶³çš„æ¡ä»¶â€”not GET /lib4/items/_search &#123; &quot;post_filter&quot;: &#123; &quot;bool&quot;: &#123; &quot;should&quot;: [ &#123;&quot;term&quot;: &#123;&quot;price&quot;:25&#125;&#125;, &#123;&quot;term&quot;: &#123;&quot;itemID&quot;: &quot;id100123&quot;&#125;&#125; ], &quot;must_not&quot;: &#123; &quot;term&quot;:&#123;&quot;price&quot;: 30&#125; &#125; &#125; &#125;&#125; åµŒå¥—ä½¿ç”¨boolï¼š GET /lib4/items/_search &#123; &quot;post_filter&quot;: &#123; &quot;bool&quot;: &#123; &quot;should&quot;: [ &#123;&quot;term&quot;: &#123;&quot;itemID&quot;: &quot;id100123&quot;&#125;&#125;, &#123; &quot;bool&quot;: &#123; &quot;must&quot;: [ &#123;&quot;term&quot;: &#123;&quot;itemID&quot;: &quot;id100124&quot;&#125;&#125;, &#123;&quot;term&quot;: &#123;&quot;price&quot;: 40&#125;&#125; ] &#125; &#125; ] &#125; &#125;&#125; 2.8.3 èŒƒå›´è¿‡æ»¤gt: &gt; lt: &lt; gte: &gt;= lte: &lt;= GET /lib4/items/_search &#123; &quot;post_filter&quot;: &#123; &quot;range&quot;: &#123; &quot;price&quot;: &#123; &quot;gt&quot;: 25, &quot;lt&quot;: 50 &#125; &#125; &#125;&#125; 2.8.5 è¿‡æ»¤éç©ºGET /lib4/items/_search &#123; &quot;query&quot;: &#123; &quot;bool&quot;: &#123; &quot;filter&quot;: &#123; &quot;exists&quot;:&#123; &quot;field&quot;:&quot;price&quot; &#125; &#125; &#125; &#125;&#125; GET /lib4/items/_search &#123; &quot;query&quot; : &#123; &quot;constant_score&quot; : &#123; &quot;filter&quot;: &#123; &quot;exists&quot; : &#123; &quot;field&quot; : &quot;price&quot; &#125; &#125; &#125; &#125;&#125; 2.8.6 è¿‡æ»¤å™¨ç¼“å­˜ElasticSearchæä¾›äº†ä¸€ç§ç‰¹æ®Šçš„ç¼“å­˜ï¼Œå³è¿‡æ»¤å™¨ç¼“å­˜ï¼ˆfilter cacheï¼‰ï¼Œç”¨æ¥å­˜å‚¨è¿‡æ»¤å™¨çš„ç»“æœï¼Œè¢«ç¼“å­˜çš„è¿‡æ»¤å™¨å¹¶ä¸éœ€è¦æ¶ˆè€—è¿‡å¤šçš„å†…å­˜ï¼ˆå› ä¸ºå®ƒä»¬åªå­˜å‚¨äº†å“ªäº›æ–‡æ¡£èƒ½ä¸è¿‡æ»¤å™¨ç›¸åŒ¹é…çš„ç›¸å…³ä¿¡æ¯ï¼‰ï¼Œè€Œä¸”å¯ä¾›åç»­æ‰€æœ‰ä¸ä¹‹ç›¸å…³çš„æŸ¥è¯¢é‡å¤ä½¿ç”¨ï¼Œä»è€Œæå¤§åœ°æé«˜äº†æŸ¥è¯¢æ€§èƒ½ã€‚ æ³¨æ„ï¼šElasticSearchå¹¶ä¸æ˜¯é»˜è®¤ç¼“å­˜æ‰€æœ‰è¿‡æ»¤å™¨ï¼Œä»¥ä¸‹è¿‡æ»¤å™¨é»˜è®¤ä¸ç¼“å­˜ï¼š numeric_range script geo_bbox geo_distance geo_distance_range geo_polygon geo_shape and or not exists,missing,range,term,termsé»˜è®¤æ˜¯å¼€å¯ç¼“å­˜çš„ å¼€å¯æ–¹å¼ï¼šåœ¨filteræŸ¥è¯¢è¯­å¥åè¾¹åŠ ä¸Šâ€œ_catchâ€:true 2.9 èšåˆæŸ¥è¯¢(1)sum GET /lib4/items/_search &#123; &quot;size&quot;:0, &quot;aggs&quot;: &#123; &quot;price_of_sum&quot;: &#123; &quot;sum&quot;: &#123; &quot;field&quot;: &quot;price&quot; &#125; &#125; &#125;&#125; (2)min GET /lib4/items/_search &#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;price_of_min&quot;: &#123; &quot;min&quot;: &#123; &quot;field&quot;: &quot;price&quot; &#125; &#125; &#125;&#125; (3)max GET /lib4/items/_search &#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;price_of_max&quot;: &#123; &quot;max&quot;: &#123; &quot;field&quot;: &quot;price&quot; &#125; &#125; &#125;&#125; (4)avg GET /lib4/items/_search &#123; &quot;size&quot;:0, &quot;aggs&quot;: &#123; &quot;price_of_avg&quot;: &#123; &quot;avg&quot;: &#123; &quot;field&quot;: &quot;price&quot; &#125; &#125; &#125;&#125; (5)cardinality:æ±‚åŸºæ•° GET /lib4/items/_search &#123; &quot;size&quot;:0, &quot;aggs&quot;: &#123; &quot;price_of_cardi&quot;: &#123; &quot;cardinality&quot;: &#123; &quot;field&quot;: &quot;price&quot; &#125; &#125; &#125;&#125; (6)terms:åˆ†ç»„ GET /lib4/items/_search &#123; &quot;size&quot;:0, &quot;aggs&quot;: &#123; &quot;price_group_by&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;price&quot; &#125; &#125; &#125;&#125; å¯¹é‚£äº›æœ‰å”±æ­Œå…´è¶£çš„ç”¨æˆ·æŒ‰å¹´é¾„åˆ†ç»„GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;interests&quot;: &quot;changge&quot; &#125; &#125;, &quot;size&quot;: 0, &quot;aggs&quot;:&#123; &quot;age_group_by&quot;:&#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;age&quot;, &quot;order&quot;: &#123; &quot;avg_of_age&quot;: &quot;desc&quot; &#125; &#125;, &quot;aggs&quot;: &#123; &quot;avg_of_age&quot;: &#123; &quot;avg&quot;: &#123; &quot;field&quot;: &quot;age&quot; &#125; &#125; &#125; &#125; &#125;&#125; 2.10 å¤åˆæŸ¥è¯¢å°†å¤šä¸ªåŸºæœ¬æŸ¥è¯¢ç»„åˆæˆå•ä¸€æŸ¥è¯¢çš„æŸ¥è¯¢ 2.10.1 ä½¿ç”¨boolæŸ¥è¯¢æ¥æ”¶ä»¥ä¸‹å‚æ•°ï¼š mustï¼š æ–‡æ¡£ å¿…é¡»åŒ¹é…è¿™äº›æ¡ä»¶æ‰èƒ½è¢«åŒ…å«è¿›æ¥ã€‚must_notï¼š æ–‡æ¡£ å¿…é¡»ä¸åŒ¹é…è¿™äº›æ¡ä»¶æ‰èƒ½è¢«åŒ…å«è¿›æ¥ã€‚shouldï¼š å¦‚æœæ»¡è¶³è¿™äº›è¯­å¥ä¸­çš„ä»»æ„è¯­å¥ï¼Œå°†å¢åŠ  _scoreï¼Œå¦åˆ™ï¼Œæ— ä»»ä½•å½±å“ã€‚å®ƒä»¬ä¸»è¦ç”¨äºä¿®æ­£æ¯ä¸ªæ–‡æ¡£çš„ç›¸å…³æ€§å¾—åˆ†ã€‚filterï¼š å¿…é¡» åŒ¹é…ï¼Œä½†å®ƒä»¥ä¸è¯„åˆ†ã€è¿‡æ»¤æ¨¡å¼æ¥è¿›è¡Œã€‚è¿™äº›è¯­å¥å¯¹è¯„åˆ†æ²¡æœ‰è´¡çŒ®ï¼Œåªæ˜¯æ ¹æ®è¿‡æ»¤æ ‡å‡†æ¥æ’é™¤æˆ–åŒ…å«æ–‡æ¡£ã€‚ ç›¸å…³æ€§å¾—åˆ†æ˜¯å¦‚ä½•ç»„åˆçš„ã€‚æ¯ä¸€ä¸ªå­æŸ¥è¯¢éƒ½ç‹¬è‡ªåœ°è®¡ç®—æ–‡æ¡£çš„ç›¸å…³æ€§å¾—åˆ†ã€‚ä¸€æ—¦ä»–ä»¬çš„å¾—åˆ†è¢«è®¡ç®—å‡ºæ¥ï¼Œ bool æŸ¥è¯¢å°±å°†è¿™äº›å¾—åˆ†è¿›è¡Œåˆå¹¶å¹¶ä¸”è¿”å›ä¸€ä¸ªä»£è¡¨æ•´ä¸ªå¸ƒå°”æ“ä½œçš„å¾—åˆ†ã€‚ ä¸‹é¢çš„æŸ¥è¯¢ç”¨äºæŸ¥æ‰¾ title å­—æ®µåŒ¹é… how to make millions å¹¶ä¸”ä¸è¢«æ ‡è¯†ä¸º spam çš„æ–‡æ¡£ã€‚é‚£äº›è¢«æ ‡è¯†ä¸º starred æˆ–åœ¨2014ä¹‹åçš„æ–‡æ¡£ï¼Œå°†æ¯”å¦å¤–é‚£äº›æ–‡æ¡£æ‹¥æœ‰æ›´é«˜çš„æ’åã€‚å¦‚æœ ä¸¤è€… éƒ½æ»¡è¶³ï¼Œé‚£ä¹ˆå®ƒæ’åå°†æ›´é«˜ï¼š &#123; &quot;bool&quot;: &#123; &quot;must&quot;: &#123; &quot;match&quot;: &#123; &quot;title&quot;: &quot;how to make millions&quot; &#125;&#125;, &quot;must_not&quot;: &#123; &quot;match&quot;: &#123; &quot;tag&quot;: &quot;spam&quot; &#125;&#125;, &quot;should&quot;: [ &#123; &quot;match&quot;: &#123; &quot;tag&quot;: &quot;starred&quot; &#125;&#125;, &#123; &quot;range&quot;: &#123; &quot;date&quot;: &#123; &quot;gte&quot;: &quot;2014-01-01&quot; &#125;&#125;&#125; ] &#125;&#125; å¦‚æœæ²¡æœ‰ must è¯­å¥ï¼Œé‚£ä¹ˆè‡³å°‘éœ€è¦èƒ½å¤ŸåŒ¹é…å…¶ä¸­çš„ä¸€æ¡ should è¯­å¥ã€‚ä½†ï¼Œå¦‚æœå­˜åœ¨è‡³å°‘ä¸€æ¡ must è¯­å¥ï¼Œåˆ™å¯¹ should è¯­å¥çš„åŒ¹é…æ²¡æœ‰è¦æ±‚ã€‚å¦‚æœæˆ‘ä»¬ä¸æƒ³å› ä¸ºæ–‡æ¡£çš„æ—¶é—´è€Œå½±å“å¾—åˆ†ï¼Œå¯ä»¥ç”¨ filter è¯­å¥æ¥é‡å†™å‰é¢çš„ä¾‹å­ï¼š &#123; &quot;bool&quot;: &#123; &quot;must&quot;: &#123; &quot;match&quot;: &#123; &quot;title&quot;: &quot;how to make millions&quot; &#125;&#125;, &quot;must_not&quot;: &#123; &quot;match&quot;: &#123; &quot;tag&quot;: &quot;spam&quot; &#125;&#125;, &quot;should&quot;: [ &#123; &quot;match&quot;: &#123; &quot;tag&quot;: &quot;starred&quot; &#125;&#125; ], &quot;filter&quot;: &#123; &quot;range&quot;: &#123; &quot;date&quot;: &#123; &quot;gte&quot;: &quot;2014-01-01&quot; &#125;&#125; &#125; &#125;&#125; é€šè¿‡å°† range æŸ¥è¯¢ç§»åˆ° filter è¯­å¥ä¸­ï¼Œæˆ‘ä»¬å°†å®ƒè½¬æˆä¸è¯„åˆ†çš„æŸ¥è¯¢ï¼Œå°†ä¸å†å½±å“æ–‡æ¡£çš„ç›¸å…³æ€§æ’åã€‚ç”±äºå®ƒç°åœ¨æ˜¯ä¸€ä¸ªä¸è¯„åˆ†çš„æŸ¥è¯¢ï¼Œå¯ä»¥ä½¿ç”¨å„ç§å¯¹ filter æŸ¥è¯¢æœ‰æ•ˆçš„ä¼˜åŒ–æ‰‹æ®µæ¥æå‡æ€§èƒ½ã€‚ bool æŸ¥è¯¢æœ¬èº«ä¹Ÿå¯ä»¥è¢«ç”¨åšä¸è¯„åˆ†çš„æŸ¥è¯¢ã€‚ç®€å•åœ°å°†å®ƒæ”¾ç½®åˆ° filter è¯­å¥ä¸­å¹¶åœ¨å†…éƒ¨æ„å»ºå¸ƒå°”é€»è¾‘ï¼š &#123; &quot;bool&quot;: &#123; &quot;must&quot;: &#123; &quot;match&quot;: &#123; &quot;title&quot;: &quot;how to make millions&quot; &#125;&#125;, &quot;must_not&quot;: &#123; &quot;match&quot;: &#123; &quot;tag&quot;: &quot;spam&quot; &#125;&#125;, &quot;should&quot;: [ &#123; &quot;match&quot;: &#123; &quot;tag&quot;: &quot;starred&quot; &#125;&#125; ], &quot;filter&quot;: &#123; &quot;bool&quot;: &#123; &quot;must&quot;: [ &#123; &quot;range&quot;: &#123; &quot;date&quot;: &#123; &quot;gte&quot;: &quot;2014-01-01&quot; &#125;&#125;&#125;, &#123; &quot;range&quot;: &#123; &quot;price&quot;: &#123; &quot;lte&quot;: 29.99 &#125;&#125;&#125; ], &quot;must_not&quot;: [ &#123; &quot;term&quot;: &#123; &quot;category&quot;: &quot;ebooks&quot; &#125;&#125; ] &#125; &#125; &#125;&#125; 2.10.2 constant_scoreæŸ¥è¯¢å®ƒå°†ä¸€ä¸ªä¸å˜çš„å¸¸é‡è¯„åˆ†åº”ç”¨äºæ‰€æœ‰åŒ¹é…çš„æ–‡æ¡£ã€‚å®ƒè¢«ç»å¸¸ç”¨äºä½ åªéœ€è¦æ‰§è¡Œä¸€ä¸ª filter è€Œæ²¡æœ‰å…¶å®ƒæŸ¥è¯¢ï¼ˆä¾‹å¦‚ï¼Œè¯„åˆ†æŸ¥è¯¢ï¼‰çš„æƒ…å†µä¸‹ã€‚ &#123; &quot;constant_score&quot;: &#123; &quot;filter&quot;: &#123; &quot;term&quot;: &#123; &quot;category&quot;: &quot;ebooks&quot; &#125; &#125; &#125;&#125; term æŸ¥è¯¢è¢«æ”¾ç½®åœ¨ constant_score ä¸­ï¼Œè½¬æˆä¸è¯„åˆ†çš„filterã€‚è¿™ç§æ–¹å¼å¯ä»¥ç”¨æ¥å–ä»£åªæœ‰ filter è¯­å¥çš„ bool æŸ¥è¯¢ã€‚ ç¬¬ä¸‰èŠ‚ ElasticSearchåŸç†3.1 è§£æesçš„åˆ†å¸ƒå¼æ¶æ„3.1.1 åˆ†å¸ƒå¼æ¶æ„çš„é€æ˜éšè—ç‰¹æ€§ ElasticSearchæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œéšè—äº†å¤æ‚çš„å¤„ç†æœºåˆ¶ åˆ†ç‰‡æœºåˆ¶ï¼šæˆ‘ä»¬ä¸ç”¨å…³å¿ƒæ•°æ®æ˜¯æŒ‰ç…§ä»€ä¹ˆæœºåˆ¶åˆ†ç‰‡çš„ã€æœ€åæ”¾å…¥åˆ°å“ªä¸ªåˆ†ç‰‡ä¸­ åˆ†ç‰‡çš„å‰¯æœ¬ï¼šé›†ç¾¤å‘ç°æœºåˆ¶(cluster discovery)ï¼šæ¯”å¦‚å½“å‰æˆ‘ä»¬å¯åŠ¨äº†ä¸€ä¸ªesè¿›ç¨‹ï¼Œå½“å¯åŠ¨äº†ç¬¬äºŒä¸ªesè¿›ç¨‹æ—¶ï¼Œè¿™ä¸ªè¿›ç¨‹ä½œä¸ºä¸€ä¸ªnodeè‡ªåŠ¨å°±å‘ç°äº†é›†ç¾¤ï¼Œå¹¶ä¸”åŠ å…¥äº†è¿›å»shardè´Ÿè½½å‡è¡¡ï¼šæ¯”å¦‚ç°åœ¨æœ‰10shardï¼Œé›†ç¾¤ä¸­æœ‰3ä¸ªèŠ‚ç‚¹ï¼Œesä¼šè¿›è¡Œå‡è¡¡çš„è¿›è¡Œåˆ†é…ï¼Œä»¥ä¿æŒæ¯ä¸ªèŠ‚ç‚¹å‡è¡¡çš„è´Ÿè½½è¯·æ±‚ è¯·æ±‚è·¯ç”± 3.1.2 æ‰©å®¹æœºåˆ¶å‚ç›´æ‰©å®¹ï¼šè´­ç½®æ–°çš„æœºå™¨ï¼Œæ›¿æ¢å·²æœ‰çš„æœºå™¨ æ°´å¹³æ‰©å®¹ï¼šç›´æ¥å¢åŠ æœºå™¨ 3.1.3 rebalanceå¢åŠ æˆ–å‡å°‘èŠ‚ç‚¹æ—¶ä¼šè‡ªåŠ¨å‡è¡¡ 3.1.4 masterèŠ‚ç‚¹ä¸»èŠ‚ç‚¹çš„ä¸»è¦èŒè´£æ˜¯å’Œé›†ç¾¤æ“ä½œç›¸å…³çš„å†…å®¹ï¼Œå¦‚åˆ›å»ºæˆ–åˆ é™¤ç´¢å¼•ï¼Œè·Ÿè¸ªå“ªäº›èŠ‚ç‚¹æ˜¯ç¾¤é›†çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶å†³å®šå“ªäº›åˆ†ç‰‡åˆ†é…ç»™ç›¸å…³çš„èŠ‚ç‚¹ã€‚ç¨³å®šçš„ä¸»èŠ‚ç‚¹å¯¹é›†ç¾¤çš„å¥åº·æ˜¯éå¸¸é‡è¦çš„ã€‚ 3.1.5 èŠ‚ç‚¹å¯¹ç­‰æ¯ä¸ªèŠ‚ç‚¹éƒ½èƒ½æ¥æ”¶è¯·æ±‚æ¯ä¸ªèŠ‚ç‚¹æ¥æ”¶åˆ°è¯·æ±‚åéƒ½èƒ½æŠŠè¯¥è¯·æ±‚è·¯ç”±åˆ°æœ‰ç›¸å…³æ•°æ®çš„å…¶å®ƒèŠ‚ç‚¹ä¸Šæ¥æ”¶åŸå§‹è¯·æ±‚çš„èŠ‚ç‚¹è´Ÿè´£é‡‡é›†æ•°æ®å¹¶è¿”å›ç»™å®¢æˆ·ç«¯ 3.2 åˆ†ç‰‡å’Œå‰¯æœ¬æœºåˆ¶ indexåŒ…å«å¤šä¸ªshard æ¯ä¸ªshardéƒ½æ˜¯ä¸€ä¸ªæœ€å°å·¥ä½œå•å…ƒï¼Œæ‰¿è½½éƒ¨åˆ†æ•°æ®ï¼›æ¯ä¸ªshardéƒ½æ˜¯ä¸€ä¸ªluceneå®ä¾‹ï¼Œæœ‰å®Œæ•´çš„å»ºç«‹ç´¢å¼•å’Œå¤„ç†è¯·æ±‚çš„èƒ½åŠ› å¢å‡èŠ‚ç‚¹æ—¶ï¼Œshardä¼šè‡ªåŠ¨åœ¨nodesä¸­è´Ÿè½½å‡è¡¡ primary shardå’Œreplica shardï¼Œæ¯ä¸ªdocumentè‚¯å®šåªå­˜åœ¨äºæŸä¸€ä¸ªprimary shardä»¥åŠå…¶å¯¹åº”çš„replica shardä¸­ï¼Œä¸å¯èƒ½å­˜åœ¨äºå¤šä¸ªprimary shard replica shardæ˜¯primary shardçš„å‰¯æœ¬ï¼Œè´Ÿè´£å®¹é”™ï¼Œä»¥åŠæ‰¿æ‹…è¯»è¯·æ±‚è´Ÿè½½ primary shardçš„æ•°é‡åœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™å°±å›ºå®šäº†ï¼Œreplica shardçš„æ•°é‡å¯ä»¥éšæ—¶ä¿®æ”¹ primary shardçš„é»˜è®¤æ•°é‡æ˜¯5ï¼Œreplicaé»˜è®¤æ˜¯1ï¼Œé»˜è®¤æœ‰10ä¸ªshardï¼Œ5ä¸ªprimary shardï¼Œ5ä¸ªreplica shard primary shardä¸èƒ½å’Œè‡ªå·±çš„replica shardæ”¾åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ˆå¦åˆ™èŠ‚ç‚¹å®•æœºï¼Œprimary shardå’Œå‰¯æœ¬éƒ½ä¸¢å¤±ï¼Œèµ·ä¸åˆ°å®¹é”™çš„ä½œç”¨ï¼‰ï¼Œä½†æ˜¯å¯ä»¥å’Œå…¶ä»–primary shardçš„replica shardæ”¾åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Š 3.3 å•èŠ‚ç‚¹ç¯å¢ƒä¸‹åˆ›å»ºç´¢å¼•åˆ†æPUT /myindex &#123; &quot;settings&quot; : &#123; &quot;number_of_shards&quot; : 3, &quot;number_of_replicas&quot; : 1 &#125;&#125; è¿™ä¸ªæ—¶å€™ï¼Œåªä¼šå°†3ä¸ªprimary shardåˆ†é…åˆ°ä»…æœ‰çš„ä¸€ä¸ªnodeä¸Šå»ï¼Œå¦å¤–3ä¸ªreplica shardæ˜¯æ— æ³•åˆ†é…çš„ï¼ˆä¸€ä¸ªshardçš„å‰¯æœ¬replicaï¼Œä»–ä»¬ä¸¤ä¸ªæ˜¯ä¸èƒ½åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹çš„ï¼‰ã€‚é›†ç¾¤å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯ä¸€æ—¦å‡ºç°èŠ‚ç‚¹å®•æœºï¼Œæ•°æ®å…¨éƒ¨ä¸¢å¤±ï¼Œè€Œä¸”é›†ç¾¤ä¸å¯ç”¨ï¼Œæ— æ³•æ¥æ”¶ä»»ä½•è¯·æ±‚ã€‚ 3.4 ä¸¤ä¸ªèŠ‚ç‚¹ç¯å¢ƒä¸‹åˆ›å»ºç´¢å¼•åˆ†æå°†3ä¸ªprimary shardåˆ†é…åˆ°ä¸€ä¸ªnodeä¸Šå»ï¼Œå¦å¤–3ä¸ªreplica shardåˆ†é…åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Š primary shard å’Œreplica shard ä¿æŒåŒæ­¥ primary shard å’Œreplica shard éƒ½å¯ä»¥å¤„ç†å®¢æˆ·ç«¯çš„è¯»è¯·æ±‚ 3.5 æ°´å¹³æ‰©å®¹çš„è¿‡ç¨‹ æ‰©å®¹åprimary shardå’Œreplica shardä¼šè‡ªåŠ¨çš„è´Ÿè½½å‡è¡¡ æ‰©å®¹åæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„shardä¼šå‡å°‘ï¼Œé‚£ä¹ˆåˆ†é…ç»™æ¯ä¸ªshardçš„CPUï¼Œå†…å­˜ï¼ŒIOèµ„æºä¼šæ›´å¤šï¼Œæ€§èƒ½æé«˜ æ‰©å®¹çš„æé™ï¼Œå¦‚æœæœ‰6ä¸ªshardï¼Œæ‰©å®¹çš„æé™å°±æ˜¯6ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šä¸€ä¸ªshardï¼Œå¦‚æœæƒ³è¶…å‡ºæ‰©å®¹çš„æé™ï¼Œæ¯”å¦‚è¯´æ‰©å®¹åˆ°9ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥å¢åŠ replica shardçš„ä¸ªæ•° 6ä¸ªshardï¼Œ3ä¸ªèŠ‚ç‚¹ï¼Œæœ€å¤šèƒ½æ‰¿å—å‡ ä¸ªèŠ‚ç‚¹æ‰€åœ¨çš„æœåŠ¡å™¨å®•æœºï¼Ÿ(å®¹é”™æ€§)ä»»ä½•ä¸€å°æœåŠ¡å™¨å®•æœºéƒ½ä¼šä¸¢å¤±éƒ¨åˆ†æ•°æ®ã€‚ä¸ºäº†æé«˜å®¹é”™æ€§ï¼Œå¢åŠ shardçš„ä¸ªæ•°ï¼š9ä¸ªshardï¼Œ(3ä¸ªprimary shardï¼Œ6ä¸ªreplicashard)ï¼Œè¿™æ ·å°±èƒ½å®¹å¿æœ€å¤šä¸¤å°æœåŠ¡å™¨å®•æœºäº† æ€»ç»“ï¼šæ‰©å®¹æ˜¯ä¸ºäº†æé«˜ç³»ç»Ÿçš„ååé‡ï¼ŒåŒæ—¶ä¹Ÿè¦è€ƒè™‘å®¹é”™æ€§ï¼Œä¹Ÿå°±æ˜¯è®©å°½å¯èƒ½å¤šçš„æœåŠ¡å™¨å®•æœºè¿˜èƒ½ä¿è¯æ•°æ®ä¸ä¸¢å¤± 3.6ElasticSearchçš„å®¹é”™æœºåˆ¶ä»¥9ä¸ªshardï¼Œ3ä¸ªèŠ‚ç‚¹ä¸ºä¾‹ï¼š 1.å¦‚æœmaster node å®•æœºï¼Œæ­¤æ—¶ä¸æ˜¯æ‰€æœ‰çš„primary shardéƒ½æ˜¯Active statusï¼Œæ‰€ä»¥æ­¤æ—¶çš„é›†ç¾¤çŠ¶æ€æ˜¯redã€‚ å®¹é”™å¤„ç†çš„ç¬¬ä¸€æ­¥:æ˜¯é€‰ä¸¾ä¸€å°æœåŠ¡å™¨ä½œä¸ºmasterå®¹é”™å¤„ç†çš„ç¬¬äºŒæ­¥:æ–°é€‰ä¸¾å‡ºçš„masterä¼šæŠŠæŒ‚æ‰çš„primary shardçš„æŸä¸ªreplica shard æå‡ä¸ºprimary shard,æ­¤æ—¶é›†ç¾¤çš„çŠ¶æ€ä¸ºyellowï¼Œå› ä¸ºå°‘äº†ä¸€ä¸ªreplica shardï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„replica shardéƒ½æ˜¯active status å®¹é”™å¤„ç†çš„ç¬¬ä¸‰æ­¥ï¼šé‡å¯æ•…éšœæœºï¼Œæ–°masterä¼šæŠŠæ‰€æœ‰çš„å‰¯æœ¬éƒ½å¤åˆ¶ä¸€ä»½åˆ°è¯¥èŠ‚ç‚¹ä¸Šï¼Œï¼ˆåŒæ­¥ä¸€ä¸‹å®•æœºåå‘ç”Ÿçš„ä¿®æ”¹ï¼‰ï¼Œæ­¤æ—¶é›†ç¾¤çš„çŠ¶æ€ä¸ºgreenï¼Œå› ä¸ºæ‰€æœ‰çš„primary shardå’Œreplica shardéƒ½æ˜¯Active status 3.7æ–‡æ¡£çš„æ ¸å¿ƒå…ƒæ•°æ® _index: è¯´æ˜äº†ä¸€ä¸ªæ–‡æ¡£å­˜å‚¨åœ¨å“ªä¸ªç´¢å¼•ä¸­ åŒä¸€ä¸ªç´¢å¼•ä¸‹å­˜æ”¾çš„æ˜¯ç›¸ä¼¼çš„æ–‡æ¡£(æ–‡æ¡£çš„fieldå¤šæ•°æ˜¯ç›¸åŒçš„) ç´¢å¼•åå¿…é¡»æ˜¯å°å†™çš„ï¼Œä¸èƒ½ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼Œä¸èƒ½åŒ…æ‹¬é€—å· _type: è¡¨ç¤ºæ–‡æ¡£å±äºç´¢å¼•ä¸­çš„å“ªä¸ªç±»å‹ ä¸€ä¸ªç´¢å¼•ä¸‹åªèƒ½æœ‰ä¸€ä¸ªtype ç±»å‹åå¯ä»¥æ˜¯å¤§å†™ä¹Ÿå¯ä»¥æ˜¯å°å†™çš„ï¼Œä¸èƒ½ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼Œä¸èƒ½åŒ…æ‹¬é€—å· _id: æ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†ï¼Œå’Œç´¢å¼•ï¼Œç±»å‹ç»„åˆåœ¨ä¸€èµ·å”¯ä¸€æ ‡è¯†äº†ä¸€ä¸ªæ–‡æ¡£ å¯ä»¥æ‰‹åŠ¨æŒ‡å®šå€¼ï¼Œä¹Ÿå¯ä»¥ç”±esæ¥ç”Ÿæˆè¿™ä¸ªå€¼ 3.8 æ–‡æ¡£idç”Ÿæˆæ–¹å¼ æ‰‹åŠ¨æŒ‡å®š put /index/type/66 é€šå¸¸æ˜¯æŠŠå…¶å®ƒç³»ç»Ÿçš„å·²æœ‰æ•°æ®å¯¼å…¥åˆ°esæ—¶ ç”±esç”Ÿæˆidå€¼ post /index/type esç”Ÿæˆçš„idé•¿åº¦ä¸º20ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨çš„æ˜¯base64ç¼–ç ï¼ŒURLå®‰å…¨ï¼Œä½¿ç”¨çš„æ˜¯GUIDç®—æ³•ï¼Œåˆ†å¸ƒå¼ä¸‹å¹¶å‘ç”Ÿæˆidå€¼æ—¶ä¸ä¼šå†²çª 3.9 _sourceå…ƒæ•°æ®åˆ†æå…¶å®å°±æ˜¯æˆ‘ä»¬åœ¨æ·»åŠ æ–‡æ¡£æ—¶request bodyä¸­çš„å†…å®¹ æŒ‡å®šè¿”å›çš„ç»“æœä¸­å«æœ‰å“ªäº›å­—æ®µï¼š get /index/type/1?_source=name 3.10 æ”¹å˜æ–‡æ¡£å†…å®¹åŸç†è§£ææ›¿æ¢æ–¹å¼ï¼š PUT /lib/user/4 &#123; &quot;first_name&quot; : &quot;Jane&quot;,&quot;last_name&quot; : &quot;Lucy&quot;,&quot;age&quot; : 24,&quot;about&quot; : &quot;I like to collect rock albums&quot;,&quot;interests&quot;: [ &quot;music&quot; ]&#125; ä¿®æ”¹æ–¹å¼(partial update)ï¼š POST /lib/user/2/_update &#123; &quot;doc&quot;:&#123; &quot;age&quot;:26 &#125;&#125; åˆ é™¤æ–‡æ¡£ï¼šæ ‡è®°ä¸ºdeletedï¼Œéšç€æ•°æ®é‡çš„å¢åŠ ï¼Œesä¼šé€‰æ‹©åˆé€‚çš„æ—¶é—´åˆ é™¤æ‰ 3.11 åŸºäºgroovyè„šæœ¬æ‰§è¡Œpartial updateesæœ‰å†…ç½®çš„è„šæœ¬æ”¯æŒï¼Œå¯ä»¥åŸºäºgroovyè„šæœ¬å®ç°å¤æ‚çš„æ“ä½œ ä¿®æ”¹å¹´é¾„ POST /lib/user/4/_update &#123; &quot;script&quot;: &quot;ctx._source.age+=1&quot;&#125; ä¿®æ”¹åå­— POST /lib/user/4/_update &#123; &quot;script&quot;: &quot;ctx._source.last_name+=&apos;hehe&apos;&quot;&#125; æ·»åŠ çˆ±å¥½ POST /lib/user/4/_update &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;ctx._source.interests.add(params.tag)&quot;, &quot;params&quot;: &#123; &quot;tag&quot;:&quot;picture&quot; &#125; &#125;&#125; åˆ é™¤çˆ±å¥½ POST /lib/user/4/_update &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;ctx._source.interests.remove(ctx._source.interests.indexOf(params.tag))&quot;, &quot;params&quot;: &#123; &quot;tag&quot;:&quot;picture&quot; &#125; &#125;&#125; åˆ é™¤æ–‡æ¡£ POST /lib/user/4/_update &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;ctx.op=ctx._source.age==params.count?&apos;delete&apos;:&apos;none&apos;&quot;, &quot;params&quot;: &#123; &quot;count&quot;:29 &#125; &#125;&#125; upsert POST /lib/user/4/_update &#123; &quot;script&quot;: &quot;ctx._source.age += 1&quot;, &quot;upsert&quot;: &#123; &quot;first_name&quot; : &quot;Jane&quot;, &quot;last_name&quot; : &quot;Lucy&quot;, &quot;age&quot; : 20, &quot;about&quot; : &quot;I like to collect rock albums&quot;, &quot;interests&quot;: [ &quot;music&quot; ] &#125;&#125; 3.12 partial update å¤„ç†å¹¶å‘å†²çªä½¿ç”¨çš„æ˜¯ä¹è§‚é”:_version retry_on_conflict: POST /lib/user/4/_update?retry_on_conflict=3 é‡æ–°è·å–æ–‡æ¡£æ•°æ®å’Œç‰ˆæœ¬ä¿¡æ¯è¿›è¡Œæ›´æ–°ï¼Œä¸æ–­çš„æ“ä½œï¼Œæœ€å¤šæ“ä½œçš„æ¬¡æ•°å°±æ˜¯retry_on_conflictçš„å€¼ 3.13 æ–‡æ¡£æ•°æ®è·¯ç”±åŸç†è§£æ æ–‡æ¡£è·¯ç”±åˆ°åˆ†ç‰‡ä¸Šï¼š ä¸€ä¸ªç´¢å¼•ç”±å¤šä¸ªåˆ†ç‰‡æ„æˆï¼Œå½“æ·»åŠ (åˆ é™¤ï¼Œä¿®æ”¹)ä¸€ä¸ªæ–‡æ¡£æ—¶ï¼Œeså°±éœ€è¦å†³å®šè¿™ä¸ªæ–‡æ¡£å­˜å‚¨åœ¨å“ªä¸ªåˆ†ç‰‡ä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ç§°ä¸ºæ•°æ®è·¯ç”±(routing) è·¯ç”±ç®—æ³•ï¼š shard=hash(routing) % number_of_pirmary_shards ç¤ºä¾‹ï¼šä¸€ä¸ªç´¢å¼•ï¼Œ3ä¸ªprimary shard (1)æ¯æ¬¡å¢åˆ æ”¹æŸ¥æ—¶ï¼Œéƒ½æœ‰ä¸€ä¸ªroutingå€¼ï¼Œé»˜è®¤æ˜¯æ–‡æ¡£çš„_idçš„å€¼ (2)å¯¹è¿™ä¸ªroutingå€¼ä½¿ç”¨å“ˆå¸Œå‡½æ•°è¿›è¡Œè®¡ç®— (3)è®¡ç®—å‡ºçš„å€¼å†å’Œä¸»åˆ†ç‰‡ä¸ªæ•°å–ä½™æ•° ä½™æ•°è‚¯å®šåœ¨0â€”-ï¼ˆnumber_of_pirmary_shards-1ï¼‰ä¹‹é—´ï¼Œæ–‡æ¡£å°±åœ¨å¯¹åº”çš„shardä¸Š routingå€¼é»˜è®¤æ˜¯æ–‡æ¡£çš„_idçš„å€¼ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªå€¼ï¼Œæ‰‹åŠ¨æŒ‡å®šå¯¹äºè´Ÿè½½å‡è¡¡ä»¥åŠæé«˜æ‰¹é‡è¯»å–çš„æ€§èƒ½éƒ½æœ‰å¸®åŠ© primary shardä¸ªæ•°ä¸€æ—¦ç¡®å®šå°±ä¸èƒ½ä¿®æ”¹äº† 3.14 æ–‡æ¡£å¢åˆ æ”¹å†…éƒ¨åŸç†1:å‘é€å¢åˆ æ”¹è¯·æ±‚æ—¶ï¼Œå¯ä»¥é€‰æ‹©ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹å°±æˆäº†åè°ƒèŠ‚ç‚¹(coordinating node) 2.åè°ƒèŠ‚ç‚¹ä½¿ç”¨è·¯ç”±ç®—æ³•è¿›è¡Œè·¯ç”±ï¼Œç„¶åå°†è¯·æ±‚è½¬åˆ°primary shardæ‰€åœ¨èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹å¤„ç†è¯·æ±‚ï¼Œå¹¶æŠŠæ•°æ®åŒæ­¥åˆ°å®ƒçš„replica shard 3.åè°ƒèŠ‚ç‚¹å¯¹å®¢æˆ·ç«¯åšå‡ºå“åº” 3.15 å†™ä¸€è‡´æ€§åŸç†å’Œquorumæœºåˆ¶ ä»»ä½•ä¸€ä¸ªå¢åˆ æ”¹æ“ä½œéƒ½å¯ä»¥è·Ÿä¸Šä¸€ä¸ªå‚æ•°consistency å¯ä»¥ç»™è¯¥å‚æ•°æŒ‡å®šçš„å€¼ï¼š one: (primary shard)åªè¦æœ‰ä¸€ä¸ªprimary shardæ˜¯æ´»è·ƒçš„å°±å¯ä»¥æ‰§è¡Œ all: (all shard)æ‰€æœ‰çš„primary shardå’Œreplica shardéƒ½æ˜¯æ´»è·ƒçš„æ‰èƒ½æ‰§è¡Œ quorum: (default) é»˜è®¤å€¼ï¼Œå¤§éƒ¨åˆ†shardæ˜¯æ´»è·ƒçš„æ‰èƒ½æ‰§è¡Œ ï¼ˆä¾‹å¦‚å…±æœ‰6ä¸ªshardï¼Œè‡³å°‘æœ‰3ä¸ªshardæ˜¯æ´»è·ƒçš„æ‰èƒ½æ‰§è¡Œå†™æ“ä½œï¼‰ quorumæœºåˆ¶ï¼šå¤šæ•°shardéƒ½æ˜¯å¯ç”¨çš„ï¼Œ int((primary+number_of_replica)/2)+1 ä¾‹å¦‚ï¼š3ä¸ªprimary shardï¼Œ1ä¸ªreplica int((3+1)/2)+1=3 è‡³å°‘3ä¸ªshardæ˜¯æ´»è·ƒçš„ æ³¨æ„ï¼šå¯èƒ½å‡ºç°shardä¸èƒ½åˆ†é…é½å…¨çš„æƒ…å†µ æ¯”å¦‚ï¼š1ä¸ªprimary shard,1ä¸ªreplicaint((1+1)/2)+1=2ä½†æ˜¯å¦‚æœåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºprimary shardå’Œreplica shardä¸èƒ½åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥ä»ç„¶ä¸èƒ½æ‰§è¡Œå†™æ“ä½œ å†ä¸¾ä¾‹ï¼š1ä¸ªprimary shard,3ä¸ªreplica,2ä¸ªèŠ‚ç‚¹ int((1+3)/2)+1=3 æœ€å:å½“æ´»è·ƒçš„shardçš„ä¸ªæ•°æ²¡æœ‰è¾¾åˆ°è¦æ±‚æ—¶ï¼Œesé»˜è®¤ä¼šç­‰å¾…ä¸€åˆ†é’Ÿï¼Œå¦‚æœåœ¨ç­‰å¾…çš„æœŸé—´æ´»è·ƒçš„shardçš„ä¸ªæ•°æ²¡æœ‰å¢åŠ ï¼Œåˆ™æ˜¾ç¤ºtimeout put /index/type/id?timeout=60s 3.16 æ–‡æ¡£æŸ¥è¯¢å†…éƒ¨åŸç†ç¬¬ä¸€æ­¥ï¼šæŸ¥è¯¢è¯·æ±‚å‘ç»™ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹å°±æˆäº†coordinating nodeï¼Œè¯¥èŠ‚ç‚¹ä½¿ç”¨è·¯ç”±ç®—æ³•ç®—å‡ºæ–‡æ¡£æ‰€åœ¨çš„primary shard ç¬¬äºŒæ­¥ï¼šåè°ƒèŠ‚ç‚¹æŠŠè¯·æ±‚è½¬å‘ç»™primary shardä¹Ÿå¯ä»¥è½¬å‘ç»™replica shard(ä½¿ç”¨è½®è¯¢è°ƒåº¦ç®—æ³•(Round-Robin Schedulingï¼ŒæŠŠè¯·æ±‚å¹³å‡åˆ†é…è‡³primary shard å’Œreplica shard) ç¬¬ä¸‰æ­¥ï¼šå¤„ç†è¯·æ±‚çš„èŠ‚ç‚¹æŠŠç»“æœè¿”å›ç»™åè°ƒèŠ‚ç‚¹ï¼Œåè°ƒèŠ‚ç‚¹å†è¿”å›ç»™åº”ç”¨ç¨‹åº ç‰¹æ®Šæƒ…å†µï¼šè¯·æ±‚çš„æ–‡æ¡£è¿˜åœ¨å»ºç«‹ç´¢å¼•çš„è¿‡ç¨‹ä¸­ï¼Œprimary shardä¸Šå­˜åœ¨ï¼Œä½†replica sharä¸Šä¸å­˜åœ¨ï¼Œä½†æ˜¯è¯·æ±‚è¢«è½¬å‘åˆ°äº†replica shardä¸Šï¼Œè¿™æ—¶å°±ä¼šæç¤ºæ‰¾ä¸åˆ°æ–‡æ¡£ 3.17 bulkæ‰¹é‡æ“ä½œçš„jsonæ ¼å¼è§£æbulkçš„æ ¼å¼ï¼š {action:{metadata}}\\n {requstbody}\\n ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å¦‚ä¸‹æ ¼å¼ï¼š [&#123;&quot;action&quot;: &#123;&#125;,&quot;data&quot;: &#123;&#125;&#125;] è¿™ç§æ–¹å¼å¯è¯»æ€§å¥½ï¼Œä½†æ˜¯å†…éƒ¨å¤„ç†å°±éº»çƒ¦äº†ï¼š å°†jsonæ•°ç»„è§£æä¸ºJSONArrayå¯¹è±¡ï¼Œåœ¨å†…å­˜ä¸­å°±éœ€è¦æœ‰ä¸€ä»½jsonæ–‡æœ¬çš„æ‹·è´ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªJSONArrayå¯¹è±¡ã€‚ è§£æjsonæ•°ç»„é‡Œçš„æ¯ä¸ªjsonï¼Œå¯¹æ¯ä¸ªè¯·æ±‚ä¸­çš„documentè¿›è¡Œè·¯ç”± ä¸ºè·¯ç”±åˆ°åŒä¸€ä¸ªshardä¸Šçš„å¤šä¸ªè¯·æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªè¯·æ±‚æ•°ç»„ å°†è¿™ä¸ªè¯·æ±‚æ•°ç»„åºåˆ—åŒ– å°†åºåˆ—åŒ–åçš„è¯·æ±‚æ•°ç»„å‘é€åˆ°å¯¹åº”çš„èŠ‚ç‚¹ä¸Šå» è€—è´¹æ›´å¤šå†…å­˜ï¼Œå¢åŠ javaè™šæ‹Ÿæœºå¼€é”€ ä¸ç”¨å°†å…¶è½¬æ¢ä¸ºjsonå¯¹è±¡ï¼Œç›´æ¥æŒ‰ç…§æ¢è¡Œç¬¦åˆ‡å‰²jsonï¼Œå†…å­˜ä¸­ä¸éœ€è¦jsonæ–‡æœ¬çš„æ‹·è´ å¯¹æ¯ä¸¤ä¸ªä¸€ç»„çš„jsonï¼Œè¯»å–metaï¼Œè¿›è¡Œdocumentè·¯ç”± ç›´æ¥å°†å¯¹åº”çš„jsonå‘é€åˆ°nodeä¸Šå» 3.18 æŸ¥è¯¢ç»“æœåˆ†æ&#123; &quot;took&quot;: 419, &quot;timed_out&quot;: false, &quot;_shards&quot;: &#123; &quot;total&quot;: 3, &quot;successful&quot;: 3, &quot;skipped&quot;: 0, &quot;failed&quot;: 0 &#125;, &quot;hits&quot;: &#123; &quot;total&quot;: 3, &quot;max_score&quot;: 0.6931472, &quot;hits&quot;: [ &#123; &quot;_index&quot;: &quot;lib3&quot;, &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: &quot;3&quot;, &quot;_score&quot;: 0.6931472, &quot;_source&quot;: &#123; &quot;address&quot;: &quot;bei jing hai dian qu qing he zhen&quot;, &quot;name&quot;: &quot;lisi&quot; &#125; &#125;, &#123; &quot;_index&quot;: &quot;lib3&quot;, &quot;_type&quot;: &quot;user&quot;, &quot;_id&quot;: &quot;2&quot;, &quot;_score&quot;: 0.47000363, &quot;_source&quot;: &#123; &quot;address&quot;: &quot;bei jing hai dian qu qing he zhen&quot;, &quot;name&quot;: &quot;zhaoming&quot; &#125; &#125; tookï¼šæŸ¥è¯¢è€—è´¹çš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ _shardsï¼šå…±è¯·æ±‚äº†å¤šå°‘ä¸ªshard totalï¼šæŸ¥è¯¢å‡ºçš„æ–‡æ¡£æ€»ä¸ªæ•° max_scoreï¼šæœ¬æ¬¡æŸ¥è¯¢ä¸­ï¼Œç›¸å…³åº¦åˆ†æ•°çš„æœ€å¤§å€¼ï¼Œæ–‡æ¡£å’Œæ­¤æ¬¡æŸ¥è¯¢çš„åŒ¹é…åº¦è¶Šé«˜ï¼Œ_scoreçš„å€¼è¶Šå¤§ï¼Œæ’ä½è¶Šé å‰ hitsï¼šé»˜è®¤æŸ¥è¯¢å‰10ä¸ªæ–‡æ¡£ timed_outï¼š GET /lib3/user/_search?timeout=10ms &#123; &quot;_source&quot;: [&quot;address&quot;,&quot;name&quot;], &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;interests&quot;: &quot;changge&quot; &#125; &#125;&#125; 3.19 å¤šindexï¼Œå¤štypeæŸ¥è¯¢æ¨¡å¼GET _search GET /lib/_search GET /lib,lib3/_search GET /3,4/_search GET /lib/user/_search GET /lib,lib4/user,items/_search GET /_all/_search GET /_all/user,items/_search 3.20 åˆ†é¡µæŸ¥è¯¢ä¸­çš„deep pagingé—®é¢˜GET /lib3/user/_search &#123; &quot;from&quot;:0, &quot;size&quot;:2, &quot;query&quot;:&#123; &quot;terms&quot;:&#123; &quot;interests&quot;: [&quot;hejiu&quot;,&quot;changge&quot;] &#125; &#125;&#125; GET /_search?from=0&amp;size=3 deep paging:æŸ¥è¯¢çš„å¾ˆæ·±ï¼Œæ¯”å¦‚ä¸€ä¸ªç´¢å¼•æœ‰ä¸‰ä¸ªprimary shardï¼Œåˆ†åˆ«å­˜å‚¨äº†6000æ¡æ•°æ®ï¼Œæˆ‘ä»¬è¦å¾—åˆ°ç¬¬100é¡µçš„æ•°æ®(æ¯é¡µ10æ¡)ï¼Œç±»ä¼¼è¿™ç§æƒ…å†µå°±å«deep paging å¦‚ä½•å¾—åˆ°ç¬¬100é¡µçš„10æ¡æ•°æ®ï¼Ÿ åœ¨æ¯ä¸ªshardä¸­æœç´¢990åˆ°999è¿™10æ¡æ•°æ®ï¼Œç„¶åç”¨è¿™30æ¡æ•°æ®æ’åºï¼Œæ’åºä¹‹åå–10æ¡æ•°æ®å°±æ˜¯è¦æœç´¢çš„æ•°æ®ï¼Œè¿™ç§åšæ³•æ˜¯é”™çš„ï¼Œå› ä¸º3ä¸ªshardä¸­çš„æ•°æ®çš„_scoreåˆ†æ•°ä¸ä¸€æ ·ï¼Œå¯èƒ½è¿™æŸä¸€ä¸ªshardä¸­ç¬¬ä¸€æ¡æ•°æ®çš„_scoreåˆ†æ•°æ¯”å¦ä¸€ä¸ªshardä¸­ç¬¬1000æ¡éƒ½è¦é«˜ï¼Œæ‰€ä»¥åœ¨æ¯ä¸ªshardä¸­æœç´¢990åˆ°999è¿™10æ¡æ•°æ®ç„¶åæ’åºçš„åšæ³•æ˜¯ä¸æ­£ç¡®çš„ã€‚ æ­£ç¡®çš„åšæ³•æ˜¯æ¯ä¸ªshardæŠŠ0åˆ°999æ¡æ•°æ®å…¨éƒ¨æœç´¢å‡ºæ¥ï¼ˆæŒ‰æ’åºé¡ºåºï¼‰ï¼Œç„¶åå…¨éƒ¨è¿”å›ç»™coordinate nodeï¼Œç”±coordinate nodeæŒ‰_scoreåˆ†æ•°æ’åºåï¼Œå–å‡ºç¬¬100é¡µçš„10æ¡æ•°æ®ï¼Œç„¶åè¿”å›ç»™å®¢æˆ·ç«¯ã€‚ deep pagingæ€§èƒ½é—®é¢˜ è€—è´¹ç½‘ç»œå¸¦å®½ï¼Œå› ä¸ºæœç´¢è¿‡æ·±çš„è¯ï¼Œå„shardè¦æŠŠæ•°æ®ä¼ é€ç»™coordinate nodeï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æœ‰å¤§é‡æ•°æ®ä¼ é€’çš„ï¼Œæ¶ˆè€—ç½‘ç»œï¼Œ æ¶ˆè€—å†…å­˜ï¼Œå„shardè¦æŠŠæ•°æ®ä¼ é€ç»™coordinate nodeï¼Œè¿™ä¸ªä¼ é€’å›æ¥çš„æ•°æ®ï¼Œæ˜¯è¢«coordinate nodeä¿å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œè¿™æ ·ä¼šå¤§é‡æ¶ˆè€—å†…å­˜ã€‚ æ¶ˆè€—cpu coordinate nodeè¦æŠŠä¼ å›æ¥çš„æ•°æ®è¿›è¡Œæ’åºï¼Œè¿™ä¸ªæ’åºè¿‡ç¨‹å¾ˆæ¶ˆè€—cpu. é‰´äºdeep pagingçš„æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥åº”å°½é‡å‡å°‘ä½¿ç”¨ã€‚ 3.21 query stringæŸ¥è¯¢åŠcopy_toè§£æGET /lib3/user/_search?q=interests:changge GET /lib3/user/_search?q=+interests:changge GET /lib3/user/_search?q=-interests:changge copy_toå­—æ®µæ˜¯æŠŠå…¶å®ƒå­—æ®µä¸­çš„å€¼ï¼Œä»¥ç©ºæ ¼ä¸ºåˆ†éš”ç¬¦ç»„æˆä¸€ä¸ªå¤§å­—ç¬¦ä¸²ï¼Œç„¶åè¢«åˆ†æå’Œç´¢å¼•ï¼Œä½†æ˜¯ä¸å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒèƒ½è¢«æŸ¥è¯¢ï¼Œä½†ä¸èƒ½è¢«å–å›æ˜¾ç¤ºã€‚ æ³¨æ„:copy_toæŒ‡å‘çš„å­—æ®µå­—æ®µç±»å‹è¦ä¸ºï¼štext å½“æ²¡æœ‰æŒ‡å®šfieldæ—¶ï¼Œå°±ä¼šä»copy_toå­—æ®µä¸­æŸ¥è¯¢GET /lib3/user/_search?q=changge 3.22å­—ç¬¦ä¸²æ’åºé—®é¢˜å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µè¿›è¡Œæ’åºé€šå¸¸ä¸å‡†ç¡®ï¼Œå› ä¸ºå·²ç»è¢«åˆ†è¯æˆå¤šä¸ªè¯æ¡äº† è§£å†³æ–¹å¼ï¼šå¯¹å­—æ®µç´¢å¼•ä¸¤æ¬¡ï¼Œä¸€æ¬¡ç´¢å¼•åˆ†è¯ï¼ˆç”¨äºæœç´¢ï¼‰ï¼Œä¸€æ¬¡ç´¢å¼•ä¸åˆ†è¯(ç”¨äºæ’åº) GET /lib3/_search GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;sort&quot;: [ &#123; &quot;interests&quot;: &#123; &quot;order&quot;: &quot;desc&quot; &#125; &#125; ]&#125; GET /lib3/user/_search &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;sort&quot;: [ &#123; &quot;interests.raw&quot;: &#123; &quot;order&quot;: &quot;asc&quot; &#125; &#125; ]&#125; DELETE lib3 PUT /lib3 &#123; &quot;settings&quot;:&#123; &quot;number_of_shards&quot; : 3, &quot;number_of_replicas&quot; : 0 &#125;, &quot;mappings&quot;:&#123; &quot;user&quot;:&#123; &quot;properties&quot;:&#123; &quot;name&quot;: &#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;address&quot;: &#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;age&quot;: &#123;&quot;type&quot;:&quot;integer&quot;&#125;, &quot;birthday&quot;: &#123;&quot;type&quot;:&quot;date&quot;&#125;, &quot;interests&quot;: &#123; &quot;type&quot;:&quot;text&quot;, &quot;fields&quot;: &#123; &quot;raw&quot;:&#123; &quot;type&quot;: &quot;keyword&quot; &#125; &#125;, &quot;fielddata&quot;: true &#125; &#125; &#125; &#125;&#125; 3.23 å¦‚ä½•è®¡ç®—ç›¸å…³åº¦åˆ†æ•°ä½¿ç”¨çš„æ˜¯TF/IDFç®—æ³•(Term Frequency&amp;Inverse Document Frequency) Term Frequency:æˆ‘ä»¬æŸ¥è¯¢çš„æ–‡æœ¬ä¸­çš„è¯æ¡åœ¨documentæœ¬ä¸­å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œå‡ºç°æ¬¡æ•°è¶Šå¤šï¼Œç›¸å…³åº¦è¶Šé«˜ æœç´¢å†…å®¹ï¼š hello world Helloï¼ŒI love china. Hello world,how are you! Inverse Document Frequencyï¼šæˆ‘ä»¬æŸ¥è¯¢çš„æ–‡æœ¬ä¸­çš„è¯æ¡åœ¨ç´¢å¼•çš„æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œå‡ºç°çš„æ¬¡æ•°è¶Šå¤šï¼Œç›¸å…³åº¦è¶Šä½ æœç´¢å†…å®¹ï¼šhello world helloï¼Œwhat are you doing? I like the world. hello åœ¨ç´¢å¼•çš„æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°äº†500æ¬¡ï¼Œworldå‡ºç°äº†100æ¬¡ Field-length(å­—æ®µé•¿åº¦å½’çº¦) norm:fieldè¶Šé•¿ï¼Œç›¸å…³åº¦è¶Šä½ æœç´¢å†…å®¹ï¼šhello world {â€œtitleâ€:â€hello,whatâ€™s your name?â€,â€contentâ€:{â€œowieurowieuolsdjflkâ€}} {â€œtitleâ€:â€hi,good morningâ€,â€contentâ€:{â€œlkjkljkjâ€¦â€¦.worldâ€}} æŸ¥çœ‹åˆ†æ•°æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼š GET /lib3/user/_search?explain=true &#123; &quot;query&quot;:&#123; &quot;match&quot;:&#123; &quot;interests&quot;: &quot;duanlian,changge&quot; &#125; &#125;&#125; æŸ¥çœ‹ä¸€ä¸ªæ–‡æ¡£èƒ½å¦åŒ¹é…ä¸ŠæŸä¸ªæŸ¥è¯¢ï¼š GET /lib3/user/2/_explain &#123; &quot;query&quot;:&#123; &quot;match&quot;:&#123; &quot;interests&quot;: &quot;duanlian,changge&quot; &#125; &#125;&#125; 3.24 Doc Values è§£æDocValueså…¶å®æ˜¯Luceneåœ¨æ„å»ºå€’æ’ç´¢å¼•æ—¶ï¼Œä¼šé¢å¤–å»ºç«‹ä¸€ä¸ªæœ‰åºçš„æ­£æ’ç´¢å¼•(åŸºäºdocument =&gt; field valueçš„æ˜ å°„åˆ—è¡¨) {â€œbirthdayâ€:â€1985-11-11â€,age:23} {â€œbirthdayâ€:â€1989-11-11â€,age:29} document age birthday doc1 23 1985-11-11 doc2 29 1989-11-11 å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼ŒèŠ‚çœå†…å­˜ å¯¹æ’åºï¼Œåˆ†ç»„å’Œä¸€äº›èšåˆæ“ä½œèƒ½å¤Ÿå¤§å¤§æå‡æ€§èƒ½ æ³¨æ„ï¼šé»˜è®¤å¯¹ä¸åˆ†è¯çš„å­—æ®µæ˜¯å¼€å¯çš„ï¼Œå¯¹åˆ†è¯å­—æ®µæ— æ•ˆï¼ˆéœ€è¦æŠŠfielddataè®¾ç½®ä¸ºtrueï¼‰ PUT /lib3 &#123; &quot;settings&quot;:&#123; &quot;number_of_shards&quot; : 3, &quot;number_of_replicas&quot; : 0 &#125;, &quot;mappings&quot;:&#123; &quot;user&quot;:&#123; &quot;properties&quot;:&#123; &quot;name&quot;: &#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;address&quot;: &#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;age&quot;: &#123; &quot;type&quot;:&quot;integer&quot;, &quot;doc_values&quot;:false &#125;, &quot;interests&quot;: &#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;birthday&quot;: &#123;&quot;type&quot;:&quot;date&quot;&#125; &#125; &#125; &#125;&#125; 3.25 åŸºäºscrollæŠ€æœ¯æ»šåŠ¨æœç´¢å¤§é‡æ•°æ®å¦‚æœä¸€æ¬¡æ€§è¦æŸ¥å‡ºæ¥æ¯”å¦‚10ä¸‡æ¡æ•°æ®ï¼Œé‚£ä¹ˆæ€§èƒ½ä¼šå¾ˆå·®ï¼Œæ­¤æ—¶ä¸€èˆ¬ä¼šé‡‡å–ç”¨scollæ»šåŠ¨æŸ¥è¯¢ï¼Œä¸€æ‰¹ä¸€æ‰¹çš„æŸ¥ï¼Œç›´åˆ°æ‰€æœ‰æ•°æ®éƒ½æŸ¥è¯¢å®Œä¸ºæ­¢ã€‚ scollæœç´¢ä¼šåœ¨ç¬¬ä¸€æ¬¡æœç´¢çš„æ—¶å€™ï¼Œä¿å­˜ä¸€ä¸ªå½“æ—¶çš„è§†å›¾å¿«ç…§ï¼Œä¹‹ååªä¼šåŸºäºè¯¥æ—§çš„è§†å›¾å¿«ç…§æä¾›æ•°æ®æœç´¢ï¼Œå¦‚æœè¿™ä¸ªæœŸé—´æ•°æ®å˜æ›´ï¼Œæ˜¯ä¸ä¼šè®©ç”¨æˆ·çœ‹åˆ°çš„ é‡‡ç”¨åŸºäº_doc(ä¸ä½¿ç”¨_score)è¿›è¡Œæ’åºçš„æ–¹å¼ï¼Œæ€§èƒ½è¾ƒé«˜ æ¯æ¬¡å‘é€scrollè¯·æ±‚ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŒ‡å®šä¸€ä¸ªscollå‚æ•°ï¼ŒæŒ‡å®šä¸€ä¸ªæ—¶é—´çª—å£ï¼Œæ¯æ¬¡æœç´¢è¯·æ±‚åªè¦åœ¨è¿™ä¸ªæ—¶é—´çª—å£å†…èƒ½å®Œæˆå°±å¯ä»¥äº† GET /lib3/user/_search?scroll=1m &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;sort&quot;:[&quot;_doc&quot;], &quot;size&quot;:3&#125; GET /_search/scroll &#123; &quot;scroll&quot;: &quot;1m&quot;, &quot;scroll_id&quot;: &quot;DnF1ZXJ5VGhlbkZldGNoAwAAAAAAAAAdFkEwRENOVTdnUUJPWVZUd1p2WE5hV2cAAAAAAAAAHhZBMERDTlU3Z1FCT1lWVHdadlhOYVdnAAAAAAAAAB8WQTBEQ05VN2dRQk9ZVlR3WnZYTmFXZw==&quot;&#125; 3.26 dynamic mappingç­–ç•¥dynamic: true:é‡åˆ°é™Œç”Ÿå­—æ®µå°± dynamic mapping false:é‡åˆ°é™Œç”Ÿå­—æ®µå°±å¿½ç•¥ strict:çº¦åˆ°é™Œç”Ÿå­—æ®µå°±æŠ¥é”™ PUT /lib8 &#123; &quot;settings&quot;:&#123; &quot;number_of_shards&quot; : 3, &quot;number_of_replicas&quot; : 0 &#125;, &quot;mappings&quot;:&#123; &quot;user&quot;:&#123; &quot;dynamic&quot;:strict, &quot;properties&quot;:&#123; &quot;name&quot;: &#123;&quot;type&quot;:&quot;text&quot;&#125;, &quot;address&quot;:&#123; &quot;type&quot;:&quot;object&quot;, &quot;dynamic&quot;:true &#125;, &#125; &#125; &#125;&#125; ä¼šæŠ¥é”™ PUT /lib8/user/1 &#123; &quot;name&quot;:&quot;lisi&quot;, &quot;age&quot;:20, &quot;address&quot;:&#123; &quot;province&quot;:&quot;beijing&quot;, &quot;city&quot;:&quot;beijing&quot; &#125;&#125; date_detection:é»˜è®¤ä¼šæŒ‰ç…§ä¸€å®šæ ¼å¼è¯†åˆ«dateï¼Œæ¯”å¦‚yyyy-MM-dd å¯ä»¥æ‰‹åŠ¨å…³é—­æŸä¸ªtypeçš„date_detection PUT /lib8 &#123; &quot;settings&quot;:&#123; &quot;number_of_shards&quot; : 3, &quot;number_of_replicas&quot; : 0 &#125;, &quot;mappings&quot;:&#123; &quot;user&quot;:&#123; &quot;date_detection&quot;: false, &#125; &#125;&#125; å®šåˆ¶ dynamic mapping template(type) PUT /my_index &#123; &quot;mappings&quot;: &#123; &quot;my_type&quot;: &#123; &quot;dynamic_templates&quot;: [ &#123; &quot;en&quot;: &#123; &quot;match&quot;: &quot;*_en&quot;, &quot;match_mapping_type&quot;: &quot;string&quot;, &quot;mapping&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;english&quot; &#125; &#125; &#125; ] &#125; &#125; &#125; ä½¿ç”¨äº†æ¨¡æ¿ PUT /my_index/my_type/3 &#123; &quot;title_en&quot;: &quot;this is my dog&quot; &#125; æ²¡æœ‰ä½¿ç”¨æ¨¡æ¿ PUT /my_index/my_type/5 &#123; &quot;title&quot;: &quot;this is my cat&quot;&#125; GET my_index/my_type/_search &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;title&quot;: &quot;is&quot; &#125; &#125;&#125; 3.27é‡å»ºç´¢å¼•ä¸€ä¸ªfieldçš„è®¾ç½®æ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œå¦‚æœè¦ä¿®æ”¹ä¸€ä¸ªfieldï¼Œé‚£ä¹ˆåº”è¯¥é‡æ–°æŒ‰ç…§æ–°çš„mappingï¼Œå»ºç«‹ä¸€ä¸ªindexï¼Œç„¶åå°†æ•°æ®æ‰¹é‡æŸ¥è¯¢å‡ºæ¥ï¼Œé‡æ–°ç”¨bulk apiå†™å…¥åˆ°indexä¸­ã€‚ æ‰¹é‡æŸ¥è¯¢çš„æ—¶å€™ï¼Œå»ºè®®é‡‡ç”¨scroll apiï¼Œå¹¶ä¸”é‡‡ç”¨å¤šçº¿ç¨‹å¹¶å‘çš„æ–¹å¼æ¥reindexæ•°æ®ï¼Œæ¯æ¬¡scrollå°±æŸ¥è¯¢æŒ‡å®šæ—¥æœŸçš„ä¸€æ®µæ•°æ®ï¼Œäº¤ç»™ä¸€ä¸ªçº¿ç¨‹å³å¯ã€‚ PUT /index1/type1/4 &#123; &quot;content&quot;:&quot;1990-12-12&quot;&#125; GET /index1/type1/_search GET /index1/type1/_mapping æŠ¥é”™PUT /index1/type1/4 &#123; &quot;content&quot;:&quot;I am very happy.&quot;&#125; ä¿®æ”¹contentçš„ç±»å‹ä¸ºstringç±»å‹,æŠ¥é”™ï¼Œä¸å…è®¸ä¿®æ”¹ PUT /index1/_mapping/type1 &#123; &quot;properties&quot;: &#123; &quot;content&quot;:&#123; &quot;type&quot;: &quot;text&quot; &#125; &#125;&#125; åˆ›å»ºä¸€ä¸ªæ–°çš„ç´¢å¼•ï¼ŒæŠŠindex1ç´¢å¼•ä¸­çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥å¯¼å…¥åˆ°æ–°çš„ç´¢å¼•ä¸­ä½†æ˜¯åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ˜¯ä¹‹å‰çš„ç´¢å¼•ï¼Œä¸ºäº†ä¸ç”¨é‡å¯åº”ç”¨ç¨‹åºï¼Œç»™index1è¿™ä¸ªç´¢å¼•èµ·ä¸ª#åˆ«å PUT /index1/_alias/index2 åˆ›å»ºæ–°çš„ç´¢å¼•ï¼ŒæŠŠcontentçš„ç±»å‹æ”¹ä¸ºå­—ç¬¦ä¸² PUT /newindex &#123; &quot;mappings&quot;: &#123; &quot;type1&quot;:&#123; &quot;properties&quot;: &#123; &quot;content&quot;:&#123; &quot;type&quot;: &quot;text&quot; &#125; &#125; &#125; &#125;&#125; ä½¿ç”¨scrollæ‰¹é‡æŸ¥è¯¢ GET /index1/type1/_search?scroll=1m &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;sort&quot;: [&quot;_doc&quot;], &quot;size&quot;: 2&#125; ä½¿ç”¨bulkæ‰¹é‡å†™å…¥æ–°çš„ç´¢å¼•POST /_bulk{â€œindexâ€:{â€œ_indexâ€:â€newindexâ€,â€_typeâ€:â€type1â€,â€_idâ€:1}}{â€œcontentâ€:â€1982-12-12â€} å°†åˆ«åindex2å’Œæ–°çš„ç´¢å¼•å…³è”ï¼Œåº”ç”¨ç¨‹åºä¸ç”¨é‡å¯ POST /_aliases &#123; &quot;actions&quot;: [ &#123;&quot;remove&quot;: &#123;&quot;index&quot;:&quot;index1&quot;,&quot;alias&quot;:&quot;index2&quot;&#125;&#125;, &#123;&quot;add&quot;: &#123;&quot;index&quot;: &quot;newindex&quot;,&quot;alias&quot;: &quot;index2&quot;&#125;&#125;]&#125; GET index2/type1/_search 3.28 ç´¢å¼•ä¸å¯å˜çš„åŸå› å€’æ’ç´¢å¼•åŒ…æ‹¬ï¼š æ–‡æ¡£çš„åˆ—è¡¨ï¼Œæ–‡æ¡£çš„æ•°é‡ï¼Œè¯æ¡åœ¨æ¯ä¸ªæ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå‡ºç°çš„ä½ç½®ï¼Œæ¯ä¸ªæ–‡æ¡£çš„é•¿åº¦ï¼Œæ‰€æœ‰æ–‡æ¡£çš„å¹³å‡é•¿åº¦ ç´¢å¼•ä¸å˜çš„åŸå› ï¼š ä¸éœ€è¦é”ï¼Œæå‡äº†å¹¶å‘æ€§èƒ½ å¯ä»¥ä¸€ç›´ä¿å­˜åœ¨ç¼“å­˜ä¸­ï¼ˆfilterï¼‰ èŠ‚çœcpuå’Œioå¼€é”€ ç¬¬å››èŠ‚ åœ¨Javaåº”ç”¨ä¸­è®¿é—®ElasticSearch4.1åœ¨Javaåº”ç”¨ä¸­å®ç°æŸ¥è¯¢æ–‡æ¡£pomä¸­åŠ å…¥ElasticSearch6.2.4çš„ä¾èµ–ï¼š &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt; &lt;artifactId&gt;transport&lt;/artifactId&gt; &lt;version&gt;6.2.4&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;!-- javaç¼–è¯‘æ’ä»¶ --&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.2&lt;/version&gt; &lt;configuration&gt; &lt;source&gt;1.8&lt;/source&gt; &lt;target&gt;1.8&lt;/target&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; 4.2 åœ¨Javaåº”ç”¨ä¸­å®ç°æ·»åŠ æ–‡æ¡£ \"&#123;\" + \"\\\"id\\\":\\\"1\\\",\" + \"\\\"title\\\":\\\"Javaè®¾è®¡æ¨¡å¼ä¹‹è£…é¥°æ¨¡å¼\\\",\" + \"\\\"content\\\":\\\"åœ¨ä¸å¿…æ”¹å˜åŸç±»æ–‡ä»¶å’Œä½¿ç”¨ç»§æ‰¿çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€åœ°æ‰©å±•ä¸€ä¸ªå¯¹è±¡çš„åŠŸèƒ½ã€‚\\\",\" + \"\\\"postdate\\\":\\\"2018-05-20 14:38:00\\\",\" + \"\\\"url\\\":\\\"csdn.net/79239072\\\"\" + \"&#125;\"XContentBuilder doc1 = XContentFactory.jsonBuilder() .startObject() .field(\"id\",\"3\") .field(\"title\",\"Javaè®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼\") .field(\"content\",\"æšä¸¾å•ä¾‹æ¨¡å¼å¯ä»¥é˜²åå°„æ”»å‡»ã€‚\") .field(\"postdate\",\"2018-02-03\") .field(\"url\",\"csdn.net/79247746\") .endObject(); IndexResponse response = client.prepareIndex(\"index1\", \"blog\", null) .setSource(doc1) .get(); System.out.println(response.status()); 4.3åœ¨Javaåº”ç”¨ä¸­å®ç°åˆ é™¤æ–‡æ¡£DeleteResponse response=client.prepareDelete(\"index1\",\"blog\",\"SzYJjWMBjSAutsuLRP_P\").get();//åˆ é™¤æˆåŠŸè¿”å›OKï¼Œå¦åˆ™è¿”å›NOT_FOUNDSystem.out.println(response.status()); 4.4åœ¨Javaåº”ç”¨ä¸­å®ç°æ›´æ–°æ–‡æ¡£ UpdateRequest request=new UpdateRequest(); request.index(\"index1\") .type(\"blog\") .id(\"2\") .doc( XContentFactory.jsonBuilder().startObject() .field(\"title\",\"å•ä¾‹æ¨¡å¼è§£è¯»\") .endObject() );UpdateResponse response=client.update(request).get();//æ›´æ–°æˆåŠŸè¿”å›OKï¼Œå¦åˆ™è¿”å›NOT_FOUNDSystem.out.println(response.status());upsertæ–¹å¼ï¼šIndexRequest request1 =new IndexRequest(\"index1\",\"blog\",\"3\") .source( XContentFactory.jsonBuilder().startObject() .field(\"id\",\"3\") .field(\"title\",\"è£…é¥°æ¨¡å¼\") .field(\"content\",\"åŠ¨æ€åœ°æ‰©å±•ä¸€ä¸ªå¯¹è±¡çš„åŠŸèƒ½\") .field(\"postdate\",\"2018-05-23\") .field(\"url\",\"csdn.net/79239072\") .endObject() ); UpdateRequest request2=new UpdateRequest(\"index1\",\"blog\",\"3\") .doc( XContentFactory.jsonBuilder().startObject() .field(\"title\",\"è£…é¥°æ¨¡å¼è§£è¯»\") .endObject() ).upsert(request1); UpdateResponse response=client.update(request2).get(); //upsertæ“ä½œæˆåŠŸè¿”å›OKï¼Œå¦åˆ™è¿”å›NOT_FOUNDSystem.out.println(response.status()); 4.5åœ¨Javaåº”ç”¨ä¸­å®ç°æ‰¹é‡æ“ä½œ MultiGetResponse mgResponse = client.prepareMultiGet() .add(\"index1\",\"blog\",\"3\",\"2\") .add(\"lib3\",\"user\",\"1\",\"2\",\"3\") .get(); for(MultiGetItemResponse response:mgResponse)&#123; GetResponse rp=response.getResponse(); if(rp!=null &amp;&amp; rp.isExists())&#123; System.out.println(rp.getSourceAsString()); &#125; &#125; bulkï¼š BulkRequestBuilder bulkRequest = client.prepareBulk();bulkRequest.add(client.prepareIndex(\"lib2\", \"books\", \"4\") .setSource(XContentFactory.jsonBuilder() .startObject() .field(\"title\", \"python\") .field(\"price\", 68) .endObject() ) );bulkRequest.add(client.prepareIndex(\"lib2\", \"books\", \"5\") .setSource(XContentFactory.jsonBuilder() .startObject() .field(\"title\", \"VR\") .field(\"price\", 38) .endObject() ) ); //æ‰¹é‡æ‰§è¡ŒBulkResponse bulkResponse = bulkRequest.get(); System.out.println(bulkResponse.status());if (bulkResponse.hasFailures()) &#123; System.out.println(\"å­˜åœ¨å¤±è´¥æ“ä½œ\"); &#125; ç¬¬äº”èŠ‚ åœ¨Pythonåº”ç”¨ä¸­è®¿é—®ElasticSearch5.1 åˆ›å»º Indexfrom elasticsearch import Elasticsearches = Elasticsearch()result = es.indices.create(index='news', ignore=400)print(result) 5.2 åˆ é™¤ Indexfrom elasticsearch import Elasticsearches = Elasticsearch()result = es.indices.delete(index='news', ignore=[400, 404])print(result) 5.3 æ’å…¥æ•°æ®from elasticsearch import Elasticsearches = Elasticsearch()es.indices.create(index='news', ignore=400)data = &#123;'title': 'ç¾å›½ç•™ç»™ä¼Šæ‹‰å…‹çš„æ˜¯ä¸ªçƒ‚æ‘Šå­å—', 'url': 'http://view.news.qq.com/zt2011/usa_iraq/index.htm'&#125;result = es.create(index='news', doc_type='politics', id=1, body=data)print(result) 5.4 æ›´æ–°æ•°æ®from elasticsearch import Elasticsearches = Elasticsearch()data = &#123; 'title': 'ç¾å›½ç•™ç»™ä¼Šæ‹‰å…‹çš„æ˜¯ä¸ªçƒ‚æ‘Šå­å—', 'url': 'http://view.news.qq.com/zt2011/usa_iraq/index.htm', 'date': '2011-12-16'&#125;result = es.update(index='news', doc_type='politics', body=data, id=1)print(result) 5.5 åˆ é™¤æ•°æ®from elasticsearch import Elasticsearches = Elasticsearch()result = es.delete(index='news', doc_type='politics', id=1)print(result) 5.6 æŸ¥è¯¢æ•°æ®from elasticsearch import Elasticsearches = Elasticsearch()mapping = &#123; 'properties': &#123; 'title': &#123; 'type': 'text', 'analyzer': 'ik_max_word', 'search_analyzer': 'ik_max_word' &#125; &#125;&#125;es.indices.delete(index='news', ignore=[400, 404])es.indices.create(index='news', ignore=400)result = es.indices.put_mapping(index='news', doc_type='politics', body=mapping)print(result)","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"http://lucas0625.github.io/blog/categories/æ•°æ®åº“/"}],"tags":[{"name":"es","slug":"es","permalink":"http://lucas0625.github.io/blog/tags/es/"}]},{"title":"æ­£åˆ™è¡¨è¾¾å¼ ç®€è¦æ‰‹å†Œ","slug":"regex","date":"2019-04-29T03:32:03.363Z","updated":"2019-05-09T09:52:51.447Z","comments":true,"path":"2019/04/29/regex/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/29/regex/","excerpt":"æ­£åˆ™è¡¨è¾¾å¼çš„ç®€å•æ¢³ç†","text":"æ­£åˆ™è¡¨è¾¾å¼çš„ç®€å•æ¢³ç† æ­£åˆ™è¡¨è¾¾å¼åŸºæœ¬è¯­æ³• pythonä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼import re pattern = re.compile(expression) ç¼–è¯‘åŒ¹é…æ¨¡å¼ re.match(pattern, str) ä»å­—ç¬¦ä¸²å¼€å¤´å¼€å§‹åŒ¹é…ï¼Œè¿”å›matchå¯¹è±¡ï¼Œä½¿ç”¨group(0)å–å‡ºåŒ¹é…åˆ°çš„å­—ç¬¦ re.search(pattern, str) æœç´¢å­—ç¬¦ä¸²ï¼Œè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„matchå¯¹è±¡ï¼Œä½¿ç”¨group(0)å–å‡ºåŒ¹é…åˆ°çš„å­—ç¬¦ re.findall(pattern, str) ä»¥åˆ—è¡¨çš„å½¢å¼è¿”å›æ‰€æœ‰åŒ¹é…åˆ°çš„å­—ç¬¦ re.finditer(pattern, str) ä»¥è¿­ä»£å™¨çš„å½¢å¼è¿”å›æ‰€æœ‰åŒ¹é…åˆ°çš„å­—ç¬¦ re.sub(pattern, repl_str, str) å°†strä¸­åŒ¹é…åˆ°çš„å­—ç¬¦æ›¿æ¢æˆrepl_str æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ é¢˜æ­£åˆ™è¡¨è¾¾å¼åœ¨çº¿ç»ƒä¹ ç½‘å€: HackerRank Regex Golf s1 = â€œget-element-by-idâ€; ç»™å®šè¿™æ ·ä¸€ä¸ªè¿å­—ç¬¦ä¸²ï¼Œå†™ä¸€ä¸ªfunctionè½¬æ¢ä¸ºé©¼å³°å‘½åæ³•å½¢å¼çš„å­—ç¬¦ä¸² getElementById import rea = 'get-element-by-id'pattern = re.compile('-[a-z]')for item in re.findall(pattern, a): a = a.replace(item, item[-1].upper())print(a) getElementById åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æ•°å­— import repattern = re.compile('\\d')for i in ['asdfdsf', 'asdfdsfs43', '343']: print(True if re.search(pattern, i) else False) False True True åˆ¤æ–­ç”µè¯å·ç  import repattern = re.compile('^1[34578]\\d&#123;9&#125;$')for i in ['1233456', '13366789980', '18678900875']: print(True if re.search(pattern, i) else False) False True True åˆ¤æ–­æ˜¯å¦ç¬¦åˆæŒ‡å®šæ ¼å¼ï¼Œç»™å®šå­—ç¬¦ä¸²strï¼Œæ£€æŸ¥å…¶æ˜¯å¦ç¬¦åˆå¦‚ä¸‹æ ¼å¼ XXX-XXX-XXXX å…¶ä¸­Xä¸ºNumberç±»å‹ import repattern = re.compile('^(\\d&#123;3&#125;-)&#123;2&#125;\\d&#123;4&#125;$')for i in ['XXX-XXX-XXXX', '123-456-6889', '1232-434-1314']: print(True if re.search(pattern, i) else False) False True False åˆ¤æ–­æ˜¯å¦ç¬¦åˆUSDæ ¼å¼ï¼Œç»™å®šå­—ç¬¦ä¸² strï¼Œæ£€æŸ¥å…¶æ˜¯å¦ç¬¦åˆç¾å…ƒä¹¦å†™æ ¼å¼ ä»¥ $ å¼€å§‹ æ•´æ•°éƒ¨åˆ†ï¼Œä»ä¸ªä½èµ·ï¼Œæ»¡ 3 ä¸ªæ•°å­—ç”¨ , åˆ†éš” å¦‚æœä¸ºå°æ•°ï¼Œåˆ™å°æ•°éƒ¨åˆ†é•¿åº¦ä¸º 2 æ­£ç¡®çš„æ ¼å¼å¦‚ï¼š$1,023,032.03 æˆ–è€… $2.03ï¼Œé”™è¯¯çš„æ ¼å¼å¦‚ï¼š$3,432,12.12 æˆ–è€… $34,344.3 import repattern = re.compile('^\\$\\d&#123;1,3&#125;(,\\d&#123;3&#125;)*(\\.\\d&#123;2&#125;)?$')for i in ['$1,023,032.03', '$2.03', '$3,432,12.12', '$34,344.3']: print(True if re.search(pattern, i) else False) True True False False JSå®ç°åƒä½åˆ†éš”ç¬¦ import redef formatNum(num): if isinstance(num, int): num = str(num) pattern = re.compile(r'(\\d+)(\\d&#123;3&#125;)((,\\d&#123;3&#125;)*)') while True: num, count = re.subn(pattern, r'\\1,\\2\\3', num) if count == 0: break return numprint(formatNum(43532412245353)) 43,532,412,245,353 éªŒè¯é‚®ç®± import repattern = re.compile('^[a-zA-Z0-9_\\-]+@[a-zA-Z0-9_\\-]+\\.[a-zA-Z0-9_\\-]+$')for i in ['12@163.com', '244@qq.com', 'dsf@dsf']: print(True if re.search(pattern, i) else False) True True False éªŒè¯èº«ä»½è¯å·ç , èº«ä»½è¯å·ç å¯èƒ½ä¸º15ä½æˆ–18ä½ï¼Œ15ä½ä¸ºå…¨æ•°å­—ï¼Œ18ä½ä¸­å‰17ä½ä¸ºæ•°å­—ï¼Œæœ€åä¸€ä½ä¸ºæ•°å­—æˆ–è€…X import repattern = re.compile('^\\d&#123;15&#125;$|^\\d&#123;17&#125;[0-9Xx]$')for i in ['34345345', '123456789012345', '12345678901234567X']: print(True if re.search(pattern, i) else False) False True True åŒ¹é…æ±‰å­— import repattern = re.compile('^[\\u4E00-\\u9FA5]*$')for i in ['34sd', '', 'æˆ‘ä»¬']: print(True if re.search(pattern, i) else False) False True True å»é™¤é¦–å°¾çš„â€™/â€˜ a = '/sdf/'a.strip('/')print(a) sdf åˆ¤æ–­æ—¥æœŸæ ¼å¼æ˜¯å¦ç¬¦åˆ â€˜2017-05-11â€™çš„å½¢å¼ï¼Œç®€å•åˆ¤æ–­ï¼Œåªåˆ¤æ–­æ ¼å¼ import repattern = re.compile('^\\d&#123;4&#125;\\-\\d&#123;1,2&#125;\\-\\d&#123;1,2&#125;$') åå…­è¿›åˆ¶é¢œè‰²æ­£åˆ™ import repattern = re.compile('^#?([a-fA-F0-9]&#123;6&#125;|[a-fA-F0-9]&#123;3&#125;)$') è½¦ç‰Œå·æ­£åˆ™ import repattern = re.compile('^[äº¬æ´¥æ²ªæ¸å†€è±«äº‘è¾½é»‘æ¹˜çš–é²æ–°è‹æµ™èµ£é„‚æ¡‚ç”˜æ™‹è’™é™•å‰é—½è´µç²¤é’è—å·å®ç¼ä½¿é¢†A-Z]&#123;1&#125;[A-Z]&#123;1&#125;[A-Z0-9]&#123;4&#125;[A-Z0-9æŒ‚å­¦è­¦æ¸¯æ¾³]&#123;1&#125;$')re.search(pattern , str) å¯†ç å¼ºåº¦æ­£åˆ™ï¼Œæœ€å°‘6ä½ï¼ŒåŒ…æ‹¬è‡³å°‘1ä¸ªå¤§å†™å­—æ¯ï¼Œ1ä¸ªå°å†™å­—æ¯ï¼Œ1ä¸ªæ•°å­—ï¼Œ1ä¸ªç‰¹æ®Šå­—ç¬¦ import repattern = re.compile('^.*(?=.&#123;6,&#125;)(?=.*\\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%^&amp;*? ]).*$') åŒ¹é…æµ®ç‚¹æ•° import repattern = re.compile('^-?([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0)$')","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://lucas0625.github.io/blog/categories/å·¥å…·/"}],"tags":[{"name":"re","slug":"re","permalink":"http://lucas0625.github.io/blog/tags/re/"}]},{"title":"Git å¸¸ç”¨æ“ä½œæŒ‡å—","slug":"Gitå¸¸ç”¨æ“ä½œæŒ‡å—","date":"2019-04-28T08:11:53.115Z","updated":"2019-04-28T08:11:53.115Z","comments":true,"path":"2019/04/28/Gitå¸¸ç”¨æ“ä½œæŒ‡å—/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/28/Gitå¸¸ç”¨æ“ä½œæŒ‡å—/","excerpt":"æœ¬æ–‡ä»‹ç»è‡ªå·±å¹³æ—¶å·¥ä½œä¸­å¸¸ç”¨çš„ä¸€äº›Gitæ“ä½œ","text":"æœ¬æ–‡ä»‹ç»è‡ªå·±å¹³æ—¶å·¥ä½œä¸­å¸¸ç”¨çš„ä¸€äº›Gitæ“ä½œ Git å¸¸ç”¨æ“ä½œæŒ‡å—.gitignoreè§„èŒƒ æ‰€æœ‰ç©ºè¡Œæˆ–è€…ä»¥æ³¨é‡Šç¬¦å· ï¼ƒ å¼€å¤´çš„è¡Œéƒ½ä¼šè¢« Git å¿½ç•¥ã€‚ å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ glob æ¨¡å¼åŒ¹é…ã€‚ åŒ¹é…æ¨¡å¼æœ€åè·Ÿåæ–œæ ï¼ˆ/ï¼‰è¯´æ˜è¦å¿½ç•¥çš„æ˜¯ç›®å½•ã€‚ è¦å¿½ç•¥æŒ‡å®šæ¨¡å¼ä»¥å¤–çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¯ä»¥åœ¨æ¨¡å¼å‰åŠ ä¸ŠæƒŠå¹å·ï¼ˆ!ï¼‰å–åã€‚[æ³¨]:æ‰€è°“çš„ glob æ¨¡å¼æ˜¯æŒ‡ shell æ‰€ä½¿ç”¨çš„ç®€åŒ–äº†çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ æ˜Ÿå·ï¼ˆ*ï¼‰åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦ [abc] åŒ¹é…ä»»ä½•ä¸€ä¸ªåˆ—åœ¨æ–¹æ‹¬å·ä¸­çš„å­—ç¬¦ï¼ˆè¿™ä¸ªä¾‹å­è¦ä¹ˆåŒ¹é…ä¸€ä¸ª aï¼Œè¦ä¹ˆåŒ¹é…ä¸€ä¸ª bï¼Œè¦ä¹ˆåŒ¹é…ä¸€ä¸ª cï¼‰ é—®å·ï¼ˆ?ï¼‰åªåŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ å¦‚æœåœ¨æ–¹æ‹¬å·ä¸­ä½¿ç”¨çŸ­åˆ’çº¿åˆ†éš”ä¸¤ä¸ªå­—ç¬¦ï¼Œè¡¨ç¤ºæ‰€æœ‰åœ¨è¿™ä¸¤ä¸ªå­—ç¬¦èŒƒå›´å†…çš„éƒ½å¯ä»¥åŒ¹é…ï¼ˆæ¯”å¦‚ [0-9] è¡¨ç¤ºåŒ¹é…æ‰€æœ‰ 0 åˆ° 9 çš„æ•°å­—ï¼‰ã€‚ example: # æ­¤ä¸ºæ³¨é‡Š â€“ å°†è¢« Git å¿½ç•¥ # å¿½ç•¥æ‰€æœ‰ .a ç»“å°¾çš„æ–‡ä»¶ *.a # ä½† lib.a é™¤å¤– !lib.a # ä»…ä»…å¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ TODO æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬ subdir/TODO /TODO # å¿½ç•¥ build/ ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ build/ # ä¼šå¿½ç•¥ doc/notes.txt ä½†ä¸åŒ…æ‹¬ doc/server/arch.txt doc/*.txt æŸ¥çœ‹æ–‡ä»¶ä¹‹é—´çš„å·®åˆ« git diff file æŸ¥çœ‹å·¥ä½œç›®å½•ä¸­å½“å‰æ–‡ä»¶å’Œæš‚å­˜åŒºåŸŸå¿«ç…§ä¹‹é—´çš„å·®å¼‚ git diff â€”cached / â€”staged æŸ¥çœ‹å·²ç»æš‚å­˜èµ·æ¥çš„æ–‡ä»¶å’Œä¸Šæ¬¡æäº¤æ—¶çš„å¿«ç…§ä¹‹é—´çš„å·®å¼‚ æäº¤æ–‡ä»¶ git commit -m â€˜upâ€™ å°†æš‚å­˜åŒºçš„æ–‡ä»¶æäº¤ git commit -a -m â€˜upâ€™ è·³è¿‡addæ­¥éª¤ï¼Œå°†å·¥ä½œåŒºçš„æ–‡ä»¶ç›´æ¥æäº¤ åˆ é™¤æ–‡ä»¶ git rm file ä»æš‚å­˜åŒºåˆ é™¤ï¼Œå¹¶è¿å¸¦ä»å·¥ä½œç›®å½•ä¸­åˆ é™¤æŒ‡å®šçš„æ–‡ä»¶ git rm -f file å¦‚ä½•åˆ é™¤ä¹‹å‰ä¿®æ”¹è¿‡ï¼Œå¹¶ä¸”å·²åŠ å…¥æš‚å­˜åŒºï¼Œåˆ™å¿…é¡»å¼ºåˆ¶åˆ é™¤ git rm â€”cached file å°†æ–‡ä»¶ä»gitä»“åº“ä¸­åˆ é™¤ï¼Œä½†æ˜¯ä»ä¿ç•™åœ¨å·¥ä½œç›®å½•ä¸­ ä¿®æ”¹æ–‡ä»¶å git mv file_form file_to æŸ¥çœ‹æäº¤å†å² git log æŒ‰ç…§æäº¤å†å²åˆ—å‡ºæ‰€æœ‰æ›´æ–°ï¼Œæœ€è¿‘çš„æ›´æ–°æ’åœ¨æœ€ä¸Šé¢ git log -p -n æ˜¾ç¤ºæ¯æ¬¡æäº¤çš„å†…å®¹å·®å¼‚ï¼Œæ˜¾ç¤ºæœ€è¿‘çš„næ¬¡æäº¤ git log â€”stat æ˜¾ç¤ºæ¯æ¬¡æäº¤çš„ç®€è¦å¢æ”¹è¡Œç»Ÿè®¡ git log â€”pretty=oneline å°†æ¯ä¸ªæäº¤æ”¾åœ¨ä¸€è¡Œæ˜¾ç¤º git log â€”pretty=format:â€%h - %an, %ar : %sâ€ å®šåˆ¶è¦æ˜¾ç¤ºçš„è®°å½•æ ¼å¼ é€‰é¡¹ è¯´æ˜ %H æäº¤å¯¹è±¡ï¼ˆcommitï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸² %h æäº¤å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸² %T æ ‘å¯¹è±¡ï¼ˆtreeï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸² %t æ ‘å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸² %P çˆ¶å¯¹è±¡ï¼ˆparentï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸² %p çˆ¶å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸² %an ä½œè€…ï¼ˆauthorï¼‰çš„åå­—. å®é™…ä½œå‡ºä¿®æ”¹çš„äºº %ae ä½œè€…çš„ç”µå­é‚®ä»¶åœ°å€ %ad ä½œè€…ä¿®è®¢æ—¥æœŸï¼ˆå¯ä»¥ç”¨ -date= é€‰é¡¹å®šåˆ¶æ ¼å¼ï¼‰ %ar ä½œè€…ä¿®è®¢æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º %cn æäº¤è€…(committer)çš„åå­—. æœ€åå°†æ­¤å·¥ä½œæˆæœæäº¤åˆ°ä»“åº“çš„äºº %ce æäº¤è€…çš„ç”µå­é‚®ä»¶åœ°å€ %cd æäº¤æ—¥æœŸ %cr æäº¤æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º %s æäº¤è¯´æ˜ git log â€”pretty=format:â€%h %sâ€ â€”graph å¢åŠ ASCIIå­—ç¬¦ä¸²è¡¨ç¤ºçš„ç®€å•å›¾å½¢ï¼Œå±•ç¤ºæ¯ä¸ªæäº¤æ‰€åœ¨çš„åˆ†æ”¯åŠå…¶åˆ†åŒ–è¡åˆæƒ…å†µ å…¶ä»–é€‰é¡¹ é€‰é¡¹ è¯´æ˜ -p æŒ‰è¡¥ä¸æ ¼å¼æ˜¾ç¤ºæ¯ä¸ªæ›´æ–°ä¹‹é—´çš„å·®å¼‚ã€‚ --stat æ˜¾ç¤ºæ¯æ¬¡æ›´æ–°çš„æ–‡ä»¶ä¿®æ”¹ç»Ÿè®¡ä¿¡æ¯ã€‚ --shortstat åªæ˜¾ç¤º --stat ä¸­æœ€åçš„è¡Œæ•°ä¿®æ”¹æ·»åŠ ç§»é™¤ç»Ÿè®¡ã€‚ --name-only ä»…åœ¨æäº¤ä¿¡æ¯åæ˜¾ç¤ºå·²ä¿®æ”¹çš„æ–‡ä»¶æ¸…å•ã€‚ --name-status æ˜¾ç¤ºæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤çš„æ–‡ä»¶æ¸…å•ã€‚ --abbrev-commit ä»…æ˜¾ç¤º SHA-1 çš„å‰å‡ ä¸ªå­—ç¬¦ï¼Œè€Œéæ‰€æœ‰çš„ 40 ä¸ªå­—ç¬¦ã€‚ --relative-date ä½¿ç”¨è¾ƒçŸ­çš„ç›¸å¯¹æ—¶é—´æ˜¾ç¤ºï¼ˆæ¯”å¦‚ï¼Œâ€œ2 weeks agoâ€ï¼‰ã€‚ --graph æ˜¾ç¤º ASCII å›¾å½¢è¡¨ç¤ºçš„åˆ†æ”¯åˆå¹¶å†å²ã€‚ --pretty ä½¿ç”¨å…¶ä»–æ ¼å¼æ˜¾ç¤ºå†å²æäº¤ä¿¡æ¯ã€‚å¯ç”¨çš„é€‰é¡¹åŒ…æ‹¬ onelineï¼Œshortï¼Œfullï¼Œfuller å’Œ formatï¼ˆåè·ŸæŒ‡å®šæ ¼å¼ï¼‰ã€‚ git log â€”since=2.weeks æ˜¾ç¤ºæœ€è¿‘ä¸¤å‘¨çš„æäº¤ é€‰é¡¹ è¯´æ˜ -(n) ä»…æ˜¾ç¤ºæœ€è¿‘çš„ n æ¡æäº¤ --since, --after ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´ä¹‹åçš„æäº¤ã€‚ --until, --before ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´ä¹‹å‰çš„æäº¤ã€‚ --author ä»…æ˜¾ç¤ºæŒ‡å®šä½œè€…ç›¸å…³çš„æäº¤ã€‚ --committer ä»…æ˜¾ç¤ºæŒ‡å®šæäº¤è€…ç›¸å…³çš„æäº¤ã€‚ æ’¤é”€æ“ä½œ git commit â€”amend æ’¤é”€åˆšæ‰çš„æäº¤æ“ä½œï¼Œä½¿ç”¨å½“å‰çš„æš‚å­˜åŒºåŸŸå¿«ç…§æäº¤ï¼Œå¦‚æœåˆšæ‰æäº¤å®Œæ²¡æœ‰ä½œä»»ä½•æ”¹åŠ¨ï¼Œç›¸å½“äºæœ‰æœºä¼šé‡æ–°ç¼–è¾‘æäº¤è¯´æ˜ git reset HEAD file å–æ¶ˆå·²æš‚å­˜çš„æ–‡ä»¶ git checkout â€” file å–æ¶ˆå·¥ä½œåŒºå¯¹æ–‡ä»¶çš„ä¿®æ”¹!!!!!!!!!!(æ­¤è¿‡ç¨‹ä¸å¯é€†) ç®¡ç†è¿œç¨‹ä»“åº“ git remote åˆ—å‡ºè¿œç¨‹ä»“åº“çš„åå­— git remote -v æ˜¾ç¤ºå¯¹åº”çš„å…‹éš†åœ°å€ git pull æ‹‰å–è¿œç¨‹ä»“åº“çš„æ›´æ–° git push æ¨é€æ•°æ®åˆ°è¿œç¨‹ä»“åº“ åˆ†æ”¯æ“ä½œ git branch testing æ–°å»ºtestingåˆ†æ”¯ git branch æ˜¾ç¤ºå½“å‰åˆ†æ”¯ git branch -a æ˜¾ç¤ºæ‰€æœ‰åˆ†æ”¯ git checkout testing è½¬æ¢åˆ°testingåˆ†æ”¯ git checkout -b testing æ–°å»ºtestingåˆ†æ”¯ï¼Œå¹¶è½¬å‘testingåˆ†æ”¯ git branch -d testing åˆ é™¤testingåˆ†æ”¯ git merge testing åˆå¹¶testingåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯ åˆå¹¶æ–¹å¼åŒ…æ‹¬ç®€å•çš„æŒ‡é’ˆå‰è¿›æ“ä½œ fast forward æˆ–è€…å¤šæ–¹åˆå¹¶ recursiveï¼Œ å½“åˆå¹¶æœ‰å†²çªæ—¶ï¼Œä»»ä½•åŒ…å«æœªè§£å†³å†²çªçš„æ–‡ä»¶éƒ½ä¼šä»¥unmergedçŠ¶æ€å­˜åœ¨ã€‚&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD å½“å‰åˆ†æ”¯============&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;è¦åˆå¹¶çš„åˆ†æ”¯è§£å†³å®Œå†²çªä¹‹å æ‰§è¡Œadd, commit æäº¤åˆ°ä»“åº“ git branch -v æŸ¥çœ‹å„ä¸ªåˆ†æ”¯æœ€åä¸€ä¸ªæäº¤çš„å¯¹è±¡çš„ä¿¡æ¯ git branch â€”merged ç­›é€‰å‡ºä¸å½“å‰åˆ†æ”¯åˆå¹¶çš„åˆ†æ”¯ï¼Œä¸€èˆ¬æ¥è¯´åˆ—è¡¨ä¸­æ²¡æœ‰*çš„åˆ†æ”¯é€šå¸¸éƒ½å¯ä»¥åˆ é™¤ git branch â€”no-merged ç­›é€‰å‡ºå°šæœªä¸å½“å‰åˆ†æ”¯åˆå¹¶çš„åˆ†æ”¯ git rebase master æŠŠå½“å‰åˆ†æ”¯é‡Œæäº¤çš„æ”¹å˜ç§»åŠ¨åˆ°masteråˆ†æ”¯é‡Œ git rebase â€”onto master server client å–å‡º client åˆ†æ”¯ï¼Œæ‰¾å‡º client åˆ†æ”¯å’Œ server åˆ†æ”¯çš„å…±åŒç¥–å…ˆä¹‹åçš„å˜åŒ–ï¼Œç„¶åæŠŠå®ƒåœ¨ master ä¸Šé‡æ¼”ä¸€é git rebase master server å–å‡ºç‰¹æ€§åˆ†æ”¯ serverï¼Œç„¶ååœ¨ä¸»åˆ†æ”¯ master ä¸Šé‡æ¼” å‚¨è—(stashing)æ“ä½œâ€œâ€˜å‚¨è—â€â€œå¯ä»¥è·å–ä½ å·¥ä½œç›®å½•çš„ä¸­é—´çŠ¶æ€â€”â€”ä¹Ÿå°±æ˜¯ä½ ä¿®æ”¹è¿‡çš„è¢«è¿½è¸ªçš„æ–‡ä»¶å’Œæš‚å­˜çš„å˜æ›´â€”â€”å¹¶å°†å®ƒä¿å­˜åˆ°ä¸€ä¸ªæœªå®Œç»“å˜æ›´çš„å †æ ˆä¸­ï¼Œéšæ—¶å¯ä»¥é‡æ–°åº”ç”¨ã€‚ git stash å¾€å †æ ˆæ¨é€ä¸€ä¸ªæ–°çš„å‚¨è—ï¼Œ git stash list æŸ¥çœ‹ç°æœ‰çš„å‚¨è— git stash apply æ¢å¤æœ€è¿‘ä¸€æ¬¡å‚¨è—ï¼Œä½†æ˜¯ä¸ä»å †æ ˆä¸­åˆ é™¤è¯¥å‚¨è— git stash apply stash@{2} æ¢å¤æŒ‡å®šå‚¨è—ï¼Œä½†æ˜¯ä¸ä»å †æ ˆä¸­åˆ é™¤è¯¥å‚¨è— git stash pop æ¢å¤æœ€æ–°ä¸€æ¬¡å‚¨è—ï¼Œå¹¶ä»å †æ ˆä¸­åˆ é™¤å®ƒ git stash drop stash@{2} åˆ é™¤æŒ‡å®šå‚¨è—","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://lucas0625.github.io/blog/categories/å·¥å…·/"}],"tags":[{"name":"Git","slug":"Git","permalink":"http://lucas0625.github.io/blog/tags/Git/"}]},{"title":"Python è™šæ‹Ÿç¯å¢ƒçš„ä½¿ç”¨","slug":"Python è™šæ‹Ÿç¯å¢ƒçš„ä½¿ç”¨","date":"2019-04-28T07:14:06.892Z","updated":"2019-04-28T07:14:06.892Z","comments":true,"path":"2019/04/28/Python è™šæ‹Ÿç¯å¢ƒçš„ä½¿ç”¨/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/28/Python è™šæ‹Ÿç¯å¢ƒçš„ä½¿ç”¨/","excerpt":"ç®€è¦ä»‹ç»pythonä¸­è™šæ‹Ÿç¯å¢ƒçš„ä½¿ç”¨","text":"ç®€è¦ä»‹ç»pythonä¸­è™šæ‹Ÿç¯å¢ƒçš„ä½¿ç”¨ Python è™šæ‹Ÿç¯å¢ƒçš„ä½¿ç”¨å®‰è£…virtualenvpip install virtualenv åˆ›å»ºè™šæ‹Ÿç¯å¢ƒåœ¨å½“å‰ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå®é™…ä¸Šå°±æ˜¯å°†pythonç¯å¢ƒå…‹éš†äº†ä¸€ä»½ï¼ŒåŒ…æ‹¬pythonè§£é‡Šå™¨ï¼Œsetuptoolsï¼Œ pipï¼Œ wheelï¼Œ ä»¥åŠpythonæ ‡å‡†åº“virtualenv venv ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒæ¿€æ´»åï¼Œç³»ç»Ÿæç¤ºç¬¦å·¦ä¾§ä¼šæ˜¾ç¤ºè™šæ‹Ÿç¯å¢ƒçš„åå­—ï¼Œ(venv)source venv/bin/activate é€€å‡ºè™šæ‹Ÿç¯å¢ƒdeactivate åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…åŒ…pip install -r requirements.txt å°†è™šæ‹Ÿç¯å¢ƒä¸­çš„ä¾èµ–åº“æ‰“åŒ…pip freeze &gt; requirements.txt åˆ é™¤è™šæ‹Ÿç¯å¢ƒrm -rf venv","categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://lucas0625.github.io/blog/categories/ç¼–ç¨‹/"}],"tags":[{"name":"åŸºç¡€","slug":"åŸºç¡€","permalink":"http://lucas0625.github.io/blog/tags/åŸºç¡€/"}]},{"title":"Glove åŸç†ä¸å®ç°","slug":"Glove","date":"2019-04-25T12:15:37.175Z","updated":"2019-04-25T12:15:37.175Z","comments":true,"path":"2019/04/25/Glove/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/Glove/","excerpt":"","text":"","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"TextRNN åŸç†ä¸å®ç°","slug":"TextRNN","date":"2019-04-25T06:22:25.197Z","updated":"2019-04-25T06:22:25.197Z","comments":true,"path":"2019/04/25/TextRNN/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/TextRNN/","excerpt":"","text":"","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"FastText åŸç†ä¸å®ç°","slug":"FastText","date":"2019-04-25T02:30:15.713Z","updated":"2019-04-25T02:30:15.713Z","comments":true,"path":"2019/04/25/FastText/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/FastText/","excerpt":"","text":"","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"Word2Vec åŸç†ä¸å®ç°","slug":"Word2Vec","date":"2019-04-25T02:30:06.908Z","updated":"2019-06-18T03:25:42.612Z","comments":true,"path":"2019/04/25/Word2Vec/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/Word2Vec/","excerpt":"word2vec è¯¦ç»†æ¨å¯¼ä¸ä»£ç å®ç°","text":"word2vec è¯¦ç»†æ¨å¯¼ä¸ä»£ç å®ç° åŸºç¡€çŸ¥è¯†é€»è¾‘å›å½’sigmoid å‡½æ•°å®šä¹‰ï¼š \\sigma(x)=\\frac{1}{1+e^{-x}}å‡½æ•°å®šä¹‰åŸŸä¸º$(-\\infty,+\\infty)$, å€¼åŸŸä¸º$(0.1)$ï¼Œå›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¯¼å‡½æ•°ï¼š \\sigma^{\\prime}(x)=\\sigma(x)[1-\\sigma(x)]å…¶ä¸­ï¼Œä»¥ä¸‹ä¸¤ä¸ªå¯¼å‡½æ•°åœ¨åç»­æ¨å¯¼ä¸­ä¼šç”¨åˆ°ã€‚$\\log \\sigma(x)$ çš„å¯¼å‡½æ•°ä¸ºï¼š [\\log \\sigma(x)]^{\\prime}=1-\\sigma(x)$\\log (1-\\sigma(x))$ çš„å¯¼å‡½æ•°ä¸ºï¼š [\\log (1-\\sigma(x))]^{\\prime}=-\\sigma(x)åˆ†ç±»è¿‡ç¨‹$\\mathbf{x}{i} \\in \\mathbb{R}^{n}, y{i} \\in{0,1}$ï¼Œè€Œåˆ†ç±»é—®é¢˜å¯å†™ä¸ºï¼š h_{\\theta}(\\mathbf{x})=\\sigma\\left(\\theta_{0}+\\theta_{1} x_{1}+\\theta_{2} x_{2}+\\cdots+\\theta_{n} x_{n}\\right)h_{\\theta}(\\mathbf{x})=\\sigma\\left(\\theta^{\\top} \\mathbf{x}\\right)=\\frac{1}{1+e^{-\\theta^{\\top} \\mathbf{x}}}è€Œåˆ†ç±»åˆ¤åˆ«å…¬å¼ï¼š y(\\mathrm{x})=\\left\\{\\begin{array}{ll}{1,} & {h_{\\theta}(\\mathrm{x}) \\geq 0.5} \\\\ {0,} & {h_{\\theta}(\\mathrm{x})","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"BERT åŸç†ä¸å®ç°","slug":"BERT","date":"2019-04-25T02:29:55.578Z","updated":"2019-04-25T02:29:55.578Z","comments":true,"path":"2019/04/25/BERT/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/BERT/","excerpt":"","text":"","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"Transformer åŸç†ä¸å®ç°","slug":"Transformer","date":"2019-04-25T02:29:27.661Z","updated":"2019-07-31T06:43:49.421Z","comments":true,"path":"2019/04/25/Transformer/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/Transformer/","excerpt":"","text":"Transformer æ¨¡å‹ä»‹ç» è¯´åˆ°è‡ªç„¶è¯­è¨€å¤„ç†, è¯­è¨€æ¨¡å‹, å‘½åå®ä½“è¯†åˆ«, æœºå™¨ç¿»è¯‘, å¯èƒ½å¾ˆå¤šäººæƒ³åˆ°çš„LSTMç­‰å¾ªç¯ç¥ç»ç½‘ç»œ, ä½†ç›®å‰å…¶å®LSTMèµ·ç åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸå·²ç»è¿‡æ—¶äº†, åœ¨Stanfordé˜…è¯»ç†è§£æ•°æ®é›†(SQuAD2.0)æ¦œå•é‡Œ, æœºå™¨çš„æˆç»©å·²ç»è¶…äººç±»è¡¨ç°, è¿™å¾ˆå¤§ç¨‹åº¦è¦å½’åŠŸäºtransformerçš„BERTé¢„è®­ç»ƒæ¨¡å‹. transformeræ˜¯è°·æ­Œå¤§è„‘åœ¨2017å¹´åº•å‘è¡¨çš„è®ºæ–‡attention is all you needä¸­æ‰€æå‡ºçš„seq2seqæ¨¡å‹. ç°åœ¨å·²ç»å–å¾—äº†å¤§èŒƒå›´çš„åº”ç”¨å’Œæ‰©å±•, è€ŒBERTå°±æ˜¯ä»transformerä¸­è¡ç”Ÿå‡ºæ¥çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹. ç›®å‰è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸçš„ç°çŠ¶, ç›®å‰transformeræ¨¡å‹å·²ç»å¾—åˆ°å¹¿æ³›è®¤å¯å’Œåº”ç”¨, è€Œåº”ç”¨çš„æ–¹å¼ä¸»è¦æ˜¯å…ˆè¿›è¡Œé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹, ç„¶åæŠŠé¢„è®­ç»ƒçš„æ¨¡å‹é€‚é…ç»™ä¸‹æ¸¸ä»»åŠ¡, ä»¥å®Œæˆå„ç§ä¸åŒçš„ä»»åŠ¡, å¦‚åˆ†ç±», ç”Ÿæˆ, æ ‡è®°ç­‰ç­‰, é¢„è®­ç»ƒæ¨¡å‹éå¸¸é‡è¦, é¢„è®­ç»ƒçš„æ¨¡å‹çš„æ€§èƒ½ç›´æ¥å½±å“ä¸‹æ¸¸ä»»åŠ¡çš„æ€§èƒ½ã€‚ transformerç¼–ç å™¨(ç†è®ºéƒ¨åˆ†): $transformer$æ¨¡å‹çš„ç›´è§‰, å»ºç«‹ç›´è§‚è®¤è¯†; $positional \\ encoding$, å³ä½ç½®åµŒå…¥(æˆ–ä½ç½®ç¼–ç ); $self \\ attention \\ mechanism$, å³è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¸æ³¨æ„åŠ›çŸ©é˜µå¯è§†åŒ–; $Layer \\ Normalization$å’Œæ®‹å·®è¿æ¥. $transformer \\ encoder$æ•´ä½“ç»“æ„. 0. $transformer$æ¨¡å‹çš„ç›´è§‰, å»ºç«‹ç›´è§‚è®¤è¯†;é¦–å…ˆæ¥è¯´ä¸€ä¸‹transformerå’ŒLSTMçš„æœ€å¤§åŒºåˆ«, å°±æ˜¯LSTMçš„è®­ç»ƒæ˜¯è¿­ä»£çš„, æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªå­—çš„æ¥, å½“å‰è¿™ä¸ªå­—è¿‡å®ŒLSTMå•å…ƒ, æ‰å¯ä»¥è¿›ä¸‹ä¸€ä¸ªå­—, è€Œtransformerçš„è®­ç»ƒæ˜¯å¹¶è¡Œäº†, å°±æ˜¯æ‰€æœ‰å­—æ˜¯å…¨éƒ¨åŒæ—¶è®­ç»ƒçš„, è¿™æ ·å°±å¤§å¤§åŠ å¿«äº†è®¡ç®—æ•ˆç‡, transformerä½¿ç”¨äº†ä½ç½®åµŒå…¥$(positional \\ encoding)$æ¥ç†è§£è¯­è¨€çš„é¡ºåº, ä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œå…¨è¿æ¥å±‚æ¥è¿›è¡Œè®¡ç®—, è¿™äº›åé¢éƒ½ä¼šè¯¦ç»†è®²è§£.transformeræ¨¡å‹ä¸»è¦åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†, åˆ†åˆ«æ˜¯ç¼–ç å™¨å’Œè§£ç å™¨, ç¼–ç å™¨è´Ÿè´£æŠŠè‡ªç„¶è¯­è¨€åºåˆ—æ˜ å°„æˆä¸ºéšè—å±‚(ä¸‹å›¾ä¸­ç¬¬2æ­¥ç”¨ä¹å®«æ ¼æ¯”å–»çš„éƒ¨åˆ†), å«æœ‰è‡ªç„¶è¯­è¨€åºåˆ—çš„æ•°å­¦è¡¨è¾¾. ç„¶åè§£ç å™¨æŠŠéšè—å±‚å†æ˜ å°„ä¸ºè‡ªç„¶è¯­è¨€åºåˆ—, ä»è€Œä½¿æˆ‘ä»¬å¯ä»¥è§£å†³å„ç§é—®é¢˜, å¦‚æƒ…æ„Ÿåˆ†ç±», å‘½åå®ä½“è¯†åˆ«, è¯­ä¹‰å…³ç³»æŠ½å–, æ‘˜è¦ç”Ÿæˆ, æœºå™¨ç¿»è¯‘ç­‰ç­‰, ä¸‹é¢æˆ‘ä»¬ç®€å•è¯´ä¸€ä¸‹ä¸‹å›¾çš„æ¯ä¸€æ­¥éƒ½åšäº†ä»€ä¹ˆ: è¾“å…¥è‡ªç„¶è¯­è¨€åºåˆ—åˆ°ç¼–ç å™¨: Why do we work?(ä¸ºä»€ä¹ˆè¦å·¥ä½œ); ç¼–ç å™¨è¾“å‡ºçš„éšè—å±‚, å†è¾“å…¥åˆ°è§£ç å™¨; è¾“å…¥$$(èµ·å§‹)ç¬¦å·åˆ°è§£ç å™¨; å¾—åˆ°ç¬¬ä¸€ä¸ªå­—â€ä¸ºâ€; å°†å¾—åˆ°çš„ç¬¬ä¸€ä¸ªå­—â€ä¸ºâ€è½ä¸‹æ¥å†è¾“å…¥åˆ°è§£ç å™¨; å¾—åˆ°ç¬¬äºŒä¸ªå­—â€ä»€â€; å°†å¾—åˆ°çš„ç¬¬äºŒå­—å†è½ä¸‹æ¥, ç›´åˆ°è§£ç å™¨è¾“å‡º$$(ç»ˆæ­¢ç¬¦), å³åºåˆ—ç”Ÿæˆå®Œæˆ. æœ¬èŠ‚å†…å®¹é™äºç¼–ç å™¨éƒ¨åˆ†, å³æŠŠè‡ªç„¶è¯­è¨€åºåˆ—æ˜ å°„ä¸ºéšè—å±‚çš„æ•°å­¦è¡¨è¾¾çš„è¿‡ç¨‹, å› ä¸ºç†è§£äº†ç¼–ç å™¨ä¸­çš„ç»“æ„, ç†è§£è§£ç å™¨å°±éå¸¸ç®€å•äº†,æœ€é‡è¦çš„æ˜¯BERTé¢„è®­ç»ƒæ¨¡å‹åªç”¨åˆ°äº†ç¼–ç å™¨çš„éƒ¨åˆ†, ä¹Ÿå°±æ˜¯å…ˆç”¨ç¼–ç å™¨è®­ç»ƒä¸€ä¸ªè¯­è¨€æ¨¡å‹, ç„¶åå†æŠŠå®ƒé€‚é…ç»™å…¶ä»–äº”èŠ±å…«é—¨çš„ä»»åŠ¡.è€Œä¸”æˆ‘ä»¬ç”¨ç¼–ç å™¨å°±èƒ½å¤Ÿå®Œæˆä¸€äº›è‡ªç„¶è¯­è¨€å¤„ç†ä¸­æ¯”è¾ƒä¸»æµçš„ä»»åŠ¡, å¦‚æƒ…æ„Ÿåˆ†ç±», è¯­ä¹‰å…³ç³»åˆ†æ, å‘½åå®ä½“è¯†åˆ«ç­‰ã€‚ Transformer Blockç»“æ„å›¾, æ³¨æ„: ä¸ºæ–¹ä¾¿æŸ¥çœ‹, ä¸‹é¢çš„å†…å®¹åˆ†åˆ«å¯¹åº”ç€ä¸Šå›¾ç¬¬1, 2, 3, 4ä¸ªæ–¹æ¡†çš„åºå·: 1. $positional \\ encoding$, å³ä½ç½®åµŒå…¥(æˆ–ä½ç½®ç¼–ç );ç”±äºtransformeræ¨¡å‹æ²¡æœ‰å¾ªç¯ç¥ç»ç½‘ç»œçš„è¿­ä»£æ“ä½œ, æ‰€ä»¥æˆ‘ä»¬å¿…é¡»æä¾›æ¯ä¸ªå­—çš„ä½ç½®ä¿¡æ¯ç»™transformer, æ‰èƒ½è¯†åˆ«å‡ºè¯­è¨€ä¸­çš„é¡ºåºå…³ç³».ç°åœ¨å®šä¹‰ä¸€ä¸ªä½ç½®åµŒå…¥çš„æ¦‚å¿µ, ä¹Ÿå°±æ˜¯$positional \\ encoding$, ä½ç½®åµŒå…¥çš„ç»´åº¦ä¸º$[max \\ sequence \\ length, \\ embedding \\ dimension]$, åµŒå…¥çš„ç»´åº¦åŒè¯å‘é‡çš„ç»´åº¦, $max \\ sequence \\ length$å±äºè¶…å‚æ•°, æŒ‡çš„æ˜¯é™å®šçš„æœ€å¤§å•ä¸ªå¥é•¿.æ³¨æ„, æˆ‘ä»¬ä¸€èˆ¬ä»¥å­—ä¸ºå•ä½è®­ç»ƒtransformeræ¨¡å‹, ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸ç”¨åˆ†è¯äº†, é¦–å…ˆæˆ‘ä»¬è¦åˆå§‹åŒ–å­—å‘é‡ä¸º$[vocab \\ size, \\ embedding \\ dimension]$, $vocab \\ size$ä¸ºæ€»å…±çš„å­—åº“æ•°é‡, $embedding \\ dimension$ä¸ºå­—å‘é‡çš„ç»´åº¦, ä¹Ÿæ˜¯æ¯ä¸ªå­—çš„æ•°å­¦è¡¨è¾¾.åœ¨è¿™é‡Œè®ºæ–‡ä¸­ä½¿ç”¨äº†$sine$å’Œ$cosine$å‡½æ•°çš„çº¿æ€§å˜æ¢æ¥æä¾›ç»™æ¨¡å‹ä½ç½®ä¿¡æ¯: PE_{(pos,2i)} = sin(pos / 10000^{2i/d_{\\text{model}}}) \\quad PE_{(pos,2i+1)} = cos(pos / 10000^{2i/d_{\\text{model}}})\\tag{eq.1}ä¸Šå¼ä¸­$pos$æŒ‡çš„æ˜¯å¥ä¸­å­—çš„ä½ç½®, å–å€¼èŒƒå›´æ˜¯$[0, \\ max \\ sequence \\ length)$, $i$æŒ‡çš„æ˜¯è¯å‘é‡çš„ç»´åº¦, å–å€¼èŒƒå›´æ˜¯$[0, \\ embedding \\ dimension)$, ä¸Šé¢æœ‰$sin$å’Œ$cos$ä¸€ç»„å…¬å¼, ä¹Ÿå°±æ˜¯å¯¹åº”ç€$embedding \\ dimension$ç»´åº¦çš„ä¸€ç»„å¥‡æ•°å’Œå¶æ•°çš„åºå·çš„ç»´åº¦, ä¾‹å¦‚$0, 1$ä¸€ç»„, $2, 3$ä¸€ç»„, åˆ†åˆ«ç”¨ä¸Šé¢çš„$sin$å’Œ$cos$å‡½æ•°åšå¤„ç†, ä»è€Œäº§ç”Ÿä¸åŒçš„å‘¨æœŸæ€§å˜åŒ–, è€Œä½ç½®åµŒå…¥åœ¨$embedding \\ dimension$ç»´åº¦ä¸Šéšç€ç»´åº¦åºå·å¢å¤§, å‘¨æœŸå˜åŒ–ä¼šè¶Šæ¥è¶Šæ…¢, è€Œäº§ç”Ÿä¸€ç§åŒ…å«ä½ç½®ä¿¡æ¯çš„çº¹ç†, å°±åƒè®ºæ–‡åŸæ–‡ä¸­ç¬¬å…­é¡µè®²çš„, ä½ç½®åµŒå…¥å‡½æ•°çš„å‘¨æœŸä»$2 \\pi$åˆ°$10000 * 2 \\pi$å˜åŒ–, è€Œæ¯ä¸€ä¸ªä½ç½®åœ¨$embedding \\ dimension$ç»´åº¦ä¸Šéƒ½ä¼šå¾—åˆ°ä¸åŒå‘¨æœŸçš„$sin$å’Œ$cos$å‡½æ•°çš„å–å€¼ç»„åˆ, ä»è€Œäº§ç”Ÿç‹¬ä¸€çš„çº¹ç†ä½ç½®ä¿¡æ¯, æ¨¡å‹ä»è€Œå­¦åˆ°ä½ç½®ä¹‹é—´çš„ä¾èµ–å…³ç³»å’Œè‡ªç„¶è¯­è¨€çš„æ—¶åºç‰¹æ€§.ä¸‹é¢ç”»ä¸€ä¸‹ä½ç½®åµŒå…¥, å¯è§çºµå‘è§‚å¯Ÿ, éšç€$embedding \\ dimension$å¢å¤§, ä½ç½®åµŒå…¥å‡½æ•°å‘ˆç°ä¸åŒçš„å‘¨æœŸå˜åŒ–. # å¯¼å…¥ä¾èµ–åº“import numpy as npimport matplotlib.pyplot as pltimport seaborn as snsimport math def get_positional_encoding(max_seq_len, embed_dim): # åˆå§‹åŒ–ä¸€ä¸ªpositional encoding # embed_dim: å­—åµŒå…¥çš„ç»´åº¦ # max_seq_len: æœ€å¤§çš„åºåˆ—é•¿åº¦ positional_encoding = np.array([ [pos / np.power(10000, 2 * i / embed_dim) for i in range(embed_dim)] if pos != 0 else np.zeros(embed_dim) for pos in range(max_seq_len)]) positional_encoding[1:, 0::2] = np.sin(positional_encoding[1:, 0::2]) # dim 2i å¶æ•° positional_encoding[1:, 1::2] = np.cos(positional_encoding[1:, 1::2]) # dim 2i+1 å¥‡æ•° # å½’ä¸€åŒ–, ç”¨ä½ç½®åµŒå…¥çš„æ¯ä¸€è¡Œé™¤ä»¥å®ƒçš„æ¨¡é•¿ # denominator = np.sqrt(np.sum(position_enc**2, axis=1, keepdims=True)) # position_enc = position_enc / (denominator + 1e-8) return positional_encoding positional_encoding = get_positional_encoding(max_seq_len=100, embed_dim=16)plt.figure(figsize=(10,10))sns.heatmap(positional_encoding)plt.title(\"Sinusoidal Function\")plt.xlabel(\"hidden dimension\")plt.ylabel(\"sequence length\") Text(69.0, 0.5, &#39;sequence length&#39;) plt.figure(figsize=(8, 5))plt.plot(positional_encoding[1:, 1], label=\"dimension 1\")plt.plot(positional_encoding[1:, 2], label=\"dimension 2\")plt.plot(positional_encoding[1:, 3], label=\"dimension 3\")plt.legend()plt.xlabel(\"Sequence length\")plt.ylabel(\"Period of Positional Encoding\") Text(0, 0.5, &#39;Period of Positional Encoding&#39;) X: [batch_size, len, embedding_size]W: [embedding_size, hidden_dimension]XW = [batch_size, len, hidden_dimension] 2. $self \\ attention \\ mechanism$, è‡ªæ³¨æ„åŠ›æœºåˆ¶; Attention Mask æ³¨æ„, åœ¨ä¸Šé¢$self \\ attention$çš„è®¡ç®—è¿‡ç¨‹ä¸­, æˆ‘ä»¬é€šå¸¸ä½¿ç”¨$mini \\ batch$æ¥è®¡ç®—, ä¹Ÿå°±æ˜¯ä¸€æ¬¡è®¡ç®—å¤šå¥è¯, ä¹Ÿå°±æ˜¯$X$çš„ç»´åº¦æ˜¯$[batch \\ size, \\ sequence \\ length]$, $sequence \\ length$æ˜¯å¥é•¿, è€Œä¸€ä¸ª$mini \\ batch$æ˜¯ç”±å¤šä¸ªä¸ç­‰é•¿çš„å¥å­ç»„æˆçš„, æˆ‘ä»¬å°±éœ€è¦æŒ‰ç…§è¿™ä¸ª$mini \\ batch$ä¸­æœ€å¤§çš„å¥é•¿å¯¹å‰©ä½™çš„å¥å­è¿›è¡Œè¡¥é½é•¿åº¦, æˆ‘ä»¬ä¸€èˆ¬ç”¨$0$æ¥è¿›è¡Œå¡«å……, è¿™ä¸ªè¿‡ç¨‹å«åš$padding$.ä½†è¿™æ—¶åœ¨è¿›è¡Œ$softmax$çš„æ—¶å€™å°±ä¼šäº§ç”Ÿé—®é¢˜, å›é¡¾$softmax$å‡½æ•°$\\sigma (\\mathbf {z} ){i}={\\frac {e^{z{i}}}{\\sum {j=1}^{K}e^{z{j}}}}$, $e^0$æ˜¯1, æ˜¯æœ‰å€¼çš„, è¿™æ ·çš„è¯$softmax$ä¸­è¢«$padding$çš„éƒ¨åˆ†å°±å‚ä¸äº†è¿ç®—, å°±ç­‰äºæ˜¯è®©æ— æ•ˆçš„éƒ¨åˆ†å‚ä¸äº†è¿ç®—, ä¼šäº§ç”Ÿå¾ˆå¤§éšæ‚£, è¿™æ—¶å°±éœ€è¦åšä¸€ä¸ª$mask$è®©è¿™äº›æ— æ•ˆåŒºåŸŸä¸å‚ä¸è¿ç®—, æˆ‘ä»¬ä¸€èˆ¬ç»™æ— æ•ˆåŒºåŸŸåŠ ä¸€ä¸ªå¾ˆå¤§çš„è´Ÿæ•°çš„åç½®, ä¹Ÿå°±æ˜¯: z_{illegal} = z_{illegal} + bias_{illegal}bias_{illegal} \\to -\\inftye^{z_{illegal}} \\to 0ç»è¿‡ä¸Šå¼çš„$masking$æˆ‘ä»¬ä½¿æ— æ•ˆåŒºåŸŸç»è¿‡$softmax$è®¡ç®—ä¹‹åè¿˜å‡ ä¹ä¸º$0$, è¿™æ ·å°±é¿å…äº†æ— æ•ˆåŒºåŸŸå‚ä¸è®¡ç®—. 3. $Layer \\ Normalization$å’Œæ®‹å·®è¿æ¥.1). æ®‹å·®è¿æ¥:æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥å¾—åˆ°äº†ç»è¿‡æ³¨æ„åŠ›çŸ©é˜µåŠ æƒä¹‹åçš„$V$, ä¹Ÿå°±æ˜¯$Attention(Q, \\ K, \\ V)$, æˆ‘ä»¬å¯¹å®ƒè¿›è¡Œä¸€ä¸‹è½¬ç½®, ä½¿å…¶å’Œ$X_{embedding}$çš„ç»´åº¦ä¸€è‡´, ä¹Ÿå°±æ˜¯$[batch \\ size, \\ sequence \\ length, \\ embedding \\ dimension]$, ç„¶åæŠŠä»–ä»¬åŠ èµ·æ¥åšæ®‹å·®è¿æ¥, ç›´æ¥è¿›è¡Œå…ƒç´ ç›¸åŠ , å› ä¸ºä»–ä»¬çš„ç»´åº¦ä¸€è‡´: X_{embedding} + Attention(Q, \\ K, \\ V)åœ¨ä¹‹åçš„è¿ç®—é‡Œ, æ¯ç»è¿‡ä¸€ä¸ªæ¨¡å—çš„è¿ç®—, éƒ½è¦æŠŠè¿ç®—ä¹‹å‰çš„å€¼å’Œè¿ç®—ä¹‹åçš„å€¼ç›¸åŠ , ä»è€Œå¾—åˆ°æ®‹å·®è¿æ¥, è®­ç»ƒçš„æ—¶å€™å¯ä»¥ä½¿æ¢¯åº¦ç›´æ¥èµ°æ·å¾„åä¼ åˆ°æœ€åˆå§‹å±‚: X + SubLayer(X) \\tag{eq. 5}2). $LayerNorm$:$Layer Normalization$çš„ä½œç”¨æ˜¯æŠŠç¥ç»ç½‘ç»œä¸­éšè—å±‚å½’ä¸€ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ, ä¹Ÿå°±æ˜¯$i.i.d$ç‹¬ç«‹åŒåˆ†å¸ƒ, ä»¥èµ·åˆ°åŠ å¿«è®­ç»ƒé€Ÿåº¦, åŠ é€Ÿæ”¶æ•›çš„ä½œç”¨: \\mu_{i}=\\frac{1}{m} \\sum^{m}_{i=1}x_{ij}ä¸Šå¼ä¸­ä»¥çŸ©é˜µçš„è¡Œ$(row)$ä¸ºå•ä½æ±‚å‡å€¼; \\sigma^{2}_{j}=\\frac{1}{m} \\sum^{m}_{i=1} (x_{ij}-\\mu_{j})^{2}ä¸Šå¼ä¸­ä»¥çŸ©é˜µçš„è¡Œ$(row)$ä¸ºå•ä½æ±‚æ–¹å·®; LayerNorm(x)=\\alpha \\odot \\frac{x_{ij}-\\mu_{i}} {\\sqrt{\\sigma^{2}_{i}+\\epsilon}} + \\beta \\tag{eq.6}ç„¶åç”¨æ¯ä¸€è¡Œçš„æ¯ä¸€ä¸ªå…ƒç´ å‡å»è¿™è¡Œçš„å‡å€¼, å†é™¤ä»¥è¿™è¡Œçš„æ ‡å‡†å·®, ä»è€Œå¾—åˆ°å½’ä¸€åŒ–åçš„æ•°å€¼, $\\epsilon$æ˜¯ä¸ºäº†é˜²æ­¢é™¤$0$;ä¹‹åå¼•å…¥ä¸¤ä¸ªå¯è®­ç»ƒå‚æ•°$\\alpha, \\ \\beta$æ¥å¼¥è¡¥å½’ä¸€åŒ–çš„è¿‡ç¨‹ä¸­æŸå¤±æ‰çš„ä¿¡æ¯, æ³¨æ„$\\odot$è¡¨ç¤ºå…ƒç´ ç›¸ä¹˜è€Œä¸æ˜¯ç‚¹ç§¯, æˆ‘ä»¬ä¸€èˆ¬åˆå§‹åŒ–$\\alpha$ä¸ºå…¨$1$, è€Œ$\\beta$ä¸ºå…¨$0$. 4. $transformer \\ encoder$æ•´ä½“ç»“æ„.ç»è¿‡ä¸Šé¢3ä¸ªæ­¥éª¤, æˆ‘ä»¬å·²ç»åŸºæœ¬äº†è§£åˆ°æ¥$transformer$ç¼–ç å™¨çš„ä¸»è¦æ„æˆéƒ¨åˆ†, æˆ‘ä»¬ä¸‹é¢ç”¨å…¬å¼æŠŠä¸€ä¸ª$transformer \\ block$çš„è®¡ç®—è¿‡ç¨‹æ•´ç†ä¸€ä¸‹:1). å­—å‘é‡ä¸ä½ç½®ç¼–ç : X = EmbeddingLookup(X) + PositionalEncoding \\tag{eq.2}X \\in \\mathbb{R}^{batch \\ size \\ * \\ seq. \\ len. \\ * \\ embed. \\ dim.}2). è‡ªæ³¨æ„åŠ›æœºåˆ¶: Q = Linear(X) = XW_{Q}K = Linear(X) = XW_{K} \\tag{eq.3}V = Linear(X) = XW_{V}X_{attention} = SelfAttention(Q, \\ K, \\ V) \\tag{eq.4}3). æ®‹å·®è¿æ¥ä¸$Layer \\ Normalization$ X_{attention} = X + X_{attention} \\tag{eq. 5}X_{attention} = LayerNorm(X_{attention}) \\tag{eq. 6}4). ä¸‹é¢è¿›è¡Œ$transformer \\ block$ç»“æ„å›¾ä¸­çš„ç¬¬4éƒ¨åˆ†, ä¹Ÿå°±æ˜¯$FeedForward$, å…¶å®å°±æ˜¯ä¸¤å±‚çº¿æ€§æ˜ å°„å¹¶ç”¨æ¿€æ´»å‡½æ•°æ¿€æ´», æ¯”å¦‚è¯´$ReLU$: X_{hidden} = Activate(Linear(Linear(X_{attention}))) \\tag{eq. 7}5). é‡å¤3).: X_{hidden} = X_{attention} + X_{hidden}X_{hidden} = LayerNorm(X_{hidden})X_{hidden} \\in \\mathbb{R}^{batch \\ size \\ * \\ seq. \\ len. \\ * \\ embed. \\ dim.}å°ç»“:æˆ‘ä»¬åˆ°ç°åœ¨ä½ç½®å·²ç»è®²å®Œäº†transformerçš„ç¼–ç å™¨çš„éƒ¨åˆ†, äº†è§£åˆ°äº†transformeræ˜¯æ€æ ·è·å¾—è‡ªç„¶è¯­è¨€çš„ä½ç½®ä¿¡æ¯çš„, æ³¨æ„åŠ›æœºåˆ¶æ˜¯æ€æ ·çš„, å…¶å®ä¸¾ä¸ªè¯­è¨€æƒ…æ„Ÿåˆ†ç±»çš„ä¾‹å­, æˆ‘ä»¬å·²ç»çŸ¥é“, ç»è¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶, ä¸€å¥è¯ä¸­çš„æ¯ä¸ªå­—éƒ½å«æœ‰è¿™å¥è¯ä¸­å…¶ä»–æ‰€æœ‰å­—çš„ä¿¡æ¯, é‚£ä¹ˆæˆ‘ä»¬å¯ä¸å¯ä»¥æ·»åŠ ä¸€ä¸ªç©ºç™½å­—ç¬¦åˆ°å¥å­æœ€å‰é¢, ç„¶åè®©å¥å­ä¸­çš„æ‰€æœ‰ä¿¡æ¯å‘è¿™ä¸ªç©ºç™½å­—ç¬¦æ±‡æ€», ç„¶åå†æ˜ å°„æˆæƒ³è¦åˆ†çš„ç±»åˆ«å‘¢? è¿™å°±æ˜¯BERT, æˆ‘ä»¬ä¸‹æ¬¡ä¼šè®²åˆ°.åœ¨BERTçš„é¢„è®­ç»ƒä¸­, æˆ‘ä»¬ç»™æ¯å¥è¯çš„å¥å¤´åŠ ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦, ç„¶åå¥æœ«å†åŠ ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦, ä¹‹åæ¨¡å‹é¢„è®­ç»ƒå®Œæ¯•ä¹‹å, æˆ‘ä»¬å°±å¯ä»¥ç”¨å¥å¤´çš„ç‰¹æ®Šå­—ç¬¦çš„$hidden \\ state$å®Œæˆä¸€äº›åˆ†ç±»ä»»åŠ¡äº†.","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"Bi-LSTM åŸç†ä¸å®ç°","slug":"Bi-LSTM","date":"2019-04-25T02:28:40.370Z","updated":"2019-04-25T02:28:40.370Z","comments":true,"path":"2019/04/25/Bi-LSTM/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/Bi-LSTM/","excerpt":"","text":"","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"TextLSTM åŸç†ä¸å®ç°","slug":"TextLSTM","date":"2019-04-25T02:27:57.789Z","updated":"2019-04-25T02:27:57.790Z","comments":true,"path":"2019/04/25/TextLSTM/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/TextLSTM/","excerpt":"","text":"","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"TextCNN åŸç†ä¸å®ç°","slug":"TextCNN","date":"2019-04-25T02:27:21.661Z","updated":"2019-04-25T02:27:21.662Z","comments":true,"path":"2019/04/25/TextCNN/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/TextCNN/","excerpt":"","text":"","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"NNLM åŸç†ä¸å®ç°","slug":"NNLM","date":"2019-04-25T02:25:41.973Z","updated":"2019-04-25T02:25:41.973Z","comments":true,"path":"2019/04/25/NNLM/","link":"","permalink":"http://lucas0625.github.io/blog/2019/04/25/NNLM/","excerpt":"","text":"","categories":[{"name":"è‡ªç„¶è¯­è¨€å¤„ç†","slug":"è‡ªç„¶è¯­è¨€å¤„ç†","permalink":"http://lucas0625.github.io/blog/categories/è‡ªç„¶è¯­è¨€å¤„ç†/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"Logistic å›å½’","slug":"Logisticå›å½’","date":"2019-02-04T16:00:00.000Z","updated":"2019-05-31T07:38:10.314Z","comments":true,"path":"2019/02/05/Logisticå›å½’/","link":"","permalink":"http://lucas0625.github.io/blog/2019/02/05/Logisticå›å½’/","excerpt":"Logistic å›å½’ç†è®ºä¸å®æˆ˜","text":"Logistic å›å½’ç†è®ºä¸å®æˆ˜ Logistic å›å½’æ¨¡å‹Sigmoid å‡½æ•°Sigmoid å‡½æ•°ï¼Œå…¬ç¤ºå¦‚ä¸‹: f(x)=\\frac{1}{1+e^{-x}}å›¾åƒå¦‚ä¸‹: æŸå¤±å‡½æ•° \\operatorname{loss} =-(y * \\log (\\hat{y})+(1-y) * \\log (1-\\hat{y})) \\operatorname{loss}=-(\\log (1-\\hat{y})) \\operatorname{loss}=-(\\log (\\hat{y}))æ¨¡å‹ ä»£ç import torchfrom torch.autograd import Variableimport numpy as npimport matplotlib.pyplot as plt%matplotlib inline # è®¾å®šéšæœºç§å­torch.manual_seed(2017) &lt;torch._C.Generator at 0x10d916550&gt; # ä» data.txt ä¸­è¯»å…¥ç‚¹with open('./Logistic_data.txt', 'r') as f: data_list = [i.split('\\n')[0].split(',') for i in f.readlines()] data = [(float(i[0]), float(i[1]), float(i[2])) for i in data_list]# æ ‡å‡†åŒ–x0_max = max([i[0] for i in data])x1_max = max([i[1] for i in data])data = [(i[0]/x0_max, i[1]/x1_max, i[2]) for i in data]x0 = list(filter(lambda x: x[-1] == 0.0, data)) # é€‰æ‹©ç¬¬ä¸€ç±»çš„ç‚¹x1 = list(filter(lambda x: x[-1] == 1.0, data)) # é€‰æ‹©ç¬¬äºŒç±»çš„ç‚¹plot_x0 = [i[0] for i in x0]plot_y0 = [i[1] for i in x0]plot_x1 = [i[0] for i in x1]plot_y1 = [i[1] for i in x1]plt.plot(plot_x0, plot_y0, 'ro', label='x_0')plt.plot(plot_x1, plot_y1, 'bo', label='x_1')plt.legend(loc='best') &lt;matplotlib.legend.Legend at 0x112a31f98&gt; np_data = np.array(data, dtype='float32') # è½¬æ¢æˆ numpy arrayx_data = torch.from_numpy(np_data[:, 0:2]) # è½¬æ¢æˆ Tensor, å¤§å°æ˜¯ [100, 2]y_data = torch.from_numpy(np_data[:, -1]).unsqueeze(1) # è½¬æ¢æˆ Tensorï¼Œå¤§å°æ˜¯ [100, 1] å®ç°Sigmoid çš„å‡½æ•°ï¼ŒSigmoid å‡½æ•°çš„å…¬å¼ä¸º f(x) = \\frac{1}{1 + e^{-x}}# å®šä¹‰ sigmoid å‡½æ•°def sigmoid(x): return 1 / (1 + np.exp(-x)) # ç”»å‡º sigmoid çš„å›¾åƒplot_x = np.arange(-10, 10.01, 0.01)plot_y = sigmoid(plot_x)plt.plot(plot_x, plot_y, 'r') [&lt;matplotlib.lines.Line2D at 0x115df7fd0&gt;] x_data = Variable(x_data)y_data = Variable(y_data) # å®šä¹‰ logistic å›å½’æ¨¡å‹w = Variable(torch.randn(2, 1), requires_grad=True) b = Variable(torch.zeros(1), requires_grad=True)def logistic_regression(x): return torch.sigmoid(torch.mm(x, w) + b) # ç”»å‡ºå‚æ•°æ›´æ–°ä¹‹å‰çš„ç»“æœw0 = w[0].data[0]w1 = w[1].data[0]b0 = b.data[0]plot_x = np.arange(0.2, 1, 0.01)plot_x = torch.from_numpy(plot_x) # è½¬æ¢æˆTensorplot_y = (-w0 * plot_x - b0) / w1plot_x = plot_x.numpy() # è½¬æ¢æˆnumpyplot_y = plot_y.numpy() # è½¬æ¢æˆnumpyplt.plot(plot_x, plot_y, 'g', label='cutting line')plt.plot(plot_x0, plot_y0, 'ro', label='x_0')plt.plot(plot_x1, plot_y1, 'bo', label='x_1')plt.legend(loc='best') &lt;matplotlib.legend.Legend at 0x11686cc18&gt; å¯ä»¥çœ‹åˆ°åˆ†ç±»æ•ˆæœåŸºæœ¬æ˜¯æ··ä¹±çš„ï¼Œæˆ‘ä»¬æ¥è®¡ç®—ä¸€ä¸‹ lossï¼Œå…¬å¼å¦‚ä¸‹ loss = -(y * log(\\hat{y}) + (1 - y) * log(1 - \\hat{y}))# è®¡ç®—lossdef binary_loss(y_pred, y): logits = (y * y_pred.clamp(1e-12).log() + (1 - y) * (1 - y_pred).clamp(1e-12).log()).mean() return -logits y_pred = logistic_regression(x_data)loss = binary_loss(y_pred, y_data)print(loss) tensor(0.7911, grad_fn=&lt;NegBackward&gt;) # è‡ªåŠ¨æ±‚å¯¼å¹¶æ›´æ–°å‚æ•°loss.backward()w.data = w.data - 0.1 * w.grad.datab.data = b.data - 0.1 * b.grad.data# ç®—å‡ºä¸€æ¬¡æ›´æ–°ä¹‹åçš„lossy_pred = logistic_regression(x_data)loss = binary_loss(y_pred, y_data)print(loss) tensor(0.7801, grad_fn=&lt;NegBackward&gt;) # ä½¿ç”¨ torch.optim æ›´æ–°å‚æ•°from torch import nnw = nn.Parameter(torch.randn(2, 1))b = nn.Parameter(torch.zeros(1))optimizer = torch.optim.SGD([w, b], lr=1.) # è¿›è¡Œ 1000 æ¬¡æ›´æ–°import timestart = time.time()for e in range(1000): # å‰å‘ä¼ æ’­ y_pred = logistic_regression(x_data) loss = binary_loss(y_pred, y_data) # è®¡ç®— loss # åå‘ä¼ æ’­ optimizer.zero_grad() # ä½¿ç”¨ä¼˜åŒ–å™¨å°†æ¢¯åº¦å½’ 0 loss.backward() optimizer.step() # ä½¿ç”¨ä¼˜åŒ–å™¨æ¥æ›´æ–°å‚æ•° # è®¡ç®—æ­£ç¡®ç‡ mask = y_pred.ge(0.5).float() acc = (mask == y_data).sum().data.item() / y_data.shape[0] if (e + 1) % 200 == 0: print('epoch: &#123;&#125;, Loss: &#123;:.5f&#125;, Acc: &#123;:.5f&#125;'.format(e+1, loss.data.item(), acc))during = time.time() - startprint()print('During Time: &#123;:.3f&#125; s'.format(during)) epoch: 200, Loss: 0.32431, Acc: 0.91000 epoch: 400, Loss: 0.29052, Acc: 0.91000 epoch: 600, Loss: 0.27069, Acc: 0.91000 epoch: 800, Loss: 0.25759, Acc: 0.90000 epoch: 1000, Loss: 0.24827, Acc: 0.89000 During Time: 0.304 s # ç”»å‡ºæ›´æ–°ä¹‹åçš„ç»“æœw0 = w[0].data[0]w1 = w[1].data[0]b0 = b.data[0]plot_x = np.arange(0.2, 1, 0.01)plot_x = torch.from_numpy(plot_x) # è½¬æ¢æˆTensorplot_y = (-w0 * plot_x - b0) / w1plot_x = plot_x.numpy() # è½¬æ¢æˆnumpyplot_y = plot_y.numpy() # è½¬æ¢æˆnumpyplt.plot(plot_x, plot_y, 'g', label='cutting line')plt.plot(plot_x0, plot_y0, 'ro', label='x_0')plt.plot(plot_x1, plot_y1, 'bo', label='x_1')plt.legend(loc='best') &lt;matplotlib.legend.Legend at 0x116526ef0&gt; å‰é¢æˆ‘ä»¬ä½¿ç”¨äº†è‡ªå·±å†™çš„ lossï¼Œå…¶å® PyTorch å·²ç»ä¸ºæˆ‘ä»¬å†™å¥½äº†ä¸€äº›å¸¸è§çš„ lossï¼Œæ¯”å¦‚çº¿æ€§å›å½’é‡Œé¢çš„ loss æ˜¯ nn.MSE()ï¼Œè€Œ Logistic å›å½’çš„äºŒåˆ†ç±» loss åœ¨ PyTorch ä¸­æ˜¯ nn.BCEWithLogitsLoss()ï¼Œå…³äºæ›´å¤šçš„ lossï¼Œå¯ä»¥æŸ¥çœ‹æ–‡æ¡£ PyTorch ä¸ºæˆ‘ä»¬å®ç°çš„ loss å‡½æ•°æœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œç¬¬ä¸€æ˜¯æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ï¼Œä¸éœ€è¦é‡å¤é€ è½®å­ï¼Œç¬¬äºŒå°±æ˜¯å…¶å®ç°æ˜¯åœ¨åº•å±‚ C++ è¯­è¨€ä¸Šçš„ï¼Œæ‰€ä»¥é€Ÿåº¦ä¸Šå’Œç¨³å®šæ€§ä¸Šéƒ½è¦æ¯”æˆ‘ä»¬è‡ªå·±å®ç°çš„è¦å¥½ å¦å¤–ï¼ŒPyTorch å‡ºäºç¨³å®šæ€§è€ƒè™‘ï¼Œå°†æ¨¡å‹çš„ Sigmoid æ“ä½œå’Œæœ€åçš„ loss éƒ½åˆåœ¨äº† nn.BCEWithLogitsLoss()ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ PyTorch è‡ªå¸¦çš„ loss å°±ä¸éœ€è¦å†åŠ ä¸Š Sigmoid æ“ä½œäº† # ä½¿ç”¨è‡ªå¸¦çš„losscriterion = nn.BCEWithLogitsLoss() # å°† sigmoid å’Œ loss å†™åœ¨ä¸€å±‚ï¼Œæœ‰æ›´å¿«çš„é€Ÿåº¦ã€æ›´å¥½çš„ç¨³å®šæ€§w = nn.Parameter(torch.randn(2, 1))b = nn.Parameter(torch.zeros(1))def logistic_reg(x): return torch.mm(x, w) + boptimizer = torch.optim.SGD([w, b], 1.) y_pred = logistic_reg(x_data)loss = criterion(y_pred, y_data)print(loss.data) tensor(0.6650) # åŒæ ·è¿›è¡Œ 1000 æ¬¡æ›´æ–°start = time.time()for e in range(1000): # å‰å‘ä¼ æ’­ y_pred = logistic_reg(x_data) loss = criterion(y_pred, y_data) # åå‘ä¼ æ’­ optimizer.zero_grad() loss.backward() optimizer.step() # è®¡ç®—æ­£ç¡®ç‡ mask = y_pred.ge(0.5).float() acc = (mask == y_data).sum().data.item() / y_data.shape[0] if (e + 1) % 200 == 0: print('epoch: &#123;&#125;, Loss: &#123;:.5f&#125;, Acc: &#123;:.5f&#125;'.format(e+1, loss.data.item(), acc))during = time.time() - startprint()print('During Time: &#123;:.3f&#125; s'.format(during)) epoch: 200, Loss: 0.39010, Acc: 0.87000 epoch: 400, Loss: 0.32184, Acc: 0.87000 epoch: 600, Loss: 0.28917, Acc: 0.87000 epoch: 800, Loss: 0.26983, Acc: 0.87000 epoch: 1000, Loss: 0.25700, Acc: 0.88000 During Time: 0.202 s å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨äº† PyTorch è‡ªå¸¦çš„ loss ä¹‹åï¼Œé€Ÿåº¦æœ‰äº†ä¸€å®šçš„ä¸Šå‡ï¼Œè™½ç„¶çœ‹ä¸Šå»é€Ÿåº¦çš„æå‡å¹¶ä¸å¤šï¼Œä½†æ˜¯è¿™åªæ˜¯ä¸€ä¸ªå°ç½‘ç»œï¼Œå¯¹äºå¤§ç½‘ç»œï¼Œä½¿ç”¨è‡ªå¸¦çš„ loss ä¸ç®¡å¯¹äºç¨³å®šæ€§è¿˜æ˜¯é€Ÿåº¦è€Œè¨€ï¼Œéƒ½æœ‰è´¨çš„é£è·ƒï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†é‡å¤é€ è½®å­çš„å›°æ‰°","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"Pytorch åŸºæœ¬æ¦‚å¿µ","slug":"åŸºæœ¬æ¦‚å¿µ","date":"2019-02-04T16:00:00.000Z","updated":"2019-05-31T07:38:09.846Z","comments":true,"path":"2019/02/05/åŸºæœ¬æ¦‚å¿µ/","link":"","permalink":"http://lucas0625.github.io/blog/2019/02/05/åŸºæœ¬æ¦‚å¿µ/","excerpt":"æœ¬æ–‡ä»‹ç»Pytorchçš„åŸºæœ¬æ¦‚å¿µã€‚","text":"æœ¬æ–‡ä»‹ç»Pytorchçš„åŸºæœ¬æ¦‚å¿µã€‚ Pytorch åŸºæœ¬æ¦‚å¿µimport torchimport numpy as npimport pandas as pdfrom torch import nnfrom torch.autograd import Variablefrom torch.utils.data import Dataset, DataLoader torch.cuda.is_available() False Tensor å¼ é‡è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå¤šç»´çŸ©é˜µï¼Œé›¶ç»´å°±æ˜¯ä¸€ä¸ªç‚¹ï¼Œä¸€ç»´å°±æ˜¯å‘é‡ï¼ŒäºŒç»´å°±æ˜¯ä¸€èˆ¬çš„çŸ©é˜µï¼Œå¤šç»´å°±ç›¸å½“äºä¸€ä¸ªå¤šç»´çŸ©é˜µï¼ŒTensorå¯ä»¥å’Œnumpyçš„ndarrayç›¸äº’å¯¹åº”ï¼ŒTensorå¯ä»¥å’Œndarrayç›¸äº’è½¬æ¢ a = torch.Tensor([[2, 3], [4, 8], [7, 9]])print('a is : &#123;&#125;'.format(a))print('a size is &#123;&#125;'.format(a.size())) a is : tensor([[2., 3.], [4., 8.], [7., 9.]]) a size is torch.Size([3, 2]) b = torch.LongTensor([[2, 3], [4, 8],[7, 9]])print('b is : &#123;&#125;'.format(b)) b is : tensor([[2, 3], [4, 8], [7, 9]]) c = torch.zeros((3, 2))print('zero tensor : &#123;&#125;'.format(c))d = torch.randn((3, 2))print('randn tensor is : &#123;&#125;'.format(d)) zero tensor : tensor([[0., 0.], [0., 0.], [0., 0.]]) randn tensor is : tensor([[-0.7097, -0.2020], [-0.1451, -0.3853], [-0.9366, 1.1942]]) a[0, 1] = 100print('changed a is : &#123;&#125;'.format(a)) changed a is : tensor([[ 2., 100.], [ 4., 8.], [ 7., 9.]]) numpy_b = b.numpy()print('conver to numpy is \\n &#123;&#125;'.format(numpy_b)) conver to numpy is [[2 3] [4 8] [7 9]] e = np.array([[2, 3], [4, 5]])torch_e = torch.from_numpy(e)print('from numpy to touch.Tensor is &#123;&#125;'.format(torch_e))f_torch_e = torch_e.float()print('change data type to float tensor : &#123;&#125;'.format(f_torch_e)) from numpy to touch.Tensor is tensor([[2, 3], [4, 5]]) change data type to float tensor : tensor([[2., 3.], [4., 5.]]) Variable å˜é‡variable æä¾›äº†è‡ªåŠ¨æ±‚å¯¼åŠŸèƒ½ï¼ŒVariableå’ŒTensoræ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œä¸è¿‡Variableä¼šè¢«æ”¾å…¥ä¸€ä¸ªè®¡ç®—å›¾ä¸­ï¼Œç„¶åè¿›è¡Œå‰å‘ä¼ æ’­ï¼Œåå‘ä¼ æ’­ï¼Œè‡ªåŠ¨æ±‚å¯¼ Variableæœ‰ä¸‰ä¸ªæ¯”è¾ƒé‡è¦çš„ç»„æˆå±æ€§ï¼šdataï¼Œ gradï¼Œ grad_fn dataï¼š å¯ä»¥å–å‡ºVariableä¸­çš„Tensoræ•°å€¼ grad_fnï¼š è¡¨ç¤ºçš„æ˜¯å¾—åˆ°è¿™ä¸ªVariableçš„æ“ä½œï¼Œæ¯”å¦‚åŠ å‡æˆ–è€…ä¹˜é™¤ gradï¼š æ˜¯è¿™ä¸ªVariableçš„åå‘ä¼ æ’­æ¢¯åº¦ # creat Variablex = Variable(torch.Tensor([1]), requires_grad=True)w = Variable(torch.Tensor([2]), requires_grad=True)b = Variable(torch.Tensor([3]), requires_grad=True)# build a computational graphy = w * x + b# compute gradientsy.backward()print(x.grad)print(w.grad)print(b.grad) tensor([2.]) tensor([1.]) tensor([1.]) # çŸ©é˜µæ±‚å¯¼x = torch.randn(3)x = Variable(x, requires_grad=True)y = x * 2print(y)y.backward(torch.FloatTensor([1, 0.1, 0.01]))print(x.grad) tensor([-0.6298, 1.7484, -1.1588], grad_fn=&lt;MulBackward0&gt;) tensor([2.0000, 0.2000, 0.0200]) Dataset æ•°æ®é›†torch.utils.data.Dataset ä»£è¡¨è¿™ä¸€æ•°æ®çš„æŠ½è±¡ç±»å—å¯ä»¥è‡ªå·±å®šä¹‰æ•°æ®ç±»çš„ç»§æ‰¿å’Œé‡å†™ï¼Œåªéœ€è¦å®šä¹‰_len_å’Œ _getitem_ ä¸¤ä¸ªå‡½æ•° class myDataset(Dataset): def __init__(self, csv_file, txt_file, root_dir, other_file): self.csv_data = pd.read_csv(csv_file) with open(txt_file, 'r') as f: data_list = f.readlines() self.txt_data = data_list self.root_dir = root_dir def __len__(self): return len(self.csv_data) def __getitem__(self, idx): data = (self.csv_file[idx], self.txt_file[idx]) return data # DataLoader æ¥å®šä¹‰ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨# dataiter = DataLoader(myDataset, batch_size=32, shuffle=True, collate_fn=default_collate) nn.Module æ¨¡ç»„PyTorch ç¼–å†™çš„ç¥ç»ç½‘ç»œï¼Œæ‰€æœ‰å±‚ç»“æ„å’ŒæŸå¤±å‡½æ•°éƒ½æ¥è‡ªäºtorch.nnï¼Œæ‰€æœ‰çš„æ¨¡å‹æ„å»ºéƒ½ä»è¿™ä¸ªåŸºç±»nn.Moduleç»§æ‰¿ # æ„å»ºè®¡ç®—å›¾ ä¹Ÿå°±æ˜¯æ¨¡å‹class net_name(nn.Module): def __init__(self, other_arguments): super(net_name, self).__init__() self.conv1 = nn.Conv2d(in_channels, out_channels, kernel_size) # other network layer def forward(self, x): x = self.conv1(x) return x # å®šä¹‰æŸå¤±å‡½æ•°criterion = nn.CrossEntropyLoss()# loss = criterion(output, target) torch.optim ä¼˜åŒ–åœ¨æœºå™¨å­¦ä¹ æˆ–è€…æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ä¿®æ”¹å‚æ•°ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°åŒ–ï¼ˆæˆ–æœ€å¤§åŒ–ï¼‰ï¼Œä¼˜åŒ–ç®—æ³•å°±æ˜¯ä¸€ç§è°ƒæ•´æ¨¡å‹å‚æ•°æ›´æ–°çš„ç­–ç•¥ ä¼˜åŒ–ç®—æ³•åˆ†ç±»ï¼š ä¸€é˜¶ä¼˜åŒ–ç®—æ³• æ¢¯åº¦ä¸‹é™ äºŒé˜¶ä¼˜åŒ–ç®—æ³• ä½¿ç”¨äºŒé˜¶å€’æ•°ï¼Œä¹Ÿå«hessianæ–¹æ³• # lr å­¦ä¹ ç‡ momentum åŠ¨é‡# optimizer = torch.optim.SGD(model.parameters(), lr=0.01, momentum=0.9) æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½ä¸¤ç§ä¿å­˜æ–¹å¼ï¼š ä¿å­˜æ•´ä¸ªæ¨¡å‹çš„ç»“æ„ä¿¡æ¯å’Œå‚æ•°ä¿¡æ¯ï¼Œä¿å­˜çš„å¯¹è±¡æ˜¯æ¨¡å‹model ä¿å­˜æ¨¡å‹çš„å‚æ•°ï¼Œä¿å­˜çš„å¯¹è±¡æ˜¯æ¨¡å‹çš„çŠ¶æ€model.state_dict() ä¸¤ç§åŠ è½½æ–¹å¼ï¼š åŠ è½½å®Œæ•´çš„æ¨¡å‹ç»“æ„å’Œå‚æ•°ä¿¡æ¯ï¼Œç½‘ç»œè¾ƒå¤§çš„æ—¶å€™è®°è½½æ—¶é—´æ¯”è¾ƒé•¿ï¼ŒåŒæ—¶å­˜å‚¨ç©ºé—´ä¹Ÿæ¯”è¾ƒå¤§ åŠ è½½æ¨¡å‹å‚æ•°ä¿¡æ¯ï¼Œéœ€è¦å…ˆå¯¼å…¥æ¨¡å‹çš„ç»“æ„ï¼Œç„¶åå†å¯¼å…¥æ¨¡å‹ # ä¿å­˜# torch.save(model, './model.path')# torch.save(model.state_dict(), './model_state.path')# åŠ è½½# load_model = torch.load('model.path')# å…ˆåŠ è½½æ¨¡å‹ï¼Œå†åŠ è½½å‚æ•°# model.load_state_dict(torch.load('model_state.path'))","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://lucas0625.github.io/blog/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"PyTorch","slug":"PyTorch","permalink":"http://lucas0625.github.io/blog/tags/PyTorch/"}]},{"title":"çˆ¬è™«åŸºç¡€","slug":"çˆ¬è™«åŸºç¡€","date":"2019-02-03T16:00:00.000Z","updated":"2019-02-04T09:17:45.054Z","comments":true,"path":"2019/02/04/çˆ¬è™«åŸºç¡€/","link":"","permalink":"http://lucas0625.github.io/blog/2019/02/04/çˆ¬è™«åŸºç¡€/","excerpt":"æœ¬æ–‡ä»‹ç»çˆ¬è™«çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚","text":"æœ¬æ–‡ä»‹ç»çˆ¬è™«çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚ çˆ¬è™«åŸºæœ¬åŸç†è®²è§£ä»€ä¹ˆæ˜¯çˆ¬è™«è‡ªåŠ¨è·å–ç½‘ç»œèµ„æºæœºå™¨äººã€‚è¯·æ±‚ç½‘ç«™å¹¶æå–æ•°æ®çš„è‡ªåŠ¨åŒ–ç¨‹åºã€‚è·å–çš„æ˜¯htmlä»£ç ï¼Œæ‰€éœ€è¦çš„æ•°æ®ä¿å­˜åœ¨htmlä»£ç ä¸­ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä»htmlä¸­æå–å‡ºæƒ³è¦çš„ä¿¡æ¯ï¼Œç„¶åå°†ä¿¡æ¯å­˜å‚¨åœ¨æ•°æ®åº“ã€‚ çˆ¬è™«çš„åŸºæœ¬æµç¨‹ å‘èµ·è¯·æ±‚é€šè¿‡HTTPåº“åƒç›®æ ‡ç«™ç‚¹å‘èµ·è¯·æ±‚ï¼Œå³å‘é€ä¸€ä¸ªRequestï¼Œè¯·æ±‚åŒ…å«é¢å¤–çš„headersç­‰ä¿¡æ¯ï¼Œç­‰å¾…æœåŠ¡å™¨å“åº”ã€‚ è·å–å“åº”å†…å®¹å¦‚æœæœåŠ¡å™¨èƒ½æ­£å¸¸å“åº”ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªResponseï¼ŒResponseçš„å†…å®¹ä¾¿æ˜¯æ‰€è¦è·å–çš„é¡µé¢å†…å®¹ï¼Œç±»å‹å¯èƒ½æœ‰HTMLï¼ŒJsonå­—ç¬¦ä¸²ï¼ŒäºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚å›¾ç‰‡è§†é¢‘ï¼‰ç­‰ç±»å‹ã€‚ è§£æå†…å®¹å¾—åˆ°çš„å†…å®¹å¯èƒ½æ˜¯HTMLï¼Œå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œç½‘é¡µè§£æåº“è¿›è¡Œè§£æï¼Œå¯èƒ½æ˜¯Jsonï¼Œå¯ä»¥ç›´æ¥è½¬ä¸ºJsonå¯¹è±¡è§£æï¼Œå¯èƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œå¯ä»¥åšä¿å­˜æˆ–è€…è¿›ä¸€æ­¥çš„å¤„ç†ã€‚ ä¿å­˜æ•°æ®ä¿å­˜å½¢å¼å¤šæ ·ï¼Œå¯ä»¥å­˜ä¸ºæ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥ä¿å­˜è‡³æ•°æ®åº“ï¼Œæˆ–è€…ä¿å­˜ç‰¹å®šæ ¼å¼çš„æ–‡ä»¶ã€‚ Requestä¸­åŒ…å«çš„å†…å®¹ è¯·æ±‚æ–¹å¼ä¸»è¦æœ‰GETï¼ŒPOSTä¸¤ç§ç±»å‹ï¼Œå¦å¤–è¿˜æœ‰HEADï¼ŒPUTï¼ŒDELETEï¼ŒOPTIONSç­‰ã€‚GETè¯·æ±‚ï¼š è¯·æ±‚çš„å‚æ•°éƒ½åŒ…å«åœ¨è¯·æ±‚ç½‘å€é‡Œé¢ï¼Œå³åŒ…å«åœ¨Request urlä¸­ï¼›å¯ä»¥ç›´æ¥è¾“å…¥urlç„¶åå›è½¦ç›´æ¥è®¿é—®ã€‚POSTè¯·æ±‚ï¼šè¯·æ±‚çš„å‚æ•°åŒ…å«åœ¨Form Dataä¸­ï¼Œä¸åŒ…å«åœ¨è¯·æ±‚ç½‘å€ä¸­ï¼›å¿…é¡»æ„å»ºè¡¨å•ï¼Œç‚¹å‡»è¡¨å•æäº¤ï¼Œæ‰å¯ä»¥æ„é€ ä¸€ä¸ªPOSTè¯·æ±‚ã€‚ è¯·æ±‚URLURLå…¨ç§°æ˜¯ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œå¦‚ä¸€ä¸ªç½‘é¡µæ–‡æ¡£ï¼Œä¸€å¼ å›¾ç‰‡ï¼Œä¸€ä¸ªè§†é¢‘ç­‰éƒ½å¯ä»¥ç”¨URLå”¯ä¸€æ¥ç¡®å®šã€‚ è¯·æ±‚å¤´åŒ…å«è¯·æ±‚æ—¶çš„å¤´éƒ¨ä¿¡æ¯ï¼ˆé…ç½®ä¿¡æ¯ï¼‰ï¼Œå¦‚User-Agentï¼ŒHostï¼ŒCookiesç­‰ä¿¡æ¯ã€‚ è¯·æ±‚ä½“è¯·æ±‚æ—¶é¢å¤–æºå¸¦çš„æ•°æ®ï¼Œå¦‚è¡¨å•æäº¤æ—¶çš„è¡¨å•æ•°æ®ã€‚GETè¯·æ±‚æ—¶ä¸€èˆ¬ä¸åŒ…å«ï¼ŒPOSTè¯·æ±‚æ—¶åŠ å…¥Form Dataä¿¡æ¯ Responseä¸­åŒ…å«çš„å†…å®¹ å“åº”çŠ¶æ€Status Codeï¼Œæœ‰å¤šç§å“åº”çŠ¶æ€ï¼Œå¦‚200ä»£è¡¨æˆåŠŸï¼Œ301è·³è½¬ï¼Œ404æ‰¾ä¸åˆ°é¡µé¢ï¼Œ502æœåŠ¡å™¨é”™è¯¯ã€‚ å“åº”å¤´å¦‚å†…å®¹ç±»å‹ï¼Œå†…å®¹é•¿åº¦ï¼ŒæœåŠ¡å™¨ä¿¡æ¯ï¼Œè®¾ç½®Cookieç­‰ç­‰ã€‚ å“åº”ä½“æœ€ä¸»è¦çš„éƒ¨åˆ†ï¼ŒåŒ…å«äº†è¯·æ±‚èµ„æºçš„å†…å®¹ï¼Œå¦‚ç½‘é¡µHTMLï¼Œå›¾ç‰‡ï¼ŒäºŒè¿›åˆ¶æ•°æ®ç­‰ã€‚ çˆ¬è™«å¯ä»¥æŠ“å–ä»€ä¹ˆæ ·çš„æ•°æ® ç½‘é¡µæ–‡æœ¬å¦‚HTMLæ–‡æ¡£ï¼ŒJsonæ ¼å¼æ–‡æœ¬ç­‰ã€‚ å›¾ç‰‡è·å–åˆ°çš„æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¿å­˜ä¸ºå›¾ç‰‡æ ¼å¼ã€‚ è§†é¢‘åŒä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¿å­˜ä¸ºè§†é¢‘æ ¼å¼å³å¯ã€‚4.å…¶ä»–åªè¦æ˜¯èƒ½è¯·æ±‚åˆ°çš„ï¼Œéƒ½èƒ½è·å–ã€‚ æ€ä¹ˆè¿›è¡Œè§£æ ç›´æ¥å¤„ç†è¿”å›æœ€ç®€å•çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥å¯¹å­—ç¬¦ä¸²ç›´æ¥è¿›è¡Œå¤„ç†ã€‚è¿™ç§å¤„ç†çš„ç½‘ç«™æ¯”è¾ƒç®€å•ã€‚ Jsonè§£æXHRæ ‡ç­¾ï¼Œè§£æjson æ­£åˆ™è¡¨è¾¾å¼ Beautifulsoupè§£æ PyQueryè§£æ XPathè§£æ ä¸ºä»€ä¹ˆæˆ‘æŠ“åˆ°çš„æ•°æ®å’Œæµè§ˆå™¨çœ‹åˆ°çš„ä¸ä¸€æ ·æŠ“åˆ°çš„åªæ˜¯ç½‘é¡µæºä»£ç ï¼Œæµè§ˆå™¨çœ‹å¾—åˆ°ä»£ç æ˜¯é€šè¿‡JSæ¸²æŸ“è¿‡çš„ è§£å†³JavaScriptæ¸²æŸ“é—®é¢˜ åˆ†æAjaxè¯·æ±‚è¿”å›çš„ç»“æœæ˜¯Jsonæ ¼å¼å­—ç¬¦ä¸² ä½¿ç”¨Selenium/Webdriveré©±åŠ¨ä¸€ä¸ªæµè§ˆå™¨ Splash æ¨¡æ‹ŸJavaScript PyV8ï¼ŒGhost.pyè¿›è¡Œæ¨¡æ‹ŸåŠ è½½ æ€æ ·ä¿å­˜æ•°æ® æ–‡æœ¬å­˜æ–‡æœ¬ï¼ŒJsonï¼ŒXmlç­‰ã€‚ å…³ç³»å‹æ•°æ®åº“å¦‚MySQLï¼ŒOracleï¼ŒSQL Serverï¼Œç­‰å…·æœ‰ç»“æ„åŒ–è¡¨ç»“æ„å½¢å¼å­˜å‚¨ã€‚ éå…³ç³»å‹æ•°æ®åº“å¦‚MongoDBï¼ŒRedisç­‰key-valueå½¢å¼å­˜å‚¨ã€‚ ç¯å¢ƒé…ç½®æ‰€éœ€ç¯å¢ƒpython3.6, anacondaMongoDB éå…³ç³»å‹æ•°æ®åº“ã€‚key,valueå‹æ•°æ®åº“ ç¯å¢ƒå®‰è£…é¦–å…ˆå®‰è£…homebrew,ç„¶ååˆ©ç”¨homebrewå®‰è£…mongodbbrew install mongodb Redis éå…³ç³»å‹æ•°æ®åº“ã€‚key,valueå‹æ•°æ®åº“ï¼Œåˆ†å¸ƒå¼çˆ¬è™«éœ€è¦ç”¨åˆ°ã€‚ brew install redis MySQL å…³ç³»å‹æ•°æ®åº“ï¼Œä½“ç§¯å°ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œåšæ•°æ®å­˜å‚¨æ—¶ç®€ä¾¿æ˜“ç”¨brew install mysql Pythonå¤šç‰ˆæœ¬å…±å­˜ windows:ç¯å¢ƒå˜é‡ï¼šwhere python å¯ä»¥æŸ¥çœ‹å„ç‰ˆæœ¬Pythonmac:echo $PATH è¾“å‡ºç¯å¢ƒå˜é‡ çˆ¬è™«å¸¸ç”¨åº“å®‰è£… è¯·æ±‚åº“ urllib urllib.request re requests selenium é©±åŠ¨æµè§ˆå™¨ï¼Œç”¨æ¥åšè‡ªåŠ¨åŒ–æµ‹è¯• chromedriver é©±åŠ¨chromeæµè§ˆå™¨ phantomjs æ— ç•Œé¢æµè§ˆå™¨ è§£æåº“ lxml æä¾›äº†xpathè§£ææ–¹å¼ beautifulsoup4 (bs4)ç½‘é¡µè§£æåº“ï¼Œä¾èµ–äºlxml pyquery ç½‘é¡µè§£æåº“ï¼Œç›¸å¯¹äºbs4æ›´åŠ æ–¹ä¾¿ å­˜å‚¨åº“ pymysql ç”¨Pythonæ“ä½œMySQLæ•°æ®åº“ pymongo ç”¨Pythonæ“ä½œMongoDBæ•°æ®åº“ redis ç”¨Pythonæ“ä½œRedisæ•°æ®åº“ flask webåº“ï¼Œåšwebä»£ç†çš„æ—¶å€™ä¼šç”¨åˆ° django webæœåŠ¡å™¨æ¡†æ¶ï¼Œæä¾›äº†å®Œæ•´çš„åå°ç®¡ç†ã€‚åšåˆ†å¸ƒå¼çˆ¬è™«ç®¡ç†çš„æ—¶å€™ä¼šç”¨åˆ° jupyter è¿è¡Œåœ¨ç½‘é¡µä¸Šçš„è®°äº‹æœ¬Urllibkåº“åŸºæœ¬ä½¿ç”¨Urllibåº“ç»„æˆ urllib.request è¯·æ±‚æ¨¡å—,ç”¨æ¥è¯·æ±‚url urllib.error å¼‚å¸¸å¤„ç†æ¨¡å—ï¼Œæ•æ‰è¯·æ±‚æ—¶å‡ºç°çš„é”™è¯¯ urllib.parse urlè§£ææ¨¡å— urllib.robotparse robot.txtè§£ææ¨¡å— urlopenurllib.request.urlopen(url, data=None, [timeout, ]*, cafile=None, capath=None, cadefault=False, context=None) import urllib.requestresponse = urllib.request.urlopen('http://www.baidu.com')print(response.read().decode('utf-8')) import urllib.parseimport urllib.requestdata = bytes(urllib.parse.urlencode(&#123;'word': 'hello'&#125;), encoding='utf8')response = urllib.request.urlopen('http://httpbin.org/post', data=data)print(response.read()) b&#39;{\\n &quot;args&quot;: {}, \\n &quot;data&quot;: &quot;&quot;, \\n &quot;files&quot;: {}, \\n &quot;form&quot;: {\\n &quot;word&quot;: &quot;hello&quot;\\n }, \\n &quot;headers&quot;: {\\n &quot;Accept-Encoding&quot;: &quot;identity&quot;, \\n &quot;Connect-Time&quot;: &quot;1&quot;, \\n &quot;Connection&quot;: &quot;close&quot;, \\n &quot;Content-Length&quot;: &quot;10&quot;, \\n &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;, \\n &quot;Host&quot;: &quot;httpbin.org&quot;, \\n &quot;Total-Route-Time&quot;: &quot;0&quot;, \\n &quot;User-Agent&quot;: &quot;Python-urllib/3.5&quot;, \\n &quot;Via&quot;: &quot;1.1 vegur&quot;, \\n &quot;X-Request-Id&quot;: &quot;89667a57-c909-475a-9870-f01181e8c85d&quot;\\n }, \\n &quot;json&quot;: null, \\n &quot;origin&quot;: &quot;219.238.82.169&quot;, \\n &quot;url&quot;: &quot;http://httpbin.org/post&quot;\\n}\\n&#39; import urllib.requestresponse = urllib.request.urlopen('http://httpbin.org/get', timeout=1)print(response.read()) b&#39;{\\n &quot;args&quot;: {}, \\n &quot;headers&quot;: {\\n &quot;Accept-Encoding&quot;: &quot;identity&quot;, \\n &quot;Connect-Time&quot;: &quot;0&quot;, \\n &quot;Connection&quot;: &quot;close&quot;, \\n &quot;Host&quot;: &quot;httpbin.org&quot;, \\n &quot;Total-Route-Time&quot;: &quot;0&quot;, \\n &quot;User-Agent&quot;: &quot;Python-urllib/3.5&quot;, \\n &quot;Via&quot;: &quot;1.1 vegur&quot;, \\n &quot;X-Request-Id&quot;: &quot;40948f0e-e4b2-4b5f-9d84-aeb77595ca52&quot;\\n }, \\n &quot;origin&quot;: &quot;219.238.82.169&quot;, \\n &quot;url&quot;: &quot;http://httpbin.org/get&quot;\\n}\\n&#39; import socketimport urllib.requestimport urllib.errortry: response = urllib.request.urlopen('http://httpbin.org/get', timeout=0.1)except urllib.error.URLError as e: if isinstance(e.reason, socket.timeout): print('TIME OUT') TIME OUT å“åº”å“åº”ç±»å‹import urllib.requestresponse = urllib.request.urlopen('https://www.python.org')print(type(response)) &lt;class &#39;http.client.HTTPResponse&#39;&gt; çŠ¶æ€ç ã€å“åº”å¤´import urllib.requestresponse = urllib.request.urlopen('https://www.python.org')print(response.status)print(response.getheaders())print(response.getheader('Server')) 200 [(&#39;Server&#39;, &#39;nginx&#39;), (&#39;Content-Type&#39;, &#39;text/html; charset=utf-8&#39;), (&#39;X-Frame-Options&#39;, &#39;SAMEORIGIN&#39;), (&#39;X-Clacks-Overhead&#39;, &#39;GNU Terry Pratchett&#39;), (&#39;Content-Length&#39;, &#39;47436&#39;), (&#39;Accept-Ranges&#39;, &#39;bytes&#39;), (&#39;Date&#39;, &#39;Wed, 22 Mar 2017 15:40:16 GMT&#39;), (&#39;Via&#39;, &#39;1.1 varnish&#39;), (&#39;Age&#39;, &#39;3417&#39;), (&#39;Connection&#39;, &#39;close&#39;), (&#39;X-Served-By&#39;, &#39;cache-itm7426-ITM&#39;), (&#39;X-Cache&#39;, &#39;HIT&#39;), (&#39;X-Cache-Hits&#39;, &#39;16&#39;), (&#39;X-Timer&#39;, &#39;S1490197216.605863,VS0,VE0&#39;), (&#39;Vary&#39;, &#39;Cookie&#39;), (&#39;Public-Key-Pins&#39;, &#39;max-age=600; includeSubDomains; pin-sha256=&quot;WoiWRyIOVNa9ihaBciRSC7XHjliYS9VwUGOIud4PB18=&quot;; pin-sha256=&quot;5C8kvU039KouVrl52D0eZSGf4Onjo4Khs8tmyTlV3nU=&quot;; pin-sha256=&quot;5C8kvU039KouVrl52D0eZSGf4Onjo4Khs8tmyTlV3nU=&quot;; pin-sha256=&quot;lCppFqbkrlJ3EcVFAkeip0+44VaoJUymbnOaEUk7tEU=&quot;; pin-sha256=&quot;TUDnr0MEoJ3of7+YliBMBVFB4/gJsv5zO7IxD9+YoWI=&quot;; pin-sha256=&quot;x4QzPSC810K5/cMjb05Qm4k3Bw5zBn4lTdO/nEW/Td4=&quot;;&#39;), (&#39;Strict-Transport-Security&#39;, &#39;max-age=63072000; includeSubDomains&#39;)] nginx import urllib.requestresponse = urllib.request.urlopen('https://www.python.org')print(response.read().decode('utf-8')) Requestimport urllib.requestrequest = urllib.request.Request('https://python.org')response = urllib.request.urlopen(request)print(response.read().decode('utf-8')) from urllib import request, parseurl = 'http://httpbin.org/post'headers = &#123; 'User-Agent': 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)', 'Host': 'httpbin.org'&#125;dict = &#123; 'name': 'Germey'&#125;data = bytes(parse.urlencode(dict), encoding='utf8')req = request.Request(url=url, data=data, headers=headers, method='POST')response = request.urlopen(req)print(response.read().decode('utf-8')) { &quot;args&quot;: {}, &quot;data&quot;: &quot;&quot;, &quot;files&quot;: {}, &quot;form&quot;: { &quot;name&quot;: &quot;Germey&quot; }, &quot;headers&quot;: { &quot;Accept-Encoding&quot;: &quot;identity&quot;, &quot;Connect-Time&quot;: &quot;1&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Content-Length&quot;: &quot;11&quot;, &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;Host&quot;: &quot;httpbin.org&quot;, &quot;Total-Route-Time&quot;: &quot;0&quot;, &quot;User-Agent&quot;: &quot;Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)&quot;, &quot;Via&quot;: &quot;1.1 vegur&quot;, &quot;X-Request-Id&quot;: &quot;f96e736e-0b8a-4ab4-9dcc-a970fcd2fbbf&quot; }, &quot;json&quot;: null, &quot;origin&quot;: &quot;219.238.82.169&quot;, &quot;url&quot;: &quot;http://httpbin.org/post&quot; } from urllib import request, parseurl = 'http://httpbin.org/post'dict = &#123; 'name': 'Germey'&#125;data = bytes(parse.urlencode(dict), encoding='utf8')req = request.Request(url=url, data=data, method='POST')req.add_header('User-Agent', 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)')response = request.urlopen(req)print(response.read().decode('utf-8')) { &quot;args&quot;: {}, &quot;data&quot;: &quot;&quot;, &quot;files&quot;: {}, &quot;form&quot;: { &quot;name&quot;: &quot;Germey&quot; }, &quot;headers&quot;: { &quot;Accept-Encoding&quot;: &quot;identity&quot;, &quot;Connect-Time&quot;: &quot;0&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Content-Length&quot;: &quot;11&quot;, &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;Host&quot;: &quot;httpbin.org&quot;, &quot;Total-Route-Time&quot;: &quot;0&quot;, &quot;User-Agent&quot;: &quot;Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)&quot;, &quot;Via&quot;: &quot;1.1 vegur&quot;, &quot;X-Request-Id&quot;: &quot;a624bcaa-3581-4b93-84b0-037940338e71&quot; }, &quot;json&quot;: null, &quot;origin&quot;: &quot;219.238.82.169&quot;, &quot;url&quot;: &quot;http://httpbin.org/post&quot; } Handlerä»£ç†import urllib.requestproxy_handler = urllib.request.ProxyHandler(&#123; 'http': 'http://127.0.0.1:9743', 'https': 'https://127.0.0.1:9743'&#125;)opener = urllib.request.build_opener(proxy_handler)response = opener.open('http://httpbin.org/get')print(response.read()) b&#39;{\\n &quot;args&quot;: {}, \\n &quot;headers&quot;: {\\n &quot;Accept-Encoding&quot;: &quot;identity&quot;, \\n &quot;Connect-Time&quot;: &quot;2&quot;, \\n &quot;Connection&quot;: &quot;close&quot;, \\n &quot;Host&quot;: &quot;httpbin.org&quot;, \\n &quot;Total-Route-Time&quot;: &quot;0&quot;, \\n &quot;User-Agent&quot;: &quot;Python-urllib/3.5&quot;, \\n &quot;Via&quot;: &quot;1.1 vegur&quot;, \\n &quot;X-Request-Id&quot;: &quot;b0e2272d-1663-4192-ac45-eb958279afd8&quot;\\n }, \\n &quot;origin&quot;: &quot;110.10.176.224&quot;, \\n &quot;url&quot;: &quot;http://httpbin.org/get&quot;\\n}\\n&#39; Cookieimport http.cookiejar, urllib.requestcookie = http.cookiejar.CookieJar()handler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open('http://www.baidu.com')for item in cookie: print(item.name+\"=\"+item.value) BAIDUID=E77BF84491E332F6F8F1D451AD0063D3:FG=1 BIDUPSID=E77BF84491E332F6F8F1D451AD0063D3 H_PS_PSSID=1466_21127_22075 PSTM=1490198051 BDSVRTM=0 BD_HOME=0 import http.cookiejar, urllib.requestfilename = \"cookie.txt\"cookie = http.cookiejar.MozillaCookieJar(filename)handler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open('http://www.baidu.com')cookie.save(ignore_discard=True, ignore_expires=True) import http.cookiejar, urllib.requestfilename = 'cookie.txt'cookie = http.cookiejar.LWPCookieJar(filename)handler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open('http://www.baidu.com')cookie.save(ignore_discard=True, ignore_expires=True) import http.cookiejar, urllib.requestcookie = http.cookiejar.LWPCookieJar()cookie.load('cookie.txt', ignore_discard=True, ignore_expires=True)handler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open('http://www.baidu.com')print(response.read().decode('utf-8')) å¼‚å¸¸å¤„ç†from urllib import request, errortry: response = request.urlopen('http://cuiqingcai.com/index.htm')except error.URLError as e: print(e.reason) Not Found from urllib import request, errortry: response = request.urlopen('http://cuiqingcai.com/index.htm')except error.HTTPError as e: print(e.reason, e.code, e.headers, sep='\\n')except error.URLError as e: print(e.reason)else: print('Request Successfully') Not Found 404 Server: nginx/1.10.1 Date: Wed, 22 Mar 2017 15:59:55 GMT Content-Type: text/html; charset=UTF-8 Transfer-Encoding: chunked Connection: close Vary: Cookie Expires: Wed, 11 Jan 1984 05:00:00 GMT Cache-Control: no-cache, must-revalidate, max-age=0 Link: &lt;http://cuiqingcai.com/wp-json/&gt;; rel=&quot;https://api.w.org/&quot; import socketimport urllib.requestimport urllib.errortry: response = urllib.request.urlopen('https://www.baidu.com', timeout=0.01)except urllib.error.URLError as e: print(type(e.reason)) if isinstance(e.reason, socket.timeout): print('TIME OUT') &lt;class &#39;socket.timeout&#39;&gt; TIME OUT URLè§£æurlparseurllib.parse.urlparse(urlstring, scheme=â€™â€™, allow_fragments=True) from urllib.parse import urlparseresult = urlparse('http://www.baidu.com/index.html;user?id=5#comment')print(type(result), result) &lt;class &#39;urllib.parse.ParseResult&#39;&gt; ParseResult(scheme=&#39;http&#39;, netloc=&#39;www.baidu.com&#39;, path=&#39;/index.html&#39;, params=&#39;user&#39;, query=&#39;id=5&#39;, fragment=&#39;comment&#39;) from urllib.parse import urlparseresult = urlparse('www.baidu.com/index.html;user?id=5#comment', scheme='https')print(result) ParseResult(scheme=&#39;https&#39;, netloc=&#39;&#39;, path=&#39;www.baidu.com/index.html&#39;, params=&#39;user&#39;, query=&#39;id=5&#39;, fragment=&#39;comment&#39;) from urllib.parse import urlparseresult = urlparse('http://www.baidu.com/index.html;user?id=5#comment', scheme='https')print(result) ParseResult(scheme=&#39;http&#39;, netloc=&#39;www.baidu.com&#39;, path=&#39;/index.html&#39;, params=&#39;user&#39;, query=&#39;id=5&#39;, fragment=&#39;comment&#39;) from urllib.parse import urlparseresult = urlparse('http://www.baidu.com/index.html;user?id=5#comment', allow_fragments=False)print(result) ParseResult(scheme=&#39;http&#39;, netloc=&#39;www.baidu.com&#39;, path=&#39;/index.html&#39;, params=&#39;user&#39;, query=&#39;id=5#comment&#39;, fragment=&#39;&#39;) from urllib.parse import urlparseresult = urlparse('http://www.baidu.com/index.html#comment', allow_fragments=False)print(result) ParseResult(scheme=&#39;http&#39;, netloc=&#39;www.baidu.com&#39;, path=&#39;/index.html#comment&#39;, params=&#39;&#39;, query=&#39;&#39;, fragment=&#39;&#39;) urlunparsefrom urllib.parse import urlunparsedata = ['http', 'www.baidu.com', 'index.html', 'user', 'a=6', 'comment']print(urlunparse(data)) http://www.baidu.com/index.html;user?a=6#comment urljoinfrom urllib.parse import urljoinprint(urljoin('http://www.baidu.com', 'FAQ.html'))print(urljoin('http://www.baidu.com', 'https://cuiqingcai.com/FAQ.html'))print(urljoin('http://www.baidu.com/about.html', 'https://cuiqingcai.com/FAQ.html'))print(urljoin('http://www.baidu.com/about.html', 'https://cuiqingcai.com/FAQ.html?question=2'))print(urljoin('http://www.baidu.com?wd=abc', 'https://cuiqingcai.com/index.php'))print(urljoin('http://www.baidu.com', '?category=2#comment'))print(urljoin('www.baidu.com', '?category=2#comment'))print(urljoin('www.baidu.com#comment', '?category=2')) http://www.baidu.com/FAQ.html https://cuiqingcai.com/FAQ.html https://cuiqingcai.com/FAQ.html https://cuiqingcai.com/FAQ.html?question=2 https://cuiqingcai.com/index.php http://www.baidu.com?category=2#comment www.baidu.com?category=2#comment www.baidu.com?category=2 urlencodefrom urllib.parse import urlencodeparams = &#123; 'name': 'germey', 'age': 22&#125;base_url = 'http://www.baidu.com?'url = base_url + urlencode(params)print(url) http://www.baidu.com?name=germey&amp;age=22 requeståº“ä½¿ç”¨requestsRequestsæ˜¯Pythonè¯­è¨€ç¼–å†™ï¼ŒåŸºäºurllibï¼Œé‡‡ç”¨Apache2 Licensedå¼€æºåè®®çš„HTTPåº“ã€‚å®ƒæ¯”urllibæ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥èŠ‚çº¦æˆ‘ä»¬å¤§é‡çš„å·¥ä½œï¼Œå®Œå…¨æ»¡è¶³HTTPæµ‹è¯•éœ€æ±‚ã€‚ å®ä¾‹å¼•å…¥import requestsresponse = requests.get('https://www.baidu.com/')print(type(response))print(response.status_code)print(type(response.text))print(response.text)print(response.cookies) å„ç§è¯·æ±‚æ–¹å¼import requestsrequests.post('http://httpbin.org/post')requests.put('http://httpbin.org/put')requests.delete('http://httpbin.org/delete')requests.head('http://httpbin.org/get')requests.options('http://httpbin.org/get') è¯·æ±‚åŸºæœ¬GETè¯·æ±‚åŸºæœ¬å†™æ³•import requestsresponse = requests.get('http://httpbin.org/get')print(response.text) å¸¦å‚æ•°GETè¯·æ±‚import requestsresponse = requests.get(\"http://httpbin.org/get?name=germey&amp;age=22\")print(response.text) import requestsdata = &#123; 'name': 'germey', 'age': 22&#125;response = requests.get(\"http://httpbin.org/get\", params=data)print(response.text) è§£æjsonimport requestsimport jsonresponse = requests.get(\"http://httpbin.org/get\")print(type(response.text))print(response.json())print(json.loads(response.text))print(type(response.json())) è·å–äºŒè¿›åˆ¶æ•°æ®import requestsresponse = requests.get(\"https://github.com/favicon.ico\")print(type(response.text), type(response.content))print(response.text)print(response.content) import requestsresponse = requests.get(\"https://github.com/favicon.ico\")with open('favicon.ico', 'wb') as f: f.write(response.content) f.close() æ·»åŠ headersimport requestsresponse = requests.get(\"https://www.zhihu.com/explore\")print(response.text) import requestsheaders = &#123; 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36'&#125;response = requests.get(\"https://www.zhihu.com/explore\", headers=headers)print(response.text) åŸºæœ¬POSTè¯·æ±‚import requestsdata = &#123;'name': 'germey', 'age': '22'&#125;response = requests.post(\"http://httpbin.org/post\", data=data)print(response.text) import requestsdata = &#123;'name': 'germey', 'age': '22'&#125;headers = &#123; 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36'&#125;response = requests.post(\"http://httpbin.org/post\", data=data, headers=headers)print(response.json()) å“åº”responseå±æ€§import requestsresponse = requests.get('http://www.jianshu.com')print(type(response.status_code), response.status_code)print(type(response.headers), response.headers)print(type(response.cookies), response.cookies)print(type(response.url), response.url)print(type(response.history), response.history) çŠ¶æ€ç åˆ¤æ–­import requestsresponse = requests.get('http://www.jianshu.com/hello.html')exit() if not response.status_code == requests.codes.not_found else print('404 Not Found') import requestsresponse = requests.get('http://www.jianshu.com')exit() if not response.status_code == 200 else print('Request Successfully') 100: ('continue',),101: ('switching_protocols',),102: ('processing',),103: ('checkpoint',),122: ('uri_too_long', 'request_uri_too_long'),200: ('ok', 'okay', 'all_ok', 'all_okay', 'all_good', '\\\\o/', 'âœ“'),201: ('created',),202: ('accepted',),203: ('non_authoritative_info', 'non_authoritative_information'),204: ('no_content',),205: ('reset_content', 'reset'),206: ('partial_content', 'partial'),207: ('multi_status', 'multiple_status', 'multi_stati', 'multiple_stati'),208: ('already_reported',),226: ('im_used',),# Redirection.300: ('multiple_choices',),301: ('moved_permanently', 'moved', '\\\\o-'),302: ('found',),303: ('see_other', 'other'),304: ('not_modified',),305: ('use_proxy',),306: ('switch_proxy',),307: ('temporary_redirect', 'temporary_moved', 'temporary'),308: ('permanent_redirect', 'resume_incomplete', 'resume',), # These 2 to be removed in 3.0# Client Error.400: ('bad_request', 'bad'),401: ('unauthorized',),402: ('payment_required', 'payment'),403: ('forbidden',),404: ('not_found', '-o-'),405: ('method_not_allowed', 'not_allowed'),406: ('not_acceptable',),407: ('proxy_authentication_required', 'proxy_auth', 'proxy_authentication'),408: ('request_timeout', 'timeout'),409: ('conflict',),410: ('gone',),411: ('length_required',),412: ('precondition_failed', 'precondition'),413: ('request_entity_too_large',),414: ('request_uri_too_large',),415: ('unsupported_media_type', 'unsupported_media', 'media_type'),416: ('requested_range_not_satisfiable', 'requested_range', 'range_not_satisfiable'),417: ('expectation_failed',),418: ('im_a_teapot', 'teapot', 'i_am_a_teapot'),421: ('misdirected_request',),422: ('unprocessable_entity', 'unprocessable'),423: ('locked',),424: ('failed_dependency', 'dependency'),425: ('unordered_collection', 'unordered'),426: ('upgrade_required', 'upgrade'),428: ('precondition_required', 'precondition'),429: ('too_many_requests', 'too_many'),431: ('header_fields_too_large', 'fields_too_large'),444: ('no_response', 'none'),449: ('retry_with', 'retry'),450: ('blocked_by_windows_parental_controls', 'parental_controls'),451: ('unavailable_for_legal_reasons', 'legal_reasons'),499: ('client_closed_request',),# Server Error.500: ('internal_server_error', 'server_error', '/o\\\\', 'âœ—'),501: ('not_implemented',),502: ('bad_gateway',),503: ('service_unavailable', 'unavailable'),504: ('gateway_timeout',),505: ('http_version_not_supported', 'http_version'),506: ('variant_also_negotiates',),507: ('insufficient_storage',),509: ('bandwidth_limit_exceeded', 'bandwidth'),510: ('not_extended',),511: ('network_authentication_required', 'network_auth', 'network_authentication'), é«˜çº§æ“ä½œæ–‡ä»¶ä¸Šä¼ import requestsfiles = &#123;'file': open('favicon.ico', 'rb')&#125;response = requests.post(\"http://httpbin.org/post\", files=files)print(response.text) è·å–cookieimport requestsresponse = requests.get(\"https://www.baidu.com\")print(response.cookies)for key, value in response.cookies.items(): print(key + '=' + value) ä¼šè¯ç»´æŒæ¨¡æ‹Ÿç™»å½• import requestsrequests.get('http://httpbin.org/cookies/set/number/123456789')response = requests.get('http://httpbin.org/cookies')print(response.text) import requestss = requests.Session()s.get('http://httpbin.org/cookies/set/number/123456789')response = s.get('http://httpbin.org/cookies')print(response.text) è¯ä¹¦éªŒè¯import requestsresponse = requests.get('https://www.12306.cn')print(response.status_code) import requestsfrom requests.packages import urllib3urllib3.disable_warnings()response = requests.get('https://www.12306.cn', verify=False)print(response.status_code) import requestsresponse = requests.get('https://www.12306.cn', cert=('/path/server.crt', '/path/key'))print(response.status_code) ä»£ç†è®¾ç½®import requestsproxies = &#123; \"http\": \"http://127.0.0.1:9743\", \"https\": \"https://127.0.0.1:9743\",&#125;response = requests.get(\"https://www.taobao.com\", proxies=proxies)print(response.status_code) import requestsproxies = &#123; \"http\": \"http://user:password@127.0.0.1:9743/\",&#125;response = requests.get(\"https://www.taobao.com\", proxies=proxies)print(response.status_code) pip3 install 'requests[socks]' import requestsproxies = &#123; 'http': 'socks5://127.0.0.1:9742', 'https': 'socks5://127.0.0.1:9742'&#125;response = requests.get(\"https://www.taobao.com\", proxies=proxies)print(response.status_code) è¶…æ—¶è®¾ç½®import requestsfrom requests.exceptions import ReadTimeouttry: response = requests.get(\"http://httpbin.org/get\", timeout = 0.5) print(response.status_code)except ReadTimeout: print('Timeout') è®¤è¯è®¾ç½®import requestsfrom requests.auth import HTTPBasicAuthr = requests.get('http://120.27.34.24:9001', auth=HTTPBasicAuth('user', '123'))print(r.status_code) import requestsr = requests.get('http://120.27.34.24:9001', auth=('user', '123'))print(r.status_code) å¼‚å¸¸å¤„ç†import requestsfrom requests.exceptions import ReadTimeout, ConnectionError, RequestExceptiontry: response = requests.get(\"http://httpbin.org/get\", timeout = 0.5) print(response.status_code)except ReadTimeout: print('Timeout')except ConnectionError: print('Connection error')except RequestException: print('Error') Connection error seleniumä½¿ç”¨Seleniumè‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œæ”¯æŒå¤šç§æµè§ˆå™¨ã€‚çˆ¬è™«ä¸­ä¸»è¦æ¥è§£å†³JavaScriptæ¸²æŸ“é—®é¢˜ã€‚ åŸºæœ¬ä½¿ç”¨from selenium import webdriverfrom selenium.webdriver.common.by import Byfrom selenium.webdriver.common.keys import Keysfrom selenium.webdriver.support import expected_conditions as ECfrom selenium.webdriver.support.wait import WebDriverWaitbrowser = webdriver.Chrome()try: browser.get('https://www.baidu.com') input = browser.find_element_by_id('kw') input.send_keys('Python') input.send_keys(Keys.ENTER) wait = WebDriverWait(browser, 10) wait.until(EC.presence_of_element_located((By.ID, 'content_left'))) print(browser.current_url) print(browser.get_cookies()) print(browser.page_source)finally: browser.close() å£°æ˜æµè§ˆå™¨å¯¹è±¡from selenium import webdriverbrowser = webdriver.Chrome()browser = webdriver.Firefox()browser = webdriver.Edge()browser = webdriver.PhantomJS()browser = webdriver.Safari() è®¿é—®é¡µé¢from selenium import webdriverbrowser = webdriver.Chrome()browser.get('https://www.taobao.com')print(browser.page_source)browser.close() æŸ¥æ‰¾å…ƒç´ å•ä¸ªå…ƒç´ from selenium import webdriverbrowser = webdriver.Chrome()browser.get('https://www.taobao.com')input_first = browser.find_element_by_id('q')input_second = browser.find_element_by_css_selector('#q')input_third = browser.find_element_by_xpath('//*[@id=\"q\"]')print(input_first, input_second, input_third)browser.close() &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;5e53d9e1c8646e44c14c1c2880d424af&quot;, element=&quot;0.5649563096161541-1&quot;)&gt; &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;5e53d9e1c8646e44c14c1c2880d424af&quot;, element=&quot;0.5649563096161541-1&quot;)&gt; &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;5e53d9e1c8646e44c14c1c2880d424af&quot;, element=&quot;0.5649563096161541-1&quot;)&gt; find_element_by_name find_element_by_xpath find_element_by_link_text find_element_by_partial_link_text find_element_by_tag_name find_element_by_class_name find_element_by_css_selector from selenium import webdriverfrom selenium.webdriver.common.by import Bybrowser = webdriver.Chrome()browser.get('https://www.taobao.com')input_first = browser.find_element(By.ID, 'q')print(input_first)browser.close() &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;1f209c0d11551c40d9d20ad964fef244&quot;, element=&quot;0.07914603542731591-1&quot;)&gt; å¤šä¸ªå…ƒç´ from selenium import webdriverbrowser = webdriver.Chrome()browser.get('https://www.taobao.com')lis = browser.find_elements_by_css_selector('.service-bd li')print(lis)browser.close() [&lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-1&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-2&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-3&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-4&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-5&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-6&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-7&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-8&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-9&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-10&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-11&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-12&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-13&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-14&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-15&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;c26290835d4457ebf7d96bfab3740d19&quot;, element=&quot;0.09221044033125603-16&quot;)&gt;] from selenium import webdriverfrom selenium.webdriver.common.by import Bybrowser = webdriver.Chrome()browser.get('https://www.taobao.com')lis = browser.find_elements(By.CSS_SELECTOR, '.service-bd li')print(lis)browser.close() [&lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-1&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-2&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-3&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-4&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-5&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-6&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-7&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-8&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-9&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-10&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-11&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-12&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-13&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-14&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-15&quot;)&gt;, &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;bca1503cd36be550e8dba984b55c5d0e&quot;, element=&quot;0.7914623408963901-16&quot;)&gt;] find_elements_by_name find_elements_by_xpath find_elements_by_link_text find_elements_by_partial_link_text find_elements_by_tag_name find_elements_by_class_name find_elements_by_css_selector å…ƒç´ äº¤äº’æ“ä½œå¯¹è·å–çš„å…ƒç´ è°ƒç”¨äº¤äº’æ–¹æ³• from selenium import webdriverimport timebrowser = webdriver.Chrome()browser.get('https://www.taobao.com')input = browser.find_element_by_id('q')input.send_keys('iPhone')time.sleep(1)input.clear()input.send_keys('iPad')button = browser.find_element_by_class_name('btn-search')button.click() æ›´å¤šæ“ä½œ: http://selenium-python.readthedocs.io/api.html#module-selenium.webdriver.remote.webelement äº¤äº’åŠ¨ä½œå°†åŠ¨ä½œé™„åŠ åˆ°åŠ¨ä½œé“¾ä¸­ä¸²è¡Œæ‰§è¡Œ from selenium import webdriverfrom selenium.webdriver import ActionChainsbrowser = webdriver.Chrome()url = 'http://www.runoob.com/try/try.php?filename=jqueryui-api-droppable'browser.get(url)browser.switch_to.frame('iframeResult')source = browser.find_element_by_css_selector('#draggable')target = browser.find_element_by_css_selector('#droppable')actions = ActionChains(browser)actions.drag_and_drop(source, target)actions.perform() æ›´å¤šæ“ä½œ: http://selenium-python.readthedocs.io/api.html#module-selenium.webdriver.common.action_chains æ‰§è¡ŒJavaScriptfrom selenium import webdriverbrowser = webdriver.Chrome()browser.get('https://www.zhihu.com/explore')browser.execute_script('window.scrollTo(0, document.body.scrollHeight)')browser.execute_script('alert(\"To Bottom\")') è·å–å…ƒç´ ä¿¡æ¯è·å–å±æ€§from selenium import webdriverfrom selenium.webdriver import ActionChainsbrowser = webdriver.Chrome()url = 'https://www.zhihu.com/explore'browser.get(url)logo = browser.find_element_by_id('zh-top-link-logo')print(logo)print(logo.get_attribute('class')) &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;e08c0f28d7f44d75ccd50df6bb676104&quot;, element=&quot;0.7236390660048155-1&quot;)&gt; zu-top-link-logo è·å–æ–‡æœ¬å€¼from selenium import webdriverbrowser = webdriver.Chrome()url = 'https://www.zhihu.com/explore'browser.get(url)input = browser.find_element_by_class_name('zu-top-add-question')print(input.text) æé—® è·å–IDã€ä½ç½®ã€æ ‡ç­¾åã€å¤§å°from selenium import webdriverbrowser = webdriver.Chrome()url = 'https://www.zhihu.com/explore'browser.get(url)input = browser.find_element_by_class_name('zu-top-add-question')print(input.id)print(input.location)print(input.tag_name)print(input.size) 0.6822924344980397-1 {&#39;y&#39;: 7, &#39;x&#39;: 774} button {&#39;height&#39;: 32, &#39;width&#39;: 66} Frameimport timefrom selenium import webdriverfrom selenium.common.exceptions import NoSuchElementExceptionbrowser = webdriver.Chrome()url = 'http://www.runoob.com/try/try.php?filename=jqueryui-api-droppable'browser.get(url)browser.switch_to.frame('iframeResult')source = browser.find_element_by_css_selector('#draggable')print(source)try: logo = browser.find_element_by_class_name('logo')except NoSuchElementException: print('NO LOGO')browser.switch_to.parent_frame()logo = browser.find_element_by_class_name('logo')print(logo)print(logo.text) &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;4bb8ac03ced4ecbdefef03ffdc0e4ccd&quot;, element=&quot;0.44746093888932004-1&quot;)&gt; NO LOGO &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;4bb8ac03ced4ecbdefef03ffdc0e4ccd&quot;, element=&quot;0.13792611320464965-2&quot;)&gt; RUNOOB.COM ç­‰å¾…éšå¼ç­‰å¾…å½“ä½¿ç”¨äº†éšå¼ç­‰å¾…æ‰§è¡Œæµ‹è¯•çš„æ—¶å€™ï¼Œå¦‚æœ WebDriveræ²¡æœ‰åœ¨ DOMä¸­æ‰¾åˆ°å…ƒç´ ï¼Œå°†ç»§ç»­ç­‰å¾…ï¼Œè¶…å‡ºè®¾å®šæ—¶é—´ååˆ™æŠ›å‡ºæ‰¾ä¸åˆ°å…ƒç´ çš„å¼‚å¸¸, æ¢å¥è¯è¯´ï¼Œå½“æŸ¥æ‰¾å…ƒç´ æˆ–å…ƒç´ å¹¶æ²¡æœ‰ç«‹å³å‡ºç°çš„æ—¶å€™ï¼Œéšå¼ç­‰å¾…å°†ç­‰å¾…ä¸€æ®µæ—¶é—´å†æŸ¥æ‰¾ DOMï¼Œé»˜è®¤çš„æ—¶é—´æ˜¯0 from selenium import webdriverbrowser = webdriver.Chrome()browser.implicitly_wait(10)browser.get('https://www.zhihu.com/explore')input = browser.find_element_by_class_name('zu-top-add-question')print(input) &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;b29214772d59e912f1ac52e96ed29abe&quot;, element=&quot;0.12886805191194894-1&quot;)&gt; æ˜¾å¼ç­‰å¾…from selenium import webdriverfrom selenium.webdriver.common.by import Byfrom selenium.webdriver.support.ui import WebDriverWaitfrom selenium.webdriver.support import expected_conditions as ECbrowser = webdriver.Chrome()browser.get('https://www.taobao.com/')wait = WebDriverWait(browser, 10)input = wait.until(EC.presence_of_element_located((By.ID, 'q')))button = wait.until(EC.element_to_be_clickable((By.CSS_SELECTOR, '.btn-search')))print(input, button) &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;07dd2fbc2d5b1ce40e82b9754aba8fa8&quot;, element=&quot;0.5642646294074107-1&quot;)&gt; &lt;selenium.webdriver.remote.webelement.WebElement (session=&quot;07dd2fbc2d5b1ce40e82b9754aba8fa8&quot;, element=&quot;0.5642646294074107-2&quot;)&gt; title_is æ ‡é¢˜æ˜¯æŸå†…å®¹ title_contains æ ‡é¢˜åŒ…å«æŸå†…å®¹ presence_of_element_located å…ƒç´ åŠ è½½å‡ºï¼Œä¼ å…¥å®šä½å…ƒç»„ï¼Œå¦‚(By.ID, â€˜pâ€™) visibility_of_element_located å…ƒç´ å¯è§ï¼Œä¼ å…¥å®šä½å…ƒç»„ visibility_of å¯è§ï¼Œä¼ å…¥å…ƒç´ å¯¹è±¡ presence_of_all_elements_located æ‰€æœ‰å…ƒç´ åŠ è½½å‡º text_to_be_present_in_element æŸä¸ªå…ƒç´ æ–‡æœ¬åŒ…å«æŸæ–‡å­— text_to_be_present_in_element_value æŸä¸ªå…ƒç´ å€¼åŒ…å«æŸæ–‡å­— frame_to_be_available_and_switch_to_it frameåŠ è½½å¹¶åˆ‡æ¢ invisibility_of_element_located å…ƒç´ ä¸å¯è§ element_to_be_clickable å…ƒç´ å¯ç‚¹å‡» staleness_of åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦ä»åœ¨DOMï¼Œå¯åˆ¤æ–­é¡µé¢æ˜¯å¦å·²ç»åˆ·æ–° element_to_be_selected å…ƒç´ å¯é€‰æ‹©ï¼Œä¼ å…ƒç´ å¯¹è±¡ element_located_to_be_selected å…ƒç´ å¯é€‰æ‹©ï¼Œä¼ å…¥å®šä½å…ƒç»„ element_selection_state_to_be ä¼ å…¥å…ƒç´ å¯¹è±¡ä»¥åŠçŠ¶æ€ï¼Œç›¸ç­‰è¿”å›Trueï¼Œå¦åˆ™è¿”å›False element_located_selection_state_to_be ä¼ å…¥å®šä½å…ƒç»„ä»¥åŠçŠ¶æ€ï¼Œç›¸ç­‰è¿”å›Trueï¼Œå¦åˆ™è¿”å›False alert_is_present æ˜¯å¦å‡ºç°Alert è¯¦ç»†å†…å®¹ï¼šhttp://selenium-python.readthedocs.io/api.html#module-selenium.webdriver.support.expected_conditions å‰è¿›åé€€import timefrom selenium import webdriverbrowser = webdriver.Chrome()browser.get('https://www.baidu.com/')browser.get('https://www.taobao.com/')browser.get('https://www.python.org/')browser.back()time.sleep(1)browser.forward()browser.close() Cookiesfrom selenium import webdriverbrowser = webdriver.Chrome()browser.get('https://www.zhihu.com/explore')print(browser.get_cookies())browser.add_cookie(&#123;'name': 'name', 'domain': 'www.zhihu.com', 'value': 'germey'&#125;)print(browser.get_cookies())browser.delete_all_cookies()print(browser.get_cookies()) [{&#39;secure&#39;: False, &#39;value&#39;: &#39;&quot;NGM0ZTM5NDAwMWEyNDQwNDk5ODlkZWY3OTkxY2I0NDY=|1491604091|236e34290a6f407bfbb517888849ea509ac366d0&quot;&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;l_cap_id&#39;, &#39;expiry&#39;: 1494196091.403418}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;&quot;YWEyOGY4MmI1MzQ2NGY5MmFiMjgzZGUzZWJjYTgwYjY=|1491604091|ff946847ddb5881245bdb7a5e6401b70dc61013f&quot;&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;cap_id&#39;, &#39;expiry&#39;: 1494196091.402855}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;l_n_c&#39;}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;&quot;MjcxMDE3YzU1YjI4NDljZjljNTQ4ZDIyOWJjZTBhNmY=|1491604091|8da4722b56a1545c2020dba97394a220c0eca8d9&quot;&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;r_cap_id&#39;, &#39;expiry&#39;: 1494196091.402525}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmc&#39;}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;&quot;AADCo7e1kguPTqvEOMieRUzwkA7ZUBhV-VY=|1491604091&quot;&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;d_c0&#39;, &#39;expiry&#39;: 1586212091.344773}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390.1491604091.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmz&#39;, &#39;expiry&#39;: 1507372091}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;3cc99fc5-8706-43fc-90ac-3ad991bd1a25&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;_zap&#39;, &#39;expiry&#39;: 1554676091}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;97cb00128ccb46659728f7c69cc191b0|1491604091000|1491604091000&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;q_c1&#39;, &#39;expiry&#39;: 1586212091.401644}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390.2.10.1491604091&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmb&#39;, &#39;expiry&#39;: 1491605891}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;n_c&#39;}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390.000--|3=entry_date=20170408=1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmv&#39;, &#39;expiry&#39;: 1554676091}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390.669300758.1491604091.1491604091.1491604091.1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utma&#39;, &#39;expiry&#39;: 1554676091}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmt&#39;, &#39;expiry&#39;: 1491604691}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;AQAAALCZuwh+dgIAeu3PPHA+csDPnXvT&#39;, &#39;domain&#39;: &#39;www.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: True, &#39;name&#39;: &#39;aliyungf_tc&#39;}] [{&#39;secure&#39;: False, &#39;value&#39;: &#39;germey&#39;, &#39;domain&#39;: &#39;.www.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;name&#39;}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;&quot;NGM0ZTM5NDAwMWEyNDQwNDk5ODlkZWY3OTkxY2I0NDY=|1491604091|236e34290a6f407bfbb517888849ea509ac366d0&quot;&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;l_cap_id&#39;, &#39;expiry&#39;: 1494196091.403418}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;&quot;YWEyOGY4MmI1MzQ2NGY5MmFiMjgzZGUzZWJjYTgwYjY=|1491604091|ff946847ddb5881245bdb7a5e6401b70dc61013f&quot;&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;cap_id&#39;, &#39;expiry&#39;: 1494196091.402855}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;l_n_c&#39;}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;&quot;MjcxMDE3YzU1YjI4NDljZjljNTQ4ZDIyOWJjZTBhNmY=|1491604091|8da4722b56a1545c2020dba97394a220c0eca8d9&quot;&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;r_cap_id&#39;, &#39;expiry&#39;: 1494196091.402525}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmc&#39;}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;&quot;AADCo7e1kguPTqvEOMieRUzwkA7ZUBhV-VY=|1491604091&quot;&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;d_c0&#39;, &#39;expiry&#39;: 1586212091.344773}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390.1491604091.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmz&#39;, &#39;expiry&#39;: 1507372091}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;3cc99fc5-8706-43fc-90ac-3ad991bd1a25&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;_zap&#39;, &#39;expiry&#39;: 1554676091}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;97cb00128ccb46659728f7c69cc191b0|1491604091000|1491604091000&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;q_c1&#39;, &#39;expiry&#39;: 1586212091.401644}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390.2.10.1491604091&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmb&#39;, &#39;expiry&#39;: 1491605891}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;n_c&#39;}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390.000--|3=entry_date=20170408=1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmv&#39;, &#39;expiry&#39;: 1554676091}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;51854390.669300758.1491604091.1491604091.1491604091.1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utma&#39;, &#39;expiry&#39;: 1554676091}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;1&#39;, &#39;domain&#39;: &#39;.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: False, &#39;name&#39;: &#39;__utmt&#39;, &#39;expiry&#39;: 1491604691}, {&#39;secure&#39;: False, &#39;value&#39;: &#39;AQAAALCZuwh+dgIAeu3PPHA+csDPnXvT&#39;, &#39;domain&#39;: &#39;www.zhihu.com&#39;, &#39;path&#39;: &#39;/&#39;, &#39;httpOnly&#39;: True, &#39;name&#39;: &#39;aliyungf_tc&#39;}] [] é€‰é¡¹å¡ç®¡ç†import timefrom selenium import webdriverbrowser = webdriver.Chrome()browser.get('https://www.baidu.com')browser.execute_script('window.open()')print(browser.window_handles)browser.switch_to_window(browser.window_handles[1])browser.get('https://www.taobao.com')time.sleep(1)browser.switch_to_window(browser.window_handles[0])browser.get('https://python.org') [&#39;CDwindow-4f58e3a7-7167-4587-bedf-9cd8c867f435&#39;, &#39;CDwindow-6e05f076-6d77-453a-a36c-32baacc447df&#39;] å¼‚å¸¸å¤„ç†from selenium import webdriverbrowser = webdriver.Chrome()browser.get('https://www.baidu.com')browser.find_element_by_id('hello') --------------------------------------------------------------------------- NoSuchElementException Traceback (most recent call last) &lt;ipython-input-23-978945848a1b&gt; in &lt;module&gt;() 3 browser = webdriver.Chrome() 4 browser.get(&#39;https://www.baidu.com&#39;) ----&gt; 5 browser.find_element_by_id(&#39;hello&#39;) /Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/selenium/webdriver/remote/webdriver.py in find_element_by_id(self, id_) 267 driver.find_element_by_id(&#39;foo&#39;) 268 &quot;&quot;&quot; --&gt; 269 return self.find_element(by=By.ID, value=id_) 270 271 def find_elements_by_id(self, id_): /Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/selenium/webdriver/remote/webdriver.py in find_element(self, by, value) 750 return self.execute(Command.FIND_ELEMENT, { 751 &#39;using&#39;: by, --&gt; 752 &#39;value&#39;: value})[&#39;value&#39;] 753 754 def find_elements(self, by=By.ID, value=None): /Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/selenium/webdriver/remote/webdriver.py in execute(self, driver_command, params) 234 response = self.command_executor.execute(driver_command, params) 235 if response: --&gt; 236 self.error_handler.check_response(response) 237 response[&#39;value&#39;] = self._unwrap_value( 238 response.get(&#39;value&#39;, None)) /Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/selenium/webdriver/remote/errorhandler.py in check_response(self, response) 190 elif exception_class == UnexpectedAlertPresentException and &#39;alert&#39; in value: 191 raise exception_class(message, screen, stacktrace, value[&#39;alert&#39;].get(&#39;text&#39;)) --&gt; 192 raise exception_class(message, screen, stacktrace) 193 194 def _value_or_default(self, obj, key, default): NoSuchElementException: Message: no such element: Unable to locate element: {&quot;method&quot;:&quot;id&quot;,&quot;selector&quot;:&quot;hello&quot;} (Session info: chrome=57.0.2987.133) (Driver info: chromedriver=2.27.440174 (e97a722caafc2d3a8b807ee115bfb307f7d2cfd9),platform=Mac OS X 10.12.3 x86_64) from selenium import webdriverfrom selenium.common.exceptions import TimeoutException, NoSuchElementExceptionbrowser = webdriver.Chrome()try: browser.get('https://www.baidu.com')except TimeoutException: print('Time Out')try: browser.find_element_by_id('hello')except NoSuchElementException: print('No Element')finally: browser.close() No Element è¯¦ç»†æ–‡æ¡£ï¼šhttp://selenium-python.readthedocs.io/api.html#module-selenium.common.exceptions JsonJson æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼å­—ç¬¦ä¸²æ˜¯Jsonçš„è¡¨ç°å½¢å¼ç¬¦åˆJsonæ ¼å¼çš„å­—ç¬¦ä¸²å«Jsonå­—ç¬¦ä¸² Jsonç›¸æ¯”ä¸XMLçš„ä¼˜ç‚¹ æ˜“äºé˜…è¯» æ˜“äºè§£æ ç½‘ç»œä¼ è¾“æ•ˆç‡é«˜åŒæ—¶ä¹Ÿå¯ä»¥è·¨è¯­è¨€äº¤æ¢æ•°æ® ååºåˆ—åŒ–json.loads() # å°†Jsonå­—ç¬¦ä¸²æ ¼å¼è½¬æ¢æˆå¯¹åº”çš„Pythonç›¸å¯¹åº”æ•°æ®æ ¼å¼ åºåˆ—åŒ–json.dumps() #å°†Pythonæ•°æ®æ ¼å¼è½¬æ¢æˆJsonç›¸å¯¹åº”çš„æ ¼å¼ æ•°æ®ç±»å‹è½¬æ¢å¯¹åº”å…³ç³» Json Python object dict array kist string str number int number float true True false False null None ç›¸å…³åè¯è¾¨æ Jsonå¯¹è±¡ï¼šæ˜¯Javascriptä¸­çš„ä¸€ä¸­å«æ³•ï¼Œç›¸å¯¹äºå…¶ä»–è¯­è¨€å…¶å®æ˜¯æ²¡æœ‰çš„ã€‚ Jsonï¼šæ•°æ®äº¤æ¢çš„æ ‡å‡†æ ¼å¼ã€‚ Jsonå­—ç¬¦ä¸²ï¼šç¬¦åˆJsonæ ¼å¼çš„å­—ç¬¦ä¸²ã€‚ æ­£åˆ™è¡¨è¾¾å¼æ­£åˆ™è¡¨è¾¾å¼æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¯¹å­—ç¬¦ä¸²æ“ä½œçš„ä¸€ä¸­é€»è¾‘å…¬ç¤ºï¼Œå°±æ˜¯ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ä¸€äº›ç‰¹å®šå­—ç¬¦ï¼Œä»¥åŠè¿™äº›ç‰¹å®šå­—ç¬¦çš„ç»„åˆï¼Œç»„æˆä¸€ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ï¼Œè¿™ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ç”¨æ¥è¡¨è¾¾å¯¹å­—ç¬¦ä¸²çš„ä¸€ä¸­è¿‡æ»¤é€»è¾‘ã€‚ å¸¸è§åŒ¹é…æ¨¡å¼ æ¨¡å¼ æè¿° \\w åŒ¹é…å­—æ¯æ•°å­—åŠä¸‹åˆ’çº¿ \\W åŒ¹é…éå­—æ¯æ•°å­—ä¸‹åˆ’çº¿ \\s åŒ¹é…ä»»æ„ç©ºç™½å­—ç¬¦ï¼Œç­‰ä»·äº [\\t\\n\\r\\f]. \\S åŒ¹é…ä»»æ„éç©ºå­—ç¬¦ \\d åŒ¹é…ä»»æ„æ•°å­—ï¼Œç­‰ä»·äº [0-9] \\D åŒ¹é…ä»»æ„éæ•°å­— \\A åŒ¹é…å­—ç¬¦ä¸²å¼€å§‹ \\Z åŒ¹é…å­—ç¬¦ä¸²ç»“æŸï¼Œå¦‚æœæ˜¯å­˜åœ¨æ¢è¡Œï¼ŒåªåŒ¹é…åˆ°æ¢è¡Œå‰çš„ç»“æŸå­—ç¬¦ä¸² \\z åŒ¹é…å­—ç¬¦ä¸²ç»“æŸ \\G åŒ¹é…æœ€ååŒ¹é…å®Œæˆçš„ä½ç½® \\n åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ \\t åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ ^ åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´ $ åŒ¹é…å­—ç¬¦ä¸²çš„æœ«å°¾ã€‚ . åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œé™¤äº†æ¢è¡Œç¬¦ï¼Œå½“re.DOTALLæ ‡è®°è¢«æŒ‡å®šæ—¶ï¼Œåˆ™å¯ä»¥åŒ¹é…åŒ…æ‹¬æ¢è¡Œç¬¦çš„ä»»æ„å­—ç¬¦ã€‚ [â€¦] ç”¨æ¥è¡¨ç¤ºä¸€ç»„å­—ç¬¦,å•ç‹¬åˆ—å‡ºï¼š[amk] åŒ¹é… â€˜aâ€™ï¼Œâ€™mâ€™æˆ–â€™kâ€™ ... ä¸åœ¨[]ä¸­çš„å­—ç¬¦ï¼šabc åŒ¹é…é™¤äº†a,b,cä¹‹å¤–çš„å­—ç¬¦ã€‚ * åŒ¹é…0ä¸ªæˆ–å¤šä¸ªçš„è¡¨è¾¾å¼ã€‚ + åŒ¹é…1ä¸ªæˆ–å¤šä¸ªçš„è¡¨è¾¾å¼ã€‚ ? åŒ¹é…0ä¸ªæˆ–1ä¸ªç”±å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰çš„ç‰‡æ®µï¼Œéè´ªå©ªæ–¹å¼ {n} ç²¾ç¡®åŒ¹é…nä¸ªå‰é¢è¡¨è¾¾å¼ã€‚ {n, m} åŒ¹é… n åˆ° m æ¬¡ç”±å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰çš„ç‰‡æ®µï¼Œè´ªå©ªæ–¹å¼ a&#124;b åŒ¹é…aæˆ–b ( ) åŒ¹é…æ‹¬å·å†…çš„è¡¨è¾¾å¼ï¼Œä¹Ÿè¡¨ç¤ºä¸€ä¸ªç»„ re.matchre.match å°è¯•ä»å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®åŒ¹é…ä¸€ä¸ªæ¨¡å¼ï¼Œå¦‚æœä¸æ˜¯èµ·å§‹ä½ç½®åŒ¹é…æˆåŠŸçš„è¯ï¼Œmatch()å°±è¿”å›noneã€‚re.match(pattern, string, flags=0) æœ€å¸¸è§„çš„åŒ¹é…import recontent = 'Hello 123 4567 World_This is a Regex Demo'print(len(content))result = re.match('^Hello\\s\\d\\d\\d\\s\\d&#123;4&#125;\\s\\w&#123;10&#125;.*Demo$', content)print(result)print(result.group())print(result.span()) 41 &lt;_sre.SRE_Match object; span=(0, 41), match=&#39;Hello 123 4567 World_This is a Regex Demo&#39;&gt; Hello 123 4567 World_This is a Regex Demo (0, 41) æ³›åŒ¹é…import recontent = 'Hello 123 4567 World_This is a Regex Demo'result = re.match('^Hello.*Demo$', content)print(result)print(result.group())print(result.span()) &lt;_sre.SRE_Match object; span=(0, 41), match=&#39;Hello 123 4567 World_This is a Regex Demo&#39;&gt; Hello 123 4567 World_This is a Regex Demo (0, 41) åŒ¹é…ç›®æ ‡import recontent = 'Hello 1234567 World_This is a Regex Demo'result = re.match('^Hello\\s(\\d+)\\sWorld.*Demo$', content)print(result)print(result.group(1))print(result.span()) &lt;_sre.SRE_Match object; span=(0, 40), match=&#39;Hello 1234567 World_This is a Regex Demo&#39;&gt; 1234567 (0, 40) è´ªå©ªåŒ¹é…import recontent = 'Hello 1234567 World_This is a Regex Demo'result = re.match('^He.*(\\d+).*Demo$', content)print(result)print(result.group(1)) &lt;_sre.SRE_Match object; span=(0, 40), match=&#39;Hello 1234567 World_This is a Regex Demo&#39;&gt; 7 éè´ªå©ªåŒ¹é…import recontent = 'Hello 1234567 World_This is a Regex Demo'result = re.match('^He.*?(\\d+).*Demo$', content)print(result)print(result.group(1)) &lt;_sre.SRE_Match object; span=(0, 40), match=&#39;Hello 1234567 World_This is a Regex Demo&#39;&gt; 1234567 åŒ¹é…æ¨¡å¼import recontent = '''Hello 1234567 World_Thisis a Regex Demo'''result = re.match('^He.*?(\\d+).*?Demo$', content, re.S)print(result.group(1)) 1234567 è½¬ä¹‰import recontent = 'price is $5.00'result = re.match('price is $5.00', content)print(result) None import recontent = 'price is $5.00'result = re.match('price is \\$5\\.00', content)print(result) &lt;_sre.SRE_Match object; span=(0, 14), match=&#39;price is $5.00&#39;&gt; æ€»ç»“ï¼šå°½é‡ä½¿ç”¨æ³›åŒ¹é…ã€ä½¿ç”¨æ‹¬å·å¾—åˆ°åŒ¹é…ç›®æ ‡ã€å°½é‡ä½¿ç”¨éè´ªå©ªæ¨¡å¼ã€æœ‰æ¢è¡Œç¬¦å°±ç”¨re.S re.searchre.search æ‰«ææ•´ä¸ªå­—ç¬¦ä¸²å¹¶è¿”å›ç¬¬ä¸€ä¸ªæˆåŠŸçš„åŒ¹é…ã€‚ import recontent = 'Extra stings Hello 1234567 World_This is a Regex Demo Extra stings'result = re.match('Hello.*?(\\d+).*?Demo', content)print(result) None import recontent = 'Extra stings Hello 1234567 World_This is a Regex Demo Extra stings'result = re.search('Hello.*?(\\d+).*?Demo', content)print(result)print(result.group(1)) &lt;_sre.SRE_Match object; span=(13, 53), match=&#39;Hello 1234567 World_This is a Regex Demo&#39;&gt; 1234567 æ€»ç»“ï¼šä¸ºåŒ¹é…æ–¹ä¾¿ï¼Œèƒ½ç”¨searchå°±ä¸ç”¨match åŒ¹é…æ¼”ç»ƒimport rehtml = '''&lt;div id=\"songs-list\"&gt; &lt;h2 class=\"title\"&gt;ç»å…¸è€æ­Œ&lt;/h2&gt; &lt;p class=\"introduction\"&gt; ç»å…¸è€æ­Œåˆ—è¡¨ &lt;/p&gt; &lt;ul id=\"list\" class=\"list-group\"&gt; &lt;li data-view=\"2\"&gt;ä¸€è·¯ä¸Šæœ‰ä½ &lt;/li&gt; &lt;li data-view=\"7\"&gt; &lt;a href=\"/2.mp3\" singer=\"ä»»è´¤é½\"&gt;æ²§æµ·ä¸€å£°ç¬‘&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"4\" class=\"active\"&gt; &lt;a href=\"/3.mp3\" singer=\"é½ç§¦\"&gt;å¾€äº‹éšé£&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"6\"&gt;&lt;a href=\"/4.mp3\" singer=\"beyond\"&gt;å…‰è¾‰å²æœˆ&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt;&lt;a href=\"/5.mp3\" singer=\"é™ˆæ…§ç³\"&gt;è®°äº‹æœ¬&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt; &lt;a href=\"/6.mp3\" singer=\"é‚“ä¸½å›\"&gt;&lt;i class=\"fa fa-user\"&gt;&lt;/i&gt;ä½†æ„¿äººé•¿ä¹…&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;'''result = re.search('&lt;li.*?active.*?singer=\"(.*?)\"&gt;(.*?)&lt;/a&gt;', html, re.S)if result: print(result.group(1), result.group(2)) é½ç§¦ å¾€äº‹éšé£ import rehtml = '''&lt;div id=\"songs-list\"&gt; &lt;h2 class=\"title\"&gt;ç»å…¸è€æ­Œ&lt;/h2&gt; &lt;p class=\"introduction\"&gt; ç»å…¸è€æ­Œåˆ—è¡¨ &lt;/p&gt; &lt;ul id=\"list\" class=\"list-group\"&gt; &lt;li data-view=\"2\"&gt;ä¸€è·¯ä¸Šæœ‰ä½ &lt;/li&gt; &lt;li data-view=\"7\"&gt; &lt;a href=\"/2.mp3\" singer=\"ä»»è´¤é½\"&gt;æ²§æµ·ä¸€å£°ç¬‘&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"4\" class=\"active\"&gt; &lt;a href=\"/3.mp3\" singer=\"é½ç§¦\"&gt;å¾€äº‹éšé£&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"6\"&gt;&lt;a href=\"/4.mp3\" singer=\"beyond\"&gt;å…‰è¾‰å²æœˆ&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt;&lt;a href=\"/5.mp3\" singer=\"é™ˆæ…§ç³\"&gt;è®°äº‹æœ¬&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt; &lt;a href=\"/6.mp3\" singer=\"é‚“ä¸½å›\"&gt;ä½†æ„¿äººé•¿ä¹…&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;'''result = re.search('&lt;li.*?singer=\"(.*?)\"&gt;(.*?)&lt;/a&gt;', html, re.S)if result: print(result.group(1), result.group(2)) ä»»è´¤é½ æ²§æµ·ä¸€å£°ç¬‘ import rehtml = '''&lt;div id=\"songs-list\"&gt; &lt;h2 class=\"title\"&gt;ç»å…¸è€æ­Œ&lt;/h2&gt; &lt;p class=\"introduction\"&gt; ç»å…¸è€æ­Œåˆ—è¡¨ &lt;/p&gt; &lt;ul id=\"list\" class=\"list-group\"&gt; &lt;li data-view=\"2\"&gt;ä¸€è·¯ä¸Šæœ‰ä½ &lt;/li&gt; &lt;li data-view=\"7\"&gt; &lt;a href=\"/2.mp3\" singer=\"ä»»è´¤é½\"&gt;æ²§æµ·ä¸€å£°ç¬‘&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"4\" class=\"active\"&gt; &lt;a href=\"/3.mp3\" singer=\"é½ç§¦\"&gt;å¾€äº‹éšé£&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"6\"&gt;&lt;a href=\"/4.mp3\" singer=\"beyond\"&gt;å…‰è¾‰å²æœˆ&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt;&lt;a href=\"/5.mp3\" singer=\"é™ˆæ…§ç³\"&gt;è®°äº‹æœ¬&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt; &lt;a href=\"/6.mp3\" singer=\"é‚“ä¸½å›\"&gt;ä½†æ„¿äººé•¿ä¹…&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;'''result = re.search('&lt;li.*?singer=\"(.*?)\"&gt;(.*?)&lt;/a&gt;', html)if result: print(result.group(1), result.group(2)) beyond å…‰è¾‰å²æœˆ re.findallæœç´¢å­—ç¬¦ä¸²ï¼Œä»¥åˆ—è¡¨å½¢å¼è¿”å›å…¨éƒ¨èƒ½åŒ¹é…çš„å­ä¸²ã€‚ import rehtml = '''&lt;div id=\"songs-list\"&gt; &lt;h2 class=\"title\"&gt;ç»å…¸è€æ­Œ&lt;/h2&gt; &lt;p class=\"introduction\"&gt; ç»å…¸è€æ­Œåˆ—è¡¨ &lt;/p&gt; &lt;ul id=\"list\" class=\"list-group\"&gt; &lt;li data-view=\"2\"&gt;ä¸€è·¯ä¸Šæœ‰ä½ &lt;/li&gt; &lt;li data-view=\"7\"&gt; &lt;a href=\"/2.mp3\" singer=\"ä»»è´¤é½\"&gt;æ²§æµ·ä¸€å£°ç¬‘&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"4\" class=\"active\"&gt; &lt;a href=\"/3.mp3\" singer=\"é½ç§¦\"&gt;å¾€äº‹éšé£&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"6\"&gt;&lt;a href=\"/4.mp3\" singer=\"beyond\"&gt;å…‰è¾‰å²æœˆ&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt;&lt;a href=\"/5.mp3\" singer=\"é™ˆæ…§ç³\"&gt;è®°äº‹æœ¬&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt; &lt;a href=\"/6.mp3\" singer=\"é‚“ä¸½å›\"&gt;ä½†æ„¿äººé•¿ä¹…&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;'''results = re.findall('&lt;li.*?href=\"(.*?)\".*?singer=\"(.*?)\"&gt;(.*?)&lt;/a&gt;', html, re.S)print(results)print(type(results))for result in results: print(result) print(result[0], result[1], result[2]) [(&#39;/2.mp3&#39;, &#39;ä»»è´¤é½&#39;, &#39;æ²§æµ·ä¸€å£°ç¬‘&#39;), (&#39;/3.mp3&#39;, &#39;é½ç§¦&#39;, &#39;å¾€äº‹éšé£&#39;), (&#39;/4.mp3&#39;, &#39;beyond&#39;, &#39;å…‰è¾‰å²æœˆ&#39;), (&#39;/5.mp3&#39;, &#39;é™ˆæ…§ç³&#39;, &#39;è®°äº‹æœ¬&#39;), (&#39;/6.mp3&#39;, &#39;é‚“ä¸½å›&#39;, &#39;ä½†æ„¿äººé•¿ä¹…&#39;)] &lt;class &#39;list&#39;&gt; (&#39;/2.mp3&#39;, &#39;ä»»è´¤é½&#39;, &#39;æ²§æµ·ä¸€å£°ç¬‘&#39;) /2.mp3 ä»»è´¤é½ æ²§æµ·ä¸€å£°ç¬‘ (&#39;/3.mp3&#39;, &#39;é½ç§¦&#39;, &#39;å¾€äº‹éšé£&#39;) /3.mp3 é½ç§¦ å¾€äº‹éšé£ (&#39;/4.mp3&#39;, &#39;beyond&#39;, &#39;å…‰è¾‰å²æœˆ&#39;) /4.mp3 beyond å…‰è¾‰å²æœˆ (&#39;/5.mp3&#39;, &#39;é™ˆæ…§ç³&#39;, &#39;è®°äº‹æœ¬&#39;) /5.mp3 é™ˆæ…§ç³ è®°äº‹æœ¬ (&#39;/6.mp3&#39;, &#39;é‚“ä¸½å›&#39;, &#39;ä½†æ„¿äººé•¿ä¹…&#39;) /6.mp3 é‚“ä¸½å› ä½†æ„¿äººé•¿ä¹… import rehtml = '''&lt;div id=\"songs-list\"&gt; &lt;h2 class=\"title\"&gt;ç»å…¸è€æ­Œ&lt;/h2&gt; &lt;p class=\"introduction\"&gt; ç»å…¸è€æ­Œåˆ—è¡¨ &lt;/p&gt; &lt;ul id=\"list\" class=\"list-group\"&gt; &lt;li data-view=\"2\"&gt;ä¸€è·¯ä¸Šæœ‰ä½ &lt;/li&gt; &lt;li data-view=\"7\"&gt; &lt;a href=\"/2.mp3\" singer=\"ä»»è´¤é½\"&gt;æ²§æµ·ä¸€å£°ç¬‘&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"4\" class=\"active\"&gt; &lt;a href=\"/3.mp3\" singer=\"é½ç§¦\"&gt;å¾€äº‹éšé£&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"6\"&gt;&lt;a href=\"/4.mp3\" singer=\"beyond\"&gt;å…‰è¾‰å²æœˆ&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt;&lt;a href=\"/5.mp3\" singer=\"é™ˆæ…§ç³\"&gt;è®°äº‹æœ¬&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt; &lt;a href=\"/6.mp3\" singer=\"é‚“ä¸½å›\"&gt;ä½†æ„¿äººé•¿ä¹…&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;'''results = re.findall('&lt;li.*?&gt;\\s*?(&lt;a.*?&gt;)?(\\w+)(&lt;/a&gt;)?\\s*?&lt;/li&gt;', html, re.S)print(results)for result in results: print(result[1]) [(&#39;&#39;, &#39;ä¸€è·¯ä¸Šæœ‰ä½ &#39;, &#39;&#39;), (&#39;&lt;a href=&quot;/2.mp3&quot; singer=&quot;ä»»è´¤é½&quot;&gt;&#39;, &#39;æ²§æµ·ä¸€å£°ç¬‘&#39;, &#39;&lt;/a&gt;&#39;), (&#39;&lt;a href=&quot;/3.mp3&quot; singer=&quot;é½ç§¦&quot;&gt;&#39;, &#39;å¾€äº‹éšé£&#39;, &#39;&lt;/a&gt;&#39;), (&#39;&lt;a href=&quot;/4.mp3&quot; singer=&quot;beyond&quot;&gt;&#39;, &#39;å…‰è¾‰å²æœˆ&#39;, &#39;&lt;/a&gt;&#39;), (&#39;&lt;a href=&quot;/5.mp3&quot; singer=&quot;é™ˆæ…§ç³&quot;&gt;&#39;, &#39;è®°äº‹æœ¬&#39;, &#39;&lt;/a&gt;&#39;), (&#39;&lt;a href=&quot;/6.mp3&quot; singer=&quot;é‚“ä¸½å›&quot;&gt;&#39;, &#39;ä½†æ„¿äººé•¿ä¹…&#39;, &#39;&lt;/a&gt;&#39;)] ä¸€è·¯ä¸Šæœ‰ä½  æ²§æµ·ä¸€å£°ç¬‘ å¾€äº‹éšé£ å…‰è¾‰å²æœˆ è®°äº‹æœ¬ ä½†æ„¿äººé•¿ä¹… re.subæ›¿æ¢å­—ç¬¦ä¸²ä¸­æ¯ä¸€ä¸ªåŒ¹é…çš„å­ä¸²åè¿”å›æ›¿æ¢åçš„å­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼šsubå‡½æ•°ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ã€‚ import recontent = 'Extra stings Hello 1234567 World_This is a Regex Demo Extra stings'content = re.sub('\\d+', '', content)print(content) Extra stings Hello World_This is a Regex Demo Extra stings import recontent = 'Extra stings Hello 1234567 World_This is a Regex Demo Extra stings'content = re.sub('\\d+', 'Replacement', content)print(content) Extra stings Hello Replacement World_This is a Regex Demo Extra stings import recontent = 'Extra stings Hello 1234567 World_This is a Regex Demo Extra stings'content = re.sub('(\\d+)', r'\\1 8910', content)print(content) Extra stings Hello 1234567 8910 World_This is a Regex Demo Extra stings import rehtml = '''&lt;div id=\"songs-list\"&gt; &lt;h2 class=\"title\"&gt;ç»å…¸è€æ­Œ&lt;/h2&gt; &lt;p class=\"introduction\"&gt; ç»å…¸è€æ­Œåˆ—è¡¨ &lt;/p&gt; &lt;ul id=\"list\" class=\"list-group\"&gt; &lt;li data-view=\"2\"&gt;ä¸€è·¯ä¸Šæœ‰ä½ &lt;/li&gt; &lt;li data-view=\"7\"&gt; &lt;a href=\"/2.mp3\" singer=\"ä»»è´¤é½\"&gt;æ²§æµ·ä¸€å£°ç¬‘&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"4\" class=\"active\"&gt; &lt;a href=\"/3.mp3\" singer=\"é½ç§¦\"&gt;å¾€äº‹éšé£&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"6\"&gt;&lt;a href=\"/4.mp3\" singer=\"beyond\"&gt;å…‰è¾‰å²æœˆ&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt;&lt;a href=\"/5.mp3\" singer=\"é™ˆæ…§ç³\"&gt;è®°äº‹æœ¬&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt; &lt;a href=\"/6.mp3\" singer=\"é‚“ä¸½å›\"&gt;ä½†æ„¿äººé•¿ä¹…&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;''' import rehtml = '''&lt;div id=\"songs-list\"&gt; &lt;h2 class=\"title\"&gt;ç»å…¸è€æ­Œ&lt;/h2&gt; &lt;p class=\"introduction\"&gt; ç»å…¸è€æ­Œåˆ—è¡¨ &lt;/p&gt; &lt;ul id=\"list\" class=\"list-group\"&gt; &lt;li data-view=\"2\"&gt;ä¸€è·¯ä¸Šæœ‰ä½ &lt;/li&gt; &lt;li data-view=\"7\"&gt; &lt;a href=\"/2.mp3\" singer=\"ä»»è´¤é½\"&gt;æ²§æµ·ä¸€å£°ç¬‘&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"4\" class=\"active\"&gt; &lt;a href=\"/3.mp3\" singer=\"é½ç§¦\"&gt;å¾€äº‹éšé£&lt;/a&gt; &lt;/li&gt; &lt;li data-view=\"6\"&gt;&lt;a href=\"/4.mp3\" singer=\"beyond\"&gt;å…‰è¾‰å²æœˆ&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt;&lt;a href=\"/5.mp3\" singer=\"é™ˆæ…§ç³\"&gt;è®°äº‹æœ¬&lt;/a&gt;&lt;/li&gt; &lt;li data-view=\"5\"&gt; &lt;a href=\"/6.mp3\" singer=\"é‚“ä¸½å›\"&gt;ä½†æ„¿äººé•¿ä¹…&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;'''html = re.sub('&lt;a.*?&gt;|&lt;/a&gt;', '', html)print(html)results = re.findall('&lt;li.*?&gt;(.*?)&lt;/li&gt;', html, re.S)print(results)for result in results: print(result.strip()) &lt;div id=&quot;songs-list&quot;&gt; &lt;h2 class=&quot;title&quot;&gt;ç»å…¸è€æ­Œ&lt;/h2&gt; &lt;p class=&quot;introduction&quot;&gt; ç»å…¸è€æ­Œåˆ—è¡¨ &lt;/p&gt; &lt;ul id=&quot;list&quot; class=&quot;list-group&quot;&gt; &lt;li data-view=&quot;2&quot;&gt;ä¸€è·¯ä¸Šæœ‰ä½ &lt;/li&gt; &lt;li data-view=&quot;7&quot;&gt; æ²§æµ·ä¸€å£°ç¬‘ &lt;/li&gt; &lt;li data-view=&quot;4&quot; class=&quot;active&quot;&gt; å¾€äº‹éšé£ &lt;/li&gt; &lt;li data-view=&quot;6&quot;&gt;å…‰è¾‰å²æœˆ&lt;/li&gt; &lt;li data-view=&quot;5&quot;&gt;è®°äº‹æœ¬&lt;/li&gt; &lt;li data-view=&quot;5&quot;&gt; ä½†æ„¿äººé•¿ä¹… &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; [&#39;ä¸€è·¯ä¸Šæœ‰ä½ &#39;, &#39;\\n æ²§æµ·ä¸€å£°ç¬‘\\n &#39;, &#39;\\n å¾€äº‹éšé£\\n &#39;, &#39;å…‰è¾‰å²æœˆ&#39;, &#39;è®°äº‹æœ¬&#39;, &#39;\\n ä½†æ„¿äººé•¿ä¹…\\n &#39;] ä¸€è·¯ä¸Šæœ‰ä½  æ²§æµ·ä¸€å£°ç¬‘ å¾€äº‹éšé£ å…‰è¾‰å²æœˆ è®°äº‹æœ¬ ä½†æ„¿äººé•¿ä¹… re.compileå°†æ­£åˆ™å­—ç¬¦ä¸²ç¼–è¯‘æˆæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ å°†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸²ç¼–è¯‘æˆæ­£åˆ™å¯¹è±¡ï¼Œä»¥ä¾¿äºå¤ç”¨è¯¥åŒ¹é…æ¨¡å¼ import recontent = '''Hello 1234567 World_Thisis a Regex Demo'''pattern = re.compile('Hello.*Demo', re.S)result = re.match(pattern, content)#result = re.match('Hello.*Demo', content, re.S)print(result) &lt;_sre.SRE_Match object; span=(0, 40), match=&#39;Hello 1234567 World_This\\nis a Regex Demo&#39;&gt; å®æˆ˜ç»ƒä¹ import requestsimport recontent = requests.get('https://book.douban.com/').textpattern = re.compile('&lt;li.*?cover.*?href=\"(.*?)\".*?title=\"(.*?)\".*?more-meta.*?author\"&gt;(.*?)&lt;/span&gt;.*?year\"&gt;(.*?)&lt;/span&gt;.*?&lt;/li&gt;', re.S)results = re.findall(pattern, content)for result in results: url, name, author, date = result author = re.sub('\\s', '', author) date = re.sub('\\s', '', date) print(url, name, author, date) https://book.douban.com/subject/26925834/?icn=index-editionrecommend åˆ«èµ°å‡ºè¿™ä¸€æ­¥ [è‹±]S.J.æ²ƒæ£® 2017-1 https://book.douban.com/subject/26953532/?icn=index-editionrecommend ç™½å…ˆå‹‡ç»†è¯´çº¢æ¥¼æ¢¦ ç™½å…ˆå‹‡ 2017-2-1 https://book.douban.com/subject/26959159/?icn=index-editionrecommend å²æœˆå‡¶çŒ› å†¯ä»‘ 2017-2 https://book.douban.com/subject/26949210/?icn=index-editionrecommend å¦‚æœæ²¡æœ‰ä»Šå¤©ï¼Œæ˜å¤©ä¼šä¸ä¼šæœ‰æ˜¨å¤©ï¼Ÿ [ç‘å£«]ä¼Šå¤«Â·åšè¨å°”ç‰¹ï¼ˆYvesBossartï¼‰ 2017-1 https://book.douban.com/subject/27001447/?icn=index-editionrecommend äººç±»è¿™100å¹´ é˜¿å¤ 2017-2 https://book.douban.com/subject/26864566/?icn=index-latestbook-subject çœ¼æ³ªçš„åŒ–å­¦ [æ¾³]å½¼å¾—Â·å‡¯é‡Œ 2017-2 https://book.douban.com/subject/26991064/?icn=index-latestbook-subject é’å¹´æ–¯å¤§æ— [è‹±]è¥¿è’™Â·è’™è’‚è²å¥¥é‡Œ 2017-3 https://book.douban.com/subject/26938056/?icn=index-latestbook-subject å¸¦è‰¾ä¼¯ç‰¹å›å®¶ [ç¾]éœé»˜Â·å¸Œå¡å§† 2017-3 https://book.douban.com/subject/26954757/?icn=index-latestbook-subject ä¹³æˆ¿ [ç¾]å¼—æ´›ä¼¦æ–¯Â·å¨å»‰å§†æ–¯ 2017-2 https://book.douban.com/subject/26956479/?icn=index-latestbook-subject è‰åŸåŠ¨ç‰©å›­ é©¬ä¼¯åº¸ 2017-3 https://book.douban.com/subject/26956018/?icn=index-latestbook-subject è´©å–éŸ³ä¹ [ç¾]å¤§å«Â·ä¼Šæ–¯æ›¼ 2017-3-1 https://book.douban.com/subject/26703649/?icn=index-latestbook-subject è¢«å çš„å®…å­ [é˜¿æ ¹å»·]èƒ¡åˆ©å¥¥Â·ç§‘å¡”è¨å°” 2017-3 https://book.douban.com/subject/26578402/?icn=index-latestbook-subject ä¿¡ä»°ä¸è§‚çœ‹ [æ³•]ç½—å…°Â·é›·å¸Œç‰¹(RolandRecht) 2017-2-17 https://book.douban.com/subject/26939171/?icn=index-latestbook-subject å¦¹å¦¹çš„åŸå¢“ [ç¾]ç½—ä¼¯ç‰¹Â·æœæ ¼å°¼(RobertDugoni) 2017-3-1 https://book.douban.com/subject/26972465/?icn=index-latestbook-subject å…¨æ ˆå¸‚åœºäºº Lydia 2017-2-1 https://book.douban.com/subject/26986928/?icn=index-latestbook-subject ç»ˆæXæˆ˜è­¦2 [è‹±]é©¬å…‹Â·ç±³å‹’&amp;nbsp;/&amp;nbsp;[ç¾]äºšå½“Â·åº“ä¼¯ç‰¹ 2017-3-15 https://book.douban.com/subject/26948144/?icn=index-latestbook-subject æ ¼è°ƒï¼ˆä¿®è®¢ç¬¬3ç‰ˆï¼‰ [ç¾]ä¿ç½—Â·ç¦å¡å°”ï¼ˆPaulFussellï¼‰ 2017-2 https://book.douban.com/subject/26945792/?icn=index-latestbook-subject åŸè°…çŸ³ [ç¾]æ´›é‡ŒÂ·æ–¯çš®å°”æ›¼ 2017-2 https://book.douban.com/subject/26974207/?icn=index-latestbook-subject åº‡æŠ¤äºŒä¸–é—»è§å½• [æ„]çš®ç§‘æ´›ç±³å°¼ 2017-2 https://book.douban.com/subject/26983143/?icn=index-latestbook-subject é‡è§é‡å…”çš„é‚£ä¸€å¹´ [èŠ¬]é˜¿æ‰˜Â·å¸•è¥¿æ—çº³ 2017-3-1 https://book.douban.com/subject/26976429/?icn=index-latestbook-subject é²å‹ƒÂ·è¿ªä¼¦ï¼šè¯—äººä¹‹æ­Œ [æ³•]è®©-å¤šç±³å°¼å…‹Â·å¸ƒé‡ŒåŸƒ 2017-4 https://book.douban.com/subject/26962860/?icn=index-latestbook-subject ç‰™åŒ»è°‹æ€æ¡ˆ [è‹±]é˜¿åŠ èÂ·å…‹é‡Œæ–¯è’‚ 2017-3 https://book.douban.com/subject/26923022/?icn=index-latestbook-subject çŸ³æŒ¥è°ˆè‰ºå½•ï¼šæŠŠç”Ÿå‘½äº¤ç»™èˆå° çŸ³æŒ¥ 2017-2 https://book.douban.com/subject/26897190/?icn=index-latestbook-subject ç†æƒ³ [ç¾]å®‰Â·å…°å¾· 2017-2 https://book.douban.com/subject/26985981/?icn=index-latestbook-subject é’è‹”ä¸ä¼šæ¶ˆå¤± è¢å‡Œ 2017-4 https://book.douban.com/subject/26984949/?icn=index-latestbook-subject åœ°ä¸‹é“é“ [ç¾]ç§‘å°”æ£®Â·æ€€ç‰¹é»‘å¾·ï¼ˆColsonWhiteheadï¼‰ 2017-3 https://book.douban.com/subject/26944012/?icn=index-latestbook-subject æç®€è¿›æ­¥å² [è‹±]ç½—çº³å¾·Â·èµ–ç‰¹ 2017-4-1 https://book.douban.com/subject/26969002/?icn=index-latestbook-subject é©»é©¬åº—ä¼¤å¿ƒæ•…äº‹é›† éƒ‘åœ¨æ¬¢ 2017-2 https://book.douban.com/subject/26854223/?icn=index-latestbook-subject è‡´è–‡æ‹‰ [ç¾]å¼—æ‹‰åŸºç±³å°”Â·çº³åšç§‘å¤« 2017-3 https://book.douban.com/subject/26841616/?icn=index-latestbook-subject åŒ—æ–¹æ¡£æ¡ˆ [æ³•]ç›æ ¼ä¸½ç‰¹Â·å°¤ç‘Ÿçº³å°” 2017-2 https://book.douban.com/subject/26980391/?icn=index-latestbook-subject é£Ÿå¸–15ï¼šä¾¿å½“çµæ„Ÿé›† æ—æ±Ÿ 2017-2 https://book.douban.com/subject/26958882/?icn=index-latestbook-subject ç”Ÿç« [æ³•]å…‹é‡Œæ–¯å¤šå¤«Â·å¤å¸ƒç‰¹ï¼ˆChristopheChaboutÃ©ï¼‰ç¼–ç»˜ 2017-3 https://book.douban.com/subject/26989163/?icn=index-latestbook-subject æ–‡æ˜ä¹‹å…‰ï¼ˆç¬¬å››å†Œï¼‰ å´å†› 2017-3-1 https://book.douban.com/subject/26878906/?icn=index-latestbook-subject å…¬ç‰›å±± [ç¾]å¸ƒèµ–æ©Â·å¸•è¯ºå¨å¥‡ 2017-2 https://book.douban.com/subject/26989534/?icn=index-latestbook-subject å‡ ä¹æ¶ˆå¤±çš„å·é—²è‰ºæœ¯ [åŠ æ‹¿å¤§]è¾¾å°¼Â·æ‹‰è´¹é‡ŒåŸƒ 2017-4 https://book.douban.com/subject/26939973/?icn=index-latestbook-subject æ•£æ­¥å» [æ—¥]è°·å£æ²»éƒ 2017-3 https://book.douban.com/subject/26865333/?icn=index-latestbook-subject ä¸­å›½1945 [ç¾]ç†æŸ¥å¾·Â·ä¼¯æ©æ–¯å¦(RichardBernstein) 2017-3-1 https://book.douban.com/subject/26989242/?icn=index-latestbook-subject æœ‰åŒª2ï¼šç¦»æ¨æ¥¼ Priest 2017-3 https://book.douban.com/subject/26985790/?icn=index-latestbook-subject å¥³äººã€ç«ä¸å±é™©äº‹ç‰© [ç¾]ä¹”æ²»Â·è±è€ƒå¤« 2017-3 https://book.douban.com/subject/26972277/?icn=index-latestbook-subject å¯»æ‰¾æ—¶é—´çš„äºº [çˆ±å°”å…°]å‡¯ç‰¹Â·æ±¤æ™®æ£® 2017-3 https://www.douban.com/note/610758170/ ç™½å…ˆå‹‡ç»†è¯´çº¢æ¥¼æ¢¦ã€å…¨äºŒå†Œã€‘ ç™½å…ˆå‹‡ 2017-2-1 https://read.douban.com/ebook/31540864/?dcs=book-hot&amp;amp;dcm=douban&amp;amp;dct=read-subject å¥‡çˆ±åšå£« [è‹±]å½¼å¾—Â·ä¹”æ²» 2016-8-1 https://read.douban.com/ebook/31433872/?dcs=book-hot&amp;amp;dcm=douban&amp;amp;dct=read-subject åœ¨æ—¶å…‰ä¸­ç››å¼€çš„å¥³å­ æç­±æ‡¿ 2017-3 https://read.douban.com/ebook/31178635/?dcs=book-hot&amp;amp;dcm=douban&amp;amp;dct=read-subject å¦‚ä½•é«˜æ•ˆè®°å¿†ï¼ˆåŸä¹¦ç¬¬2ç‰ˆï¼‰ [ç¾]è‚¯å°¼æ€â€¢å¸Œæ ¼æ¯”ï¼ˆKennethL.Higbeeï¼‰ 2017-3-5 https://read.douban.com/ebook/31358183/?dcs=book-hot&amp;amp;dcm=douban&amp;amp;dct=read-subject æ„¿æ— å²æœˆå¯å›å¤´ å›å¿†ä¸“ç”¨å°é©¬ç”² 2016-9 https://read.douban.com/ebook/31341636/?dcs=book-hot&amp;amp;dcm=douban&amp;amp;dct=read-subject èµ°ç¥çš„è‰ºæœ¯ä¸ç§‘å­¦ [æ–°è¥¿å…°]è¿ˆå…‹å°”Â·C.ç§‘å°”å·´é‡Œæ–¯ 2017-3-1 https://read.douban.com/ebook/27621094/?dcs=book-hot&amp;amp;dcm=douban&amp;amp;dct=read-subject ç¥ç§˜çš„é‡å­ç”Ÿå‘½ [è‹±]å‰å§†â€¢è‰¾å°”ï¼å“ˆåˆ©åˆ©/çº¦ç¿°ä¹”â€¢éº¦å…‹æ³•ç™» 2016-8 https://read.douban.com/ebook/31221966/?dcs=book-hot&amp;amp;dcm=douban&amp;amp;dct=read-subject å¯»æ‰¾æ—¶é—´çš„äºº [çˆ±å°”å…°]å‡¯ç‰¹Â·æ±¤æ™®æ£® 2017-3 https://read.douban.com/ebook/31481323/?dcs=book-hot&amp;amp;dcm=douban&amp;amp;dct=read-subject å±±ä¹‹å››å­£ [æ—¥]é«˜æ‘å…‰å¤ªéƒ 2017-1 https://read.douban.com/ebook/31154855/?dcs=book-hot&amp;amp;dcm=douban&amp;amp;dct=read-subject ä¸œåŒ—æ¸¸è®° [ç¾]è¿ˆå…‹å°”Â·éº¦å°” 2017-1 BeautifulSoup è§£æåº“BeautifulSoupçµæ´»åˆæ–¹ä¾¿çš„ç½‘é¡µè§£æåº“ï¼Œå¤„ç†é«˜æ•ˆï¼Œæ”¯æŒå¤šç§è§£æå™¨ï¼Œåˆ©ç”¨å®ƒä¸ç”¨ç¼–å†™æ­£åˆ™è¡¨è¾¾å¼å³å¯æ–¹ä¾¿çš„å®ç°ç½‘é¡µä¿¡æ¯çš„æå–ã€‚ è§£æåº“ è§£æå™¨ ä½¿ç”¨æ–¹æ³• ä¼˜åŠ¿ åŠ£åŠ¿ Pythonæ ‡å‡†åº“ BeautifulSoup(markup, â€œhtml.parserâ€) Pythonçš„å†…ç½®æ ‡å‡†åº“ã€æ‰§è¡Œé€Ÿåº¦é€‚ä¸­ ã€æ–‡æ¡£å®¹é”™èƒ½åŠ›å¼º Python 2.7.3 or 3.2.2)å‰çš„ç‰ˆæœ¬ä¸­æ–‡å®¹é”™èƒ½åŠ›å·® lxml HTML è§£æå™¨ BeautifulSoup(markup, â€œlxmlâ€) é€Ÿåº¦å¿«ã€æ–‡æ¡£å®¹é”™èƒ½åŠ›å¼º éœ€è¦å®‰è£…Cè¯­è¨€åº“ lxml XML è§£æå™¨ BeautifulSoup(markup, â€œxmlâ€) é€Ÿåº¦å¿«ã€å”¯ä¸€æ”¯æŒXMLçš„è§£æå™¨ éœ€è¦å®‰è£…Cè¯­è¨€åº“ html5lib BeautifulSoup(markup, â€œhtml5libâ€) æœ€å¥½çš„å®¹é”™æ€§ã€ä»¥æµè§ˆå™¨çš„æ–¹å¼è§£ææ–‡æ¡£ã€ç”ŸæˆHTML5æ ¼å¼çš„æ–‡æ¡£ é€Ÿåº¦æ…¢ã€ä¸ä¾èµ–å¤–éƒ¨æ‰©å±• åŸºæœ¬ä½¿ç”¨html = \"\"\"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p class=\"title\" name=\"dromouse\"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;&lt;p class=\"story\"&gt;Once upon a time there were three little sisters; and their names were&lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,&lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and&lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt;;and they lived at the bottom of a well.&lt;/p&gt;&lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.prettify())print(soup.title.string) &lt;html&gt; &lt;head&gt; &lt;title&gt; The Dormouse&#39;s story &lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p class=&quot;title&quot; name=&quot;dromouse&quot;&gt; &lt;b&gt; The Dormouse&#39;s story &lt;/b&gt; &lt;/p&gt; &lt;p class=&quot;story&quot;&gt; Once upon a time there were three little sisters; and their names were &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt; &lt;!-- Elsie --&gt; &lt;/a&gt; , &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt; Lacie &lt;/a&gt; and &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt; Tillie &lt;/a&gt; ; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=&quot;story&quot;&gt; ... &lt;/p&gt; &lt;/body&gt; &lt;/html&gt; The Dormouse&#39;s story æ ‡ç­¾é€‰æ‹©å™¨é€‰æ‹©å…ƒç´ html = \"\"\"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p class=\"title\" name=\"dromouse\"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;&lt;p class=\"story\"&gt;Once upon a time there were three little sisters; and their names were&lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,&lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and&lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt;;and they lived at the bottom of a well.&lt;/p&gt;&lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.title)print(type(soup.title))print(soup.head)print(soup.p) &lt;title&gt;The Dormouse&#39;s story&lt;/title&gt; &lt;class &#39;bs4.element.Tag&#39;&gt; &lt;head&gt;&lt;title&gt;The Dormouse&#39;s story&lt;/title&gt;&lt;/head&gt; &lt;p class=&quot;title&quot; name=&quot;dromouse&quot;&gt;&lt;b&gt;The Dormouse&#39;s story&lt;/b&gt;&lt;/p&gt; è·å–åç§°html = \"\"\"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p class=\"title\" name=\"dromouse\"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;&lt;p class=\"story\"&gt;Once upon a time there were three little sisters; and their names were&lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,&lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and&lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt;;and they lived at the bottom of a well.&lt;/p&gt;&lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.title.name) title è·å–å±æ€§html = \"\"\"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p class=\"title\" name=\"dromouse\"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;&lt;p class=\"story\"&gt;Once upon a time there were three little sisters; and their names were&lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,&lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and&lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt;;and they lived at the bottom of a well.&lt;/p&gt;&lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.p.attrs['name'])print(soup.p['name']) dromouse dromouse è·å–å†…å®¹html = \"\"\"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p clss=\"title\" name=\"dromouse\"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;&lt;p class=\"story\"&gt;Once upon a time there were three little sisters; and their names were&lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,&lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and&lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt;;and they lived at the bottom of a well.&lt;/p&gt;&lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.p.string) The Dormouse&#39;s story åµŒå¥—é€‰æ‹©html = \"\"\"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p class=\"title\" name=\"dromouse\"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;&lt;p class=\"story\"&gt;Once upon a time there were three little sisters; and their names were&lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,&lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and&lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt;;and they lived at the bottom of a well.&lt;/p&gt;&lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.head.title.string) The Dormouse&#39;s story å­èŠ‚ç‚¹å’Œå­å­™èŠ‚ç‚¹html = \"\"\"&lt;html&gt; &lt;head&gt; &lt;title&gt;The Dormouse's story&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p class=\"story\"&gt; Once upon a time there were three little sisters; and their names were &lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and &lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.p.contents) [&#39;\\n Once upon a time there were three little sisters; and their names were\\n &#39;, &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt;, &#39;\\n&#39;, &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt;, &#39; \\n and\\n &#39;, &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;, &#39;\\n and they lived at the bottom of a well.\\n &#39;] html = \"\"\"&lt;html&gt; &lt;head&gt; &lt;title&gt;The Dormouse's story&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p class=\"story\"&gt; Once upon a time there were three little sisters; and their names were &lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and &lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.p.children)for i, child in enumerate(soup.p.children): print(i, child) &lt;list_iterator object at 0x1064f7dd8&gt; 0 Once upon a time there were three little sisters; and their names were 1 &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; 2 3 &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; 4 and 5 &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt; 6 and they lived at the bottom of a well. html = \"\"\"&lt;html&gt; &lt;head&gt; &lt;title&gt;The Dormouse's story&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p class=\"story\"&gt; Once upon a time there were three little sisters; and their names were &lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and &lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.p.descendants)for i, child in enumerate(soup.p.descendants): print(i, child) &lt;generator object descendants at 0x10650e678&gt; 0 Once upon a time there were three little sisters; and their names were 1 &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; 2 3 &lt;span&gt;Elsie&lt;/span&gt; 4 Elsie 5 6 7 &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; 8 Lacie 9 and 10 &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt; 11 Tillie 12 and they lived at the bottom of a well. çˆ¶èŠ‚ç‚¹å’Œç¥–å…ˆèŠ‚ç‚¹html = \"\"\"&lt;html&gt; &lt;head&gt; &lt;title&gt;The Dormouse's story&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p class=\"story\"&gt; Once upon a time there were three little sisters; and their names were &lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and &lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.a.parent) &lt;p class=&quot;story&quot;&gt; Once upon a time there were three little sisters; and their names were &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; html = \"\"\"&lt;html&gt; &lt;head&gt; &lt;title&gt;The Dormouse's story&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p class=\"story\"&gt; Once upon a time there were three little sisters; and their names were &lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and &lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(list(enumerate(soup.a.parents))) [(0, &lt;p class=&quot;story&quot;&gt; Once upon a time there were three little sisters; and their names were &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt;), (1, &lt;body&gt; &lt;p class=&quot;story&quot;&gt; Once upon a time there were three little sisters; and their names were &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=&quot;story&quot;&gt;...&lt;/p&gt; &lt;/body&gt;), (2, &lt;html&gt; &lt;head&gt; &lt;title&gt;The Dormouse&#39;s story&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p class=&quot;story&quot;&gt; Once upon a time there were three little sisters; and their names were &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=&quot;story&quot;&gt;...&lt;/p&gt; &lt;/body&gt;&lt;/html&gt;), (3, &lt;html&gt; &lt;head&gt; &lt;title&gt;The Dormouse&#39;s story&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p class=&quot;story&quot;&gt; Once upon a time there were three little sisters; and their names were &lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=&quot;story&quot;&gt;...&lt;/p&gt; &lt;/body&gt;&lt;/html&gt;)] å…„å¼ŸèŠ‚ç‚¹html = \"\"\"&lt;html&gt; &lt;head&gt; &lt;title&gt;The Dormouse's story&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;p class=\"story\"&gt; Once upon a time there were three little sisters; and their names were &lt;a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\"&gt; &lt;span&gt;Elsie&lt;/span&gt; &lt;/a&gt; &lt;a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\"&gt;Lacie&lt;/a&gt; and &lt;a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\"&gt;Tillie&lt;/a&gt; and they lived at the bottom of a well. &lt;/p&gt; &lt;p class=\"story\"&gt;...&lt;/p&gt;\"\"\"from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(list(enumerate(soup.a.next_siblings)))print(list(enumerate(soup.a.previous_siblings))) [(0, &#39;\\n&#39;), (1, &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt;), (2, &#39; \\n and\\n &#39;), (3, &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;), (4, &#39;\\n and they lived at the bottom of a well.\\n &#39;)] [(0, &#39;\\n Once upon a time there were three little sisters; and their names were\\n &#39;)] æ ‡å‡†é€‰æ‹©å™¨find_all( name , attrs , recursive , text , **kwargs )å¯æ ¹æ®æ ‡ç­¾åã€å±æ€§ã€å†…å®¹æŸ¥æ‰¾æ–‡æ¡£ namehtml='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.find_all('ul'))print(type(soup.find_all('ul')[0])) [&lt;ul class=&quot;list&quot; id=&quot;list-1&quot;&gt; &lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Jay&lt;/li&gt; &lt;/ul&gt;, &lt;ul class=&quot;list list-small&quot; id=&quot;list-2&quot;&gt; &lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt; &lt;/ul&gt;] &lt;class &#39;bs4.element.Tag&#39;&gt; html='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')for ul in soup.find_all('ul'): print(ul.find_all('li')) [&lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Jay&lt;/li&gt;] [&lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt;] attrshtml='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\" name=\"elements\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.find_all(attrs=&#123;'id': 'list-1'&#125;))print(soup.find_all(attrs=&#123;'name': 'elements'&#125;)) [&lt;ul class=&quot;list&quot; id=&quot;list-1&quot; name=&quot;elements&quot;&gt; &lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Jay&lt;/li&gt; &lt;/ul&gt;] [&lt;ul class=&quot;list&quot; id=&quot;list-1&quot; name=&quot;elements&quot;&gt; &lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Jay&lt;/li&gt; &lt;/ul&gt;] html='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.find_all(id='list-1'))print(soup.find_all(class_='element')) [&lt;ul class=&quot;list&quot; id=&quot;list-1&quot;&gt; &lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Jay&lt;/li&gt; &lt;/ul&gt;] [&lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Jay&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt;] texthtml='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.find_all(text='Foo')) [&#39;Foo&#39;, &#39;Foo&#39;] find( name , attrs , recursive , text , **kwargs )findè¿”å›å•ä¸ªå…ƒç´ ï¼Œfind_allè¿”å›æ‰€æœ‰å…ƒç´  html='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.find('ul'))print(type(soup.find('ul')))print(soup.find('page')) &lt;ul class=&quot;list&quot; id=&quot;list-1&quot;&gt; &lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt; &lt;li class=&quot;element&quot;&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;class &#39;bs4.element.Tag&#39;&gt; None find_parents() find_parent()find_parents()è¿”å›æ‰€æœ‰ç¥–å…ˆèŠ‚ç‚¹ï¼Œfind_parent()è¿”å›ç›´æ¥çˆ¶èŠ‚ç‚¹ã€‚ find_next_siblings() find_next_sibling()find_next_siblings()è¿”å›åé¢æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹ï¼Œfind_next_sibling()è¿”å›åé¢ç¬¬ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ã€‚ find_previous_siblings() find_previous_sibling()find_previous_siblings()è¿”å›å‰é¢æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹ï¼Œfind_previous_sibling()è¿”å›å‰é¢ç¬¬ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ã€‚ find_all_next() find_next()find_all_next()è¿”å›èŠ‚ç‚¹åæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹, find_next()è¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ find_all_previous() å’Œ find_previous()find_all_previous()è¿”å›èŠ‚ç‚¹åæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹, find_previous()è¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ CSSé€‰æ‹©å™¨é€šè¿‡select()ç›´æ¥ä¼ å…¥CSSé€‰æ‹©å™¨å³å¯å®Œæˆé€‰æ‹©CSSé€‰æ‹©å™¨è¯­æ³•ï¼š html='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')print(soup.select('.panel .panel-heading'))print(soup.select('ul li'))print(soup.select('#list-2 .element'))print(type(soup.select('ul')[0])) [&lt;div class=&quot;panel-heading&quot;&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt;] [&lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Jay&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt;] [&lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt;] &lt;class &#39;bs4.element.Tag&#39;&gt; html='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')for ul in soup.select('ul'): print(ul.select('li')) [&lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Jay&lt;/li&gt;] [&lt;li class=&quot;element&quot;&gt;Foo&lt;/li&gt;, &lt;li class=&quot;element&quot;&gt;Bar&lt;/li&gt;] è·å–å±æ€§html='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')for ul in soup.select('ul'): print(ul['id']) print(ul.attrs['id']) list-1 list-1 list-2 list-2 è·å–å†…å®¹html='''&lt;div class=\"panel\"&gt; &lt;div class=\"panel-heading\"&gt; &lt;h4&gt;Hello&lt;/h4&gt; &lt;/div&gt; &lt;div class=\"panel-body\"&gt; &lt;ul class=\"list\" id=\"list-1\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;li class=\"element\"&gt;Jay&lt;/li&gt; &lt;/ul&gt; &lt;ul class=\"list list-small\" id=\"list-2\"&gt; &lt;li class=\"element\"&gt;Foo&lt;/li&gt; &lt;li class=\"element\"&gt;Bar&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt;'''from bs4 import BeautifulSoupsoup = BeautifulSoup(html, 'lxml')for li in soup.select('li'): print(li.get_text()) Foo Bar Jay Foo Bar æ€»ç»“ æ¨èä½¿ç”¨lxmlè§£æåº“ï¼Œå¿…è¦æ—¶ä½¿ç”¨html.parser æ ‡ç­¾é€‰æ‹©ç­›é€‰åŠŸèƒ½å¼±ä½†æ˜¯é€Ÿåº¦å¿« å»ºè®®ä½¿ç”¨find()ã€find_all() æŸ¥è¯¢åŒ¹é…å•ä¸ªç»“æœæˆ–è€…å¤šä¸ªç»“æœ å¦‚æœå¯¹CSSé€‰æ‹©å™¨ç†Ÿæ‚‰å»ºè®®ä½¿ç”¨select() è®°ä½å¸¸ç”¨çš„è·å–å±æ€§å’Œæ–‡æœ¬å€¼çš„æ–¹æ³• pyquerypyqueryå¼ºå¤§åˆçµæ´»çš„ç½‘é¡µè§£æåº“ã€‚å¦‚æœä½ è§‰å¾—æ­£åˆ™å†™èµ·æ¥å¤ªéº»çƒ¦ï¼Œå¦‚æœä½ è§‰å¾—BeautifulSoupè¯­æ³•å¤ªéš¾è®°ï¼Œå¦‚æœä½ ç†Ÿæ‚‰jQueryçš„è¯­æ³•ï¼Œé‚£ä¹ˆPyQueryå°±æ˜¯ä½ çš„ç»ä½³é€‰æ‹©ã€‚ä¸»è¦æ˜¯ä½¿ç”¨CSSé€‰æ‹©å™¨è¿›è¡Œè§£æã€‚æ¯”BeautifulSoupä¸­çš„select()æ–¹æ³•æ›´åŠ å¼ºå¤§ã€‚ åˆå§‹åŒ– å­—ç¬¦ä¸²åˆå§‹åŒ–ï¼Œç›´æ¥ä¼ å…¥htmlå³å¯ URLåˆå§‹åŒ–ï¼Œå°†URLä»¥å‚æ•°urlä¼ å…¥å³å¯ã€‚ æ–‡ä»¶åˆå§‹åŒ–ï¼Œå°†demo.htmlä¼ å…¥filenameå³å¯ã€‚ å­—ç¬¦ä¸²åˆå§‹åŒ–html = '''&lt;div&gt; &lt;ul&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)print(doc('li')) &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; URLåˆå§‹åŒ–from pyquery import PyQuery as pqdoc = pq(url='http://www.baidu.com')print(doc('head')) &lt;head&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;/&gt;&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=Edge&quot;/&gt;&lt;meta content=&quot;always&quot; name=&quot;referrer&quot;/&gt;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://s1.bdstatic.com/r/www/cache/bdorz/baidu.min.css&quot;/&gt;&lt;title&gt;Ã§Â™Â¾Ã¥ÂºÂ¦Ã¤Â¸Â€Ã¤Â¸Â‹Ã¯Â¼ÂŒÃ¤Â½ Ã¥Â°Â±Ã§ÂŸÂ¥Ã©ÂÂ“&lt;/title&gt;&lt;/head&gt; æ–‡ä»¶åˆå§‹åŒ–from pyquery import PyQuery as pqdoc = pq(filename='demo.html')print(doc('li')) &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; åŸºæœ¬CSSé€‰æ‹©å™¨ find() è¿”å›ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚ children() è¿”å›æ‰€æœ‰å­èŠ‚ç‚¹ã€‚ parent() è¿”å›æŸä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ parents() è¿”å›æŸä¸ªèŠ‚ç‚¹çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚ siblings() è¿”å›æŸä¸ªèŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹ã€‚ è·å–åˆ°å•ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥ç›´æ¥æ‰“å°æˆ–è€…è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚è·å–åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œéœ€è¦è°ƒç”¨items()æ–¹æ³•ï¼Œå°†ç»“æœå˜æˆç”Ÿæˆå™¨ï¼Œç„¶åå¯¹å…¶éå†ï¼Œå»é™¤æ‰€æœ‰ç»“æœã€‚ attr() è·å–å±æ€§ã€‚ text() è·å–æ–‡æœ¬ã€‚ html = '''&lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)print(doc('#container .list li')) &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; æŸ¥æ‰¾å…ƒç´ å­å…ƒç´ html = '''&lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)items = doc('.list')print(type(items))print(items)lis = items.find('li')print(type(lis))print(lis) &lt;class &#39;pyquery.pyquery.PyQuery&#39;&gt; &lt;ul class=&quot;list&quot;&gt; &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;class &#39;pyquery.pyquery.PyQuery&#39;&gt; &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; lis = items.children()print(type(lis))print(lis) &lt;class &#39;pyquery.pyquery.PyQuery&#39;&gt; &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; lis = items.children('.active')print(lis) &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; çˆ¶å…ƒç´ html = '''&lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)items = doc('.list')container = items.parent()print(type(container))print(container) &lt;class &#39;pyquery.pyquery.PyQuery&#39;&gt; &lt;div id=&quot;container&quot;&gt; &lt;ul class=&quot;list&quot;&gt; &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; html = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)items = doc('.list')parents = items.parents()print(type(parents))print(parents) &lt;class &#39;pyquery.pyquery.PyQuery&#39;&gt; &lt;div class=&quot;wrap&quot;&gt; &lt;div id=&quot;container&quot;&gt; &lt;ul class=&quot;list&quot;&gt; &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;&lt;div id=&quot;container&quot;&gt; &lt;ul class=&quot;list&quot;&gt; &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; parent = items.parents('.wrap')print(parent) &lt;div class=&quot;wrap&quot;&gt; &lt;div id=&quot;container&quot;&gt; &lt;ul class=&quot;list&quot;&gt; &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; å…„å¼Ÿå…ƒç´ html = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)li = doc('.list .item-0.active')print(li.siblings()) &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; html = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)li = doc('.list .item-0.active')print(li.siblings('.active')) &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; éå†å•ä¸ªå…ƒç´ html = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)li = doc('.item-0.active')print(li) &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; html = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)lis = doc('li').items()print(type(lis))for li in lis: print(li) &lt;class &#39;generator&#39;&gt; &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; è·å–ä¿¡æ¯è·å–å±æ€§html = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)a = doc('.item-0.active a')print(a)print(a.attr('href'))print(a.attr.href) &lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt; link3.html link3.html è·å–æ–‡æœ¬html = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)a = doc('.item-0.active a')print(a)print(a.text()) &lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt; third item è·å–HTMLhtml = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)li = doc('.item-0.active')print(li)print(li.html()) &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt; DOMæ“ä½œaddClassã€removeClasshtml = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)li = doc('.item-0.active')print(li)li.removeClass('active')print(li)li.addClass('active')print(li) &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; attrã€csshtml = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)li = doc('.item-0.active')print(li)li.attr('name', 'link')print(li)li.css('font-size', '14px')print(li) &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot; name=&quot;link&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0 active&quot; name=&quot;link&quot; style=&quot;font-size: 14px&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;bold&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; removehtml = '''&lt;div class=\"wrap\"&gt; Hello, World &lt;p&gt;This is a paragraph.&lt;/p&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)wrap = doc('.wrap')print(wrap.text())wrap.find('p').remove()print(wrap.text()) Hello, World This is a paragraph. Hello, World å…¶ä»–DOMæ–¹æ³•http://pyquery.readthedocs.io/en/latest/api.html ä¼ªç±»é€‰æ‹©å™¨html = '''&lt;div class=\"wrap\"&gt; &lt;div id=\"container\"&gt; &lt;ul class=\"list\"&gt; &lt;li class=\"item-0\"&gt;first item&lt;/li&gt; &lt;li class=\"item-1\"&gt;&lt;a href=\"link2.html\"&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0 active\"&gt;&lt;a href=\"link3.html\"&gt;&lt;span class=\"bold\"&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-1 active\"&gt;&lt;a href=\"link4.html\"&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=\"item-0\"&gt;&lt;a href=\"link5.html\"&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt;'''from pyquery import PyQuery as pqdoc = pq(html)li = doc('li:first-child')print(li)li = doc('li:last-child')print(li)li = doc('li:nth-child(2)')print(li)li = doc('li:gt(2)')print(li)li = doc('li:nth-child(2n)')print(li)li = doc('li:contains(second)')print(li) &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt; æ›´å¤šCSSé€‰æ‹©å™¨å¯ä»¥æŸ¥çœ‹http://www.w3school.com.cn/css/index.asp å®˜æ–¹æ–‡æ¡£http://pyquery.readthedocs.io/ æ•°æ®åº“Pythonæ“ä½œä¸‰å¤§ä¸»æµæ•°æ®åº“æ•°æ®åº“åˆ†ç±» å…³ç³»å‹æ•°æ®åº“e.g: MariaDB, SQLite, SQLServer, MySQL, PostgreSQL, ORACLE éå…³ç³»å‹æ•°æ®åº“e.g: mongoDB, HBASE, redis, CouchDB, Cassandre, Neo4jåˆ†ç±»ï¼š æ–‡æ¡£å‹ key-valueå‹ åˆ—å¼æ•°æ®åº“ å›¾å½¢æ•°æ®åº“ MySQL æ•°æ®åº“","categories":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://lucas0625.github.io/blog/categories/çˆ¬è™«/"}],"tags":[{"name":"åŸºç¡€çŸ¥è¯†","slug":"åŸºç¡€çŸ¥è¯†","permalink":"http://lucas0625.github.io/blog/tags/åŸºç¡€çŸ¥è¯†/"}]},{"title":"å¸¸è§æ’åºç®—æ³•","slug":"å¸¸è§æ’åºç®—æ³•","date":"2018-12-10T16:00:00.000Z","updated":"2019-06-04T06:02:34.374Z","comments":true,"path":"2018/12/11/å¸¸è§æ’åºç®—æ³•/","link":"","permalink":"http://lucas0625.github.io/blog/2018/12/11/å¸¸è§æ’åºç®—æ³•/","excerpt":"æœ¬æ–‡ä»‹ç»å¸¸è§çš„æ’åºç®—æ³•ã€‚åŒ…æ‹¬å†’æ³¡æ’åºï¼Œæ’å…¥æ’åºï¼Œé€‰æ‹©æ’åºã€‚","text":"æœ¬æ–‡ä»‹ç»å¸¸è§çš„æ’åºç®—æ³•ã€‚åŒ…æ‹¬å†’æ³¡æ’åºï¼Œæ’å…¥æ’åºï¼Œé€‰æ‹©æ’åºã€‚ å†’æ³¡æ’åºfrom typing import List# å†’æ³¡æ’åº ç¨³å®šæ’åºç®—æ³•def bubble_sort(a: List[int]): if len(a) &lt;= 1: return for i in range(len(a)): made_swap = False for j in range(len(a) - i - 1): if a[j] &gt; a[j + 1]: a[j], a[j + 1] = a[j + 1], a[j] made_swap = True if not made_swap: break æ³¨ï¼š ç©ºé—´å¤æ‚åº¦O(1)ï¼ŒåŸåœ°æ’åºç®—æ³•ã€‚ ç¨³å®šæ’åºç®—æ³•ã€‚ æœ€ä¼˜æ—¶é—´å¤æ‚åº¦O(n), æœ€åæ—¶é—´å¤æ‚åº¦O(n^2), å¹³å‡æ—¶é—´å¤æ‚åº¦O(n^2) æ’å…¥æ’åºfrom typing import List# æ’å…¥æ’åº ç¨³å®šæ’åºç®—æ³•def insertion_sort(a: List[int]): if len(a) &lt;= 1: return for i in range(1, len(a)): value = a[i] j = i - 1 while j &gt;= 0 and a[j] &gt; value: a[j + 1] = a[j] j -= 1 a[j + 1] = value æ³¨ï¼š ç©ºé—´å¤æ‚åº¦O(1)ï¼ŒåŸåœ°æ’åºç®—æ³•ã€‚ ç¨³å®šæ’åºç®—æ³•ã€‚ æœ€ä¼˜æ—¶é—´å¤æ‚åº¦O(n), æœ€åæ—¶é—´å¤æ‚åº¦O(n^2), å¹³å‡æ—¶é—´å¤æ‚åº¦O(n^2) é€‰æ‹©æ’åºfrom typing import List# é€‰æ‹©æ’åº éç¨³å®šæ’åºç®—æ³•def selection_sort(a: List[int]): if len(a) &lt;= 1: return for i in range(len(a)): min_index = i min_val = a[i] for j in range(i, len(a)): if a[j] &lt; min_val: min_val = a[j] min_index = j a[i], a[min_index] = a[min_index], a[i] æ³¨ï¼š ç©ºé—´å¤æ‚åº¦O(1)ï¼ŒåŸåœ°æ’åºç®—æ³•ã€‚ éç¨³å®šæ’åºç®—æ³•ã€‚ æœ€ä¼˜æ—¶é—´å¤æ‚åº¦O(n^2), æœ€åæ—¶é—´å¤æ‚åº¦O(n^2), å¹³å‡æ—¶é—´å¤æ‚åº¦O(n^2) å½’å¹¶æ’åºfrom typing import List# å½’å¹¶æ’åº ç¨³å®šæ’åºç®—æ³•def merge_sort(a: List[int]): _merge_sort_between(a, 0, len(a) - 1)def _merge_sort_between(a: List[int], low: int, high: int): # The indices are inclusive for both low and high. if low &lt; high: mid = low + (high - low) // 2 _merge_sort_between(a, low, mid) _merge_sort_between(a, mid + 1, high) _merge(a, low, mid, high)def _merge(a: List[int], low: int, mid: int, high: int): # a[low:mid], a[mid+1, high] are sorted. i, j = low, mid + 1 tmp = [] while i &lt;= mid and j &lt;= high: if a[i] &lt;= a[j]: tmp.append(a[i]) i += 1 else: tmp.append(a[j]) j += 1 start = i if i &lt;= mid else j end = mid if i &lt;= mid else high tmp.extend(a[start:end + 1]) a[low:high + 1] = tmp æ³¨ï¼š ç©ºé—´å¤æ‚åº¦O(N), éåŸåœ°æ’åºç®—æ³•ã€‚ ç¨³å®šæ’åºç®—æ³•ã€‚ æœ€ä¼˜æ—¶é—´å¤æ‚åº¦O(NlogN), æœ€åæ—¶é—´å¤æ‚åº¦O(NlogN), å¹³å‡æ—¶é—´å¤æ‚åº¦O(NlogN)","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/categories/ç®—æ³•/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]},{"title":"Python ç¼–ç è§„èŒƒ","slug":"Python ç¼–ç è§„èŒƒ","date":"2018-10-08T16:00:00.000Z","updated":"2018-10-09T13:42:43.892Z","comments":true,"path":"2018/10/09/Python ç¼–ç è§„èŒƒ/","link":"","permalink":"http://lucas0625.github.io/blog/2018/10/09/Python ç¼–ç è§„èŒƒ/","excerpt":"éµå¾ªè‰¯å¥½çš„ç¼–ç é£æ ¼ï¼Œå¯ä»¥æœ‰æ•ˆçš„æé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œé™ä½å‡ºé”™å‡ ç‡å’Œç»´æŠ¤éš¾åº¦ã€‚åœ¨å›¢é˜Ÿå¼€å‘ä¸­ï¼Œä½¿ç”¨ï¼ˆå°½é‡ï¼‰ç»Ÿä¸€çš„ç¼–ç é£æ ¼ï¼Œè¿˜å¯ä»¥é™ä½æ²Ÿé€šæˆæœ¬ã€‚","text":"éµå¾ªè‰¯å¥½çš„ç¼–ç é£æ ¼ï¼Œå¯ä»¥æœ‰æ•ˆçš„æé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œé™ä½å‡ºé”™å‡ ç‡å’Œç»´æŠ¤éš¾åº¦ã€‚åœ¨å›¢é˜Ÿå¼€å‘ä¸­ï¼Œä½¿ç”¨ï¼ˆå°½é‡ï¼‰ç»Ÿä¸€çš„ç¼–ç é£æ ¼ï¼Œè¿˜å¯ä»¥é™ä½æ²Ÿé€šæˆæœ¬ã€‚ ç¼©ç´§ ä¸è¦ä½¿ç”¨ tab ç¼©è¿› ä½¿ç”¨ä»»ä½•ç¼–è¾‘å™¨å†™ Pythonï¼Œè¯·æŠŠä¸€ä¸ª tab å±•å¼€ä¸º 4 ä¸ªç©ºæ ¼ ç»å¯¹ä¸è¦æ··ç”¨ tab å’Œç©ºæ ¼ï¼Œå¦åˆ™å®¹æ˜“å‡ºç° IndentationError ç©ºæ ¼ åœ¨ list, dict, tuple, set, å‚æ•°åˆ—è¡¨çš„ , åé¢åŠ ä¸€ä¸ªç©ºæ ¼ åœ¨ dict çš„ : åé¢åŠ ä¸€ä¸ªç©ºæ ¼ åœ¨æ³¨é‡Šç¬¦å· # åé¢åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œä½†æ˜¯ #!/usr/bin/python çš„ # åä¸èƒ½æœ‰ç©ºæ ¼ æ“ä½œç¬¦ä¸¤ç«¯åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œå¦‚ +, -, *, /, |, &amp;, = æ¥ä¸Šä¸€æ¡ï¼Œåœ¨å‚æ•°åˆ—è¡¨é‡Œçš„ =ä¸¤ç«¯ä¸éœ€è¦ç©ºæ ¼ æ‹¬å·((), {}, [])å†…çš„ä¸¤ç«¯ä¸éœ€è¦ç©ºæ ¼ ç©ºè¡Œ function å’Œ class é¡¶ä¸Šä¸¤ä¸ªç©ºè¡Œ class çš„ method ä¹‹é—´ä¸€ä¸ªç©ºè¡Œ å‡½æ•°å†…é€»è¾‘æ— å…³çš„æ®µè½ä¹‹é—´ç©ºä¸€è¡Œï¼Œä¸è¦è¿‡åº¦ä½¿ç”¨ç©ºè¡Œ ä¸è¦æŠŠå¤šä¸ªè¯­å¥å†™åœ¨ä¸€è¡Œï¼Œç„¶åç”¨ ; éš”å¼€ if/for/while è¯­å¥ä¸­ï¼Œå³ä½¿æ‰§è¡Œè¯­å¥åªæœ‰ä¸€å¥ï¼Œä¹Ÿè¦å¦èµ·ä¸€è¡Œ æ¢è¡Œ æ¯ä¸€è¡Œä»£ç æ§åˆ¶åœ¨80å­—ç¬¦ä»¥å†… ä½¿ç”¨\\æˆ–()æ§åˆ¶æ¢è¡Œï¼Œä¸¾ä¾‹ï¼š def foo(first, second, third, fourth, fifth, sixth, and_some_other_very_long_param): user = User.objects.filter_by(first=first, second=second, third=third) \\ .skip(100).limit(100) \\ .all()text = ('Long strings can be made up ' 'of several shorter strings.') å‘½å ä½¿ç”¨æœ‰æ„ä¹‰çš„ï¼Œè‹±æ–‡å•è¯æˆ–è¯ç»„ï¼Œç»å¯¹ä¸è¦ä½¿ç”¨æ±‰è¯­æ‹¼éŸ³ package/module åä¸­ä¸è¦å‡ºç° - å„ç§ç±»å‹çš„å‘½åè§„èŒƒï¼š import æ‰€æœ‰ import å°½é‡æ”¾åœ¨æ–‡ä»¶å¼€å¤´ï¼Œåœ¨ docstring ä¸‹é¢ï¼Œå…¶ä»–å˜é‡å®šä¹‰çš„ä¸Šé¢ ä¸è¦ä½¿ç”¨ from foo imort * import éœ€è¦åˆ†ç»„ï¼Œæ¯ç»„ä¹‹é—´ä¸€ä¸ªç©ºè¡Œï¼Œæ¯ä¸ªåˆ†ç»„å†…çš„é¡ºåºå°½é‡é‡‡ç”¨å­—å…¸åºï¼Œåˆ†ç»„é¡ºåºæ˜¯ï¼š 1.æ ‡å‡†åº“ 2.ç¬¬ä¸‰æ–¹åº“ 3.æœ¬é¡¹ç›®çš„ package å’Œ module ä¸è¦ä½¿ç”¨éšå¼çš„ç›¸å¯¹å¯¼å…¥ï¼ˆimplicit relative importsï¼‰ï¼Œå¯æ˜¯ä½¿ç”¨æ˜¾ç¤ºçš„ç›¸å¯¹å¯¼å…¥ï¼ˆexplicit relative importsï¼‰ï¼Œå¦‚ from ..utils import validatorï¼Œæœ€å¥½ä½¿ç”¨å…¨è·¯å¾„å¯¼å…¥ï¼ˆabsolute importsï¼‰ å¯¹äºä¸åŒçš„ packageï¼Œä¸€ä¸ª import å•ç‹¬ä¸€è¡Œï¼ŒåŒä¸€ä¸ª package/module ä¸‹çš„å†…å®¹å¯ä»¥å†™ä¸€èµ· ä¸ºäº†é¿å…å¯èƒ½å‡ºç°çš„å‘½åå†²çªï¼Œå¯ä»¥ä½¿ç”¨ as æˆ–å¯¼å…¥ä¸Šä¸€çº§å‘½åç©ºé—´ ä¸è¦å‡ºç°å¾ªç¯å¯¼å…¥(cyclic import) æ³¨é‡Š æ–‡æ¡£å­—ç¬¦ä¸² docstring, æ˜¯ package, module, class, method, function çº§åˆ«çš„æ³¨é‡Šï¼Œå¯ä»¥é€šè¿‡ __doc__ æˆå‘˜è®¿é—®åˆ°ï¼Œæ³¨é‡Šå†…å®¹åœ¨ä¸€å¯¹ &quot;&quot;&quot; ç¬¦å·ä¹‹é—´ function, method çš„æ–‡æ¡£å­—ç¬¦ä¸²åº”å½“æè¿°å…¶åŠŸèƒ½ã€è¾“å…¥å‚æ•°ã€è¿”å›å€¼ï¼Œå¦‚æœæœ‰å¤æ‚çš„ç®—æ³•å’Œå®ç°ï¼Œä¹Ÿéœ€è¦å†™æ¸…æ¥š ä¸è¦å†™é”™è¯¯çš„æ³¨é‡Šï¼Œä¸è¦æ— è°“çš„æ³¨é‡Š ä¼˜å…ˆä½¿ç”¨è‹±æ–‡å†™æ³¨é‡Šï¼Œè‹±æ–‡ä¸å¥½å…¨éƒ¨å†™ä¸­æ–‡ï¼Œå¦åˆ™æ›´åŠ çœ‹ä¸æ‡‚ å¼‚å¸¸ ä¸è¦è½»æ˜“ä½¿ç”¨ try/except except åé¢éœ€è¦æŒ‡å®šæ•æ‰çš„å¼‚å¸¸ï¼Œè£¸éœ²çš„ except ä¼šæ•æ‰æ‰€æœ‰å¼‚å¸¸ï¼Œæ„å‘³ç€ä¼šéšè—æ½œåœ¨çš„é—®é¢˜ å¯ä»¥æœ‰å¤šä¸ª except è¯­å¥ï¼Œæ•æ‰å¤šç§å¼‚å¸¸ï¼Œåˆ†åˆ«åšå¼‚å¸¸å¤„ç† ä½¿ç”¨ finally å­å¥æ¥å¤„ç†ä¸€äº›æ”¶å°¾æ“ä½œ try/except é‡Œçš„å†…å®¹ä¸è¦å¤ªå¤šï¼Œåªåœ¨å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„åœ°æ–¹ä½¿ç”¨ ä» Exception è€Œä¸æ˜¯ BaseException ç»§æ‰¿è‡ªå®šä¹‰çš„å¼‚å¸¸ç±» Class(ç±») æ˜¾ç¤ºçš„å†™æ˜çˆ¶ç±»ï¼Œå¦‚æœä¸æ˜¯ç»§æ‰¿è‡ªåˆ«çš„ç±»ï¼Œå°±ç»§æ‰¿è‡ª object ç±» ä½¿ç”¨ super è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³• æ”¯æŒå¤šç»§æ‰¿ï¼Œå³åŒæ—¶æœ‰å¤šä¸ªçˆ¶ç±»ï¼Œå»ºè®®ä½¿ç”¨ Mixin ç¼–ç å»ºè®®å­—ç¬¦ä¸² ä½¿ç”¨å­—ç¬¦ä¸²çš„ join æ–¹æ³•æ‹¼æ¥å­—ç¬¦ä¸² ä½¿ç”¨å­—ç¬¦ä¸²ç±»å‹çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ string æ¨¡å—çš„æ–¹æ³• ä½¿ç”¨ startswith å’Œ endswith æ–¹æ³•æ¯”è¾ƒå‰ç¼€å’Œåç¼€ ä½¿ç”¨ format æ–¹æ³•æ ¼å¼åŒ–å­—ç¬¦ä¸² æ¯”è¾ƒ ç©ºçš„ list, str, tuple, set, dict å’Œ 0, 0.0, None éƒ½æ˜¯ False ä½¿ç”¨ if some_list è€Œä¸æ˜¯ if len(some_list) åˆ¤æ–­æŸä¸ª list æ˜¯å¦ä¸ºç©ºï¼Œå…¶ä»–ç±»å‹åŒç† ä½¿ç”¨ is å’Œ is not ä¸å•ä¾‹ï¼ˆå¦‚ Noneï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œè€Œä¸æ˜¯ç”¨ == å’Œ != ä½¿ç”¨ if a is not None è€Œä¸æ˜¯ if not a is None ç”¨ isinstance è€Œä¸æ˜¯ type åˆ¤æ–­ç±»å‹ ä¸è¦ç”¨ == å’Œ != ä¸ True å’Œ False æ¯”è¾ƒï¼ˆé™¤éæœ‰ç‰¹æ®Šæƒ…å†µï¼Œå¦‚åœ¨ sqlalchemy ä¸­å¯èƒ½ç”¨åˆ°ï¼‰ ä½¿ç”¨ in æ“ä½œ: ç”¨ key in dict è€Œä¸æ˜¯ dict.has_key() ç”¨ set åŠ é€Ÿ â€œå­˜åœ¨æ€§â€ æ£€æŸ¥ï¼Œlist çš„æŸ¥æ‰¾æ˜¯çº¿æ€§çš„ï¼Œå¤æ‚åº¦ O(n)ï¼Œset åº•å±‚æ˜¯ hash table, å¤æ‚åº¦ O(1)ï¼Œä½†ç”¨ setéœ€è¦æ¯” list æ›´å¤šå†…å­˜ç©ºé—´ å…¶ä»– ä½¿ç”¨åˆ—è¡¨è¡¨è¾¾å¼ï¼ˆlist comprehensionï¼‰ï¼Œå­—å…¸è¡¨è¾¾å¼(dict comprehension, Python 2.7+) å’Œç”Ÿæˆå™¨(generator) dict çš„ get æ–¹æ³•å¯ä»¥æŒ‡å®šé»˜è®¤å€¼ï¼Œä½†æœ‰äº›æ—¶å€™åº”è¯¥ç”¨ [] æ“ä½œï¼Œä½¿å¾—å¯ä»¥æŠ›å‡º KeyError ä½¿ç”¨ for item in list è¿­ä»£ list, for index, item in enumerate(list) è¿­ä»£ list å¹¶è·å–ä¸‹æ ‡ ä½¿ç”¨å†…å»ºå‡½æ•° sorted å’Œ list.sort è¿›è¡Œæ’åº é€‚é‡ä½¿ç”¨map, reduce, filter å’Œ lambdaï¼Œä½¿ç”¨å†…å»ºçš„ all, any å¤„ç†å¤šä¸ªæ¡ä»¶çš„åˆ¤æ–­ ä½¿ç”¨ defaultdict (Python 2.5+), Counter(Python 2.7+) ç­‰ â€œå†·é—¨â€ ä½†å¥½ç”¨çš„æ ‡å‡†åº“ç®—æ³•å’Œæ•°æ®ç»“æ„ ä½¿ç”¨è£…é¥°å™¨(decorator) ä½¿ç”¨ with è¯­å¥å¤„ç†ä¸Šä¸‹æ–‡ æœ‰äº›æ—¶å€™ä¸è¦å¯¹ç±»å‹åšå¤ªè¿‡ä¸¥æ ¼çš„é™åˆ¶ï¼Œåˆ©ç”¨ Python çš„é¸­å­ç±»å‹ï¼ˆDuck Typeï¼‰ç‰¹æ€§ ä½¿ç”¨ logging è®°å½•æ—¥å¿—ï¼Œé…ç½®å¥½æ ¼å¼å’Œçº§åˆ« äº†è§£ Python çš„ Magic Methodï¼šA Guide to Pythonâ€™s Magic Methods, Python é­”æœ¯æ–¹æ³•æŒ‡å— é˜…è¯»ä¼˜ç§€çš„å¼€æºä»£ç ï¼Œå¦‚ Flask æ¡†æ¶, Requests for Humans ä¸è¦é‡å¤é€ è½®å­ï¼ŒæŸ¥çœ‹æ ‡å‡†åº“ã€PyPiã€Githubã€Google ç­‰ä½¿ç”¨ç°æœ‰çš„ä¼˜ç§€çš„è§£å†³æ–¹æ¡ˆ","categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://lucas0625.github.io/blog/categories/ç¼–ç¨‹/"}],"tags":[{"name":"ç»éªŒ","slug":"ç»éªŒ","permalink":"http://lucas0625.github.io/blog/tags/ç»éªŒ/"}]},{"title":"æ·±å…¥ç†è§£ Python package","slug":"æ·±å…¥ç†è§£Python package","date":"2018-10-07T16:00:00.000Z","updated":"2018-10-09T13:42:17.241Z","comments":true,"path":"2018/10/08/æ·±å…¥ç†è§£Python package/","link":"","permalink":"http://lucas0625.github.io/blog/2018/10/08/æ·±å…¥ç†è§£Python package/","excerpt":"Python æ˜¯é€šè¿‡ module ç»„ç»‡ä»£ç çš„ï¼Œmodule å³ä¸€ä¸ª py æ–‡ä»¶ï¼Œmodule åˆæ˜¯é€šè¿‡ package æ¥ç»„ç»‡çš„ï¼Œpackage æ˜¯ä¸€ä¸ªåŒ…å« __init__.py çš„æ–‡ä»¶å¤¹ï¼Œä»£ç ï¼Œmoduleï¼Œpackage å®ƒä»¬ä¸‰è€…çš„å…³ç³»å°±æ˜¯ï¼šmodule åŒ…å«ä»£ç ï¼Œpackage è‡³å°‘åŒ…å«ä¸€ä¸ªä¸º __init__.py çš„ moduleã€‚ packageâ”œâ”€â”€ __init__.pyâ”œâ”€â”€ submodule.pyâ””â”€â”€ subpackage â””â”€â”€ __init__.py","text":"Python æ˜¯é€šè¿‡ module ç»„ç»‡ä»£ç çš„ï¼Œmodule å³ä¸€ä¸ª py æ–‡ä»¶ï¼Œmodule åˆæ˜¯é€šè¿‡ package æ¥ç»„ç»‡çš„ï¼Œpackage æ˜¯ä¸€ä¸ªåŒ…å« __init__.py çš„æ–‡ä»¶å¤¹ï¼Œä»£ç ï¼Œmoduleï¼Œpackage å®ƒä»¬ä¸‰è€…çš„å…³ç³»å°±æ˜¯ï¼šmodule åŒ…å«ä»£ç ï¼Œpackage è‡³å°‘åŒ…å«ä¸€ä¸ªä¸º __init__.py çš„ moduleã€‚ packageâ”œâ”€â”€ __init__.pyâ”œâ”€â”€ submodule.pyâ””â”€â”€ subpackage â””â”€â”€ __init__.py ç©ºçš„ __init__.pyä¸åŒ…å«ä»»ä½•ä»£ç çš„ __init__.py åªç”¨æ¥æ ‡è¯†ä¸€ä¸ªæ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ª packageï¼Œè€Œ package æ˜¯å¯ä»¥è¢«å¯¼å‡ºçš„ã€‚ from package import item æ­¤å¤„çš„ item å¯ä»¥æ˜¯ package ä¸­åŒ…å«çš„ submodule æˆ– subpackageã€‚ from package import submodulefrom package import subpackage ä¸ä¸ºç©º __init__.pyå¦‚æœ __init__.py ä¸ä¸ºç©ºï¼Œå…¶ä¸­åŒ…å«çš„ä»»ä½•å˜é‡ï¼ŒåŒ…æ‹¬ functionã€classã€variable ä»¥åŠ ä»»ä½•è¢«å¯¼å…¥çš„ module éƒ½å¯ä»¥é€šè¿‡ package å¯¼å‡ºã€‚ from package import item æ­¤å¤„çš„ item å¯ä»¥æ˜¯ __init__.pyä¸­çš„ä»»ä½•å˜é‡ packageçš„åˆå§‹åŒ–å·¥ä½œä¸€ä¸ª package è¢«å¯¼å…¥ï¼Œä¸ç®¡åœ¨ä»€ä¹ˆæ—¶å€™ __init__.py ä¸­çš„ä»£ç åªæ‰§è¡Œä¸€æ¬¡ã€‚ &gt;&gt;&gt; import packagehello world&gt;&gt;&gt; import package&gt;&gt;&gt; import package&gt;&gt;&gt; ç”±äº package è¢«å¯¼å…¥æ—¶__init__.py ä¸­çš„å¯æ‰§è¡Œä»£ç ä¼šè¢«æ‰§è¡Œï¼Œæ‰€ä»¥å°å¿ƒåœ¨ package ä¸­æ”¾ç½®ä½ çš„ä»£ç ï¼Œå°½å¯èƒ½æ¶ˆé™¤å®ƒä»¬äº§ç”Ÿçš„å‰¯ä½œç”¨ï¼Œæ¯”å¦‚æŠŠä»£ç å°½å¯èƒ½çš„è¿›è¡Œå°è£…æˆå‡½æ•°æˆ–ç±»ã€‚ ä»packageä¸­å€’å…¥å˜é‡çš„é¡ºåºfrom package import item import è¯­å¥é¦–å…ˆæ£€æŸ¥ item æ˜¯å¦æ˜¯ __init__.py ä¸­å®šä¹‰çš„å˜é‡ï¼Œç„¶åæ£€æŸ¥å…¶æ˜¯ä¸æ˜¯ä¸€ä¸ª subpackageï¼Œå¦‚æœä¸æ˜¯å†å»æ£€æŸ¥å…¶æ˜¯ä¸æ˜¯ä¸€ä¸ª moduleï¼Œéƒ½ä¸æ˜¯å°†æŠ›å‡º ImportErrorã€‚ åœ¨ import item.subitem.subsubitem è¯­å¥æ—¶ï¼Œé™¤äº†æœ€åä¸€ä¸ª subsubitem ä¹‹å¤–å…¶ä»– item éƒ½å¿…é¡»æ˜¯ packageï¼Œè€Œæœ€åä¸€ä¸ª subsubitem å¿…é¡»æ˜¯ä¸€ä¸ª package æˆ–è€… moduleï¼Œä¸èƒ½æ˜¯ä»–å‰ä¸€ä¸ª item å®šä¹‰çš„ functionã€classã€variableã€‚ ä½¿ç”¨*å¯¼å…¥åœ¨ from package import *è¯­å¥ä¸­ï¼Œå¦‚æœ __init__.py ä¸­å®šä¹‰äº† __all__ å˜é‡ï¼Œä¸€ä¸ª listï¼Œä»…ä»…åªæœ‰è¿™ä¸ª list ä¸­å®šä¹‰çš„ submodule æˆ–è€…å˜é‡å°†ä¼šè¢«å¯¼å‡ºã€‚ å¦‚æœ__init__.pyä¸­æ²¡æœ‰__all__å˜é‡ï¼Œå¯¼å‡ºå°†æŒ‰ç…§ä¸€ä¸‹è§„åˆ™æ‰§è¡Œï¼š æ­¤ package è¢«å¯¼å…¥ï¼Œå¹¶ä¸”æ‰§è¡Œ __init__.py ä¸­å¯è¢«æ‰§è¡Œçš„ä»£ç  __init__.py ä¸­å®šä¹‰çš„ variable è¢«å¯¼å…¥ __init__.py ä¸­è¢«æ˜¾å¼å¯¼å…¥çš„ module è¢«å¯¼å…¥","categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://lucas0625.github.io/blog/categories/ç¼–ç¨‹/"}],"tags":[{"name":"åŸºç¡€","slug":"åŸºç¡€","permalink":"http://lucas0625.github.io/blog/tags/åŸºç¡€/"}]},{"title":"python å¸¸ç”¨æŠ€å·§","slug":"json","date":"2018-09-16T08:30:18.409Z","updated":"2019-08-08T03:06:38.504Z","comments":true,"path":"2018/09/16/json/","link":"","permalink":"http://lucas0625.github.io/blog/2018/09/16/json/","excerpt":"è®°å½•è‡ªå·±å¸¸ç”¨çš„ä¸€äº›ä»£ç æŠ€å·§","text":"è®°å½•è‡ªå·±å¸¸ç”¨çš„ä¸€äº›ä»£ç æŠ€å·§ æ ¼å¼åŒ–æ˜¾ç¤ºå­—ç¬¦ä¸²import jsonjson.dumps(dict, indent=4) and, or çš„ç‰¹æ®Šç”¨æ³• a and b and c è¿”å›ç¬¬ä¸€ä¸ªFalse å¯¹è±¡, åä¹‹è¿”å› c a or b or c è¿”å›ç¬¬ä¸€ä¸ªTrue å¯¹è±¡, åä¹‹è¿”å› c åˆ é™¤ç‰¹æ®Šå­—ç¬¦str.replace(u'\\u200b', '') å°†åˆ—è¡¨æ¯ä¸ªå…ƒç´ ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°a = [1, 2, 3, 4]# å°†åˆ—è¡¨aä½œä¸ºæ•´ä½“ä¼ å…¥å‡½æ•°funcdef func(a): ...# å°†åˆ—è¡¨æ¯ä¸€ä¸ªå…ƒç´ ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°funcdef func(*a): ... ä»¥å­—ç¬¦åˆ†å‰²å­—ç¬¦ä¸²ï¼Œé•¿åº¦ä¸è¶…è¿‡nçš„æ•°å­—ä½œä¸ºä¸€ä¸ªå­—ç¬¦import redef splice_string(string: str, nums: int = 3) -&gt; str: \"\"\" æŒ‰å­—ç¬¦åˆ†å‰²å­—ç¬¦ä¸²ï¼Œä¸è¶…è¿‡ nums ä¸ªçš„æ•°å­—ä¸åˆ‡åˆ† :param string: :return: \"\"\" pattern = re.compile('((?&lt;!\\d)(\\d&#123;1,%d&#125;)(?!(\\d+))|(\\S))' % (nums)) result = re.sub(pattern, r'\\1\\t', string) return ' '.join(result.strip().split())res = splice_string('äººä¸€å¤©è¦ç¡20-24å°æ—¶ï¼Œä¸€å¤©24å°æ—¶æœ‰1å°æ—¶å¯ä»¥å¨±ä¹ï¼Œä¸€å¹´365å¤©è¿™æ ·åšï¼Œ30000å—é’±å°±åˆ°æ‰‹äº†')print(res) &#39;äºº ä¸€ å¤© è¦ ç¡ 20 - 24 å° æ—¶ ï¼Œ ä¸€ å¤© 24 å° æ—¶ æœ‰ 1 å° æ—¶ å¯ ä»¥ å¨± ä¹ ï¼Œ ä¸€ å¹´ 365 å¤© è¿™ æ · åš ï¼Œ 3 0 0 0 0 å— é’± å°± åˆ° æ‰‹ äº†&#39; åˆ¤æ–­å¥‡å¶# æ–¹æ³•ä¸€if nums % 2 == 1: # å¥‡æ•°else: # å¶æ•°# æ–¹æ³•äºŒif nums &amp; 1 == 1: # å¥‡æ•°else: # å¶æ•° ä¸ä½¿ç”¨ç¬¬ä¸‰ä¸ªå˜é‡äº¤æ¢ä¸¤ä¸ªæ•°# æ–¹æ³•ä¸€# n ^ n = 0, n ^ 0 = nx = x ^ yy = x ^ yx = x ^ y# æ–¹æ³•äºŒ# é‡‡ç”¨å››åˆ™è¿ç®—a = a + bb = a - ba = a - b å››èˆäº”å…¥æŠ€å·§a = int(b + 0.5) è¾“å‡ºåŒ–å¤šç»´åˆ—è¡¨# åˆå§‹åŒ–é•¿åº¦ä¸º n çš„ä¸€ç»´åˆ—è¡¨nums = [0] * n# åˆå§‹åŒ– n * m çš„äºŒç»´åˆ—è¡¨nums = [[0 for _in range(m)] for _ in range(n)]# åˆå§‹åŒ– n * m * z çš„ä¸‰ç»´åˆ—è¡¨nums = [[[0 for _in range(z)] for _ in range(m)] for _ in range(n)] ç¬¬ä¸‰æ–¹åŒ…çš„ä½¿ç”¨bisect-å¿«é€Ÿç»™åˆ—è¡¨æ’å…¥å…ƒç´ ï¼Œä¸æ”¹å˜åŸæ¥çš„é¡ºåºexampleï¼š # åŸºäºäºŒåˆ†æ’å…¥æ•°æ®import bisect # æŸ¥çœ‹ bisect ç»“æ„dir(bisect) [&#39;__builtins__&#39;, &#39;__cached__&#39;, &#39;__doc__&#39;, &#39;__file__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__spec__&#39;, &#39;bisect&#39;, &#39;bisect_left&#39;, &#39;bisect_right&#39;, &#39;insort&#39;, &#39;insort_left&#39;, &#39;insort_right&#39;] # ä½¿ç”¨ bisect æ¨¡å—ï¼Œå¿…é¡»ä¿è¯è¦æ“ä½œçš„æ•°ç»„æ˜¯æœ‰åºçš„data = [1, 4, 6] # ç»™æ•°ç»„æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œæ’å…¥åä¸æ”¹å˜åŸæ¥é¡ºåºbisect.insort(data, 3) data [1, 3, 4, 6] # è¿™ä¸¤ä¸ªå‡½æ•°ç”¨æ¥å¤„ç†é‡åˆ°é‡å¤å…ƒç´ ï¼Œæ˜¯é€‰æ‹©å·¦æ’å…¥ï¼Œè¿˜æ˜¯å³æ’å…¥bisect.insort_left(data, 4)bisect.insort_right(data, 4) data [1, 3, 4, 4, 4, 6] # ç”¨æ¥æŸ¥æ‰¾å…ƒç´ åº”è¯¥æ’å…¥çš„ä½ç½®ï¼Œè¿”å›å¯¹åº”ä½ç½®ï¼Œä¸æ‰§è¡Œæ’å…¥æ“ä½œbisect.bisect(data, 2) # åŒæ ·æ˜¯ç”¨æ¥å¤„ç†é‡å¤å…ƒç´ print(bisect.bisect_left(data, 4))print(bisect.bisect_right(data, 4)) 2 5","categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"http://lucas0625.github.io/blog/categories/ç¼–ç¨‹/"}],"tags":[{"name":"æŠ€å·§","slug":"æŠ€å·§","permalink":"http://lucas0625.github.io/blog/tags/æŠ€å·§/"}]},{"title":"ç®—æ³•å’Œæ•°æ®ç»“æ„","slug":"Algorithms and Data Structures","date":"2018-09-11T13:17:13.800Z","updated":"2019-09-23T03:28:21.357Z","comments":true,"path":"2018/09/11/Algorithms and Data Structures/","link":"","permalink":"http://lucas0625.github.io/blog/2018/09/11/Algorithms and Data Structures/","excerpt":"æ•°æ®ç»“æ„æ•°æ®ç»“æ„å°±æ˜¯å…³ç³»ï¼Œæ•°æ®å…ƒç´ ç›¸äº’ä¹‹é—´å­˜åœ¨çš„ä¸€ç§æˆ–å¤šç§ç‰¹å®šå…³ç³»çš„é›†åˆ","text":"æ•°æ®ç»“æ„æ•°æ®ç»“æ„å°±æ˜¯å…³ç³»ï¼Œæ•°æ®å…ƒç´ ç›¸äº’ä¹‹é—´å­˜åœ¨çš„ä¸€ç§æˆ–å¤šç§ç‰¹å®šå…³ç³»çš„é›†åˆ é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„é€»è¾‘ç»“æ„ï¼š æŒ‡æ•°æ®å¯¹è±¡ä¸­æ•°æ®å…ƒç´ ä¹‹é—´çš„ç›¸äº’å…³ç³»ï¼Œä¹Ÿæ˜¯ä»Šåæœ€éœ€è¦å…³æ³¨å’Œè®¨è®ºçš„é—®é¢˜ é€»è¾‘ç»“æ„æŒ‡æ•°æ®çš„é€»è¾‘ç»“æ„åœ¨è®¡ç®—æœºä¸­çš„å­˜å‚¨å½¢å¼ å››å¤§é€»è¾‘ç»“æ„ï¼š é›†åˆç»“æ„ï¼š åŒå±ä¸€ä¸ªé›†åˆ çº¿æ€§ç»“æ„ï¼š ä¸€å¯¹ä¸€ æ ‘å½¢ç»“æ„ï¼š ä¸€å¯¹å¤š å›¾å½¢ç»“æ„ï¼š å¤šå¯¹å¤š ç‰©ç†ç»“æ„ å­˜å‚¨å™¨ï¼š ä¸»è¦é’ˆå¯¹å†…å­˜è€Œè¨€ï¼Œæƒ³èµ¢ç›˜ï¼Œå…‰ç›˜ æ•°æ®å­˜å‚¨ç»“æ„å½¢å¼ï¼š é¡ºåºå­˜å‚¨ï¼Œé“¾å¼å­˜å‚¨ é¡ºåºå­˜å‚¨ï¼š æ•°æ®å…ƒç´ å­˜æ”¾åœ¨åœ°å€è¿ç»­çš„å­˜å‚¨å•å…ƒé‡Œï¼Œå…¶æ•°æ®çš„é€»è¾‘å…³ç³»å’Œç‰©ç†å…³ç³»æ˜¯ä¸€è‡´çš„é“¾å¼å­˜å‚¨ï¼š æŠŠæ•°æ®å…ƒç´ æ”¾åœ¨ä»»æ„çš„å­˜å‚¨å•å…ƒé‡Œï¼Œè¿™ç»„å­˜å‚¨å•å…ƒå¯ä»¥æ˜¯è¿ç»­çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸è¿ç»­çš„ ç®—æ³•ç®—æ³•æ˜¯è§£å†³ç‰¹å®šé—®é¢˜æ±‚è§£æ­¥éª¤çš„æè¿°ï¼Œåœ¨è®¡ç®—æœºä¸­è¡¨ç°ä¸ºæŒ‡ä»¤çš„æœ‰é™åºåˆ—ï¼Œå¹¶ä¸”æ¯æ¡æŒ‡ä»¤è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œ ç®—æ³•çš„äº”ä¸ªåŸºæœ¬ç‰¹å¾ï¼š è¾“å…¥ï¼šé›¶ä¸ªæˆ–å¤šä¸ªè¾“å…¥ è¾“å‡ºï¼š è‡³å°‘æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å‡º æœ‰ç©·è¡Œï¼š ç®—æ³•åœ¨æ‰§è¡Œæœ‰é™çš„æ­¥éª¤ä¹‹åï¼Œè‡ªåŠ¨ç»“æŸè€Œä¸ä¼šå‡ºç°æ— é™å¾ªç¯ ç¡®å®šæ€§ï¼š æ¯ä¸€ä¸ªæ­¥éª¤éƒ½å…·æœ‰ç¡®å®šçš„å«ä¹‰ å¯è¡Œæ€§ï¼š æ¯ä¸€æ­¥éƒ½å¿…é¡»æ˜¯å¯è¡Œçš„ ç®—æ³•è®¾è®¡çš„è¦æ±‚ æ­£ç¡®æ€§ å¯è¯»æ€§ å¥å£®æ€§ æ—¶é—´æ•ˆç‡é«˜å’Œå­˜å‚¨é‡ä½ ç®—æ³•æ•ˆç‡çš„åº¦é‡æ–¹æ³•è¿è¡Œæ—¶é—´ä¸»è¦å–å†³å› ç´  ç®—æ³•é‡‡ç”¨çš„ç­–ç•¥ï¼Œæ–¹æ¡ˆ ç¼–è¯‘äº§ç”Ÿçš„ä»£ç è´¨é‡ é—®é¢˜çš„è¾“å…¥è§„æ¨¡ æœºå™¨æ‰§è¡ŒæŒ‡ä»¤çš„é€Ÿåº¦ åˆ†æç®—æ³•çš„è¿è¡Œæ—¶é—´æ—¶ï¼Œé‡è¦çš„æ˜¯æŠŠåŸºæœ¬æ“ä½œçš„æ•°é‡å’Œè¾“å…¥æ¨¡å¼å…³è”èµ·æ¥å¯ä»¥å¿½ç•¥çš„é¡¹ å¸¸æ•°å¯ä»¥å¿½ç•¥ ä¸æœ€é«˜æ¬¡é¡¹ç›¸ä¹˜çš„å¸¸æ•°å¯ä»¥å¿½ç•¥ å…¶ä»–æ¬¡é¡¹ï¼ˆé™¤å»æœ€é«˜é¡¹ï¼‰ æ—¶é—´å¤æ‚åº¦å®šä¹‰ï¼šåœ¨è¿›è¡Œç®—æ³•åˆ†ææ—¶ï¼Œè¯­å¥æ€»çš„æ‰§è¡Œæ¬¡æ•°T(n)æ˜¯å…³äºé—®é¢˜è§„æ¨¡nçš„å‡½æ•°ï¼Œè¿›è€Œåˆ†æT(n)éšnçš„å˜åŒ–æƒ…å†µå¹¶ç¡®å®šT(n)çš„æ•°é‡çº§ã€‚ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ï¼Œä¹Ÿå°±æ˜¯ç®—æ³•çš„æ—¶é—´åº¦é‡ï¼Œè®°ä½œï¼šT(n)=O(f(n))ã€‚å®ƒè¡¨ç¤ºéšé—®é¢˜è§„æ¨¡nçš„å¢å¤§ï¼Œç®—æ³•æ‰§è¡Œæ—¶é—´çš„å¢é•¿ç‡å’Œf(n)çš„å¢é•¿ç‡ç›¸åŒï¼Œç§°ä½œç®—æ³•çš„æ¸è¿›æ—¶é—´å¤æ‚åº¦ï¼Œç®€ç§°ä¸ºæ—¶é—´å¤æ‚åº¦ã€‚å…¶ä¸­f(n)æ˜¯é—®é¢˜è§„æ¨¡nçš„æŸä¸ªå‡½æ•°ã€‚è®°æ³•ï¼šO()ï¼Œå¤§Oè®°æ³•æ¨å¯¼å¤§Oé˜¶ï¼š ç”¨å¸¸æ•°1å–ä»£è¿è¡Œæ—¶é—´ä¸­çš„æ‰€æœ‰å‡å‘å¸¸æ•° åœ¨ä¿®æ”¹åçš„è¿è¡Œæ¬¡æ•°å‡½æ•°ä¸­ï¼Œåªä¿ç•™æœ€é«˜é˜¶é¡¹ å¦‚æœæœ€é«˜é˜¶å­˜åœ¨ä¸”ä¸æ˜¯1ï¼Œåˆ™å»é™¤ä¸è¿™ä¸ªé¡¹ç›¸ä¹˜çš„å¸¸æ•° å¾—åˆ°çš„æœ€åç»“æœå°±æ˜¯å¤§Oé˜¶æœ€å¸¸ç”¨çš„å¤§Oé˜¶1.O(1) å¸¸æ•°é˜¶2.O(n) çº¿å½¢é˜¶3.O(n^2 ) å¹³æ–¹é˜¶4.O(logn) å¯¹æ•°é˜¶5.O(nlogn) nlogné˜¶6.O(n^3 ) ç«‹æ–¹é˜¶7.O(2^n ) æŒ‡æ•°é˜¶ ç©ºé—´å¤æ‚åº¦ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦é€šè¿‡è®¡ç®—ç®—æ³•æ‰€éœ€çš„å­˜å‚¨ç©ºé—´å®ç°ï¼Œç®—æ³•çš„ç©ºé—´å¤æ‚åº¦çš„è®¡ç®—å…¬å¼ï¼šS(n)=O(f(n))ï¼Œå…¶ä¸­ï¼Œnä¸ºé—®é¢˜è§„æ¨¡ï¼Œf(n)ä¸ºè¯­å¥å…³äºnæ‰€å å­˜å‚¨ç©ºé—´çš„å‡½æ•°é€šå¸¸ï¼Œæˆ‘ä»¬éƒ½æ˜¯ç”¨æ—¶é—´å¤æ‚åº¦æ¥æŒ‡è¿è¡Œæ—¶é—´çš„éœ€æ±‚ï¼Œç”¨ç©ºé—´å¤æ‚åº¦æ¥æŒ‡ç©ºé—´éœ€æ±‚ å››å¤§ç®—æ³•æ€æƒ³è´ªå¿ƒæ€æƒ³æ ¸å¿ƒé’ˆå¯¹ä¸€ç»„æ•°æ®ï¼Œæˆ‘ä»¬å®šä¹‰äº†é™åˆ¶å€¼å’ŒæœŸæœ›å€¼ï¼Œå¸Œæœ›ä»ä¸­é€‰å‡ºå‡ ä¸ªæ•°æ®ï¼Œåœ¨æ»¡è¶³é™åˆ¶å€¼çš„æƒ…å†µä¸‹ï¼ŒæœŸæœ›å€¼æœ€å¤§ã€‚æ‰€åšçš„ä¸‹ä¸€æ­¥é€‰æ‹©ä¸€å®šæ˜¯å½“å‰çš„æœ€ä¼˜è§£ã€‚ä½†æ˜¯å½“è¯¥æ­¥é€‰æ‹©å¯¹ä¸‹ä¸€æ­¥é€‰æ‹©æœ‰å½±å“çš„è¯ï¼Œå¾€å¾€è´ªå¿ƒç®—æ³•ä¸èƒ½æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚ å…¸å‹é—®é¢˜ èƒŒåŒ…é—®é¢˜ åˆ†ç³–æœé—®é¢˜ æˆ‘ä»¬æœ‰ m ä¸ªç³–æœå’Œ n ä¸ªå­©å­ã€‚æˆ‘ä»¬ç°åœ¨è¦æŠŠç³–æœåˆ†ç»™è¿™äº›å­©å­åƒï¼Œä½†æ˜¯ç³–æœå°‘ï¼Œå­©å­å¤šï¼ˆm&lt;nï¼‰ï¼Œæ‰€ä»¥ç³–æœåªèƒ½åˆ†é…ç»™ä¸€éƒ¨åˆ†å­©å­ã€‚ æ¯ä¸ªç³–æœçš„å¤§å°ä¸ç­‰ï¼Œè¿™ m ä¸ªç³–æœçš„å¤§å°åˆ†åˆ«æ˜¯ s1ï¼Œs2ï¼Œs3ï¼Œâ€¦â€¦ï¼Œsmã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸ªå­©å­å¯¹ç³–æœå¤§å°çš„éœ€æ±‚ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œåªæœ‰ç³–æœçš„å¤§å°å¤§äºç­‰äºå­©å­çš„å¯¹ç³–æœå¤§å°çš„éœ€æ±‚çš„æ—¶å€™ï¼Œå­©å­æ‰å¾—åˆ°æ»¡è¶³ã€‚å‡è®¾è¿™ n ä¸ªå­©å­å¯¹ç³–æœå¤§å°çš„éœ€æ±‚åˆ†åˆ«æ˜¯ g1ï¼Œg2ï¼Œg3ï¼Œâ€¦â€¦ï¼Œgnã€‚ é—®é¢˜æ˜¯ï¼Œå¦‚ä½•åˆ†é…ç³–æœï¼Œèƒ½å°½å¯èƒ½æ»¡è¶³æœ€å¤šæ•°é‡çš„å­©å­ï¼Ÿ é’±å¸æ‰¾é›¶é—®é¢˜ å‡è®¾æˆ‘ä»¬æœ‰ 1 å…ƒã€2 å…ƒã€5 å…ƒã€10 å…ƒã€20 å…ƒã€50 å…ƒã€100 å…ƒè¿™äº›é¢é¢çš„çº¸å¸ï¼Œå®ƒä»¬çš„å¼ æ•°åˆ†åˆ«æ˜¯ c1ã€c2ã€c5ã€c10ã€c20ã€c50ã€c100ã€‚æˆ‘ä»¬ç°åœ¨è¦ç”¨è¿™äº›é’±æ¥æ”¯ä»˜ K å…ƒï¼Œæœ€å°‘è¦ç”¨å¤šå°‘å¼ çº¸å¸å‘¢ï¼Ÿ åˆ†æ²»æ€æƒ³å›æº¯æ€æƒ³åŠ¨æ€è§„åˆ’æ€æƒ³å›¾æœç´¢æ·±åº¦ä¼˜å…ˆæœç´¢(DFS) å®šä¹‰ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDepth First Searchï¼ŒDFSï¼‰ï¼Œæ˜¯æœ€å¸¸è§çš„å›¾æœç´¢æ–¹æ³•ä¹‹ä¸€ã€‚æ·±åº¦ä¼˜å…ˆæœç´¢æ²¿ç€ä¸€æ¡è·¯å¾„ä¸€ç›´èµ°ä¸‹å»ï¼Œæ— æ³•è¡Œè¿›æ—¶ï¼Œå›é€€å›é€€åˆ°åˆšåˆšè®¿é—®çš„ç»“ç‚¹ï¼Œä¼¼ä¸æ’å—å¢™ä¸å›å¤´ï¼Œä¸åˆ°é»„æ²³ä¸æ­»å¿ƒã€‚æ·±åº¦ä¼˜å…ˆéå†æ˜¯æŒ‰ç…§æ·±åº¦ä¼˜å…ˆæœç´¢çš„æ–¹å¼å¯¹å›¾è¿›è¡Œéå†ã€‚ ç§˜ç±:åè¢«è®¿é—®çš„é¡¶ç‚¹ï¼Œå…¶é‚»æ¥ç‚¹å…ˆè¢«è®¿é—®ã€‚æ ¹æ®æ·±åº¦ä¼˜å…ˆéå†ç§˜ç±ï¼Œåæ¥å…ˆæœåŠ¡ï¼Œå¯ä»¥å€ŸåŠ©äºæ ˆå®ç°ã€‚é€’å½’æœ¬èº«å°±æ˜¯ä½¿ç”¨æ ˆå®ç°çš„ï¼Œå› æ­¤ä½¿ç”¨é€’å½’æ–¹æ³•æ›´æ–¹ä¾¿ã€‚ ç®—æ³•æ­¥éª¤: åˆå§‹åŒ–å›¾ä¸­æ‰€æœ‰é¡¶ç‚¹æœªè¢«è®¿é—®ã€‚ ä»å›¾ä¸­çš„æŸä¸ªé¡¶ç‚¹vå‡ºå‘ï¼Œè®¿é—®vå¹¶æ ‡è®°å·²è®¿é—®ï¼› ä¾æ¬¡æ£€æŸ¥vçš„æ‰€æœ‰é‚»æ¥ç‚¹wï¼Œå¦‚æœwæœªè¢«è®¿é—®ï¼Œåˆ™ä»wå‡ºå‘è¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†ï¼ˆé€’å½’è°ƒç”¨ï¼Œé‡å¤2â€”3æ­¥ï¼‰ã€‚ ç®—æ³•å›¾è§£:ç”Ÿæˆæ ‘:åŒ…å«æ‰€æœ‰èŠ‚ç‚¹çš„æ ‘ç”Ÿæˆï¼šåŒ…å«æ‰€æœ‰èŠ‚ç‚¹ ã€‚ æ ‘ï¼šè¿é€šm=n-1ï¼Œå³è¿é€šæ— å›è·¯ã€‚ ä»£ç å®ç°: def process(node): ''' å¯¹èŠ‚ç‚¹è¿›è¡Œä¸€ç³»åˆ—æ“ä½œ :param node: è¦æ“ä½œçš„èŠ‚ç‚¹ :return: ''' passdef generate_related_nodes(node): ''' å–å‡ºå½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰åç»§èŠ‚ç‚¹ :param node: å½“å‰èŠ‚ç‚¹ :return: è¿”å›æ‰€æœ‰åç»§èŠ‚ç‚¹ ''' passvisited = set()def DFS(node, visited): visited.add(node) process(node) ... for next_node in generate_related_nodes(node): if not next_node in visited: DFS(node, visited) å¹¿åº¦ä¼˜å…ˆæœç´¢(BFS) å®šä¹‰: ä¾æ¬¡è®¿é—®æ¯ä¸ªèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ ç®—æ³•å›¾è§£: ä»£ç å®ç°: def process(node): ''' å¯¹èŠ‚ç‚¹è¿›è¡Œä¸€ç³»åˆ—æ“ä½œ :param node: è¦æ“ä½œçš„èŠ‚ç‚¹ :return: ''' passdef generate_related_nodes(node): ''' å–å‡ºå½“å‰èŠ‚ç‚¹çš„å…¨éƒ¨åç»§èŠ‚ç‚¹ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦è¢«è®¿é—®è¿‡ã€‚ :param node: å½“å‰èŠ‚ç‚¹ :return: è¿”å›æ‰€æœ‰æ²¡è®¿é—®è¿‡çš„åç»§èŠ‚ç‚¹ ''' passdef BFS(graph, start, end): queue = [] visited = set() # å­˜å‚¨è®¿é—®è¿‡çš„å…ƒç´  queue.append(start) visited.add(start) while queue: node = queue.pop() visited.add(node) process(node) nodes = generate_related_nodes(node) queue.append(nodes) å“ˆå¸Œè¡¨ä¸¤ç§å®ç°æ–¹å¼ å“ˆå¸Œå‡½æ•°ï¼ŒæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œè§£å†³å“ˆå¸Œå†²çªçš„æ—¶å€™å¯ä»¥é‡‡å–åœ¨å†²çªä½ç½®å†…åµŒé“¾è¡¨ã€‚ ä¼˜ç‚¹ï¼šæŸ¥æ‰¾é€Ÿåº¦å¿«ã€‚ ç¼ºç‚¹ï¼šæ•°æ®å­˜æ”¾å®Œå…¨æ— åº äºŒå‰æ ‘ï¼ŒæŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦O(logN)ã€‚ ä¼˜ç‚¹: æ•°æ®å­˜æ”¾ç›¸å¯¹æœ‰åºã€‚ ç¼ºç‚¹: æŸ¥æ‰¾ç›¸å¯¹è¾ƒæ…¢ äºŒå‰æ ‘æ¦‚å¿µ äºŒå‰æ ‘ï¼šæ¯ä¸ªèŠ‚ç‚¹åªæœ‰ä¸¤ä¸ªå­©å­ï¼Œå·¦å­©å­ï¼Œå³å­©å­ã€‚ å®Œå…¨äºŒå‰æ ‘: æ¯ä¸ªèŠ‚ç‚¹éƒ½éƒ½å«æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚ äºŒå‰æœç´¢æ ‘ï¼šç©ºæ ‘æˆ–è€…å·¦å­æ ‘æ¯ä¸ªèŠ‚ç‚¹éƒ½å°äºæ ¹èŠ‚ç‚¹ï¼Œå³å­æ ‘æ¯ä¸ªèŠ‚ç‚¹éƒ½å¤§äºæ ¹èŠ‚ç‚¹ ä»£ç class TreeNode(): def __init__(self, val): self.val = val self.left, self.right = None, None äºŒåˆ†æŸ¥æ‰¾æ¦‚å¿µæ»¡è¶³äºŒåˆ†æŸ¥æ‰¾çš„æ¡ä»¶ï¼š åºåˆ—å•è°ƒé€’å¢æˆ–è€…é€’å‡ å­˜åœ¨ä¸Šä¸‹å±Š èƒ½å¤Ÿé€šè¿‡ç´¢å¼•è®¿é—® ä»£ç # æ—¶é—´å¤æ‚åº¦O(logN)# ä¼ªä»£ç ï¼Œæ•°ç»„é»˜è®¤é€’å¢left, right = 0, len(array) -1while left &lt;= right: mid = (left + right) // 2 if array[mid] == target: //æ‰¾åˆ°ç›®æ ‡ break or return result elif array[mid] &lt; target: left = mid + 1 else: right = mid -1 Trie æ ‘(å­—å…¸æ ‘)æ¦‚å¿µæ˜¯ä¸€ç§æ ‘å½¢ç»“æ„ï¼Œæ˜¯ä¸€ç§å“ˆå¸Œæ ‘çš„å˜ç§ã€‚å…¸å‹çš„åº”ç”¨æ˜¯ç”¨äºç»Ÿè®¡å’Œæ’åºå¤§é‡çš„å­—ç¬¦ä¸²(ä½†ä¸ä»…é™ä¸å­—ç¬¦ä¸²)ï¼Œæ‰€ä»¥ç»å¸¸è¢«æœç´¢å¼•æ“ç³»ç»Ÿç”¨äºæ–‡æœ¬è¯é¢‘ç»Ÿè®¡ã€‚ä¼˜ç‚¹ï¼šæœ€å¤§é™åº¦åœ°å‡å°‘æ— è°“çš„å­—ç¬¦ä¸²æ¯”è¾ƒï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”å“ˆå¸Œè¡¨é«˜ã€‚ç‰¹ç‚¹ï¼šç”¨è¾¹æ¥å­˜å‚¨å­—ç¬¦ï¼Œèµ°è¿‡çš„è·¯å¾„ä»£è¡¨ä¸€ä¸ªå•è¯ï¼Œå¶å­ç»“ç‚¹ä»£è¡¨ä¸€ä¸ªå•è¯ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šç©ºé—´æ¢æ—¶é—´ï¼Œåˆ©ç”¨å­—ç¬¦ä¸²çš„å…¬å…±å‰ç¼€æ¥é™ä½æŸ¥è¯¢æ—¶é—´çš„å¼€é”€ä»¥è¾¾åˆ°æé«˜æ•ˆç‡çš„ç›®çš„ã€‚ ä»£ç class Trie: def __init__(self): \"\"\" Initialize your data structure here. \"\"\" self.root = dict() self.end_of_word = '#' def insert(self, word: str) -&gt; None: \"\"\" Inserts a word into the trie. \"\"\" node = self.root for char in word: node = node.setdefault(char, &#123;&#125;) node[self.end_of_word] = self.end_of_word def search(self, word: str) -&gt; bool: \"\"\" Returns if the word is in the trie. \"\"\" node = self.root for char in word: if char not in node: return False node = node[char] return self.end_of_word in node def startsWith(self, prefix: str) -&gt; bool: \"\"\" Returns if there is any word in the trie that starts with the given prefix. \"\"\" node = self.root for char in prefix: if char not in node: return False node = node[char] return True # Your Trie object will be instantiated and called as such:# obj = Trie()# obj.insert(word)# param_2 = obj.search(word)# param_3 = obj.startsWith(prefix) Bloom Filter å¸ƒéš†è¿‡æ»¤å™¨å®šä¹‰ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡å’Œä¸€ä¸ªæ˜ å°„å‡½æ•°ã€‚å¸ƒéš†è¿‡æ»¤å™¨ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å¦‚æœåˆ¤æ–­ç»“æœä¸åœ¨é›†åˆä¸­ï¼Œåˆ™ä¸€å®šä¸åœ¨é›†åˆä¸­ã€‚è‹¥åˆ¤æ–­ç»“æœåœ¨é›†åˆä¸­ï¼Œåˆ™æœ‰ä¸€å®šæ¦‚ç‡åˆ¤æ–­é”™è¯¯ã€‚ä¼˜ç‚¹ï¼šç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬ç®—æ³•ã€‚ç¼ºç‚¹ï¼šæœ‰ä¸€å®šçš„è¯¯è¯†åˆ«ç‡å’Œåˆ é™¤å›°éš¾ã€‚ä¸ç¼“å­˜æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œå¯ä»¥ä½œä¸ºé¢„å¤„ç†æ¨¡å—ã€‚ ä»£ç from bitarray import bitarrayimport mmh3class BloomFilter(set): def __init__(self,size,hash_count): #size:the num of the bitarray #hash_count:the num of hash function super(BloomFilter,self).__init__() self.bit_array = bitarray(size) self.bit_array.setall(0) #åˆå§‹åŒ–ä¸º0 self.size = size self.hash_count = hash_count def __len__(self): return self.size def __iter__(self): return iter(self.bit_array) def add(self,item): for i in range(self.hash_count): index = mmh3.hash(item,i) % self.size self.bit_array[index] = 1 return self def __contains__(self,item): out = True for i in range(self.hash_count): index = mmh3.hash(item,i)%self.size if bit_array[index] == 0: out = False return out å †å®šä¹‰å †æ˜¯ä¸€ç§åŸºæœ¬çš„æ•°æ®ç»“æ„ã€‚åœ¨è¿™é‡Œæˆ‘ç”¨æ•°ç»„æ¥å½¢å®¹ï¼Œåœ¨ä¸€ä¸ªäºŒå‰å †çš„æ•°ç»„ä¸­ï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½è¦ä¿è¯å¤§äºç­‰äºå¦å¤–ä¸¤ä¸ªç‰¹å®šä½ç½®çš„å…ƒç´ ã€‚åŒæ—¶ç›¸åº”çš„ï¼Œè¿™äº›å…ƒç´ åˆè¦å¤§äºç­‰äºå¦å¤–ä¸¤ä¸ªç›¸åº”ä½ç½®çš„å…ƒç´ ï¼Œæ•´ä¸ªæ•°æ®ç»“æ„ä»¥æ­¤ç±»æ¨ã€‚å¦‚æœæˆ‘ä»¬å°†æ•´ä¸ªæ•°æ®ç»“æ„ç”»æˆæ ‘çŠ¶ç»“æ„ï¼Œå°±èƒ½å¤Ÿæ¸…æ™°åœ°çœ‹å‡ºæ•´ä¸ªç»“æ„çš„æ ·å­ã€‚ä¸‹å›¾ä»£è¡¨å¤§é¡¶å †å’Œå°é¡¶å †ï¼š ä»£ç å®ç°python ä¸­å†…ç½®åŒ…heapqå®ç°äº†å°é¡¶å †import heapqnums = [4, 5, 2, 4, 5, 3, 9, 8]heapq.heapify(nums) # å°†åˆ—è¡¨å˜ä¸ºå †heapq.heappush(nums, 10) # å¾€å †ä¸­æ·»åŠ å…ƒç´ nums_min = heapq.heappop(nums) # è¿”å›å †ä¸­çš„æœ€å°å…ƒç´ , å¹¶å°†è¯¥å…ƒç´ åˆ é™¤nums_top_N = heapq.nlargest(3, nums) # è¿”å›å †ä¸­æœ€å¤§çš„3ä¸ªæ•°nums_small_N = heapq.nsmallest(3, nums) # è¿”å›å †ä¸­æœ€å°çš„3ä¸ªæ•° åŠ¨æ€è§„åˆ’è§£å†³ç±»ä¼¼é—®é¢˜ï¼šæ±‚è·¯å¾„ é€’æ¨ (é€’å½’ + è®°å¿†åŒ–) çŠ¶æ€å®šä¹‰ï¼šopt[n], dp[n], fib[n] çŠ¶æ€è½¬ç§»æ–¹ç¨‹: opt[n] = best_of(opt[n-1], opt[n-2], â€¦) æœ€ä¼˜å­ç»“æ„.æŒ‡çš„æ˜¯è§£å†³æœ€ç»ˆé—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œè§£å†³äº†åŒ…å«çš„å­é—®é¢˜ã€‚ DP VS å›æº¯ VS è´ªå¿ƒ æ¯”è¾ƒ å›æº¯ï¼ˆé€’å½’ï¼‰ â€” é‡å¤è®¡ç®— è´ªå¿ƒ â€” æ°¸è¿œå±€éƒ¨æœ€ä¼˜è§£ DP â€” è®°å½•å±€éƒ¨æœ€ä¼˜å­ç»“æ„/å¤šç§è®°å½•å€¼","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/categories/ç®—æ³•/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://lucas0625.github.io/blog/tags/ç®—æ³•/"}]}]}